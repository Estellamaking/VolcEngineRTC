/*
* Copyright (c) 2020 The VolcEngineRTC project authors. All Rights Reserved.
* @brief VolcEngine Advance API
* version: 4.44.0
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).VERTC=t()}(this,(function(){"use strict";function e(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i=function(e){return e&&e.Math==Math&&e},n=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof r&&r)||function(){return this}()||Function("return this")(),o={},a=function(e){try{return!!e()}catch(e){return!0}},s=!a((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),c=!a((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),u=c,d=Function.prototype.call,l=u?d.bind(d):function(){return d.apply(d,arguments)},h={},p={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,_=f&&!p.call({1:2},1);h.f=_?function(e){var t=f(this,e);return!!t&&t.enumerable}:p;var v,m,S=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},y=c,E=Function.prototype,g=E.bind,b=E.call,T=y&&g.bind(b,b),I=y?function(e){return e&&T(e)}:function(e){return e&&function(){return b.apply(e,arguments)}},R=I,A=R({}.toString),C=R("".slice),O=function(e){return C(A(e),8,-1)},N=I,w=a,P=O,D=n.Object,k=N("".split),M=w((function(){return!D("z").propertyIsEnumerable(0)}))?function(e){return"String"==P(e)?k(e,""):D(e)}:D,U=n.TypeError,L=function(e){if(null==e)throw U("Can't call method on "+e);return e},x=M,V=L,F=function(e){return x(V(e))},B=function(e){return"function"==typeof e},j=B,G=function(e){return"object"==typeof e?null!==e:j(e)},H=n,z=B,K=function(e){return z(e)?e:void 0},W=function(e,t){return arguments.length<2?K(H[e]):H[e]&&H[e][t]},X=I({}.isPrototypeOf),Y=W("navigator","userAgent")||"",J=n,q=Y,Q=J.process,Z=J.Deno,$=Q&&Q.versions||Z&&Z.version,ee=$&&$.v8;ee&&(m=(v=ee.split("."))[0]>0&&v[0]<4?1:+(v[0]+v[1])),!m&&q&&(!(v=q.match(/Edge\/(\d+)/))||v[1]>=74)&&(v=q.match(/Chrome\/(\d+)/))&&(m=+v[1]);var te=m,re=te,ie=a,ne=!!Object.getOwnPropertySymbols&&!ie((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&re&&re<41})),oe=ne&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ae=W,se=B,ce=X,ue=oe,de=n.Object,le=ue?function(e){return"symbol"==typeof e}:function(e){var t=ae("Symbol");return se(t)&&ce(t.prototype,de(e))},he=n.String,pe=function(e){try{return he(e)}catch(e){return"Object"}},fe=B,_e=pe,ve=n.TypeError,me=function(e){if(fe(e))return e;throw ve(_e(e)+" is not a function")},Se=me,ye=function(e,t){var r=e[t];return null==r?void 0:Se(r)},Ee=l,ge=B,be=G,Te=n.TypeError,Ie={exports:{}},Re=n,Ae=Object.defineProperty,Ce=function(e,t){try{Ae(Re,e,{value:t,configurable:!0,writable:!0})}catch(r){Re[e]=t}return t},Oe=Ce,Ne="__core-js_shared__",we=n[Ne]||Oe(Ne,{}),Pe=we;(Ie.exports=function(e,t){return Pe[e]||(Pe[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.0",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",source:"https://github.com/zloirock/core-js"});var De=L,ke=n.Object,Me=function(e){return ke(De(e))},Ue=Me,Le=I({}.hasOwnProperty),xe=Object.hasOwn||function(e,t){return Le(Ue(e),t)},Ve=I,Fe=0,Be=Math.random(),je=Ve(1..toString),Ge=function(e){return"Symbol("+(void 0===e?"":e)+")_"+je(++Fe+Be,36)},He=n,ze=Ie.exports,Ke=xe,We=Ge,Xe=ne,Ye=oe,Je=ze("wks"),qe=He.Symbol,Qe=qe&&qe.for,Ze=Ye?qe:qe&&qe.withoutSetter||We,$e=function(e){if(!Ke(Je,e)||!Xe&&"string"!=typeof Je[e]){var t="Symbol."+e;Xe&&Ke(qe,e)?Je[e]=qe[e]:Je[e]=Ye&&Qe?Qe(t):Ze(t)}return Je[e]},et=l,tt=G,rt=le,it=ye,nt=function(e,t){var r,i;if("string"===t&&ge(r=e.toString)&&!be(i=Ee(r,e)))return i;if(ge(r=e.valueOf)&&!be(i=Ee(r,e)))return i;if("string"!==t&&ge(r=e.toString)&&!be(i=Ee(r,e)))return i;throw Te("Can't convert object to primitive value")},ot=$e,at=n.TypeError,st=ot("toPrimitive"),ct=function(e,t){if(!tt(e)||rt(e))return e;var r,i=it(e,st);if(i){if(void 0===t&&(t="default"),r=et(i,e,t),!tt(r)||rt(r))return r;throw at("Can't convert object to primitive value")}return void 0===t&&(t="number"),nt(e,t)},ut=ct,dt=le,lt=function(e){var t=ut(e,"string");return dt(t)?t:t+""},ht=G,pt=n.document,ft=ht(pt)&&ht(pt.createElement),_t=function(e){return ft?pt.createElement(e):{}},vt=_t,mt=!s&&!a((function(){return 7!=Object.defineProperty(vt("div"),"a",{get:function(){return 7}}).a})),St=s,yt=l,Et=h,gt=S,bt=F,Tt=lt,It=xe,Rt=mt,At=Object.getOwnPropertyDescriptor;o.f=St?At:function(e,t){if(e=bt(e),t=Tt(t),Rt)try{return At(e,t)}catch(e){}if(It(e,t))return gt(!yt(Et.f,e,t),e[t])};var Ct={},Ot=s&&a((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Nt=n,wt=G,Pt=Nt.String,Dt=Nt.TypeError,kt=function(e){if(wt(e))return e;throw Dt(Pt(e)+" is not an object")},Mt=s,Ut=mt,Lt=Ot,xt=kt,Vt=lt,Ft=n.TypeError,Bt=Object.defineProperty,jt=Object.getOwnPropertyDescriptor,Gt="enumerable",Ht="configurable",zt="writable";Ct.f=Mt?Lt?function(e,t,r){if(xt(e),t=Vt(t),xt(r),"function"==typeof e&&"prototype"===t&&"value"in r&&zt in r&&!r.writable){var i=jt(e,t);i&&i.writable&&(e[t]=r.value,r={configurable:Ht in r?r.configurable:i.configurable,enumerable:Gt in r?r.enumerable:i.enumerable,writable:!1})}return Bt(e,t,r)}:Bt:function(e,t,r){if(xt(e),t=Vt(t),xt(r),Ut)try{return Bt(e,t,r)}catch(e){}if("get"in r||"set"in r)throw Ft("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Kt=Ct,Wt=S,Xt=s?function(e,t,r){return Kt.f(e,t,Wt(1,r))}:function(e,t,r){return e[t]=r,e},Yt={exports:{}},Jt=B,qt=we,Qt=I(Function.toString);Jt(qt.inspectSource)||(qt.inspectSource=function(e){return Qt(e)});var Zt,$t,er,tr=qt.inspectSource,rr=B,ir=tr,nr=n.WeakMap,or=rr(nr)&&/native code/.test(ir(nr)),ar=Ie.exports,sr=Ge,cr=ar("keys"),ur=function(e){return cr[e]||(cr[e]=sr(e))},dr={},lr=or,hr=n,pr=I,fr=G,_r=Xt,vr=xe,mr=we,Sr=ur,yr=dr,Er="Object already initialized",gr=hr.TypeError,br=hr.WeakMap;if(lr||mr.state){var Tr=mr.state||(mr.state=new br),Ir=pr(Tr.get),Rr=pr(Tr.has),Ar=pr(Tr.set);Zt=function(e,t){if(Rr(Tr,e))throw new gr(Er);return t.facade=e,Ar(Tr,e,t),t},$t=function(e){return Ir(Tr,e)||{}},er=function(e){return Rr(Tr,e)}}else{var Cr=Sr("state");yr[Cr]=!0,Zt=function(e,t){if(vr(e,Cr))throw new gr(Er);return t.facade=e,_r(e,Cr,t),t},$t=function(e){return vr(e,Cr)?e[Cr]:{}},er=function(e){return vr(e,Cr)}}var Or={set:Zt,get:$t,has:er,enforce:function(e){return er(e)?$t(e):Zt(e,{})},getterFor:function(e){return function(t){var r;if(!fr(t)||(r=$t(t)).type!==e)throw gr("Incompatible receiver, "+e+" required");return r}}},Nr=s,wr=xe,Pr=Function.prototype,Dr=Nr&&Object.getOwnPropertyDescriptor,kr=wr(Pr,"name"),Mr={EXISTS:kr,PROPER:kr&&"something"===function(){}.name,CONFIGURABLE:kr&&(!Nr||Nr&&Dr(Pr,"name").configurable)},Ur=n,Lr=B,xr=xe,Vr=Xt,Fr=Ce,Br=tr,jr=Mr.CONFIGURABLE,Gr=Or.get,Hr=Or.enforce,zr=String(String).split("String");(Yt.exports=function(e,t,r,i){var n,o=!!i&&!!i.unsafe,a=!!i&&!!i.enumerable,s=!!i&&!!i.noTargetGet,c=i&&void 0!==i.name?i.name:t;Lr(r)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!xr(r,"name")||jr&&r.name!==c)&&Vr(r,"name",c),(n=Hr(r)).source||(n.source=zr.join("string"==typeof c?c:""))),e!==Ur?(o?!s&&e[t]&&(a=!0):delete e[t],a?e[t]=r:Vr(e,t,r)):a?e[t]=r:Fr(t,r)})(Function.prototype,"toString",(function(){return Lr(this)&&Gr(this).source||Br(this)}));var Kr={},Wr=Math.ceil,Xr=Math.floor,Yr=function(e){var t=+e;return t!=t||0===t?0:(t>0?Xr:Wr)(t)},Jr=Yr,qr=Math.max,Qr=Math.min,Zr=function(e,t){var r=Jr(e);return r<0?qr(r+t,0):Qr(r,t)},$r=Yr,ei=Math.min,ti=function(e){return e>0?ei($r(e),9007199254740991):0},ri=ti,ii=function(e){return ri(e.length)},ni=F,oi=Zr,ai=ii,si=function(e){return function(t,r,i){var n,o=ni(t),a=ai(o),s=oi(i,a);if(e&&r!=r){for(;a>s;)if((n=o[s++])!=n)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},ci={includes:si(!0),indexOf:si(!1)},ui=xe,di=F,li=ci.indexOf,hi=dr,pi=I([].push),fi=function(e,t){var r,i=di(e),n=0,o=[];for(r in i)!ui(hi,r)&&ui(i,r)&&pi(o,r);for(;t.length>n;)ui(i,r=t[n++])&&(~li(o,r)||pi(o,r));return o},_i=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],vi=fi,mi=_i.concat("length","prototype");Kr.f=Object.getOwnPropertyNames||function(e){return vi(e,mi)};var Si={};Si.f=Object.getOwnPropertySymbols;var yi=W,Ei=Kr,gi=Si,bi=kt,Ti=I([].concat),Ii=yi("Reflect","ownKeys")||function(e){var t=Ei.f(bi(e)),r=gi.f;return r?Ti(t,r(e)):t},Ri=xe,Ai=Ii,Ci=o,Oi=Ct,Ni=function(e,t,r){for(var i=Ai(t),n=Oi.f,o=Ci.f,a=0;a<i.length;a++){var s=i[a];Ri(e,s)||r&&Ri(r,s)||n(e,s,o(t,s))}},wi=a,Pi=B,Di=/#|\.prototype\./,ki=function(e,t){var r=Ui[Mi(e)];return r==xi||r!=Li&&(Pi(t)?wi(t):!!t)},Mi=ki.normalize=function(e){return String(e).replace(Di,".").toLowerCase()},Ui=ki.data={},Li=ki.NATIVE="N",xi=ki.POLYFILL="P",Vi=ki,Fi=n,Bi=o.f,ji=Xt,Gi=Yt.exports,Hi=Ce,zi=Ni,Ki=Vi,Wi=function(e,t){var r,i,n,o,a,s=e.target,c=e.global,u=e.stat;if(r=c?Fi:u?Fi[s]||Hi(s,{}):(Fi[s]||{}).prototype)for(i in t){if(o=t[i],n=e.noTargetGet?(a=Bi(r,i))&&a.value:r[i],!Ki(c?i:s+(u?".":"#")+i,e.forced)&&void 0!==n){if(typeof o==typeof n)continue;zi(o,n)}(e.sham||n&&n.sham)&&ji(o,"sham",!0),Gi(r,i,o,e)}},Xi=n,Yi=B,Ji=Xi.String,qi=Xi.TypeError,Qi=I,Zi=kt,$i=function(e){if("object"==typeof e||Yi(e))return e;throw qi("Can't set "+Ji(e)+" as a prototype")},en=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Qi(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(e){}return function(r,i){return Zi(r),$i(i),t?e(r,i):r.__proto__=i,r}}():void 0);Wi({target:"Object",stat:!0},{setPrototypeOf:en});var tn={},rn=fi,nn=_i,on=Object.keys||function(e){return rn(e,nn)},an=s,sn=Ot,cn=Ct,un=kt,dn=F,ln=on;tn.f=an&&!sn?Object.defineProperties:function(e,t){un(e);for(var r,i=dn(t),n=ln(t),o=n.length,a=0;o>a;)cn.f(e,r=n[a++],i[r]);return e};var hn,pn=W("document","documentElement"),fn=kt,_n=tn,vn=_i,mn=dr,Sn=pn,yn=_t,En=ur("IE_PROTO"),gn=function(){},bn=function(e){return"<script>"+e+"</"+"script>"},Tn=function(e){e.write(bn("")),e.close();var t=e.parentWindow.Object;return e=null,t},In=function(){try{hn=new ActiveXObject("htmlfile")}catch(e){}var e,t;In="undefined"!=typeof document?document.domain&&hn?Tn(hn):((t=yn("iframe")).style.display="none",Sn.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(bn("document.F=Object")),e.close(),e.F):Tn(hn);for(var r=vn.length;r--;)delete In.prototype[vn[r]];return In()};mn[En]=!0;var Rn=Object.create||function(e,t){var r;return null!==e?(gn.prototype=fn(e),r=new gn,gn.prototype=null,r[En]=e):r=In(),void 0===t?r:_n.f(r,t)};Wi({target:"Object",stat:!0,sham:!s},{create:Rn});var An=s,Cn=I,On=l,Nn=a,wn=on,Pn=Si,Dn=h,kn=Me,Mn=M,Un=Object.assign,Ln=Object.defineProperty,xn=Cn([].concat),Vn=!Un||Nn((function(){if(An&&1!==Un({b:1},Un(Ln({},"a",{enumerable:!0,get:function(){Ln(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach((function(e){t[e]=e})),7!=Un({},e)[r]||wn(Un({},t)).join("")!=i}))?function(e,t){for(var r=kn(e),i=arguments.length,n=1,o=Pn.f,a=Dn.f;i>n;)for(var s,c=Mn(arguments[n++]),u=o?xn(wn(c),o(c)):wn(c),d=u.length,l=0;d>l;)s=u[l++],An&&!On(a,c,s)||(r[s]=c[s]);return r}:Un,Fn=Vn;Wi({target:"Object",stat:!0,forced:Object.assign!==Fn},{assign:Fn});var Bn=a,jn=function(e,t){var r=[][e];return!!r&&Bn((function(){r.call(null,t||function(){throw 1},1)}))},Gn=Wi,Hn=ci.indexOf,zn=jn,Kn=I([].indexOf),Wn=!!Kn&&1/Kn([1],1,-0)<0,Xn=zn("indexOf");Gn({target:"Array",proto:!0,forced:Wn||!Xn},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return Wn?Kn(this,e,t)||0:Hn(this,e,t)}});var Yn=c,Jn=Function.prototype,qn=Jn.apply,Qn=Jn.call,Zn="object"==typeof Reflect&&Reflect.apply||(Yn?Qn.bind(qn):function(){return Qn.apply(qn,arguments)}),$n=O,eo=Array.isArray||function(e){return"Array"==$n(e)},to={};to[$e("toStringTag")]="z";var ro="[object z]"===String(to),io=n,no=ro,oo=B,ao=O,so=$e("toStringTag"),co=io.Object,uo="Arguments"==ao(function(){return arguments}()),lo=no?ao:function(e){var t,r,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=co(e),so))?r:uo?ao(t):"Object"==(i=ao(t))&&oo(t.callee)?"Arguments":i},ho=lo,po=n.String,fo=function(e){if("Symbol"===ho(e))throw TypeError("Cannot convert a Symbol value to a string");return po(e)},_o={},vo=lt,mo=Ct,So=S,yo=function(e,t,r){var i=vo(t);i in e?mo.f(e,i,So(0,r)):e[i]=r},Eo=Zr,go=ii,bo=yo,To=n.Array,Io=Math.max,Ro=function(e,t,r){for(var i=go(e),n=Eo(t,i),o=Eo(void 0===r?i:r,i),a=To(Io(o-n,0)),s=0;n<o;n++,s++)bo(a,s,e[n]);return a.length=s,a},Ao=O,Co=F,Oo=Kr.f,No=Ro,wo="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];_o.f=function(e){return wo&&"Window"==Ao(e)?function(e){try{return Oo(e)}catch(e){return No(wo)}}(e):Oo(Co(e))};var Po=I([].slice),Do={},ko=$e;Do.f=ko;var Mo=n,Uo=xe,Lo=Do,xo=Ct.f,Vo=function(e){var t=Mo.Symbol||(Mo.Symbol={});Uo(t,e)||xo(t,e,{value:Lo.f(e)})},Fo=Ct.f,Bo=xe,jo=$e("toStringTag"),Go=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Bo(e,jo)&&Fo(e,jo,{configurable:!0,value:t})},Ho=me,zo=c,Ko=I(I.bind),Wo=function(e,t){return Ho(e),void 0===t?e:zo?Ko(e,t):function(){return e.apply(t,arguments)}},Xo=I,Yo=a,Jo=B,qo=lo,Qo=tr,Zo=function(){},$o=[],ea=W("Reflect","construct"),ta=/^\s*(?:class|function)\b/,ra=Xo(ta.exec),ia=!ta.exec(Zo),na=function(e){if(!Jo(e))return!1;try{return ea(Zo,$o,e),!0}catch(e){return!1}},oa=function(e){if(!Jo(e))return!1;switch(qo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ia||!!ra(ta,Qo(e))}catch(e){return!0}};oa.sham=!0;var aa=!ea||Yo((function(){var e;return na(na.call)||!na(Object)||!na((function(){e=!0}))||e}))?oa:na,sa=n,ca=eo,ua=aa,da=G,la=$e("species"),ha=sa.Array,pa=function(e){var t;return ca(e)&&(t=e.constructor,(ua(t)&&(t===ha||ca(t.prototype))||da(t)&&null===(t=t[la]))&&(t=void 0)),void 0===t?ha:t},fa=function(e,t){return new(pa(e))(0===t?0:t)},_a=Wo,va=M,ma=Me,Sa=ii,ya=fa,Ea=I([].push),ga=function(e){var t=1==e,r=2==e,i=3==e,n=4==e,o=6==e,a=7==e,s=5==e||o;return function(c,u,d,l){for(var h,p,f=ma(c),_=va(f),v=_a(u,d),m=Sa(_),S=0,y=l||ya,E=t?y(c,m):r||a?y(c,0):void 0;m>S;S++)if((s||S in _)&&(p=v(h=_[S],S,f),e))if(t)E[S]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return S;case 2:Ea(E,h)}else switch(e){case 4:return!1;case 7:Ea(E,h)}return o?-1:i||n?n:E}},ba={forEach:ga(0),map:ga(1),filter:ga(2),some:ga(3),every:ga(4),find:ga(5),findIndex:ga(6),filterReject:ga(7)},Ta=Wi,Ia=n,Ra=W,Aa=Zn,Ca=l,Oa=I,Na=s,wa=ne,Pa=a,Da=xe,ka=eo,Ma=B,Ua=G,La=X,xa=le,Va=kt,Fa=Me,Ba=F,ja=lt,Ga=fo,Ha=S,za=Rn,Ka=on,Wa=Kr,Xa=_o,Ya=Si,Ja=o,qa=Ct,Qa=tn,Za=h,$a=Po,es=Yt.exports,ts=Ie.exports,rs=dr,is=Ge,ns=$e,os=Do,as=Vo,ss=Go,cs=Or,us=ba.forEach,ds=ur("hidden"),ls="Symbol",hs=ns("toPrimitive"),ps=cs.set,fs=cs.getterFor(ls),_s=Object.prototype,vs=Ia.Symbol,ms=vs&&vs.prototype,Ss=Ia.TypeError,ys=Ia.QObject,Es=Ra("JSON","stringify"),gs=Ja.f,bs=qa.f,Ts=Xa.f,Is=Za.f,Rs=Oa([].push),As=ts("symbols"),Cs=ts("op-symbols"),Os=ts("string-to-symbol-registry"),Ns=ts("symbol-to-string-registry"),ws=ts("wks"),Ps=!ys||!ys.prototype||!ys.prototype.findChild,Ds=Na&&Pa((function(){return 7!=za(bs({},"a",{get:function(){return bs(this,"a",{value:7}).a}})).a}))?function(e,t,r){var i=gs(_s,t);i&&delete _s[t],bs(e,t,r),i&&e!==_s&&bs(_s,t,i)}:bs,ks=function(e,t){var r=As[e]=za(ms);return ps(r,{type:ls,tag:e,description:t}),Na||(r.description=t),r},Ms=function(e,t,r){e===_s&&Ms(Cs,t,r),Va(e);var i=ja(t);return Va(r),Da(As,i)?(r.enumerable?(Da(e,ds)&&e[ds][i]&&(e[ds][i]=!1),r=za(r,{enumerable:Ha(0,!1)})):(Da(e,ds)||bs(e,ds,Ha(1,{})),e[ds][i]=!0),Ds(e,i,r)):bs(e,i,r)},Us=function(e,t){Va(e);var r=Ba(t),i=Ka(r).concat(Fs(r));return us(i,(function(t){Na&&!Ca(Ls,r,t)||Ms(e,t,r[t])})),e},Ls=function(e){var t=ja(e),r=Ca(Is,this,t);return!(this===_s&&Da(As,t)&&!Da(Cs,t))&&(!(r||!Da(this,t)||!Da(As,t)||Da(this,ds)&&this[ds][t])||r)},xs=function(e,t){var r=Ba(e),i=ja(t);if(r!==_s||!Da(As,i)||Da(Cs,i)){var n=gs(r,i);return!n||!Da(As,i)||Da(r,ds)&&r[ds][i]||(n.enumerable=!0),n}},Vs=function(e){var t=Ts(Ba(e)),r=[];return us(t,(function(e){Da(As,e)||Da(rs,e)||Rs(r,e)})),r},Fs=function(e){var t=e===_s,r=Ts(t?Cs:Ba(e)),i=[];return us(r,(function(e){!Da(As,e)||t&&!Da(_s,e)||Rs(i,As[e])})),i};(wa||(vs=function(){if(La(ms,this))throw Ss("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?Ga(arguments[0]):void 0,t=is(e),r=function(e){this===_s&&Ca(r,Cs,e),Da(this,ds)&&Da(this[ds],t)&&(this[ds][t]=!1),Ds(this,t,Ha(1,e))};return Na&&Ps&&Ds(_s,t,{configurable:!0,set:r}),ks(t,e)},es(ms=vs.prototype,"toString",(function(){return fs(this).tag})),es(vs,"withoutSetter",(function(e){return ks(is(e),e)})),Za.f=Ls,qa.f=Ms,Qa.f=Us,Ja.f=xs,Wa.f=Xa.f=Vs,Ya.f=Fs,os.f=function(e){return ks(ns(e),e)},Na&&(bs(ms,"description",{configurable:!0,get:function(){return fs(this).description}}),es(_s,"propertyIsEnumerable",Ls,{unsafe:!0}))),Ta({global:!0,wrap:!0,forced:!wa,sham:!wa},{Symbol:vs}),us(Ka(ws),(function(e){as(e)})),Ta({target:ls,stat:!0,forced:!wa},{for:function(e){var t=Ga(e);if(Da(Os,t))return Os[t];var r=vs(t);return Os[t]=r,Ns[r]=t,r},keyFor:function(e){if(!xa(e))throw Ss(e+" is not a symbol");if(Da(Ns,e))return Ns[e]},useSetter:function(){Ps=!0},useSimple:function(){Ps=!1}}),Ta({target:"Object",stat:!0,forced:!wa,sham:!Na},{create:function(e,t){return void 0===t?za(e):Us(za(e),t)},defineProperty:Ms,defineProperties:Us,getOwnPropertyDescriptor:xs}),Ta({target:"Object",stat:!0,forced:!wa},{getOwnPropertyNames:Vs,getOwnPropertySymbols:Fs}),Ta({target:"Object",stat:!0,forced:Pa((function(){Ya.f(1)}))},{getOwnPropertySymbols:function(e){return Ya.f(Fa(e))}}),Es)&&Ta({target:"JSON",stat:!0,forced:!wa||Pa((function(){var e=vs();return"[null]"!=Es([e])||"{}"!=Es({a:e})||"{}"!=Es(Object(e))}))},{stringify:function(e,t,r){var i=$a(arguments),n=t;if((Ua(t)||void 0!==e)&&!xa(e))return ka(t)||(t=function(e,t){if(Ma(n)&&(t=Ca(n,this,e,t)),!xa(t))return t}),i[1]=t,Aa(Es,null,i)}});if(!ms[hs]){var Bs=ms.valueOf;es(ms,hs,(function(e){return Ca(Bs,this)}))}ss(vs,ls),rs[ds]=!0;var js=Wi,Gs=a,Hs=F,zs=o.f,Ks=s,Ws=Gs((function(){zs(1)}));js({target:"Object",stat:!0,forced:!Ks||Ws,sham:!Ks},{getOwnPropertyDescriptor:function(e,t){return zs(Hs(e),t)}});var Xs=lo,Ys=ro?{}.toString:function(){return"[object "+Xs(this)+"]"},Js=ro,qs=Yt.exports,Qs=Ys;Js||qs(Object.prototype,"toString",Qs,{unsafe:!0});var Zs=Wi,$s=s,ec=Ct.f;Zs({target:"Object",stat:!0,forced:Object.defineProperty!==ec,sham:!$s},{defineProperty:ec});var tc=n.Promise,rc=Yt.exports,ic=function(e,t,r){for(var i in t)rc(e,i,t[i],r);return e},nc=W,oc=Ct,ac=s,sc=$e("species"),cc=function(e){var t=nc(e),r=oc.f;ac&&t&&!t[sc]&&r(t,sc,{configurable:!0,get:function(){return this}})},uc=X,dc=n.TypeError,lc=function(e,t){if(uc(t,e))return e;throw dc("Incorrect invocation")},hc={},pc=hc,fc=$e("iterator"),_c=Array.prototype,vc=function(e){return void 0!==e&&(pc.Array===e||_c[fc]===e)},mc=lo,Sc=ye,yc=hc,Ec=$e("iterator"),gc=function(e){if(null!=e)return Sc(e,Ec)||Sc(e,"@@iterator")||yc[mc(e)]},bc=l,Tc=me,Ic=kt,Rc=pe,Ac=gc,Cc=n.TypeError,Oc=function(e,t){var r=arguments.length<2?Ac(e):t;if(Tc(r))return Ic(bc(r,e));throw Cc(Rc(e)+" is not iterable")},Nc=l,wc=kt,Pc=ye,Dc=function(e,t,r){var i,n;wc(e);try{if(!(i=Pc(e,"return"))){if("throw"===t)throw r;return r}i=Nc(i,e)}catch(e){n=!0,i=e}if("throw"===t)throw r;if(n)throw i;return wc(i),r},kc=Wo,Mc=l,Uc=kt,Lc=pe,xc=vc,Vc=ii,Fc=X,Bc=Oc,jc=gc,Gc=Dc,Hc=n.TypeError,zc=function(e,t){this.stopped=e,this.result=t},Kc=zc.prototype,Wc=function(e,t,r){var i,n,o,a,s,c,u,d=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),f=kc(t,d),_=function(e){return i&&Gc(i,"normal",e),new zc(!0,e)},v=function(e){return l?(Uc(e),p?f(e[0],e[1],_):f(e[0],e[1])):p?f(e,_):f(e)};if(h)i=e;else{if(!(n=jc(e)))throw Hc(Lc(e)+" is not iterable");if(xc(n)){for(o=0,a=Vc(e);a>o;o++)if((s=v(e[o]))&&Fc(Kc,s))return s;return new zc(!1)}i=Bc(e,n)}for(c=i.next;!(u=Mc(c,i)).done;){try{s=v(u.value)}catch(e){Gc(i,"throw",e)}if("object"==typeof s&&s&&Fc(Kc,s))return s}return new zc(!1)},Xc=$e("iterator"),Yc=!1;try{var Jc=0,qc={next:function(){return{done:!!Jc++}},return:function(){Yc=!0}};qc[Xc]=function(){return this},Array.from(qc,(function(){throw 2}))}catch(e){}var Qc,Zc,$c,eu,tu=function(e,t){if(!t&&!Yc)return!1;var r=!1;try{var i={};i[Xc]=function(){return{next:function(){return{done:r=!0}}}},e(i)}catch(e){}return r},ru=aa,iu=pe,nu=n.TypeError,ou=function(e){if(ru(e))return e;throw nu(iu(e)+" is not a constructor")},au=kt,su=ou,cu=$e("species"),uu=function(e,t){var r,i=au(e).constructor;return void 0===i||null==(r=au(i)[cu])?t:su(r)},du=n.TypeError,lu=function(e,t){if(e<t)throw du("Not enough arguments");return e},hu=/(?:ipad|iphone|ipod).*applewebkit/i.test(Y),pu="process"==O(n.process),fu=n,_u=Zn,vu=Wo,mu=B,Su=xe,yu=a,Eu=pn,gu=Po,bu=_t,Tu=lu,Iu=hu,Ru=pu,Au=fu.setImmediate,Cu=fu.clearImmediate,Ou=fu.process,Nu=fu.Dispatch,wu=fu.Function,Pu=fu.MessageChannel,Du=fu.String,ku=0,Mu={},Uu="onreadystatechange";try{Qc=fu.location}catch(e){}var Lu=function(e){if(Su(Mu,e)){var t=Mu[e];delete Mu[e],t()}},xu=function(e){return function(){Lu(e)}},Vu=function(e){Lu(e.data)},Fu=function(e){fu.postMessage(Du(e),Qc.protocol+"//"+Qc.host)};Au&&Cu||(Au=function(e){Tu(arguments.length,1);var t=mu(e)?e:wu(e),r=gu(arguments,1);return Mu[++ku]=function(){_u(t,void 0,r)},Zc(ku),ku},Cu=function(e){delete Mu[e]},Ru?Zc=function(e){Ou.nextTick(xu(e))}:Nu&&Nu.now?Zc=function(e){Nu.now(xu(e))}:Pu&&!Iu?(eu=($c=new Pu).port2,$c.port1.onmessage=Vu,Zc=vu(eu.postMessage,eu)):fu.addEventListener&&mu(fu.postMessage)&&!fu.importScripts&&Qc&&"file:"!==Qc.protocol&&!yu(Fu)?(Zc=Fu,fu.addEventListener("message",Vu,!1)):Zc=Uu in bu("script")?function(e){Eu.appendChild(bu("script")).onreadystatechange=function(){Eu.removeChild(this),Lu(e)}}:function(e){setTimeout(xu(e),0)});var Bu,ju,Gu,Hu,zu,Ku,Wu,Xu,Yu={set:Au,clear:Cu},Ju=n,qu=/ipad|iphone|ipod/i.test(Y)&&void 0!==Ju.Pebble,Qu=/web0s(?!.*chrome)/i.test(Y),Zu=n,$u=Wo,ed=o.f,td=Yu.set,rd=hu,id=qu,nd=Qu,od=pu,ad=Zu.MutationObserver||Zu.WebKitMutationObserver,sd=Zu.document,cd=Zu.process,ud=Zu.Promise,dd=ed(Zu,"queueMicrotask"),ld=dd&&dd.value;ld||(Bu=function(){var e,t;for(od&&(e=cd.domain)&&e.exit();ju;){t=ju.fn,ju=ju.next;try{t()}catch(e){throw ju?Hu():Gu=void 0,e}}Gu=void 0,e&&e.enter()},rd||od||nd||!ad||!sd?!id&&ud&&ud.resolve?((Wu=ud.resolve(void 0)).constructor=ud,Xu=$u(Wu.then,Wu),Hu=function(){Xu(Bu)}):od?Hu=function(){cd.nextTick(Bu)}:(td=$u(td,Zu),Hu=function(){td(Bu)}):(zu=!0,Ku=sd.createTextNode(""),new ad(Bu).observe(Ku,{characterData:!0}),Hu=function(){Ku.data=zu=!zu}));var hd=ld||function(e){var t={fn:e,next:void 0};Gu&&(Gu.next=t),ju||(ju=t,Hu()),Gu=t},pd={},fd=me,_d=function(e){var t,r;this.promise=new e((function(e,i){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=i})),this.resolve=fd(t),this.reject=fd(r)};pd.f=function(e){return new _d(e)};var vd=kt,md=G,Sd=pd,yd=function(e,t){if(vd(e),md(t)&&t.constructor===e)return t;var r=Sd.f(e);return(0,r.resolve)(t),r.promise},Ed=n,gd=function(){this.head=null,this.tail=null};gd.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var bd,Td,Id,Rd,Ad=gd,Cd="object"==typeof window,Od=Wi,Nd=n,wd=W,Pd=l,Dd=tc,kd=Yt.exports,Md=ic,Ud=en,Ld=Go,xd=cc,Vd=me,Fd=B,Bd=G,jd=lc,Gd=tr,Hd=Wc,zd=tu,Kd=uu,Wd=Yu.set,Xd=hd,Yd=yd,Jd=function(e,t){var r=Ed.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))},qd=pd,Qd=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Zd=Ad,$d=Or,el=Vi,tl=Cd,rl=pu,il=te,nl=$e("species"),ol="Promise",al=$d.getterFor(ol),sl=$d.set,cl=$d.getterFor(ol),ul=Dd&&Dd.prototype,dl=Dd,ll=ul,hl=Nd.TypeError,pl=Nd.document,fl=Nd.process,_l=qd.f,vl=_l,ml=!!(pl&&pl.createEvent&&Nd.dispatchEvent),Sl=Fd(Nd.PromiseRejectionEvent),yl="unhandledrejection",El=!1,gl=el(ol,(function(){var e=Gd(dl),t=e!==String(dl);if(!t&&66===il)return!0;if(il>=51&&/native code/.test(e))return!1;var r=new dl((function(e){e(1)})),i=function(e){e((function(){}),(function(){}))};return(r.constructor={})[nl]=i,!(El=r.then((function(){}))instanceof i)||!t&&tl&&!Sl})),bl=gl||!zd((function(e){dl.all(e).catch((function(){}))})),Tl=function(e){var t;return!(!Bd(e)||!Fd(t=e.then))&&t},Il=function(e,t){var r,i,n,o=t.value,a=1==t.state,s=a?e.ok:e.fail,c=e.resolve,u=e.reject,d=e.domain;try{s?(a||(2===t.rejection&&Nl(t),t.rejection=1),!0===s?r=o:(d&&d.enter(),r=s(o),d&&(d.exit(),n=!0)),r===e.promise?u(hl("Promise-chain cycle")):(i=Tl(r))?Pd(i,r,c,u):c(r)):u(o)}catch(e){d&&!n&&d.exit(),u(e)}},Rl=function(e,t){e.notified||(e.notified=!0,Xd((function(){for(var r,i=e.reactions;r=i.get();)Il(r,e);e.notified=!1,t&&!e.rejection&&Cl(e)})))},Al=function(e,t,r){var i,n;ml?((i=pl.createEvent("Event")).promise=t,i.reason=r,i.initEvent(e,!1,!0),Nd.dispatchEvent(i)):i={promise:t,reason:r},!Sl&&(n=Nd["on"+e])?n(i):e===yl&&Jd("Unhandled promise rejection",r)},Cl=function(e){Pd(Wd,Nd,(function(){var t,r=e.facade,i=e.value;if(Ol(e)&&(t=Qd((function(){rl?fl.emit("unhandledRejection",i,r):Al(yl,r,i)})),e.rejection=rl||Ol(e)?2:1,t.error))throw t.value}))},Ol=function(e){return 1!==e.rejection&&!e.parent},Nl=function(e){Pd(Wd,Nd,(function(){var t=e.facade;rl?fl.emit("rejectionHandled",t):Al("rejectionhandled",t,e.value)}))},wl=function(e,t,r){return function(i){e(t,i,r)}},Pl=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,Rl(e,!0))},Dl=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw hl("Promise can't be resolved itself");var i=Tl(t);i?Xd((function(){var r={done:!1};try{Pd(i,t,wl(Dl,r,e),wl(Pl,r,e))}catch(t){Pl(r,t,e)}})):(e.value=t,e.state=1,Rl(e,!1))}catch(t){Pl({done:!1},t,e)}}};if(gl&&(ll=(dl=function(e){jd(this,ll),Vd(e),Pd(bd,this);var t=al(this);try{e(wl(Dl,t),wl(Pl,t))}catch(e){Pl(t,e)}}).prototype,(bd=function(e){sl(this,{type:ol,done:!1,notified:!1,parent:!1,reactions:new Zd,rejection:!1,state:0,value:void 0})}).prototype=Md(ll,{then:function(e,t){var r=cl(this),i=_l(Kd(this,dl));return r.parent=!0,i.ok=!Fd(e)||e,i.fail=Fd(t)&&t,i.domain=rl?fl.domain:void 0,0==r.state?r.reactions.add(i):Xd((function(){Il(i,r)})),i.promise},catch:function(e){return this.then(void 0,e)}}),Td=function(){var e=new bd,t=al(e);this.promise=e,this.resolve=wl(Dl,t),this.reject=wl(Pl,t)},qd.f=_l=function(e){return e===dl||e===Id?new Td(e):vl(e)},Fd(Dd)&&ul!==Object.prototype)){Rd=ul.then,El||(kd(ul,"then",(function(e,t){var r=this;return new dl((function(e,t){Pd(Rd,r,e,t)})).then(e,t)}),{unsafe:!0}),kd(ul,"catch",ll.catch,{unsafe:!0}));try{delete ul.constructor}catch(e){}Ud&&Ud(ul,ll)}Od({global:!0,wrap:!0,forced:gl},{Promise:dl}),Ld(dl,ol,!1),xd(ol),Id=wd(ol),Od({target:ol,stat:!0,forced:gl},{reject:function(e){var t=_l(this);return Pd(t.reject,void 0,e),t.promise}}),Od({target:ol,stat:!0,forced:gl},{resolve:function(e){return Yd(this,e)}}),Od({target:ol,stat:!0,forced:bl},{all:function(e){var t=this,r=_l(t),i=r.resolve,n=r.reject,o=Qd((function(){var r=Vd(t.resolve),o=[],a=0,s=1;Hd(e,(function(e){var c=a++,u=!1;s++,Pd(r,t,e).then((function(e){u||(u=!0,o[c]=e,--s||i(o))}),n)})),--s||i(o)}));return o.error&&n(o.value),r.promise},race:function(e){var t=this,r=_l(t),i=r.reject,n=Qd((function(){var n=Vd(t.resolve);Hd(e,(function(e){Pd(n,t,e).then(r.resolve,i)}))}));return n.error&&i(n.value),r.promise}});var kl=Wi,Ml=s,Ul=n,Ll=I,xl=xe,Vl=B,Fl=X,Bl=fo,jl=Ct.f,Gl=Ni,Hl=Ul.Symbol,zl=Hl&&Hl.prototype;if(Ml&&Vl(Hl)&&(!("description"in zl)||void 0!==Hl().description)){var Kl={},Wl=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:Bl(arguments[0]),t=Fl(zl,this)?new Hl(e):void 0===e?Hl():Hl(e);return""===e&&(Kl[t]=!0),t};Gl(Wl,Hl),Wl.prototype=zl,zl.constructor=Wl;var Xl="Symbol(test)"==String(Hl("test")),Yl=Ll(zl.toString),Jl=Ll(zl.valueOf),ql=/^Symbol\((.*)\)[^)]+$/,Ql=Ll("".replace),Zl=Ll("".slice);jl(zl,"description",{configurable:!0,get:function(){var e=Jl(this),t=Yl(e);if(xl(Kl,e))return"";var r=Xl?Zl(t,7,-1):Ql(t,ql,"$1");return""===r?void 0:r}}),kl({global:!0,forced:!0},{Symbol:Wl})}Vo("iterator");var $l=Rn,eh=Ct,th=$e("unscopables"),rh=Array.prototype;null==rh[th]&&eh.f(rh,th,{configurable:!0,value:$l(null)});var ih,nh,oh,ah=function(e){rh[th][e]=!0},sh=!a((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),ch=n,uh=xe,dh=B,lh=Me,hh=sh,ph=ur("IE_PROTO"),fh=ch.Object,_h=fh.prototype,vh=hh?fh.getPrototypeOf:function(e){var t=lh(e);if(uh(t,ph))return t[ph];var r=t.constructor;return dh(r)&&t instanceof r?r.prototype:t instanceof fh?_h:null},mh=a,Sh=B,yh=vh,Eh=Yt.exports,gh=$e("iterator"),bh=!1;[].keys&&("next"in(oh=[].keys())?(nh=yh(yh(oh)))!==Object.prototype&&(ih=nh):bh=!0);var Th=null==ih||mh((function(){var e={};return ih[gh].call(e)!==e}));Th&&(ih={}),Sh(ih[gh])||Eh(ih,gh,(function(){return this}));var Ih={IteratorPrototype:ih,BUGGY_SAFARI_ITERATORS:bh},Rh=Ih.IteratorPrototype,Ah=Rn,Ch=S,Oh=Go,Nh=hc,wh=function(){return this},Ph=function(e,t,r,i){var n=t+" Iterator";return e.prototype=Ah(Rh,{next:Ch(+!i,r)}),Oh(e,n,!1),Nh[n]=wh,e},Dh=Wi,kh=l,Mh=Mr,Uh=B,Lh=Ph,xh=vh,Vh=en,Fh=Go,Bh=Xt,jh=Yt.exports,Gh=hc,Hh=Mh.PROPER,zh=Mh.CONFIGURABLE,Kh=Ih.IteratorPrototype,Wh=Ih.BUGGY_SAFARI_ITERATORS,Xh=$e("iterator"),Yh="keys",Jh="values",qh="entries",Qh=function(){return this},Zh=function(e,t,r,i,n,o,a){Lh(r,t,i);var s,c,u,d=function(e){if(e===n&&_)return _;if(!Wh&&e in p)return p[e];switch(e){case Yh:case Jh:case qh:return function(){return new r(this,e)}}return function(){return new r(this)}},l=t+" Iterator",h=!1,p=e.prototype,f=p[Xh]||p["@@iterator"]||n&&p[n],_=!Wh&&f||d(n),v="Array"==t&&p.entries||f;if(v&&(s=xh(v.call(new e)))!==Object.prototype&&s.next&&(xh(s)!==Kh&&(Vh?Vh(s,Kh):Uh(s[Xh])||jh(s,Xh,Qh)),Fh(s,l,!0)),Hh&&n==Jh&&f&&f.name!==Jh&&(zh?Bh(p,"name",Jh):(h=!0,_=function(){return kh(f,this)})),n)if(c={values:d(Jh),keys:o?_:d(Yh),entries:d(qh)},a)for(u in c)(Wh||h||!(u in p))&&jh(p,u,c[u]);else Dh({target:t,proto:!0,forced:Wh||h},c);return p[Xh]!==_&&jh(p,Xh,_,{name:n}),Gh[t]=_,c},$h=F,ep=ah,tp=hc,rp=Or,ip=Ct.f,np=Zh,op=s,ap="Array Iterator",sp=rp.set,cp=rp.getterFor(ap),up=np(Array,"Array",(function(e,t){sp(this,{type:ap,target:$h(e),index:0,kind:t})}),(function(){var e=cp(this),t=e.target,r=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values"),dp=tp.Arguments=tp.Array;if(ep("keys"),ep("values"),ep("entries"),op&&"values"!==dp.name)try{ip(dp,"name",{value:"values"})}catch(e){}var lp=I,hp=Yr,pp=fo,fp=L,_p=lp("".charAt),vp=lp("".charCodeAt),mp=lp("".slice),Sp=function(e){return function(t,r){var i,n,o=pp(fp(t)),a=hp(r),s=o.length;return a<0||a>=s?e?"":void 0:(i=vp(o,a))<55296||i>56319||a+1===s||(n=vp(o,a+1))<56320||n>57343?e?_p(o,a):i:e?mp(o,a,a+2):n-56320+(i-55296<<10)+65536}},yp={codeAt:Sp(!1),charAt:Sp(!0)},Ep=yp.charAt,gp=fo,bp=Or,Tp=Zh,Ip="String Iterator",Rp=bp.set,Ap=bp.getterFor(Ip);Tp(String,"String",(function(e){Rp(this,{type:Ip,string:gp(e),index:0})}),(function(){var e,t=Ap(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=Ep(r,i),t.index+=e.length,{value:e,done:!1})}));var Cp={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Op=_t("span").classList,Np=Op&&Op.constructor&&Op.constructor.prototype,wp=Np===Object.prototype?void 0:Np,Pp=n,Dp=Cp,kp=wp,Mp=up,Up=Xt,Lp=$e,xp=Lp("iterator"),Vp=Lp("toStringTag"),Fp=Mp.values,Bp=function(e,t){if(e){if(e[xp]!==Fp)try{Up(e,xp,Fp)}catch(t){e[xp]=Fp}if(e[Vp]||Up(e,Vp,t),Dp[t])for(var r in Mp)if(e[r]!==Mp[r])try{Up(e,r,Mp[r])}catch(t){e[r]=Mp[r]}}};for(var jp in Dp)Bp(Pp[jp]&&Pp[jp].prototype,jp);Bp(kp,"DOMTokenList");var Gp=a,Hp=te,zp=$e("species"),Kp=function(e){return Hp>=51||!Gp((function(){var t=[];return(t.constructor={})[zp]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Wp=Wi,Xp=n,Yp=a,Jp=eo,qp=G,Qp=Me,Zp=ii,$p=yo,ef=fa,tf=Kp,rf=te,nf=$e("isConcatSpreadable"),of=9007199254740991,af="Maximum allowed index exceeded",sf=Xp.TypeError,cf=rf>=51||!Yp((function(){var e=[];return e[nf]=!1,e.concat()[0]!==e})),uf=tf("concat"),df=function(e){if(!qp(e))return!1;var t=e[nf];return void 0!==t?!!t:Jp(e)};Wp({target:"Array",proto:!0,forced:!cf||!uf},{concat:function(e){var t,r,i,n,o,a=Qp(this),s=ef(a,0),c=0;for(t=-1,i=arguments.length;t<i;t++)if(df(o=-1===t?a:arguments[t])){if(c+(n=Zp(o))>of)throw sf(af);for(r=0;r<n;r++,c++)r in o&&$p(s,c,o[r])}else{if(c>=of)throw sf(af);$p(s,c++,o)}return s.length=c,s}});var lf=Wi,hf=n,pf=eo,ff=aa,_f=G,vf=Zr,mf=ii,Sf=F,yf=yo,Ef=$e,gf=Po,bf=Kp("slice"),Tf=Ef("species"),If=hf.Array,Rf=Math.max;lf({target:"Array",proto:!0,forced:!bf},{slice:function(e,t){var r,i,n,o=Sf(this),a=mf(o),s=vf(e,a),c=vf(void 0===t?a:t,a);if(pf(o)&&(r=o.constructor,(ff(r)&&(r===If||pf(r.prototype))||_f(r)&&null===(r=r[Tf]))&&(r=void 0),r===If||void 0===r))return gf(o,s,c);for(i=new(void 0===r?If:r)(Rf(c-s,0)),n=0;s<c;s++,n++)s in o&&yf(i,n,o[s]);return i.length=n,i}}),Vo("asyncIterator");var Af=function(e,t){return Af=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Af(e,t)};function Cf(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Af(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Of,Nf,wf,Pf,Df,kf,Mf,Uf,Lf,xf,Vf,Ff,Bf,jf,Gf,Hf,zf,Kf,Wf,Xf,Yf,Jf,qf,Qf,Zf=function(){return Zf=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},Zf.apply(this,arguments)};function $f(e,r,i,n){var o,a=arguments.length,s=a<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,i):n;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,i,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(r,i,s):o(r,i))||s);return a>3&&s&&Object.defineProperty(r,i,s),s}function e_(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))}function t_(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function r_(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function i_(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function n_(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}!function(e){e[e.VIDEO_SOURCE_TYPE_EXTERNAL=0]="VIDEO_SOURCE_TYPE_EXTERNAL",e[e.VIDEO_SOURCE_TYPE_INTERNAL=1]="VIDEO_SOURCE_TYPE_INTERNAL"}(Of||(Of={})),function(e){e[e.AUDIO_SOURCE_TYPE_EXTERNAL=0]="AUDIO_SOURCE_TYPE_EXTERNAL",e[e.AUDIO_SOURCE_TYPE_INTERNAL=1]="AUDIO_SOURCE_TYPE_INTERNAL"}(Nf||(Nf={})),function(e){e[e.QUIT=0]="QUIT",e[e.DROPPED=1]="DROPPED",e[e.SWITCH_TO_INVISIBLE=2]="SWITCH_TO_INVISIBLE",e[e.KICKED_BY_ADMIN=3]="KICKED_BY_ADMIN"}(wf||(wf={})),function(e){e[e.CHANNEL_PROFILE_COMMUNICATION=0]="CHANNEL_PROFILE_COMMUNICATION",e[e.CHANNEL_PROFILE_LIVE_BROADCASTING=1]="CHANNEL_PROFILE_LIVE_BROADCASTING"}(Pf||(Pf={})),function(e){e[e.AUTO_SUBSCRIBE_MODE=0]="AUTO_SUBSCRIBE_MODE",e[e.MANUAL_SUBSCRIBE_MODE=1]="MANUAL_SUBSCRIBE_MODE"}(Df||(Df={})),function(e){e[e.SUBSCRIBE_SUCC=0]="SUBSCRIBE_SUCC",e[e.SUBSCRIBE_FAIL=1]="SUBSCRIBE_FAIL"}(kf||(kf={})),function(e){e[e.PUBLISH_SUCC=0]="PUBLISH_SUCC",e[e.PUBLISH_FAIL=1]="PUBLISH_FAIL"}(Mf||(Mf={})),function(e){e[e.MIRROR_MODE_OFF=0]="MIRROR_MODE_OFF",e[e.MIRROR_MODE_ON=1]="MIRROR_MODE_ON"}(Uf||(Uf={})),function(e){e[e.RENDER_MODE_HIDDEN=0]="RENDER_MODE_HIDDEN",e[e.RENDER_MODE_FIT=1]="RENDER_MODE_FIT"}(Lf||(Lf={})),function(e){e[e.STREAM_INDEX_MAIN=0]="STREAM_INDEX_MAIN",e[e.STREAM_INDEX_SCREEN=1]="STREAM_INDEX_SCREEN"}(xf||(xf={})),function(e){e[e.AUDIO=1]="AUDIO",e[e.VIDEO=2]="VIDEO",e[e.AUDIO_AND_VIDEO=3]="AUDIO_AND_VIDEO"}(Vf||(Vf={})),function(e){e[e.STREAM_REMOVE_REASON_UNPUBLISH=0]="STREAM_REMOVE_REASON_UNPUBLISH",e[e.STREAM_REMOVE_REASON_PUBLISH_FAILED=1]="STREAM_REMOVE_REASON_PUBLISH_FAILED",e[e.STREAM_REMOVE_REASON_KEEP_LIVE_FAILED=2]="STREAM_REMOVE_REASON_KEEP_LIVE_FAILED",e[e.STREAM_REMOVE_REASON_CLIENT_DISCONNECTED=3]="STREAM_REMOVE_REASON_CLIENT_DISCONNECTED",e[e.STREAM_REMOVE_REASON_REPUBLISH=4]="STREAM_REMOVE_REASON_REPUBLISH",e[e.STREAM_REMOVE_REASON_OTHER=5]="STREAM_REMOVE_REASON_OTHER"}(Ff||(Ff={})),function(e){e[e.CONNECTION_START=0]="CONNECTION_START",e[e.CONNECTION_STATE_DISCONNECTED=1]="CONNECTION_STATE_DISCONNECTED",e[e.CONNECTION_STATE_CONNECTING=2]="CONNECTION_STATE_CONNECTING",e[e.CONNECTION_STATE_CONNECTED=3]="CONNECTION_STATE_CONNECTED",e[e.CONNECTION_STATE_RECONNECTING=4]="CONNECTION_STATE_RECONNECTING",e[e.CONNECTION_STATE_RECONNECTED=5]="CONNECTION_STATE_RECONNECTED"}(Bf||(Bf={})),function(e){e[e.MIRROR_TYPE_NONE=0]="MIRROR_TYPE_NONE",e[e.MIRROR_TYPE_RENDER=1]="MIRROR_TYPE_RENDER"}(jf||(jf={})),function(e){e[e.domestic=0]="domestic",e[e.overseas=1]="overseas"}(Gf||(Gf={})),function(e){e[e.OFFLINE=0]="OFFLINE",e[e.ONLINE=1]="ONLINE",e[e.UNREACHABLE=2]="UNREACHABLE"}(Hf||(Hf={})),function(e){e[e.AUDIO_AND_VIDEO=0]="AUDIO_AND_VIDEO",e[e.AUDIO_ONLY=1]="AUDIO_ONLY",e[e.VIDEO_ONLY=2]="VIDEO_ONLY"}(zf||(zf={})),function(e){e[e.PREV_FRAME=0]="PREV_FRAME",e[e.OTHER_FRAME=1]="OTHER_FRAME"}(Kf||(Kf={})),function(e){e[e.DISABLE=0]="DISABLE",e[e.VIDEO_STREAM_LOW=1]="VIDEO_STREAM_LOW",e[e.AUDIO_ONLY=2]="AUDIO_ONLY"}(Wf||(Wf={})),function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=100]="MEDIUM",e[e.HIGH=200]="HIGH"}(Xf||(Xf={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.EXCELLENT=1]="EXCELLENT",e[e.GOOD=2]="GOOD",e[e.POOR=3]="POOR",e[e.BAD=4]="BAD",e[e.VBAD=5]="VBAD"}(Yf||(Yf={})),function(e){e[e.Unknown=-1]="Unknown",e[e.SubscribeFallbackByBandwidth=0]="SubscribeFallbackByBandwidth",e[e.SubscribeRecoverByBandwidth=2]="SubscribeRecoverByBandwidth"}(Jf||(Jf={})),function(e){e[e.communication=0]="communication",e[e.chat=5]="chat",e[e.chatRoom=6]="chatRoom",e[e.coHost=9]="coHost",e[e.meeting=16]="meeting",e[e.classRoom=18]="classRoom"}(qf||(qf={})),function(e){e[e.default=0]="default",e[e.fluent=1]="fluent",e[e.standard=2]="standard",e[e.hd=3]="hd",e[e.standardStereo=4]="standardStereo",e[e.hdMono=5]="hdMono"}(Qf||(Qf={}));var o_,a_,s_,c_=Object.freeze({__proto__:null,get VideoSourceType(){return Of},get AudioSourceType(){return Nf},get UserOfflineReason(){return wf},get ChannelProfile(){return Pf},get SubscribeMode(){return Df},get SubscribeState(){return kf},get PublishState(){return Mf},get MirrorMode(){return Uf},get VideoRenderMode(){return Lf},get StreamIndex(){return xf},get MediaType(){return Vf},get StreamRemoveReason(){return Ff},get ConnectionState(){return Bf},get MirrorType(){return jf},get LogChannel(){return Gf},get USER_ONLINE_STATUS(){return Hf},get PublicStreamType(){return zf},get PublicInterpolationMode(){return Kf},get SubscribeFallbackOption(){return Wf},get RemoteUserPriority(){return Xf},get NetworkQuality(){return Yf},get FallbackOrRecoverReason(){return Jf},get RoomProfileType(){return qf},get AudioProfileType(){return Qf}});!function(e){e[e.AUTO=0]="AUTO",e[e.MODE_L=1]="MODE_L",e[e.MODE_R=2]="MODE_R",e[e.MODE_MIX=3]="MODE_MIX"}(o_||(o_={})),function(e){e[e.PLAYOUT=0]="PLAYOUT",e[e.PUBLISH=1]="PUBLISH",e[e.PLAYOUT_AND_PUBLISH=2]="PLAYOUT_AND_PUBLISH"}(a_||(a_={})),function(e){e[e.AUDIO_MIXING_STATE_PRELOADED=0]="AUDIO_MIXING_STATE_PRELOADED",e[e.AUDIO_MIXING_STATE_PLAYING=1]="AUDIO_MIXING_STATE_PLAYING",e[e.AUDIO_MIXING_STATE_PAUSED=2]="AUDIO_MIXING_STATE_PAUSED",e[e.AUDIO_MIXING_STATE_STOPPED=3]="AUDIO_MIXING_STATE_STOPPED",e[e.AUDIO_MIXING_STATE_FAILED=4]="AUDIO_MIXING_STATE_FAILED",e[e.AUDIO_MIXING_STATE_FINISHED=5]="AUDIO_MIXING_STATE_FINISHED",e[e.AUDIO_MIXING_STATE_PCM_ENABLED=6]="AUDIO_MIXING_STATE_PCM_ENABLED",e[e.AUDIO_MIXING_STATE_PCM_DISABLED=7]="AUDIO_MIXING_STATE_PCM_DISABLED"}(s_||(s_={}));var u_,d_,l_=Object.freeze({__proto__:null,get AudioMixingDualMonoMode(){return o_},get AudioMixingType(){return a_},get AudioMixingState(){return s_}});!function(e){e.onTrackEnded="onTrackEnded",e.onPlayerEvent="onPlayerEvent",e.onAutoplayFailed="onAutoplayFailed",e.onUserJoined="onUserJoined",e.onUserLeave="onUserLeave",e.onConnectionStateChanged="onConnectionStateChanged",e.onUserPublishStream="onUserPublishStream",e.onUserUnpublishStream="onUserUnpublishStream",e.onUserPublishScreen="onUserPublishScreen",e.onUserUnpublishScreen="onUserUnpublishScreen",e.onRoomMessageReceived="onRoomMessageReceived",e.onRoomBinaryMessageReceived="onRoomBinaryMessageReceived",e.onUserMessageReceived="onUserMessageReceived",e.onUserBinaryMessageReceived="onUserBinaryMessageReceived",e.onVideoFirstFrameRendered="onVideoFirstFrameRendered",e.onVideoFirstFrameDecoded="onVideoFirstFrameDecoded",e.onAudioFirstFrameDecoded="onAudioFirstFrameDecoded",e.onFirstPublicStreamVideoFrameRendered="onFirstPublicStreamVideoFrameRendered",e.onFirstPublicStreamVideoFrameDecoded="onFirstPublicStreamVideoFrameDecoded",e.onFirstPublicStreamAudioFrameDecoded="onFirstPublicStreamAudioFrameDecoded",e.onVideoDeviceStateChanged="onVideoDeviceStateChanged",e.onAudioDeviceStateChanged="onAudioDeviceStateChanged",e.onRemoteStreamStats="onRemoteStreamStats",e.onPublicStreamStats="onPublicStreamStats",e.onLocalStreamStats="onLocalStreamStats",e.onAudioVolumeIndication="onAudioVolumeIndication",e.onLocalAudioPropertiesReport="onLocalAudioPropertiesReport",e.onRemoteAudioPropertiesReport="onRemoteAudioPropertiesReport",e.onAudioPlaybackDeviceChanged="onAudioPlaybackDeviceChanged",e.onUserStartVideoCapture="onUserStartVideoCapture",e.onUserStopVideoCapture="onUserStopVideoCapture",e.onUserStartAudioCapture="onUserStartAudioCapture",e.onUserStopAudioCapture="onUserStopAudioCapture",e.onAutoPublishResult="onAutoPublishResult",e.onAutoSubscribeResult="onAutoSubscribeResult",e.onLiveTranscodingResult="onLiveTranscodingResult",e.onStreamMixingEvent="onStreamMixingEvent",e.onAudioPlaybackDeviceTestVolume="onAudioPlaybackDeviceTestVolume",e.onSEIMessageReceived="onSEIMessageReceived",e.onError="onError",e.onAudioMixingStateChanged="onAudioMixingStateChanged",e.onUserMessageReceivedOutsideRoom="onUserMessageReceivedOutsideRoom",e.onUserBinaryMessageReceivedOutsideRoom="onUserBinaryMessageReceivedOutsideRoom",e.onTokenWillExpire="onTokenWillExpire",e.onCloudProxyConnected="onCloudProxyConnected",e.onPushPublicStreamResult="onPushPublicStreamResult",e.onPublicStreamSEIMessageReceived="onPublicStreamSEIMessageReceived",e.onNetworkQuality="onNetworkQuality",e.onSimulcastSubscribeFallback="onSimulcastSubscribeFallback",e.onRemoteVideoSizeChanged="onRemoteVideoSizeChanged"}(u_||(u_={})),function(e){e[e.ERR_OK=0]="ERR_OK",e[e.ERR_PARAM_INVALID=1]="ERR_PARAM_INVALID",e[e.ERR_FRAME_TIMEOUT=2]="ERR_FRAME_TIMEOUT",e[e.ERR_POSTPROCESS=3]="ERR_POSTPROCESS",e[e.ERR_PUSH_CDN=4]="ERR_PUSH_CDN",e[e.ERR_UNKNOWN=9999]="ERR_UNKNOWN"}(d_||(d_={}));var h_=ba.forEach,p_=jn("forEach")?[].forEach:function(e){return h_(this,e,arguments.length>1?arguments[1]:void 0)};Wi({target:"Array",proto:!0,forced:[].forEach!=p_},{forEach:p_});var f_=n,__=Cp,v_=wp,m_=p_,S_=Xt,y_=function(e){if(e&&e.forEach!==m_)try{S_(e,"forEach",m_)}catch(t){e.forEach=m_}};for(var E_ in __)__[E_]&&y_(f_[E_]&&f_[E_].prototype);y_(v_);var g_=Wi,b_=I,T_=n.Date,I_=b_(T_.prototype.getTime);g_({target:"Date",stat:!0},{now:function(){return I_(new T_)}});var R_=I,A_=Yt.exports,C_=Date.prototype,O_="Invalid Date",N_="toString",w_=R_(C_.toString),P_=R_(C_.getTime);String(new Date(NaN))!=O_&&A_(C_,N_,(function(){var e=P_(this);return e==e?w_(this):O_}));var D_=ci.includes,k_=ah;Wi({target:"Array",proto:!0},{includes:function(e){return D_(this,e,arguments.length>1?arguments[1]:void 0)}}),k_("includes");var M_=G,U_=O,L_=$e("match"),x_=function(e){var t;return M_(e)&&(void 0!==(t=e[L_])?!!t:"RegExp"==U_(e))},V_=x_,F_=n.TypeError,B_=function(e){if(V_(e))throw F_("The method doesn't accept regular expressions");return e},j_=$e("match"),G_=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[j_]=!1,"/./"[e](t)}catch(e){}}return!1},H_=Wi,z_=B_,K_=L,W_=fo,X_=G_,Y_=I("".indexOf);H_({target:"String",proto:!0,forced:!X_("includes")},{includes:function(e){return!!~Y_(W_(K_(this)),W_(z_(e)),arguments.length>1?arguments[1]:void 0)}});var J_=kt,q_=function(){var e=J_(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Q_=a,Z_=n.RegExp,$_=Q_((function(){var e=Z_("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),ev=$_||Q_((function(){return!Z_("a","y").sticky})),tv={BROKEN_CARET:$_||Q_((function(){var e=Z_("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:ev,UNSUPPORTED_Y:$_},rv=a,iv=n.RegExp,nv=rv((function(){var e=iv(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),ov=a,av=n.RegExp,sv=ov((function(){var e=av("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),cv=l,uv=I,dv=fo,lv=q_,hv=tv,pv=Ie.exports,fv=Rn,_v=Or.get,vv=nv,mv=sv,Sv=pv("native-string-replace",String.prototype.replace),yv=RegExp.prototype.exec,Ev=yv,gv=uv("".charAt),bv=uv("".indexOf),Tv=uv("".replace),Iv=uv("".slice),Rv=function(){var e=/a/,t=/b*/g;return cv(yv,e,"a"),cv(yv,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Av=hv.BROKEN_CARET,Cv=void 0!==/()??/.exec("")[1];(Rv||Cv||Av||vv||mv)&&(Ev=function(e){var t,r,i,n,o,a,s,c=this,u=_v(c),d=dv(e),l=u.raw;if(l)return l.lastIndex=c.lastIndex,t=cv(Ev,l,d),c.lastIndex=l.lastIndex,t;var h=u.groups,p=Av&&c.sticky,f=cv(lv,c),_=c.source,v=0,m=d;if(p&&(f=Tv(f,"y",""),-1===bv(f,"g")&&(f+="g"),m=Iv(d,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==gv(d,c.lastIndex-1))&&(_="(?: "+_+")",m=" "+m,v++),r=new RegExp("^(?:"+_+")",f)),Cv&&(r=new RegExp("^"+_+"$(?!\\s)",f)),Rv&&(i=c.lastIndex),n=cv(yv,p?r:c,m),p?n?(n.input=Iv(n.input,v),n[0]=Iv(n[0],v),n.index=c.lastIndex,c.lastIndex+=n[0].length):c.lastIndex=0:Rv&&n&&(c.lastIndex=c.global?n.index+n[0].length:i),Cv&&n&&n.length>1&&cv(Sv,n[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n&&h)for(n.groups=a=fv(null),o=0;o<h.length;o++)a[(s=h[o])[0]]=n[s[1]];return n});var Ov=Ev;Wi({target:"RegExp",proto:!0,forced:/./.exec!==Ov},{exec:Ov});var Nv=I,wv=Yt.exports,Pv=Ov,Dv=a,kv=$e,Mv=Xt,Uv=kv("species"),Lv=RegExp.prototype,xv=function(e,t,r,i){var n=kv(e),o=!Dv((function(){var t={};return t[n]=function(){return 7},7!=""[e](t)})),a=o&&!Dv((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[Uv]=function(){return r},r.flags="",r[n]=/./[n]),r.exec=function(){return t=!0,null},r[n](""),!t}));if(!o||!a||r){var s=Nv(/./[n]),c=t(n,""[e],(function(e,t,r,i,n){var a=Nv(e),c=t.exec;return c===Pv||c===Lv.exec?o&&!n?{done:!0,value:s(t,r,i)}:{done:!0,value:a(r,t,i)}:{done:!1}}));wv(String.prototype,e,c[0]),wv(Lv,n,c[1])}i&&Mv(Lv[n],"sham",!0)},Vv=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},Fv=l,Bv=kt,jv=B,Gv=O,Hv=Ov,zv=n.TypeError,Kv=function(e,t){var r=e.exec;if(jv(r)){var i=Fv(r,e,t);return null!==i&&Bv(i),i}if("RegExp"===Gv(e))return Fv(Hv,e,t);throw zv("RegExp#exec called on incompatible receiver")},Wv=l,Xv=kt,Yv=L,Jv=Vv,qv=fo,Qv=ye,Zv=Kv;function $v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}xv("search",(function(e,t,r){return[function(t){var r=Yv(this),i=null==t?void 0:Qv(t,e);return i?Wv(i,t,r):new RegExp(t)[e](qv(r))},function(e){var i=Xv(this),n=qv(e),o=r(t,i,n);if(o.done)return o.value;var a=i.lastIndex;Jv(a,0)||(i.lastIndex=0);var s=Zv(i,n);return Jv(i.lastIndex,a)||(i.lastIndex=a),null===s?-1:s.index}]}));var em=yp.charAt,tm=function(e,t,r){return t+(r?em(e,t).length:1)},rm=l,im=kt,nm=ti,om=fo,am=L,sm=ye,cm=tm,um=Kv;xv("match",(function(e,t,r){return[function(t){var r=am(this),i=null==t?void 0:sm(t,e);return i?rm(i,t,r):new RegExp(t)[e](om(r))},function(e){var i=im(this),n=om(e),o=r(t,i,n);if(o.done)return o.value;if(!i.global)return um(i,n);var a=i.unicode;i.lastIndex=0;for(var s,c=[],u=0;null!==(s=um(i,n));){var d=om(s[0]);c[u]=d,""===d&&(i.lastIndex=cm(n,nm(i.lastIndex),a)),u++}return 0===u?null:c}]}));var dm="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",lm=L,hm=fo,pm=I("".replace),fm="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",_m=RegExp("^"+fm+fm+"*"),vm=RegExp(fm+fm+"*$"),mm=function(e){return function(t){var r=hm(lm(t));return 1&e&&(r=pm(r,_m,"")),2&e&&(r=pm(r,vm,"")),r}},Sm={start:mm(1),end:mm(2),trim:mm(3)},ym=n,Em=a,gm=I,bm=fo,Tm=Sm.trim,Im=dm,Rm=ym.parseInt,Am=ym.Symbol,Cm=Am&&Am.iterator,Om=/^[+-]?0x/i,Nm=gm(Om.exec),wm=8!==Rm(Im+"08")||22!==Rm(Im+"0x16")||Cm&&!Em((function(){Rm(Object(Cm))}))?function(e,t){var r=Tm(bm(e));return Rm(r,t>>>0||(Nm(Om,r)?16:10))}:Rm;Wi({global:!0,forced:parseInt!=wm},{parseInt:wm});var Pm={exports:{}},Dm=a((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),km=a,Mm=G,Um=O,Lm=Dm,xm=Object.isExtensible,Vm=km((function(){xm(1)}))||Lm?function(e){return!!Mm(e)&&((!Lm||"ArrayBuffer"!=Um(e))&&(!xm||xm(e)))}:xm,Fm=!a((function(){return Object.isExtensible(Object.preventExtensions({}))})),Bm=Wi,jm=I,Gm=dr,Hm=G,zm=xe,Km=Ct.f,Wm=Kr,Xm=_o,Ym=Vm,Jm=Fm,qm=!1,Qm=Ge("meta"),Zm=0,$m=function(e){Km(e,Qm,{value:{objectID:"O"+Zm++,weakData:{}}})},eS=Pm.exports={enable:function(){eS.enable=function(){},qm=!0;var e=Wm.f,t=jm([].splice),r={};r[Qm]=1,e(r).length&&(Wm.f=function(r){for(var i=e(r),n=0,o=i.length;n<o;n++)if(i[n]===Qm){t(i,n,1);break}return i},Bm({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Xm.f}))},fastKey:function(e,t){if(!Hm(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!zm(e,Qm)){if(!Ym(e))return"F";if(!t)return"E";$m(e)}return e[Qm].objectID},getWeakData:function(e,t){if(!zm(e,Qm)){if(!Ym(e))return!0;if(!t)return!1;$m(e)}return e[Qm].weakData},onFreeze:function(e){return Jm&&qm&&Ym(e)&&!zm(e,Qm)&&$m(e),e}};Gm[Qm]=!0;var tS=B,rS=G,iS=en,nS=function(e,t,r){var i,n;return iS&&tS(i=t.constructor)&&i!==r&&rS(n=i.prototype)&&n!==r.prototype&&iS(e,n),e},oS=Wi,aS=n,sS=I,cS=Vi,uS=Yt.exports,dS=Pm.exports,lS=Wc,hS=lc,pS=B,fS=G,_S=a,vS=tu,mS=Go,SS=nS,yS=function(e,t,r){var i=-1!==e.indexOf("Map"),n=-1!==e.indexOf("Weak"),o=i?"set":"add",a=aS[e],s=a&&a.prototype,c=a,u={},d=function(e){var t=sS(s[e]);uS(s,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(n&&!fS(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return n&&!fS(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(n&&!fS(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(cS(e,!pS(a)||!(n||s.forEach&&!_S((function(){(new a).entries().next()})))))c=r.getConstructor(t,e,i,o),dS.enable();else if(cS(e,!0)){var l=new c,h=l[o](n?{}:-0,1)!=l,p=_S((function(){l.has(1)})),f=vS((function(e){new a(e)})),_=!n&&_S((function(){for(var e=new a,t=5;t--;)e[o](t,t);return!e.has(-0)}));f||((c=t((function(e,t){hS(e,s);var r=SS(new a,e,c);return null!=t&&lS(t,r[o],{that:r,AS_ENTRIES:i}),r}))).prototype=s,s.constructor=c),(p||_)&&(d("delete"),d("has"),i&&d("get")),(_||h)&&d(o),n&&s.clear&&delete s.clear}return u[e]=c,oS({global:!0,forced:c!=a},u),mS(c,e),n||r.setStrong(c,e,i),c},ES=Ct.f,gS=Rn,bS=ic,TS=Wo,IS=lc,RS=Wc,AS=Zh,CS=cc,OS=s,NS=Pm.exports.fastKey,wS=Or.set,PS=Or.getterFor,DS={getConstructor:function(e,t,r,i){var n=e((function(e,n){IS(e,o),wS(e,{type:t,index:gS(null),first:void 0,last:void 0,size:0}),OS||(e.size=0),null!=n&&RS(n,e[i],{that:e,AS_ENTRIES:r})})),o=n.prototype,a=PS(t),s=function(e,t,r){var i,n,o=a(e),s=c(e,t);return s?s.value=r:(o.last=s={index:n=NS(t,!0),key:t,value:r,previous:i=o.last,next:void 0,removed:!1},o.first||(o.first=s),i&&(i.next=s),OS?o.size++:e.size++,"F"!==n&&(o.index[n]=s)),e},c=function(e,t){var r,i=a(e),n=NS(t);if("F"!==n)return i.index[n];for(r=i.first;r;r=r.next)if(r.key==t)return r};return bS(o,{clear:function(){for(var e=a(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,OS?e.size=0:this.size=0},delete:function(e){var t=this,r=a(t),i=c(t,e);if(i){var n=i.next,o=i.previous;delete r.index[i.index],i.removed=!0,o&&(o.next=n),n&&(n.previous=o),r.first==i&&(r.first=n),r.last==i&&(r.last=o),OS?r.size--:t.size--}return!!i},forEach:function(e){for(var t,r=a(this),i=TS(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(i(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),bS(o,r?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),OS&&ES(o,"size",{get:function(){return a(this).size}}),n},setStrong:function(e,t,r){var i=t+" Iterator",n=PS(t),o=PS(i);AS(e,t,(function(e,t){wS(this,{type:i,target:e,state:n(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),CS(t)}};yS("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),DS);var kS=Me,MS=on;Wi({target:"Object",stat:!0,forced:a((function(){MS(1)}))},{keys:function(e){return MS(kS(e))}});var US=me,LS=Me,xS=M,VS=ii,FS=n.TypeError,BS=function(e){return function(t,r,i,n){US(r);var o=LS(t),a=xS(o),s=VS(o),c=e?s-1:0,u=e?-1:1;if(i<2)for(;;){if(c in a){n=a[c],c+=u;break}if(c+=u,e?c<0:s<=c)throw FS("Reduce of empty array with no initial value")}for(;e?c>=0:s>c;c+=u)c in a&&(n=r(n,a[c],c,o));return n}},jS={left:BS(!1),right:BS(!0)},GS=jS.left,HS=te,zS=pu;Wi({target:"Array",proto:!0,forced:!jn("reduce")||!zS&&HS>79&&HS<83},{reduce:function(e){var t=arguments.length;return GS(this,e,t,t>1?arguments[1]:void 0)}});var KS,WS=Wi,XS=I,YS=o.f,JS=ti,qS=fo,QS=B_,ZS=L,$S=G_,ey=XS("".endsWith),ty=XS("".slice),ry=Math.min,iy=$S("endsWith");WS({target:"String",proto:!0,forced:!!(iy||(KS=YS(String.prototype,"endsWith"),!KS||KS.writable))&&!iy},{endsWith:function(e){var t=qS(ZS(this));QS(e);var r=arguments.length>1?arguments[1]:void 0,i=t.length,n=void 0===r?i:ry(JS(r),i),o=qS(e);return ey?ey(t,o,n):ty(t,n-o.length,n)===o}});var ny=!0,oy=!0;function ay(e,t,r){var i=e.match(t);return i&&i.length>=r&&parseInt(i[r],10)}function sy(e,t,r){if(e.RTCPeerConnection){var i=e.RTCPeerConnection.prototype,n=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return n.apply(this,arguments);var o=function(e){var t=r(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),n.apply(this,[e,o])};var o=i.removeEventListener;i.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(r))return o.apply(this,arguments);var i=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function cy(e){return"boolean"!=typeof e?new Error("Argument type: "+t(e)+". Please use a boolean."):(ny=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function uy(e){return"boolean"!=typeof e?new Error("Argument type: "+t(e)+". Please use a boolean."):(oy=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function dy(){if("object"===("undefined"==typeof window?"undefined":t(window))){if(ny)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function ly(e,t){oy&&console.warn(e+" is deprecated, please use "+t+" instead.")}function hy(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var r=e.navigator;if(r.mozGetUserMedia)t.browser="firefox",t.version=ay(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=ay(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=ay(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function py(e){return"[object Object]"===Object.prototype.toString.call(e)}function fy(e){return py(e)?Object.keys(e).reduce((function(t,r){var i=py(e[r]),n=i?fy(e[r]):e[r],o=i&&!Object.keys(n).length;return void 0===n||o?t:Object.assign(t,$v({},r,n))}),{}):e}function _y(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(i){i.endsWith("Id")?_y(e,e.get(t[i]),r):i.endsWith("Ids")&&t[i].forEach((function(t){_y(e,e.get(t),r)}))})))}function vy(e,t,r){var i=r?"outbound-rtp":"inbound-rtp",n=new Map;if(null===t)return n;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(r){r.type===i&&r.trackId===t.id&&_y(e,r,n)}))})),n}var my=Wi,Sy=ba.find,yy=ah,Ey="find",gy=!0;Ey in[]&&Array(1).find((function(){gy=!1})),my({target:"Array",proto:!0,forced:gy},{find:function(e){return Sy(this,e,arguments.length>1?arguments[1]:void 0)}}),yy(Ey);var by=Wi,Ty=n,Iy=Zr,Ry=Yr,Ay=ii,Cy=Me,Oy=fa,Ny=yo,wy=Kp("splice"),Py=Ty.TypeError,Dy=Math.max,ky=Math.min,My=9007199254740991,Uy="Maximum allowed length exceeded";by({target:"Array",proto:!0,forced:!wy},{splice:function(e,t){var r,i,n,o,a,s,c=Cy(this),u=Ay(c),d=Iy(e,u),l=arguments.length;if(0===l?r=i=0:1===l?(r=0,i=u-d):(r=l-2,i=ky(Dy(Ry(t),0),u-d)),u+r-i>My)throw Py(Uy);for(n=Oy(c,i),o=0;o<i;o++)(a=d+o)in c&&Ny(n,o,c[a]);if(n.length=i,r<i){for(o=d;o<u-i;o++)s=o+r,(a=o+i)in c?c[s]=c[a]:delete c[s];for(o=u;o>u-i+r;o--)delete c[o-1]}else if(r>i)for(o=u-i;o>d;o--)s=o+r-1,(a=o+i-1)in c?c[s]=c[a]:delete c[s];for(o=0;o<r;o++)c[o+d]=arguments[o+2];return c.length=u-i+r,n}});var Ly=ba.map;Wi({target:"Array",proto:!0,forced:!Kp("map")},{map:function(e){return Ly(this,e,arguments.length>1?arguments[1]:void 0)}});var xy=ba.filter;Wi({target:"Array",proto:!0,forced:!Kp("filter")},{filter:function(e){return xy(this,e,arguments.length>1?arguments[1]:void 0)}});var Vy=I,Fy=Me,By=Math.floor,jy=Vy("".charAt),Gy=Vy("".replace),Hy=Vy("".slice),zy=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Ky=/\$([$&'`]|\d{1,2})/g,Wy=Zn,Xy=l,Yy=I,Jy=xv,qy=a,Qy=kt,Zy=B,$y=Yr,eE=ti,tE=fo,rE=L,iE=tm,nE=ye,oE=function(e,t,r,i,n,o){var a=r+e.length,s=i.length,c=Ky;return void 0!==n&&(n=Fy(n),c=zy),Gy(o,c,(function(o,c){var u;switch(jy(c,0)){case"$":return"$";case"&":return e;case"`":return Hy(t,0,r);case"'":return Hy(t,a);case"<":u=n[Hy(c,1,-1)];break;default:var d=+c;if(0===d)return o;if(d>s){var l=By(d/10);return 0===l?o:l<=s?void 0===i[l-1]?jy(c,1):i[l-1]+jy(c,1):o}u=i[d-1]}return void 0===u?"":u}))},aE=Kv,sE=$e("replace"),cE=Math.max,uE=Math.min,dE=Yy([].concat),lE=Yy([].push),hE=Yy("".indexOf),pE=Yy("".slice),fE="$0"==="a".replace(/./,"$0"),_E=!!/./[sE]&&""===/./[sE]("a","$0");Jy("replace",(function(e,t,r){var i=_E?"$":"$0";return[function(e,r){var i=rE(this),n=null==e?void 0:nE(e,sE);return n?Xy(n,e,i,r):Xy(t,tE(i),e,r)},function(e,n){var o=Qy(this),a=tE(e);if("string"==typeof n&&-1===hE(n,i)&&-1===hE(n,"$<")){var s=r(t,o,a,n);if(s.done)return s.value}var c=Zy(n);c||(n=tE(n));var u=o.global;if(u){var d=o.unicode;o.lastIndex=0}for(var l=[];;){var h=aE(o,a);if(null===h)break;if(lE(l,h),!u)break;""===tE(h[0])&&(o.lastIndex=iE(a,eE(o.lastIndex),d))}for(var p,f="",_=0,v=0;v<l.length;v++){for(var m=tE((h=l[v])[0]),S=cE(uE($y(h.index),a.length),0),y=[],E=1;E<h.length;E++)lE(y,void 0===(p=h[E])?p:String(p));var g=h.groups;if(c){var b=dE([m],y,S,a);void 0!==g&&lE(b,g);var T=tE(Wy(n,void 0,b))}else T=oE(m,a,S,y,g,n);S>=_&&(f+=pE(a,_,S)+T,_=S+m.length)}return f+pE(a,_)}]}),!!qy((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!fE||_E);var vE=s,mE=n,SE=I,yE=Vi,EE=nS,gE=Xt,bE=Ct.f,TE=Kr.f,IE=X,RE=x_,AE=fo,CE=q_,OE=tv,NE=Yt.exports,wE=a,PE=xe,DE=Or.enforce,kE=cc,ME=nv,UE=sv,LE=$e("match"),xE=mE.RegExp,VE=xE.prototype,FE=mE.SyntaxError,BE=SE(CE),jE=SE(VE.exec),GE=SE("".charAt),HE=SE("".replace),zE=SE("".indexOf),KE=SE("".slice),WE=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,XE=/a/g,YE=/a/g,JE=new xE(XE)!==XE,qE=OE.MISSED_STICKY,QE=OE.UNSUPPORTED_Y,ZE=vE&&(!JE||qE||ME||UE||wE((function(){return YE[LE]=!1,xE(XE)!=XE||xE(YE)==YE||"/a/i"!=xE(XE,"i")})));if(yE("RegExp",ZE)){for(var $E=function(e,t){var r,i,n,o,a,s,c=IE(VE,this),u=RE(e),d=void 0===t,l=[],h=e;if(!c&&u&&d&&e.constructor===$E)return e;if((u||IE(VE,e))&&(e=e.source,d&&(t="flags"in h?h.flags:BE(h))),e=void 0===e?"":AE(e),t=void 0===t?"":AE(t),h=e,ME&&"dotAll"in XE&&(i=!!t&&zE(t,"s")>-1)&&(t=HE(t,/s/g,"")),r=t,qE&&"sticky"in XE&&(n=!!t&&zE(t,"y")>-1)&&QE&&(t=HE(t,/y/g,"")),UE&&(o=function(e){for(var t,r=e.length,i=0,n="",o=[],a={},s=!1,c=!1,u=0,d="";i<=r;i++){if("\\"===(t=GE(e,i)))t+=GE(e,++i);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:jE(WE,KE(e,i+1))&&(i+=2,c=!0),n+=t,u++;continue;case">"===t&&c:if(""===d||PE(a,d))throw new FE("Invalid capture group name");a[d]=!0,o[o.length]=[d,u],c=!1,d="";continue}c?d+=t:n+=t}return[n,o]}(e),e=o[0],l=o[1]),a=EE(xE(e,t),c?this:VE,$E),(i||n||l.length)&&(s=DE(a),i&&(s.dotAll=!0,s.raw=$E(function(e){for(var t,r=e.length,i=0,n="",o=!1;i<=r;i++)"\\"!==(t=GE(e,i))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),n+=t):n+="[\\s\\S]":n+=t+GE(e,++i);return n}(e),r)),n&&(s.sticky=!0),l.length&&(s.groups=l)),e!==h)try{gE(a,"source",""===h?"(?:)":h)}catch(e){}return a},eg=function(e){e in $E||bE($E,e,{configurable:!0,get:function(){return xE[e]},set:function(t){xE[e]=t}})},tg=TE(xE),rg=0;tg.length>rg;)eg(tg[rg++]);VE.constructor=$E,$E.prototype=VE,NE(mE,"RegExp",$E)}kE("RegExp");var ig=I,ng=Mr.PROPER,og=Yt.exports,ag=kt,sg=X,cg=fo,ug=a,dg=q_,lg="toString",hg=RegExp.prototype,pg=hg.toString,fg=ig(dg),_g=ug((function(){return"/a/b"!=pg.call({source:"a",flags:"b"})})),vg=ng&&pg.name!=lg;(_g||vg)&&og(RegExp.prototype,lg,(function(){var e=ag(this),t=cg(e.source),r=e.flags;return"/"+t+"/"+cg(void 0===r&&sg(hg,e)&&!("flags"in hg)?fg(e):r)}),{unsafe:!0});var mg=ba.some;Wi({target:"Array",proto:!0,forced:!jn("some")},{some:function(e){return mg(this,e,arguments.length>1?arguments[1]:void 0)}});var Sg=s,yg=Mr.EXISTS,Eg=I,gg=Ct.f,bg=Function.prototype,Tg=Eg(bg.toString),Ig=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Rg=Eg(Ig.exec);Sg&&!yg&&gg(bg,"name",{configurable:!0,get:function(){try{return Rg(Ig,Tg(this))[1]}catch(e){return""}}});var Ag=I,Cg=me,Og=G,Ng=xe,wg=Po,Pg=c,Dg=n.Function,kg=Ag([].concat),Mg=Ag([].join),Ug={},Lg=function(e,t,r){if(!Ng(Ug,t)){for(var i=[],n=0;n<t;n++)i[n]="a["+n+"]";Ug[t]=Dg("C,a","return new C("+Mg(i,",")+")")}return Ug[t](e,r)},xg=Pg?Dg.bind:function(e){var t=Cg(this),r=t.prototype,i=wg(arguments,1),n=function(){var r=kg(i,wg(arguments));return this instanceof n?Lg(t,r.length,r):t.apply(e,r)};return Og(r)&&(n.prototype=r),n},Vg=xg;Wi({target:"Function",proto:!0,forced:Function.bind!==Vg},{bind:Vg});var Fg=dy;function Bg(e,r){var i=e&&e.navigator;if(i.mediaDevices){var n=function(e){if("object"!==t(e)||e.mandatory||e.optional)return e;var r={};return Object.keys(e).forEach((function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var n="object"===t(e[i])?e[i]:{ideal:e[i]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){r.optional=r.optional||[];var a={};"number"==typeof n.ideal?(a[o("min",i)]=n.ideal,r.optional.push(a),(a={})[o("max",i)]=n.ideal,r.optional.push(a)):(a[o("",i)]=n.ideal,r.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(r.mandatory=r.mandatory||{},r.mandatory[o("",i)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(r.mandatory=r.mandatory||{},r.mandatory[o(e,i)]=n[e])}))}})),e.advanced&&(r.optional=(r.optional||[]).concat(e.advanced)),r},o=function(e,o){if(r.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===t(e.audio)){var a=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"===t(e.video)){var s=e.video.facingMode;s=s&&("object"===t(s)?s:{ideal:s});var c,u=r.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||u))if(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?c=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(c=["front"]),c)return i.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return c.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&c.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=s.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),Fg("chrome: "+JSON.stringify(e)),o(e)}));e.video=n(e.video)}return Fg("chrome: "+JSON.stringify(e)),o(e)},a=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=function(e,t,r){o(e,(function(e){i.webkitGetUserMedia(e,t,(function(e){r&&r(a(e))}))}))}.bind(i),i.mediaDevices.getUserMedia){var s=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(e){return o(e,(function(e){return s(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(a(e))}))}))}}}}function jg(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Gg(e){if("object"===t(e)&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",(function(i){var n;n=e.RTCPeerConnection.prototype.getReceivers?t.getReceivers().find((function(e){return e.track&&e.track.id===i.track.id})):{track:i.track};var o=new Event("track");o.track=i.track,o.receiver=n,o.transceiver={receiver:n},o.streams=[r.stream],t.dispatchEvent(o)})),r.stream.getTracks().forEach((function(i){var n;n=e.RTCPeerConnection.prototype.getReceivers?t.getReceivers().find((function(e){return e.track&&e.track.id===i.id})):{track:i};var o=new Event("track");o.track=i,o.receiver=n,o.transceiver={receiver:n},o.streams=[r.stream],t.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else sy(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function Hg(e){if("object"===t(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var r=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){var n=i.apply(this,arguments);return n||(n=r(this,e),this._senders.push(n)),n};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){t._senders.push(r(t,e))}))};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===t(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function zg(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=Array.prototype.slice.call(arguments),i=r[0],n=r[1],o=r[2];if(arguments.length>0&&"function"==typeof i)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof i))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){n(s(a(e)))};return t.apply(this,[c,i])}return new Promise((function(r,i){t.apply(e,[function(e){r(s(a(e)))},i])})).then(n,o)}}}function Kg(e){if("object"===t(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return vy(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),sy(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return vy(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,i,n=arguments[0];return this.getSenders().forEach((function(e){e.track===n&&(t?i=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===n&&(r?i=!0:r=e),e.track===n})),i||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}}function Wg(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(i)&&this._shimmedLocalStreams[r.id].push(i):this._shimmedLocalStreams[r.id]=[r,i],i};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();r.apply(this,arguments);var n=this.getSenders().filter((function(e){return-1===i.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(n)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var i=t._shimmedLocalStreams[r].indexOf(e);-1!==i&&t._shimmedLocalStreams[r].splice(i,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),n.apply(this,arguments)}}function Xg(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Wg(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var o=this.getSenders().find((function(e){return e.track===t}));if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[r.id];if(a)a.addTrack(t),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],i=$v({},t,(function(){var e=this,t=arguments,i=arguments.length&&"function"==typeof arguments[0];return i?r.apply(this,[function(r){var i=s(e,r);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return s(e,t)}))}));e.RTCPeerConnection.prototype[t]=i[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=c(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(i){r._streams[i].getTracks().find((function(t){return e.track===t}))&&(t=r._streams[i])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function s(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],n=e._streams[i.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}function c(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],n=e._streams[i.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}}function Yg(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],i=$v({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}))}function Jg(e,t){sy(e,"negotiationneeded",(function(e){var r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}var qg=Object.freeze({__proto__:null,shimMediaStream:jg,shimOnTrack:Gg,shimGetSendersWithDtmf:Hg,shimGetStats:zg,shimSenderReceiverGetStats:Kg,shimAddTrackRemoveTrackWithNative:Wg,shimAddTrackRemoveTrack:Xg,shimPeerConnection:Yg,fixNegotiationNeeded:Jg,shimGetUserMedia:Bg,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var i=r.video&&r.video.width,n=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(r.video.mandatory.maxWidth=i),n&&(r.video.mandatory.maxHeight=n),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),Qg=n,Zg=a,$g=fo,eb=Sm.trim,tb=I("".charAt),rb=Qg.parseFloat,ib=Qg.Symbol,nb=ib&&ib.iterator,ob=1/rb("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff-0")!=-1/0||nb&&!Zg((function(){rb(Object(nb))}))?function(e){var t=eb($g(e)),r=rb(t);return 0===r&&"-"==tb(t,0)?-0:r}:rb;Wi({global:!0,forced:parseFloat!=ob},{parseFloat:ob});var ab=Wi,sb=tc,cb=a,ub=W,db=B,lb=uu,hb=yd,pb=Yt.exports;if(ab({target:"Promise",proto:!0,real:!0,forced:!!sb&&cb((function(){sb.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=lb(this,ub("Promise")),r=db(e);return this.then(r?function(r){return hb(t,e()).then((function(){return r}))}:e,r?function(r){return hb(t,e()).then((function(){throw r}))}:e)}}),db(sb)){var fb=ub("Promise").prototype.finally;sb.prototype.finally!==fb&&pb(sb.prototype,"finally",fb,{unsafe:!0})}function _b(e,r){var i=e&&e.navigator,n=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,r){ly("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,r)},!(r.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(e){return"object"===t(e)&&"object"===t(e.audio)&&(e=JSON.parse(JSON.stringify(e)),o(e.audio,"autoGainControl","mozAutoGainControl"),o(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},n&&n.prototype.getSettings){var s=n.prototype.getSettings;n.prototype.getSettings=function(){var e=s.apply(this,arguments);return o(e,"mozAutoGainControl","autoGainControl"),o(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var c=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===t(e)&&(e=JSON.parse(JSON.stringify(e)),o(e,"autoGainControl","mozAutoGainControl"),o(e,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[e])}}}}function vb(e){"object"===t(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function mb(e,r){if("object"===t(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],i=$v({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}));var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),t=e[0],o=e[1],a=e[2];return n.apply(this,[t||null]).then((function(e){if(r.version<53&&!o)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(o,a)}}}function Sb(e){if("object"===t(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function yb(e){if("object"===t(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),sy(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function Eb(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;ly("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})}function gb(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function bb(e){if("object"===t(e)&&e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype.addTransceiver;r&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],t=e&&"sendEncodings"in e;t&&e.sendEncodings.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var i=r.apply(this,arguments);if(t){var n=i.sender,o=n.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e.sendEncodings,n.sendEncodings=e.sendEncodings,this.setParametersPromises.push(n.setParameters(o).then((function(){delete n.sendEncodings})).catch((function(){delete n.sendEncodings}))))}return i})}}function Tb(e){if("object"===t(e)&&e.RTCRtpSender){var r=e.RTCRtpSender.prototype.getParameters;r&&(e.RTCRtpSender.prototype.getParameters=function(){var e=r.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function Ib(e){if("object"===t(e)&&e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return r.apply(t,e)})).finally((function(){t.setParametersPromises=[]})):r.apply(this,arguments)}}}function Rb(e){if("object"===t(e)&&e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return r.apply(t,e)})).finally((function(){t.setParametersPromises=[]})):r.apply(this,arguments)}}}var Ab=Object.freeze({__proto__:null,shimOnTrack:vb,shimPeerConnection:mb,shimSenderGetStats:Sb,shimReceiverGetStats:yb,shimRemoveStream:Eb,shimRTCDataChannel:gb,shimAddTransceiver:bb,shimGetParameters:Tb,shimCreateOffer:Ib,shimCreateAnswer:Rb,shimGetUserMedia:_b,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}});function Cb(e){if("object"===t(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(i){return r.call(t,i,e)})),e.getVideoTracks().forEach((function(i){return r.call(t,i,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var t=this,i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return n&&n.forEach((function(e){t._localStreams?t._localStreams.includes(e)||t._localStreams.push(e):t._localStreams=[e]})),r.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var i=e.getTracks();this.getSenders().forEach((function(e){i.includes(e.track)&&t.removeTrack(e)}))}})}}function Ob(e){if("object"===t(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),r.apply(e,arguments)}}}function Nb(e){if("object"===t(e)&&e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.createOffer,n=r.createAnswer,o=r.setLocalDescription,a=r.setRemoteDescription,s=r.addIceCandidate;r.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n},r.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,r){var i=o.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i};r.setLocalDescription=c,c=function(e,t,r){var i=a.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},r.setRemoteDescription=c,c=function(e,t,r){var i=s.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},r.addIceCandidate=c}}function wb(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,i=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return i(Pb(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,i){t.mediaDevices.getUserMedia(e).then(r,i)}.bind(t))}function Pb(e){return e&&void 0!==e.video?Object.assign({},e,{video:fy(e.video)}):e}function Db(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var i=[],n=0;n<e.iceServers.length;n++){var o=e.iceServers[n];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(ly("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,i.push(o)):i.push(e.iceServers[n])}e.iceServers=i}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function kb(e){"object"===t(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Mb(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Ub(e){"object"!==t(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Lb=Object.freeze({__proto__:null,shimLocalStreamsAPI:Cb,shimRemoteStreamsAPI:Ob,shimCallbacksAPI:Nb,shimGetUserMedia:wb,shimConstraints:Pb,shimRTCIceServerUrls:Db,shimTrackEventTransceiver:kb,shimCreateOfferLegacy:Mb,shimAudioContext:Ub}),xb=Me,Vb=ct;Wi({target:"Date",proto:!0,forced:a((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(e){var t=xb(this),r=Vb(t,"number");return"number"!=typeof r||isFinite(r)?t.toISOString():null}});var Fb=l;Wi({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return Fb(URL.prototype.toString,this)}});var Bb=I(1..valueOf),jb=s,Gb=n,Hb=I,zb=Vi,Kb=Yt.exports,Wb=xe,Xb=nS,Yb=X,Jb=le,qb=ct,Qb=a,Zb=Kr.f,$b=o.f,eT=Ct.f,tT=Bb,rT=Sm.trim,iT="Number",nT=Gb.Number,oT=nT.prototype,aT=Gb.TypeError,sT=Hb("".slice),cT=Hb("".charCodeAt),uT=function(e){var t=qb(e,"number");return"bigint"==typeof t?t:dT(t)},dT=function(e){var t,r,i,n,o,a,s,c,u=qb(e,"number");if(Jb(u))throw aT("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=rT(u),43===(t=cT(u,0))||45===t){if(88===(r=cT(u,2))||120===r)return NaN}else if(48===t){switch(cT(u,1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+u}for(a=(o=sT(u,2)).length,s=0;s<a;s++)if((c=cT(o,s))<48||c>n)return NaN;return parseInt(o,i)}return+u};if(zb(iT,!nT(" 0o1")||!nT("0b1")||nT("+0x1"))){for(var lT,hT=function(e){var t=arguments.length<1?0:nT(uT(e)),r=this;return Yb(oT,r)&&Qb((function(){tT(r)}))?Xb(Object(t),r,hT):t},pT=jb?Zb(nT):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),fT=0;pT.length>fT;fT++)Wb(nT,lT=pT[fT])&&!Wb(hT,lT)&&eT(hT,lT,$b(nT,lT));hT.prototype=oT,oT.constructor=hT,Kb(Gb,iT,hT)}var _T=Wi,vT=M,mT=F,ST=jn,yT=I([].join),ET=vT!=Object,gT=ST("join",",");_T({target:"Array",proto:!0,forced:ET||!gT},{join:function(e){return yT(mT(this),void 0===e?",":e)}});var bT=Zn,TT=l,IT=I,RT=xv,AT=x_,CT=kt,OT=L,NT=uu,wT=tm,PT=ti,DT=fo,kT=ye,MT=Ro,UT=Kv,LT=Ov,xT=a,VT=tv.UNSUPPORTED_Y,FT=4294967295,BT=Math.min,jT=[].push,GT=IT(/./.exec),HT=IT(jT),zT=IT("".slice),KT=!xT((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));RT("split",(function(e,t,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var i=DT(OT(this)),n=void 0===r?FT:r>>>0;if(0===n)return[];if(void 0===e)return[i];if(!AT(e))return TT(t,i,e,n);for(var o,a,s,c=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,l=new RegExp(e.source,u+"g");(o=TT(LT,l,i))&&!((a=l.lastIndex)>d&&(HT(c,zT(i,d,o.index)),o.length>1&&o.index<i.length&&bT(jT,c,MT(o,1)),s=o[0].length,d=a,c.length>=n));)l.lastIndex===o.index&&l.lastIndex++;return d===i.length?!s&&GT(l,"")||HT(c,""):HT(c,zT(i,d)),c.length>n?MT(c,0,n):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:TT(t,this,e,r)}:t,[function(t,r){var n=OT(this),o=null==t?void 0:kT(t,e);return o?TT(o,t,n,r):TT(i,DT(n),t,r)},function(e,n){var o=CT(this),a=DT(e),s=r(i,o,a,n,i!==t);if(s.done)return s.value;var c=NT(o,RegExp),u=o.unicode,d=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(VT?"g":"y"),l=new c(VT?"^(?:"+o.source+")":o,d),h=void 0===n?FT:n>>>0;if(0===h)return[];if(0===a.length)return null===UT(l,a)?[a]:[];for(var p=0,f=0,_=[];f<a.length;){l.lastIndex=VT?0:f;var v,m=UT(l,VT?zT(a,f):a);if(null===m||(v=BT(PT(l.lastIndex+(VT?f:0)),a.length))===p)f=wT(a,f,u);else{if(HT(_,zT(a,p,f)),_.length===h)return _;for(var S=1;S<=m.length-1;S++)if(HT(_,m[S]),_.length===h)return _;f=p=v}}return HT(_,zT(a,p)),_}]}),!KT,VT);var WT=Mr.PROPER,XT=a,YT=dm,JT=Sm.trim;Wi({target:"String",proto:!0,forced:function(e){return XT((function(){return!!YT[e]()||"âÂá "!=="âÂá "[e]()||WT&&YT[e].name!==e}))}("trim")},{trim:function(){return JT(this)}});var qT={exports:{}};!function(e){var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":r.relatedAddress=t[i+1];break;case"rport":r.relatedPort=parseInt(t[i+1],10);break;case"tcptype":r.tcpType=t[i+1];break;case"ufrag":r.ufrag=t[i+1],r.usernameFragment=t[i+1];break;default:void 0===r[t[i]]&&(r[t[i]]=t[i+1])}return r},r.writeCandidate=function(e){var t=[];t.push(e.foundation);var r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,r={},i=e.substr(e.indexOf(" ")+1).split(";"),n=0;n<i.length;n++)r[(t=i[n].trim().split("="))[0].trim()]=t[1];return r},r.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+r+" "+i.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(r.attribute=e.substr(t+1,i-t-1),r.value=e.substr(i+1)):r.attribute=e.substr(t+1),r},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},r.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===t(e.keyParams)?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var i=r.matchPrefix(e+t,"a=ice-ufrag:")[0],n=r.matchPrefix(e+t,"a=ice-pwd:")[0];return i&&n?{usernameFragment:i.substr(12),password:n.substr(10)}:null},r.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=r.splitLines(e)[0].split(" "),n=3;n<i.length;n++){var o=i[n],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var i="";i+="m="+e+" ",i+=t.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){i+=r.writeRtpMap(e),i+=r.writeFmtp(e),i+=r.writeRtcpFb(e)}));var n=0;return t.codecs.forEach((function(e){e.maxptime>n&&(n=e.maxptime)})),n>0&&(i+="a=maxptime:"+n+"\r\n"),t.headerExtensions&&t.headerExtensions.forEach((function(e){i+=r.writeExtmap(e)})),i},r.parseRtpEncodingParameters=function(e){var t,i=[],n=r.parseRtpParameters(e),o=-1!==n.fecMechanisms.indexOf("RED"),a=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),n.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),i.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},i.push(r))}})),0===i.length&&c&&i.push({ssrc:c});var d=r.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=d}))),i},r.parseRtcpParameters=function(e){var t={},i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(t.cname=i.value,t.ssrc=i.ssrc);var n=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},r.parseMsid=function(e){var t,i=r.matchPrefix(e,"a=msid:");if(1===i.length)return{stream:(t=i[0].substr(7).split(" "))[0],track:t[1]};var n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return n.length>0?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,i=r.parseMLine(e),n=r.matchPrefix(e,"a=max-message-size:");n.length>0&&(t=parseInt(n[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:i.fmt,maxMessageSize:t};var a=r.matchPrefix(e,"a=sctpmap:");if(a.length>0){var s=a[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,i){var n=void 0!==t?t:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.getDirection=function(e,t){for(var i=r.splitLines(e),n=0;n<i.length;n++)switch(i[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[n].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),i=0;i<t.length;i++)if(t[i].length<2||"="!==t[i].charAt(1))return!1;return!0},e.exports=r}(qT);var QT=qT.exports,ZT=Object.freeze(e({__proto__:null,default:QT},[qT.exports]));function $T(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var r=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===t(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var i=new r(e),n=QT.parseCandidate(e.candidate),o=Object.assign(i,n);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new r(e)},e.RTCIceCandidate.prototype=r.prototype,sy(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function eI(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=function(e){if(!e||!e.sdp)return!1;var t=QT.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=QT.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r},n=function(e){var r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},o=function(e,r){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var n=QT.matchPrefix(e.sdp,"a=max-message-size:");return n.length>0?i=parseInt(n[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(i=2147483637),i},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),s=e.sdpSemantics;"plan-b"===s&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){var c,u=i(arguments[0]),d=n(u),l=o(arguments[0],u);c=0===d&&0===l?Number.POSITIVE_INFINITY:0===d||0===l?Math.max(d,l):Math.min(d,l);var h={};Object.defineProperty(h,"maxMessageSize",{get:function(){return c}}),this._sctp=h}return a.apply(this,arguments)}}}function tI(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},sy(e,"datachannel",(function(e){return r(e.channel,e.target),e}))}function r(e,t){var r=e.send;e.send=function(){var i=arguments[0],n=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}function rI(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}}function iI(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var i=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:i}):t.sdp=i}return r.apply(this,arguments)}}}function nI(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function oI(e,r){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var i=e.RTCPeerConnection.prototype.setLocalDescription;i&&0!==i.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,r=arguments[0]||{};if("object"!==t(r)||r.type&&r.sdp)return i.apply(this,arguments);if(!(r={type:r.type,sdp:r.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer"}if(r.sdp||"offer"!==r.type&&"answer"!==r.type)return i.apply(this,[r]);var n="offer"===r.type?this.createOffer:this.createAnswer;return n.apply(this).then((function(t){return i.apply(e,[t])}))})}}var aI=Object.freeze({__proto__:null,shimRTCIceCandidate:$T,shimMaxMessageSize:eI,shimSendThrowTypeError:tI,shimConnectionState:rI,removeExtmapAllowMixed:iI,shimAddIceCandidateNullOrEmpty:nI,shimParameterlessSetLocalDescription:oI});!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},i=dy,n=hy(t),o={browserDetails:n,commonShim:aI,extractVersion:ay,disableLog:cy,disableWarnings:uy,sdp:ZT};switch(n.browser){case"chrome":if(!qg||!Yg||!r.shimChrome)return i("Chrome shim is not included in this adapter release."),o;if(null===n.version)return i("Chrome shim can not determine version, not shimming."),o;i("adapter.js shimming chrome."),o.browserShim=qg,nI(t,n),oI(t),Bg(t,n),jg(t),Yg(t,n),Gg(t),Xg(t,n),Hg(t),zg(t),Kg(t),Jg(t,n),$T(t),rI(t),eI(t,n),tI(t),iI(t,n);break;case"firefox":if(!Ab||!mb||!r.shimFirefox)return i("Firefox shim is not included in this adapter release."),o;i("adapter.js shimming firefox."),o.browserShim=Ab,nI(t,n),oI(t),_b(t,n),mb(t,n),vb(t),Eb(t),Sb(t),yb(t),gb(t),bb(t),Tb(t),Ib(t),Rb(t),$T(t),rI(t),eI(t,n),tI(t);break;case"safari":if(!Lb||!r.shimSafari)return i("Safari shim is not included in this adapter release."),o;i("adapter.js shimming safari."),o.browserShim=Lb,nI(t,n),oI(t),Db(t),Mb(t),Nb(t),Cb(t),Ob(t),kb(t),wb(t),Ub(t),$T(t),eI(t,n),tI(t),iI(t,n);break;default:i("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window}),Wi({target:"Array",stat:!0},{isArray:eo});var sI=Ro,cI=Math.floor,uI=function(e,t){var r=e.length,i=cI(r/2);return r<8?dI(e,t):lI(e,uI(sI(e,0,i),t),uI(sI(e,i),t),t)},dI=function(e,t){for(var r,i,n=e.length,o=1;o<n;){for(i=o,r=e[o];i&&t(e[i-1],r)>0;)e[i]=e[--i];i!==o++&&(e[i]=r)}return e},lI=function(e,t,r,i){for(var n=t.length,o=r.length,a=0,s=0;a<n||s<o;)e[a+s]=a<n&&s<o?i(t[a],r[s])<=0?t[a++]:r[s++]:a<n?t[a++]:r[s++];return e},hI=uI,pI=Y.match(/firefox\/(\d+)/i),fI=!!pI&&+pI[1],_I=/MSIE|Trident/.test(Y),vI=Y.match(/AppleWebKit\/(\d+)\./),mI=!!vI&&+vI[1],SI=Wi,yI=I,EI=me,gI=Me,bI=ii,TI=fo,II=a,RI=hI,AI=jn,CI=fI,OI=_I,NI=te,wI=mI,PI=[],DI=yI(PI.sort),kI=yI(PI.push),MI=II((function(){PI.sort(void 0)})),UI=II((function(){PI.sort(null)})),LI=AI("sort"),xI=!II((function(){if(NI)return NI<70;if(!(CI&&CI>3)){if(OI)return!0;if(wI)return wI<603;var e,t,r,i,n="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(i=0;i<47;i++)PI.push({k:t+i,v:r})}for(PI.sort((function(e,t){return t.v-e.v})),i=0;i<PI.length;i++)t=PI[i].k.charAt(0),n.charAt(n.length-1)!==t&&(n+=t);return"DGBEFHACIJK"!==n}}));SI({target:"Array",proto:!0,forced:MI||!UI||!LI||!xI},{sort:function(e){void 0!==e&&EI(e);var t=gI(this);if(xI)return void 0===e?DI(t):DI(t,e);var r,i,n=[],o=bI(t);for(i=0;i<o;i++)i in t&&kI(n,t[i]);for(RI(n,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:TI(t)>TI(r)?1:-1}}(e)),r=n.length,i=0;i<r;)t[i]=n[i++];for(;i<o;)delete t[i++];return t}});var VI="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,FI=Yr,BI=ti,jI=n.RangeError,GI=function(e){if(void 0===e)return 0;var t=FI(e),r=BI(t);if(t!==r)throw jI("Wrong length or index");return r},HI=n.Array,zI=Math.abs,KI=Math.pow,WI=Math.floor,XI=Math.log,YI=Math.LN2,JI={pack:function(e,t,r){var i,n,o,a=HI(r),s=8*r-t-1,c=(1<<s)-1,u=c>>1,d=23===t?KI(2,-24)-KI(2,-77):0,l=e<0||0===e&&1/e<0?1:0,h=0;for((e=zI(e))!=e||e===1/0?(n=e!=e?1:0,i=c):(i=WI(XI(e)/YI),e*(o=KI(2,-i))<1&&(i--,o*=2),(e+=i+u>=1?d/o:d*KI(2,1-u))*o>=2&&(i++,o/=2),i+u>=c?(n=0,i=c):i+u>=1?(n=(e*o-1)*KI(2,t),i+=u):(n=e*KI(2,u-1)*KI(2,t),i=0));t>=8;)a[h++]=255&n,n/=256,t-=8;for(i=i<<t|n,s+=t;s>0;)a[h++]=255&i,i/=256,s-=8;return a[--h]|=128*l,a},unpack:function(e,t){var r,i=e.length,n=8*i-t-1,o=(1<<n)-1,a=o>>1,s=n-7,c=i-1,u=e[c--],d=127&u;for(u>>=7;s>0;)d=256*d+e[c--],s-=8;for(r=d&(1<<-s)-1,d>>=-s,s+=t;s>0;)r=256*r+e[c--],s-=8;if(0===d)d=1-a;else{if(d===o)return r?NaN:u?-1/0:1/0;r+=KI(2,t),d-=a}return(u?-1:1)*r*KI(2,d-t)}},qI=Me,QI=Zr,ZI=ii,$I=function(e){for(var t=qI(this),r=ZI(t),i=arguments.length,n=QI(i>1?arguments[1]:void 0,r),o=i>2?arguments[2]:void 0,a=void 0===o?r:QI(o,r);a>n;)t[n++]=e;return t},eR=n,tR=I,rR=s,iR=VI,nR=Mr,oR=Xt,aR=ic,sR=a,cR=lc,uR=Yr,dR=ti,lR=GI,hR=JI,pR=vh,fR=en,_R=Kr.f,vR=Ct.f,mR=$I,SR=Ro,yR=Go,ER=nR.PROPER,gR=nR.CONFIGURABLE,bR=Or.get,TR=Or.set,IR="ArrayBuffer",RR="DataView",AR="Wrong index",CR=eR.ArrayBuffer,OR=CR,NR=OR&&OR.prototype,wR=eR.DataView,PR=wR&&wR.prototype,DR=Object.prototype,kR=eR.Array,MR=eR.RangeError,UR=tR(mR),LR=tR([].reverse),xR=hR.pack,VR=hR.unpack,FR=function(e){return[255&e]},BR=function(e){return[255&e,e>>8&255]},jR=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},GR=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},HR=function(e){return xR(e,23,4)},zR=function(e){return xR(e,52,8)},KR=function(e,t){vR(e.prototype,t,{get:function(){return bR(this)[t]}})},WR=function(e,t,r,i){var n=lR(r),o=bR(e);if(n+t>o.byteLength)throw MR(AR);var a=bR(o.buffer).bytes,s=n+o.byteOffset,c=SR(a,s,s+t);return i?c:LR(c)},XR=function(e,t,r,i,n,o){var a=lR(r),s=bR(e);if(a+t>s.byteLength)throw MR(AR);for(var c=bR(s.buffer).bytes,u=a+s.byteOffset,d=i(+n),l=0;l<t;l++)c[u+l]=d[o?l:t-l-1]};if(iR){var YR=ER&&CR.name!==IR;if(sR((function(){CR(1)}))&&sR((function(){new CR(-1)}))&&!sR((function(){return new CR,new CR(1.5),new CR(NaN),YR&&!gR})))YR&&gR&&oR(CR,"name",IR);else{(OR=function(e){return cR(this,NR),new CR(lR(e))}).prototype=NR;for(var JR,qR=_R(CR),QR=0;qR.length>QR;)(JR=qR[QR++])in OR||oR(OR,JR,CR[JR]);NR.constructor=OR}fR&&pR(PR)!==DR&&fR(PR,DR);var ZR=new wR(new OR(2)),$R=tR(PR.setInt8);ZR.setInt8(0,2147483648),ZR.setInt8(1,2147483649),!ZR.getInt8(0)&&ZR.getInt8(1)||aR(PR,{setInt8:function(e,t){$R(this,e,t<<24>>24)},setUint8:function(e,t){$R(this,e,t<<24>>24)}},{unsafe:!0})}else NR=(OR=function(e){cR(this,NR);var t=lR(e);TR(this,{bytes:UR(kR(t),0),byteLength:t}),rR||(this.byteLength=t)}).prototype,PR=(wR=function(e,t,r){cR(this,PR),cR(e,NR);var i=bR(e).byteLength,n=uR(t);if(n<0||n>i)throw MR("Wrong offset");if(n+(r=void 0===r?i-n:dR(r))>i)throw MR("Wrong length");TR(this,{buffer:e,byteLength:r,byteOffset:n}),rR||(this.buffer=e,this.byteLength=r,this.byteOffset=n)}).prototype,rR&&(KR(OR,"byteLength"),KR(wR,"buffer"),KR(wR,"byteLength"),KR(wR,"byteOffset")),aR(PR,{getInt8:function(e){return WR(this,1,e)[0]<<24>>24},getUint8:function(e){return WR(this,1,e)[0]},getInt16:function(e){var t=WR(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=WR(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return GR(WR(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return GR(WR(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return VR(WR(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return VR(WR(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){XR(this,1,e,FR,t)},setUint8:function(e,t){XR(this,1,e,FR,t)},setInt16:function(e,t){XR(this,2,e,BR,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){XR(this,2,e,BR,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){XR(this,4,e,jR,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){XR(this,4,e,jR,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){XR(this,4,e,HR,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){XR(this,8,e,zR,t,arguments.length>2?arguments[2]:void 0)}});yR(OR,IR),yR(wR,RR);var eA={ArrayBuffer:OR,DataView:wR},tA=Wi,rA=I,iA=a,nA=kt,oA=Zr,aA=ti,sA=uu,cA=eA.ArrayBuffer,uA=eA.DataView,dA=uA.prototype,lA=rA(cA.prototype.slice),hA=rA(dA.getUint8),pA=rA(dA.setUint8);tA({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:iA((function(){return!new cA(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(lA&&void 0===t)return lA(nA(this),e);for(var r=nA(this).byteLength,i=oA(e,r),n=oA(void 0===t?r:t,r),o=new(sA(this,cA))(aA(n-i)),a=new uA(this),s=new uA(o),c=0;i<n;)pA(s,c++,hA(a,i++));return o}});var fA,_A,vA,mA={exports:{}},SA=VI,yA=s,EA=n,gA=B,bA=G,TA=xe,IA=lo,RA=pe,AA=Xt,CA=Yt.exports,OA=Ct.f,NA=X,wA=vh,PA=en,DA=$e,kA=Ge,MA=EA.Int8Array,UA=MA&&MA.prototype,LA=EA.Uint8ClampedArray,xA=LA&&LA.prototype,VA=MA&&wA(MA),FA=UA&&wA(UA),BA=Object.prototype,jA=EA.TypeError,GA=DA("toStringTag"),HA=kA("TYPED_ARRAY_TAG"),zA=kA("TYPED_ARRAY_CONSTRUCTOR"),KA=SA&&!!PA&&"Opera"!==IA(EA.opera),WA=!1,XA={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},YA={BigInt64Array:8,BigUint64Array:8},JA=function(e){if(!bA(e))return!1;var t=IA(e);return TA(XA,t)||TA(YA,t)};for(fA in XA)(vA=(_A=EA[fA])&&_A.prototype)?AA(vA,zA,_A):KA=!1;for(fA in YA)(vA=(_A=EA[fA])&&_A.prototype)&&AA(vA,zA,_A);if((!KA||!gA(VA)||VA===Function.prototype)&&(VA=function(){throw jA("Incorrect invocation")},KA))for(fA in XA)EA[fA]&&PA(EA[fA],VA);if((!KA||!FA||FA===BA)&&(FA=VA.prototype,KA))for(fA in XA)EA[fA]&&PA(EA[fA].prototype,FA);if(KA&&wA(xA)!==FA&&PA(xA,FA),yA&&!TA(FA,GA))for(fA in WA=!0,OA(FA,GA,{get:function(){return bA(this)?this[HA]:void 0}}),XA)EA[fA]&&AA(EA[fA],HA,fA);var qA={NATIVE_ARRAY_BUFFER_VIEWS:KA,TYPED_ARRAY_CONSTRUCTOR:zA,TYPED_ARRAY_TAG:WA&&HA,aTypedArray:function(e){if(JA(e))return e;throw jA("Target is not a typed array")},aTypedArrayConstructor:function(e){if(gA(e)&&(!PA||NA(VA,e)))return e;throw jA(RA(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,i){if(yA){if(r)for(var n in XA){var o=EA[n];if(o&&TA(o.prototype,e))try{delete o.prototype[e]}catch(r){try{o.prototype[e]=t}catch(e){}}}FA[e]&&!r||CA(FA,e,r?t:KA&&UA[e]||t,i)}},exportTypedArrayStaticMethod:function(e,t,r){var i,n;if(yA){if(PA){if(r)for(i in XA)if((n=EA[i])&&TA(n,e))try{delete n[e]}catch(e){}if(VA[e]&&!r)return;try{return CA(VA,e,r?t:KA&&VA[e]||t)}catch(e){}}for(i in XA)!(n=EA[i])||n[e]&&!r||CA(n,e,t)}},isView:function(e){if(!bA(e))return!1;var t=IA(e);return"DataView"===t||TA(XA,t)||TA(YA,t)},isTypedArray:JA,TypedArray:VA,TypedArrayPrototype:FA},QA=n,ZA=a,$A=tu,eC=qA.NATIVE_ARRAY_BUFFER_VIEWS,tC=QA.ArrayBuffer,rC=QA.Int8Array,iC=!eC||!ZA((function(){rC(1)}))||!ZA((function(){new rC(-1)}))||!$A((function(e){new rC,new rC(null),new rC(1.5),new rC(e)}),!0)||ZA((function(){return 1!==new rC(new tC(2),1,void 0).length})),nC=G,oC=Math.floor,aC=Number.isInteger||function(e){return!nC(e)&&isFinite(e)&&oC(e)===e},sC=Yr,cC=n.RangeError,uC=function(e){var t=sC(e);if(t<0)throw cC("The argument can't be less than 0");return t},dC=n.RangeError,lC=function(e,t){var r=uC(e);if(r%t)throw dC("Wrong offset");return r},hC=Wo,pC=l,fC=ou,_C=Me,vC=ii,mC=Oc,SC=gc,yC=vc,EC=qA.aTypedArrayConstructor,gC=Wi,bC=n,TC=l,IC=s,RC=iC,AC=qA,CC=eA,OC=lc,NC=S,wC=Xt,PC=aC,DC=ti,kC=GI,MC=lC,UC=lt,LC=xe,xC=lo,VC=G,FC=le,BC=Rn,jC=X,GC=en,HC=Kr.f,zC=function(e){var t,r,i,n,o,a,s=fC(this),c=_C(e),u=arguments.length,d=u>1?arguments[1]:void 0,l=void 0!==d,h=SC(c);if(h&&!yC(h))for(a=(o=mC(c,h)).next,c=[];!(n=pC(a,o)).done;)c.push(n.value);for(l&&u>2&&(d=hC(d,arguments[2])),r=vC(c),i=new(EC(s))(r),t=0;r>t;t++)i[t]=l?d(c[t],t):c[t];return i},KC=ba.forEach,WC=cc,XC=Ct,YC=o,JC=nS,qC=Or.get,QC=Or.set,ZC=XC.f,$C=YC.f,eO=Math.round,tO=bC.RangeError,rO=CC.ArrayBuffer,iO=rO.prototype,nO=CC.DataView,oO=AC.NATIVE_ARRAY_BUFFER_VIEWS,aO=AC.TYPED_ARRAY_CONSTRUCTOR,sO=AC.TYPED_ARRAY_TAG,cO=AC.TypedArray,uO=AC.TypedArrayPrototype,dO=AC.aTypedArrayConstructor,lO=AC.isTypedArray,hO="BYTES_PER_ELEMENT",pO="Wrong length",fO=function(e,t){dO(e);for(var r=0,i=t.length,n=new e(i);i>r;)n[r]=t[r++];return n},_O=function(e,t){ZC(e,t,{get:function(){return qC(this)[t]}})},vO=function(e){var t;return jC(iO,e)||"ArrayBuffer"==(t=xC(e))||"SharedArrayBuffer"==t},mO=function(e,t){return lO(e)&&!FC(t)&&t in e&&PC(+t)&&t>=0},SO=function(e,t){return t=UC(t),mO(e,t)?NC(2,e[t]):$C(e,t)},yO=function(e,t,r){return t=UC(t),!(mO(e,t)&&VC(r)&&LC(r,"value"))||LC(r,"get")||LC(r,"set")||r.configurable||LC(r,"writable")&&!r.writable||LC(r,"enumerable")&&!r.enumerable?ZC(e,t,r):(e[t]=r.value,e)};IC?(oO||(YC.f=SO,XC.f=yO,_O(uO,"buffer"),_O(uO,"byteOffset"),_O(uO,"byteLength"),_O(uO,"length")),gC({target:"Object",stat:!0,forced:!oO},{getOwnPropertyDescriptor:SO,defineProperty:yO}),mA.exports=function(e,t,r){var i=e.match(/\d+$/)[0]/8,n=e+(r?"Clamped":"")+"Array",o="get"+e,a="set"+e,s=bC[n],c=s,u=c&&c.prototype,d={},l=function(e,t){ZC(e,t,{get:function(){return function(e,t){var r=qC(e);return r.view[o](t*i+r.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var o=qC(e);r&&(n=(n=eO(n))<0?0:n>255?255:255&n),o.view[a](t*i+o.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};oO?RC&&(c=t((function(e,t,r,n){return OC(e,u),JC(VC(t)?vO(t)?void 0!==n?new s(t,MC(r,i),n):void 0!==r?new s(t,MC(r,i)):new s(t):lO(t)?fO(c,t):TC(zC,c,t):new s(kC(t)),e,c)})),GC&&GC(c,cO),KC(HC(s),(function(e){e in c||wC(c,e,s[e])})),c.prototype=u):(c=t((function(e,t,r,n){OC(e,u);var o,a,s,d=0,h=0;if(VC(t)){if(!vO(t))return lO(t)?fO(c,t):TC(zC,c,t);o=t,h=MC(r,i);var p=t.byteLength;if(void 0===n){if(p%i)throw tO(pO);if((a=p-h)<0)throw tO(pO)}else if((a=DC(n)*i)+h>p)throw tO(pO);s=a/i}else s=kC(t),o=new rO(a=s*i);for(QC(e,{buffer:o,byteOffset:h,byteLength:a,length:s,view:new nO(o)});d<s;)l(e,d++)})),GC&&GC(c,cO),u=c.prototype=BC(uO)),u.constructor!==c&&wC(u,"constructor",c),wC(u,aO,c),sO&&wC(u,sO,n),d[n]=c,gC({global:!0,forced:c!=s,sham:!oO},d),hO in c||wC(c,hO,i),hO in u||wC(u,hO,i),WC(n)}):mA.exports=function(){},(0,mA.exports)("Uint8",(function(e){return function(t,r,i){return e(this,t,r,i)}}));var EO=Me,gO=Zr,bO=ii,TO=Math.min,IO=[].copyWithin||function(e,t){var r=EO(this),i=bO(r),n=gO(e,i),o=gO(t,i),a=arguments.length>2?arguments[2]:void 0,s=TO((void 0===a?i:gO(a,i))-o,i-n),c=1;for(o<n&&n<o+s&&(c=-1,o+=s-1,n+=s-1);s-- >0;)o in r?r[n]=r[o]:delete r[n],n+=c,o+=c;return r},RO=qA,AO=I(IO),CO=RO.aTypedArray;(0,RO.exportTypedArrayMethod)("copyWithin",(function(e,t){return AO(CO(this),e,t,arguments.length>2?arguments[2]:void 0)}));var OO=ba.every,NO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("every",(function(e){return OO(NO(this),e,arguments.length>1?arguments[1]:void 0)}));var wO=l,PO=$I,DO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return wO(PO,DO(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}));var kO=ii,MO=uu,UO=qA.TYPED_ARRAY_CONSTRUCTOR,LO=qA.aTypedArrayConstructor,xO=function(e){return LO(MO(e,e[UO]))},VO=function(e,t){for(var r=0,i=kO(t),n=new e(i);i>r;)n[r]=t[r++];return n},FO=xO,BO=ba.filter,jO=function(e,t){return VO(FO(e),t)},GO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("filter",(function(e){var t=BO(GO(this),e,arguments.length>1?arguments[1]:void 0);return jO(this,t)}));var HO=ba.find,zO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("find",(function(e){return HO(zO(this),e,arguments.length>1?arguments[1]:void 0)}));var KO=ba.findIndex,WO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("findIndex",(function(e){return KO(WO(this),e,arguments.length>1?arguments[1]:void 0)}));var XO=ba.forEach,YO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("forEach",(function(e){XO(YO(this),e,arguments.length>1?arguments[1]:void 0)}));var JO=ci.includes,qO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("includes",(function(e){return JO(qO(this),e,arguments.length>1?arguments[1]:void 0)}));var QO=ci.indexOf,ZO=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("indexOf",(function(e){return QO(ZO(this),e,arguments.length>1?arguments[1]:void 0)}));var $O=n,eN=a,tN=I,rN=qA,iN=up,nN=$e("iterator"),oN=$O.Uint8Array,aN=tN(iN.values),sN=tN(iN.keys),cN=tN(iN.entries),uN=rN.aTypedArray,dN=rN.exportTypedArrayMethod,lN=oN&&oN.prototype,hN=!eN((function(){lN[nN].call([1])})),pN=!!lN&&lN.values&&lN[nN]===lN.values&&"values"===lN.values.name,fN=function(){return aN(uN(this))};dN("entries",(function(){return cN(uN(this))}),hN),dN("keys",(function(){return sN(uN(this))}),hN),dN("values",fN,hN||!pN,{name:"values"}),dN(nN,fN,hN||!pN,{name:"values"});var _N=qA.aTypedArray,vN=qA.exportTypedArrayMethod,mN=I([].join);vN("join",(function(e){return mN(_N(this),e)}));var SN=Zn,yN=F,EN=Yr,gN=ii,bN=jn,TN=Math.min,IN=[].lastIndexOf,RN=!!IN&&1/[1].lastIndexOf(1,-0)<0,AN=bN("lastIndexOf"),CN=RN||!AN?function(e){if(RN)return SN(IN,this,arguments)||0;var t=yN(this),r=gN(t),i=r-1;for(arguments.length>1&&(i=TN(i,EN(arguments[1]))),i<0&&(i=r+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}:IN,ON=Zn,NN=CN,wN=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return ON(NN,wN(this),t>1?[e,arguments[1]]:[e])}));var PN=ba.map,DN=xO,kN=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("map",(function(e){return PN(kN(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(DN(e))(t)}))}));var MN=jS.left,UN=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return MN(UN(this),e,t,t>1?arguments[1]:void 0)}));var LN=jS.right,xN=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return LN(xN(this),e,t,t>1?arguments[1]:void 0)}));var VN=qA.aTypedArray,FN=qA.exportTypedArrayMethod,BN=Math.floor;FN("reverse",(function(){for(var e,t=this,r=VN(t).length,i=BN(r/2),n=0;n<i;)e=t[n],t[n++]=t[--r],t[r]=e;return t}));var jN=n,GN=l,HN=qA,zN=ii,KN=lC,WN=Me,XN=a,YN=jN.RangeError,JN=jN.Int8Array,qN=JN&&JN.prototype,QN=qN&&qN.set,ZN=HN.aTypedArray,$N=HN.exportTypedArrayMethod,ew=!XN((function(){var e=new Uint8ClampedArray(2);return GN(QN,e,{length:1,0:3},1),3!==e[1]})),tw=ew&&HN.NATIVE_ARRAY_BUFFER_VIEWS&&XN((function(){var e=new JN(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));$N("set",(function(e){ZN(this);var t=KN(arguments.length>1?arguments[1]:void 0,1),r=WN(e);if(ew)return GN(QN,this,r,t);var i=this.length,n=zN(r),o=0;if(n+t>i)throw YN("Wrong length");for(;o<n;)this[t+o]=r[o++]}),!ew||tw);var rw=xO,iw=Po,nw=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("slice",(function(e,t){for(var r=iw(nw(this),e,t),i=rw(this),n=0,o=r.length,a=new i(o);o>n;)a[n]=r[n++];return a}),a((function(){new Int8Array(1).slice()})));var ow=ba.some,aw=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("some",(function(e){return ow(aw(this),e,arguments.length>1?arguments[1]:void 0)}));var sw=n,cw=I,uw=a,dw=me,lw=hI,hw=qA,pw=fI,fw=_I,_w=te,vw=mI,mw=sw.Array,Sw=hw.aTypedArray,yw=hw.exportTypedArrayMethod,Ew=sw.Uint16Array,gw=Ew&&cw(Ew.prototype.sort),bw=!(!gw||uw((function(){gw(new Ew(2),null)}))&&uw((function(){gw(new Ew(2),{})}))),Tw=!!gw&&!uw((function(){if(_w)return _w<74;if(pw)return pw<67;if(fw)return!0;if(vw)return vw<602;var e,t,r=new Ew(516),i=mw(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,i[e]=e-2*t+3;for(gw(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==i[e])return!0}));yw("sort",(function(e){return void 0!==e&&dw(e),Tw?gw(this,e):lw(Sw(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))}),!Tw||bw);var Iw=ti,Rw=Zr,Aw=xO,Cw=qA.aTypedArray;(0,qA.exportTypedArrayMethod)("subarray",(function(e,t){var r=Cw(this),i=r.length,n=Rw(e,i);return new(Aw(r))(r.buffer,r.byteOffset+n*r.BYTES_PER_ELEMENT,Iw((void 0===t?i:Rw(t,i))-n))}));var Ow=Zn,Nw=qA,ww=a,Pw=Po,Dw=n.Int8Array,kw=Nw.aTypedArray,Mw=Nw.exportTypedArrayMethod,Uw=[].toLocaleString,Lw=!!Dw&&ww((function(){Uw.call(new Dw(1))}));Mw("toLocaleString",(function(){return Ow(Uw,Lw?Pw(kw(this)):kw(this),Pw(arguments))}),ww((function(){return[1,2].toLocaleString()!=new Dw([1,2]).toLocaleString()}))||!ww((function(){Dw.prototype.toLocaleString.call([1,2])})));var xw=qA.exportTypedArrayMethod,Vw=a,Fw=I,Bw=n.Uint8Array,jw=Bw&&Bw.prototype||{},Gw=[].toString,Hw=Fw([].join);Vw((function(){Gw.call({})}))&&(Gw=function(){return Hw(this)});var zw=jw.toString!=Gw;xw("toString",Gw,zw);var Kw=Wi,Ww=n,Xw=Zn,Yw=B,Jw=Po,qw=lu,Qw=/MSIE .\./.test(Y),Zw=Ww.Function,$w=function(e){return function(t,r){var i=qw(arguments.length,1)>2,n=Yw(t)?t:Zw(t),o=i?Jw(arguments,2):void 0;return e(i?function(){Xw(n,this,o)}:n,r)}};Kw({global:!0,bind:!0,forced:Qw},{setTimeout:$w(Ww.setTimeout),setInterval:$w(Ww.setInterval)});var eP=Wi,tP=ba.findIndex,rP=ah,iP="findIndex",nP=!0;iP in[]&&Array(1).findIndex((function(){nP=!1})),eP({target:"Array",proto:!0,forced:nP},{findIndex:function(e){return tP(this,e,arguments.length>1?arguments[1]:void 0)}}),rP(iP);var oP,aP,sP=cc,cP="ArrayBuffer",uP=eA.ArrayBuffer;Wi({global:!0,forced:n.ArrayBuffer!==uP},{ArrayBuffer:uP}),sP(cP),function(e){e.INVALID_ENGINE="INVALID_ENGINE",e.INVALID_PARAMS="INVALID_PARAMS",e.INVOKED_BEFORE_JOIN_ROOM="INVOKED_BEFORE_JOIN_ROOM",e.INVALID_TOKEN="INVALID_TOKEN",e.EXPIRED_TOKEN="EXPIRED_TOKEN",e.JOIN_ROOM_FAILED="JOIN_ROOM_FAILED",e.UPDATE_TOKEN_WITH_INVALID_TOKEN="UPDATE_TOKEN_WITH_INVALID_TOKEN",e.UPDATE_TOKEN_BEFORE_JOIN="UPDATE_TOKEN_BEFORE_JOIN",e.REPEAT_JOIN="REPEAT_JOIN",e.REPEAT_PUBLISH="REPEAT_PUBLISH",e.REPEAT_PUSH="REPEAT_PUSH",e.REPEAT_PLAY="REPEAT_PLAY",e.PUBLISH_BEFORE_JOIN="PUBLISH_BEFORE_JOIN",e.UNPUBLISH_BEFORE_JOIN="UNPUBLISH_BEFORE_JOIN",e.SUBSCRIBE_BEFORE_JOIN="SUBSCRIBE_BEFORE_JOIN",e.UNSUBSCRIBE_BEFORE_JOIN="UNSUBSCRIBE_BEFORE_JOIN",e.NO_PUBLISH_PERMISSION="NO_PUBLISH_PERMISSION",e.STREAM_NOT_EXIST="STREAM_NOT_EXIST",e.EMPTY_STREAM="EMPTY_STREAM",e.NOT_CONNECTED_YET="NOT_CONNECTED_YET",e.IM_BEFORE_JOIN="IM_BEFORE_JOIN",e.USER_NOT_EXIST="USER_NOT_EXIST",e.ALREADY_IN_ROOM="ALREADY_IN_ROOM",e.KICKED_OUT="KICKED_OUT",e.ROOM_DISMISS="ROOM_DISMISS",e.TOKEN_EXPIRED="TOKEN_EXPIRED",e.DUPLICATE_LOGIN="DUPLICATE_LOGIN",e.REPEAT_CAPTURE="REPEAT_CAPTURE",e.GET_VIDEO_TRACK_FAILED="GET_VIDEO_TRACK_FAILED",e.GET_AUDIO_TRACK_FAILED="GET_AUDIO_TRACK_FAILED",e.GET_SCREEN_TRACK_FAILED="GET_SCREEN_TRACK_FAILED",e.STREAM_TYPE_NOT_MATCH="STREAM_TYPE_NOT_MATCH",e.CANT_FIND_DOM="CANT_FIND_DOM",e.INVALID_DEVICE_ID="INVALID_DEVICE_ID",e.NO_PERMISSION="NO_PERMISSION",e.NOT_SUPPORTED="NOT_SUPPORTED",e.ICE_SERVER_WRONG="ICE_SERVER_WRONG",e.ESTABLISH_DATACHANNEL_FAILED="ESTABLISH_DATACHANNEL_FAILED",e.LOAD_RESOURCES_FAILED="LOAD_RESOURCES_FAILED",e.SIGNALING_CHANNEL_NOT_OPEN="SIGNALING_CHANNEL_NOT_OPEN",e.TIME_OUT="TIME_OUT",e.REFUSE_OPERATION_IN_DISCONNECT="REFUSE_OPERATION_IN_DISCONNECT",e.ADD_TRANSCEIVER_FAILED="ADD_TRANSCEIVER_FAILED",e.UPDATE_TRACK_FAILED="UPDATE_TRACK_FAILED",e.PUBLISH_FAILED="PUBLISH_FAILED",e.UNPUBLISH_FAILED="UNPUBLISH_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.OPERATION_CANCEL="OPERATION_CANCEL",e.START_CLOUD_PROXY_AFTER_JOIN="START_CLOUD_PROXY_AFTER_JOIN",e.STOP_CLOUD_PROXY_BEFORE_LEAVE="STOP_CLOUD_PROXY_BEFORE_LEAVE",e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.REPEAT_DEVICE_TEST="REPEAT_DEVICE_TEST",e.AUDIO_DEVICE_TEST_FAILED="AUDIO_DEVICE_RECORD_FAILED",e.ALREADY_LOGIN="ALREADY_LOGIN",e.LOGIN_FAILED="LOGIN_FAILED",e.NOT_LOGIN="NOT_LOGIN",e.RTM_DUPLICATE_LOGIN="RTM_DUPLICATE_LOGIN",e.RTM_TOKEN_ERROR="RTM_TOKEN_ERROR",e.USER_MESSAGE_TIMEOUT="USER_MESSAGE_TIMEOUT",e.USER_MESSAGE_BROKEN="USER_MESSAGE_BROKEN",e.USER_MESSAGE_NO_RECEIVER="USER_MESSAGE_NO_RECEIVER",e.USER_MESSAGE_NO_RELAYPATH="USER_MESSAGE_NO_RELAYPATH",e.USER_MESSAGE_SEND_TO_SERVER_ERROR="USER_MESSAGE_SEND_TO_SERVER_ERROR",e.USER_MESSAGE_SERVER_RESPONSE_ERROR="USER_MESSAGE_SERVER_RESPONSE_ERROR",e.USER_MESSAGE_NOT_JOIN="USER_MESSAGE_NOT_JOIN",e.USER_MESSAGE_INIT="USER_MESSAGE_INIT",e.USER_MESSAGE_NO_CONNECTION="USER_MESSAGE_NO_CONNECTION",e.USER_MESSAGE_EXCEED_MAX_LENGTH="USER_MESSAGE_EXCEED_MAX_LENGTH",e.USER_MESSAGE_EMPTY_USER="USER_MESSAGE_EMPTY_USER",e.USER_MESSAGE_NOT_LOGIN="USER_MESSAGE_NOT_LOGIN",e.USER_MESSAGE_SERVER_PARAMS_NOTSET="USER_MESSAGE_SERVER_PARAMS_NOTSET",e.USER_MESSAGE_UNKNOWN="USER_MESSAGE_UNKNOWN",e.START_PUBLIC_STREAM_BEFORE_JOIN="START_PUBLIC_STREAM_BEFORE_JOIN",e.RECONNECT_FAILED="RECONNECT_FAILED"}(oP||(oP={})),function(e){e[e.AUDIO_MIXING_ERROR_OK=0]="AUDIO_MIXING_ERROR_OK",e[e.AUDIO_MIXING_ERROR_PRELOAD_FAILED=1]="AUDIO_MIXING_ERROR_PRELOAD_FAILED",e[e.AUDIO_MIXING_ERROR_START_FAILED=2]="AUDIO_MIXING_ERROR_START_FAILED",e[e.AUDIO_MIXING_ERROR_ID_NOT_FOUND=3]="AUDIO_MIXING_ERROR_ID_NOT_FOUND",e[e.AUDIO_MIXING_ERROR_SET_POSITION_FAILED=4]="AUDIO_MIXING_ERROR_SET_POSITION_FAILED",e[e.AUDIO_MIXING_ERROR_INVALID_VOLUME=5]="AUDIO_MIXING_ERROR_INVALID_VOLUME",e[e.AUDIO_MIXING_ERROR_LOAD_CONFLICT=6]="AUDIO_MIXING_ERROR_LOAD_CONFLICT",e[e.AUDIO_MIXING_ERROR_ID_TYPE_NOT_MATCH=7]="AUDIO_MIXING_ERROR_ID_TYPE_NOT_MATCH",e[e.AUDIO_MIXING_ERROR_ID_TYPE_INVALID_PITCH=8]="AUDIO_MIXING_ERROR_ID_TYPE_INVALID_PITCH",e[e.AUDIO_MIXING_ERROR_INVALID_AUDIO_TRACK=9]="AUDIO_MIXING_ERROR_INVALID_AUDIO_TRACK"}(aP||(aP={}));var dP=function(e,t,r){this.code=e,this.message=t,this.error=r},lP=s,hP=I,pP=on,fP=F,_P=hP(h.f),vP=hP([].push),mP=function(e){return function(t){for(var r,i=fP(t),n=pP(i),o=n.length,a=0,s=[];o>a;)r=n[a++],lP&&!_P(i,r)||vP(s,e?[r,i[r]]:i[r]);return s}},SP={entries:mP(!0),values:mP(!1)}.entries;Wi({target:"Object",stat:!0},{entries:function(e){return SP(e)}});var yP=Yr,EP=fo,gP=L,bP=n.RangeError,TP=function(e){var t=EP(gP(this)),r="",i=yP(e);if(i<0||i==1/0)throw bP("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(r+=t);return r},IP=I,RP=ti,AP=fo,CP=L,OP=IP(TP),NP=IP("".slice),wP=Math.ceil,PP=function(e){return function(t,r,i){var n,o,a=AP(CP(t)),s=RP(r),c=a.length,u=void 0===i?" ":AP(i);return s<=c||""==u?a:((o=OP(u,wP((n=s-c)/u.length))).length>n&&(o=NP(o,0,n)),e?a+o:o+a)}},DP={start:PP(!1),end:PP(!0)},kP=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Y),MP=DP.end;Wi({target:"String",proto:!0,forced:kP},{padEnd:function(e){return MP(this,e,arguments.length>1?arguments[1]:void 0)}});var UP=wm;Wi({target:"Number",stat:!0,forced:Number.parseInt!=UP},{parseInt:UP});Wi({target:"ArrayBuffer",stat:!0,forced:!qA.NATIVE_ARRAY_BUFFER_VIEWS},{isView:qA.isView}),Wi({global:!0,forced:!VI},{DataView:eA.DataView});var LP=kt,xP=Dc,VP=Wo,FP=l,BP=Me,jP=function(e,t,r,i){try{return i?t(LP(r)[0],r[1]):t(r)}catch(t){xP(e,"throw",t)}},GP=vc,HP=aa,zP=ii,KP=yo,WP=Oc,XP=gc,YP=n.Array,JP=function(e){var t=BP(e),r=HP(this),i=arguments.length,n=i>1?arguments[1]:void 0,o=void 0!==n;o&&(n=VP(n,i>2?arguments[2]:void 0));var a,s,c,u,d,l,h=XP(t),p=0;if(!h||this==YP&&GP(h))for(a=zP(t),s=r?new this(a):YP(a);a>p;p++)l=o?n(t[p],p):t[p],KP(s,p,l);else for(d=(u=WP(t,h)).next,s=r?new this:[];!(c=FP(d,u)).done;p++)l=o?jP(u,n,[c.value,p],!0):c.value,KP(s,p,l);return s.length=p,s},qP=JP;Wi({target:"Array",stat:!0,forced:!tu((function(e){Array.from(e)}))},{from:qP});var QP=Wi,ZP=eo,$P=I([].reverse),eD=[1,2];QP({target:"Array",proto:!0,forced:String(eD)===String(eD.reverse())},{reverse:function(){return ZP(this)&&(this.length=this.length),$P(this)}});var tD=Wi,rD=n,iD=I,nD=Yr,oD=Bb,aD=TP,sD=a,cD=rD.RangeError,uD=rD.String,dD=Math.floor,lD=iD(aD),hD=iD("".slice),pD=iD(1..toFixed),fD=function(e,t,r){return 0===t?r:t%2==1?fD(e,t-1,r*e):fD(e*e,t/2,r)},_D=function(e,t,r){for(var i=-1,n=r;++i<6;)n+=t*e[i],e[i]=n%1e7,n=dD(n/1e7)},vD=function(e,t){for(var r=6,i=0;--r>=0;)i+=e[r],e[r]=dD(i/t),i=i%t*1e7},mD=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var i=uD(e[t]);r=""===r?i:r+lD("0",7-i.length)+i}return r};tD({target:"Number",proto:!0,forced:sD((function(){return"0.000"!==pD(8e-5,3)||"1"!==pD(.9,0)||"1.25"!==pD(1.255,2)||"1000000000000000128"!==pD(0xde0b6b3a7640080,0)}))||!sD((function(){pD({})}))},{toFixed:function(e){var t,r,i,n,o=oD(this),a=nD(e),s=[0,0,0,0,0,0],c="",u="0";if(a<0||a>20)throw cD("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return uD(o);if(o<0&&(c="-",o=-o),o>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(o*fD(2,69,1))-69)<0?o*fD(2,-t,1):o/fD(2,t,1),r*=4503599627370496,(t=52-t)>0){for(_D(s,0,r),i=a;i>=7;)_D(s,1e7,0),i-=7;for(_D(s,fD(10,i,1),0),i=t-1;i>=23;)vD(s,1<<23),i-=23;vD(s,1<<i),_D(s,1,1),vD(s,2),u=mD(s)}else _D(s,0,r),_D(s,1<<-t,0),u=mD(s)+lD("0",a);return u=a>0?c+((n=u.length)<=a?"0."+lD("0",a-n)+u:hD(u,0,n-a)+"."+hD(u,n-a)):c+u}});var SD=Math.log,yD=Math.LOG10E;Wi({target:"Math",stat:!0},{log10:Math.log10||function(e){return SD(e)*yD}});var ED,gD=Wi,bD=I,TD=o.f,ID=ti,RD=fo,AD=B_,CD=L,OD=G_,ND=bD("".startsWith),wD=bD("".slice),PD=Math.min,DD=OD("startsWith"),kD=!DD&&!!function(){var e=TD(String.prototype,"startsWith");return e&&!e.writable}();gD({target:"String",proto:!0,forced:!kD&&!DD},{startsWith:function(e){var t=RD(CD(this));AD(e);var r=ID(PD(arguments.length>1?arguments[1]:void 0,t.length)),i=RD(e);return ND?ND(t,i,r):wD(t,r,r+i.length)===i}});var MD=new Uint8Array(16);function UD(){if(!ED&&!(ED="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ED(MD)}var LD=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function xD(e){return"string"==typeof e&&LD.test(e)}for(var VD=[],FD=0;FD<256;++FD)VD.push((FD+256).toString(16).substr(1));function BD(e,t,r){var i=(e=e||{}).random||(e.rng||UD)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=i[n];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(VD[e[t+0]]+VD[e[t+1]]+VD[e[t+2]]+VD[e[t+3]]+"-"+VD[e[t+4]]+VD[e[t+5]]+"-"+VD[e[t+6]]+VD[e[t+7]]+"-"+VD[e[t+8]]+VD[e[t+9]]+"-"+VD[e[t+10]]+VD[e[t+11]]+VD[e[t+12]]+VD[e[t+13]]+VD[e[t+14]]+VD[e[t+15]]).toLowerCase();if(!xD(r))throw TypeError("Stringified UUID is invalid");return r}(i)}var jD=new TextDecoder,GD=new TextEncoder,HD=function(){return BD()},zD=function(){return Date.now()};function KD(e){for(var t,r,i,n,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];var s=0;try{for(var c=r_(o),u=c.next();!u.done;u=c.next()){s+=(f=u.value).length}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}var d=new e(s),l=0;try{for(var h=r_(o),p=h.next();!p.done;p=h.next()){var f=p.value;d.set(f,l),l+=f.length}}catch(e){i={error:e}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(i)throw i.error}}return d}var WD=function(){return"undefined"==typeof window},XD=function(){function e(){}return e.token2auth=function(t,r,i,n){return n?"Bearer ".concat(n):"Basic ".concat(e.createUnsafeToken(t,r,i))},e.createUnsafeToken=function(e,t,r){return window.btoa([e,t,r].filter((function(e){return null!==e})).join(":"))},e.merge=function(r,i){var n,o;void 0===r&&(r={}),void 0===i&&(i={});try{for(var a=r_(Object.entries(r)),s=a.next();!s.done;s=a.next()){var c=i_(s.value,2),u=c[0],d=c[1];null!==d&&"object"===t(d)?e.merge(r[u],i[u]):void 0!==i[u]&&(r[u]=i[u])}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}},e.ab2str=function(e){return jD.decode(e)},e.ab2obj=function(t){try{var r=e.ab2str(t);return JSON.parse(r)}catch(e){return{}}},e.str2ab=function(e){return GD.encode(e).buffer},e.ab2b64str=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){var r=new FileReader;r.onload=function(){return t(r.result)},r.readAsDataURL(new Blob([e]))}))];case 1:return[2,t.sent().split(",",2)[1]]}}))}))},e.b64str2ab=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){return[2,fetch("data:application/octet;base64,"+e).then((function(e){return e.arrayBuffer()}))]}))}))},e}();function YD(){for(var e=(+"".concat(Math.random()).slice(-7).padEnd(7,"0")).toString(2).padEnd(28,"1").split(""),t=[];e.length;)t.push(e.splice(0,7));return t.map((function(e,r){var i=r===t.length-1?"0":"1";return Number.parseInt(i+e.join(""),2)}))}var JD=function(){return Math.floor(65535*Math.random())};function qD(e){return"string"==typeof e&&e.indexOf("__web__rtc__rtt__")>-1}function QD(e){return e.map((function e(t){if(t instanceof HTMLElement)return t.toString();if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){var r=ArrayBuffer.isView(t)?t.buffer:t,i=r.byteLength,n=[];if(i>10){var o=new DataView(r),a=Array.from({length:5}).map((function(e,t){return o.getUint8(t)})),s=Array.from({length:5}).map((function(e,t){return i-1-t})).reverse().map((function(e){return o.getUint8(e)}));n=n_(n_(n_([],i_(a),!1),["..."],!1),i_(s),!1)}else n=Array.from(new Uint8Array(r));return"".concat(t.constructor.name,"(").concat(i,") [").concat(n.join(", "),"]")}if(Array.isArray(t))return t.map(e);if("[object Object]"===Object.prototype.toString.call(t)){var c={};for(var u in t)c[u]=e(t[u]);return c}return t}))}var ZD=function(){return e_(void 0,void 0,void 0,(function(){var e,t;return t_(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"})).createDataChannel("default"),e.addTransceiver("audio",{direction:"recvonly"}),e.addTransceiver("video",{direction:"recvonly"}),[4,e.createOffer()];case 1:return t=r.sent(),e.close(),[2,t.sdp];case 2:return r.sent(),[3,3];case 3:return[2]}}))}))},$D=function(e){return new Promise((function(t,r){var i=(e=Array.isArray(e)?e:[]).length,n=[];0===i?r([]):e.forEach((function(e){e.then((function(e){t(e)}),(function(e){i--,n.push(e),0===i&&r(n)}))}))}))};function ek(e){return+Math.max(-127,10*Math.log10(Math.pow(e/255,2))).toFixed(2)}function tk(e){return(e&Vf.AUDIO)===Vf.AUDIO}function rk(e){return(e&Vf.VIDEO)===Vf.VIDEO}function ik(e){var r={};return Object.keys(e).forEach((function(i){"object"===t(e[i])?r[i]=ik(e[i]):i.startsWith("_")||(r[i]=e[i])})),r}function nk(e,t){if("boolean"!=typeof e)throw new dP(oP.INVALID_PARAMS,"Invalid ".concat(t,": The value should be boolean type."))}function ok(e,t,r,i){if(void 0===r&&(r=1),void 0===i&&(i=Number.POSITIVE_INFINITY),e<r||e>i||"number"!=typeof e)throw new dP(oP.INVALID_PARAMS,"Invalid ".concat(t,": the value range is [").concat(r,", ").concat(i,"]. integer only"))}function ak(e,t,r,i){if(void 0===r&&(r=1),void 0===i&&(i=Number.POSITIVE_INFINITY),null==e)throw new dP(oP.INVALID_PARAMS,"".concat(t," cannot be empty"));if(!function(e,t,r){void 0===t&&(t=1);void 0===r&&(r=Number.POSITIVE_INFINITY);return"string"==typeof e&&e.length<=r&&e.length>=t}(e,r,i))throw new dP(oP.INVALID_PARAMS,"Invalid ".concat(t,": The value should be string type. Length of the string: [").concat(r,",").concat(i,"]"))}function sk(e,t,r){if(!r.includes(e))throw new dP(oP.INVALID_PARAMS,"Invalid ".concat(t,": The value can only be set as ").concat(JSON.stringify(r)))}function ck(e,t){if(lk(e))throw new dP(oP.INVALID_PARAMS,"Invalid ".concat(t,", should not be empty"))}function uk(e,t){if(!(e instanceof ArrayBuffer))throw new dP(oP.INVALID_PARAMS,"Invalid ".concat(t,", should be ArrayBuffer"))}function dk(e){var t,r;try{var i=navigator.mediaDevices.getSupportedConstraints();try{for(var n=r_(Object.keys(e)),o=n.next();!o.done;o=n.next()){var a=o.value;i[a]||delete e[a]}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}catch(e){}}function lk(e){return null==e}function hk(e){if("string"!=typeof e||!/^[a-zA-Z0-9@._\-]{1,128}$/.test(e))throw new dP(oP.INVALID_PARAMS,"The userId must be within 128 bytes. The supported characters: a-z,A-Z,0-9,@,-,_,.")}function pk(e){if("string"!=typeof e||!/^[a-zA-Z0-9@._\-]{1,128}$/.test(e))throw new dP(oP.INVALID_PARAMS,"The publicStreamId must be within 128 bytes. The supported characters: a-z,A-Z,0-9,@,-,_,.")}function fk(e){ck(e,"videoPlayerOption")}function _k(e,t){var r,i;if(void 0===t&&(t=64),!e||0===(null===(r=e)||void 0===r?void 0:r.byteLength))throw new dP(oP.INVALID_PARAMS,"The message cannot be empty");if((null==(i=e instanceof ArrayBuffer?e:XD.str2ab(JSON.stringify(e)))?void 0:i.byteLength)>1e3*t)throw new dP(oP.INVALID_PARAMS,"The message length must be less than ".concat(t,"K"))}function vk(e){return![u_.onRemoteStreamStats,u_.onLocalStreamStats].includes(e)}var mk={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,i,o,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new n(i,o||e,a),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,a=new Array(o);n<o;n++)a[n]=i[n].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},s.prototype.emit=function(e,t,i,n,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var c,u,d=this._events[s],l=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),l){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,i),!0;case 4:return d.fn.call(d.context,t,i,n),!0;case 5:return d.fn.call(d.context,t,i,n,o),!0;case 6:return d.fn.call(d.context,t,i,n,o,a),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];d.fn.apply(d.context,c)}else{var h,p=d.length;for(u=0;u<p;u++)switch(d[u].once&&this.removeListener(e,d[u].fn,void 0,!0),l){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,t);break;case 3:d[u].fn.call(d[u].context,t,i);break;case 4:d[u].fn.call(d[u].context,t,i,n);break;default:if(!c)for(h=1,c=new Array(l-1);h<l;h++)c[h-1]=arguments[h];d[u].fn.apply(d[u].context,c)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,i,n){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||n&&!s.once||i&&s.context!==i||a(this,o);else{for(var c=0,u=[],d=s.length;c<d;c++)(s[c].fn!==t||n&&!s[c].once||i&&s[c].context!==i)&&u.push(s[c]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(mk);var Sk="[VERTC]",yk=["#0050b3","#0050b3","#0050b3","#0050b3"],Ek=!WD()&&window.location.search.includes("_rtc_debug_"),gk=function(){function e(e,t,r){this._module=e,this._indent=t}return e.prototype.print=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Ek){for(var i="",n=0;n<this._indent;n++)i+="    ";console.log.apply(console,n_(["%c".concat(Sk).concat(i,"[").concat(this._module,".").concat(e,"] ").concat(t.shift()),"color:".concat(yk[this._indent],";")],i_(t),!1))}},e}(),bk=new gk("VERTC",0),Tk=function(e){function t(){return e.call(this)||this}return Cf(t,e),t.prototype.safeEmit=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var n=this.listenerCount(t);try{return e.prototype.emit.apply(this,n_([t],i_(r),!1))}catch(e){return bk.print("safaEmit","safeEmit() | event listener threw an error [event:%s]:%o",t,e),Boolean(n)}},t.prototype.safeEmitAsPromise=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e_(this,void 0,void 0,(function(){var r=this;return t_(this,(function(i){return[2,new Promise((function(i,n){try{r.emit.apply(r,n_(n_([e],i_(t),!1),[i,n],!1))}catch(t){bk.print("safeEmitAsPromise","safeEmitAsPromise() | event listener threw an error [event:%s]:%o",e,t),n(t)}}))]}))}))},t}(mk.exports.EventEmitter),Ik=xe,Rk=function(e){return void 0!==e&&(Ik(e,"value")||Ik(e,"writable"))},Ak=l,Ck=G,Ok=kt,Nk=Rk,wk=o,Pk=vh;Wi({target:"Reflect",stat:!0},{get:function e(t,r){var i,n,o=arguments.length<3?t:arguments[2];return Ok(t)===o?t[r]:(i=wk.f(t,r))?Nk(i)?i.value:void 0===i.get?void 0:Ak(i.get,o):Ck(n=Pk(t))?e(n,r,o):void 0}});var Dk=Wi,kk=l,Mk=kt,Uk=G,Lk=Rk,xk=Ct,Vk=o,Fk=vh,Bk=S;var jk=a((function(){var e=function(){},t=xk.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}));Dk({target:"Reflect",stat:!0,forced:jk},{set:function e(t,r,i){var n,o,a,s=arguments.length<4?t:arguments[3],c=Vk.f(Mk(t),r);if(!c){if(Uk(o=Fk(t)))return e(o,r,i,s);c=Bk(0)}if(Lk(c)){if(!1===c.writable||!Uk(s))return!1;if(n=Vk.f(s,r)){if(n.get||n.set||!1===n.writable)return!1;n.value=i,xk.f(s,r,n)}else xk.f(s,r,Bk(0,i))}else{if(void 0===(a=c.set))return!1;kk(a,s,i)}return!0}}),(0,mA.exports)("Uint16",(function(e){return function(t,r,i){return e(this,t,r,i)}})),(0,mA.exports)("Int32",(function(e){return function(t,r,i){return e(this,t,r,i)}}));var Gk={};!function(e){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var r=Array.prototype.slice.call(arguments,1);r.length;){var n=r.shift();if(n){if("object"!==t(n))throw new TypeError(n+"must be non-object");for(var o in n)i(n,o)&&(e[o]=n[o])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),n);else for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){var t,r,i,n,o,a;for(i=0,t=0,r=e.length;t<r;t++)i+=e[t].length;for(a=new Uint8Array(i),n=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,n),n+=o.length;return a}},o={arraySet:function(e,t,r,i,n){for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,o))},e.setTyped(r)}(Gk);var Hk={},zk={},Kk={},Wk=Gk;function Xk(e){for(var t=e.length;--t>=0;)e[t]=0}var Yk=256,Jk=286,qk=30,Qk=15,Zk=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],eM=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],tM=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],rM=new Array(576);Xk(rM);var iM=new Array(60);Xk(iM);var nM=new Array(512);Xk(nM);var oM=new Array(256);Xk(oM);var aM=new Array(29);Xk(aM);var sM,cM,uM,dM=new Array(qk);function lM(e,t,r,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function hM(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function pM(e){return e<256?nM[e]:nM[256+(e>>>7)]}function fM(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function _M(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,fM(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function vM(e,t,r){_M(e,r[2*t],r[2*t+1])}function mM(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function SM(e,t,r){var i,n,o=new Array(16),a=0;for(i=1;i<=Qk;i++)o[i]=a=a+r[i-1]<<1;for(n=0;n<=t;n++){var s=e[2*n+1];0!==s&&(e[2*n]=mM(o[s]++,s))}}function yM(e){var t;for(t=0;t<Jk;t++)e.dyn_ltree[2*t]=0;for(t=0;t<qk;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function EM(e){e.bi_valid>8?fM(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function gM(e,t,r,i){var n=2*t,o=2*r;return e[n]<e[o]||e[n]===e[o]&&i[t]<=i[r]}function bM(e,t,r){for(var i=e.heap[r],n=r<<1;n<=e.heap_len&&(n<e.heap_len&&gM(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!gM(t,i,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=i}function TM(e,t,r){var i,n,o,a,s=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],n=e.pending_buf[e.l_buf+s],s++,0===i?vM(e,n,t):(vM(e,(o=oM[n])+Yk+1,t),0!==(a=Zk[o])&&_M(e,n-=aM[o],a),vM(e,o=pM(--i),r),0!==(a=$k[o])&&_M(e,i-=dM[o],a))}while(s<e.last_lit);vM(e,256,t)}function IM(e,t){var r,i,n,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<c;r++)0!==o[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(n=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[n]=0,e.opt_len--,s&&(e.static_len-=a[2*n+1]);for(t.max_code=u,r=e.heap_len>>1;r>=1;r--)bM(e,o,r);n=c;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],bM(e,o,1),i=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=i,o[2*n]=o[2*r]+o[2*i],e.depth[n]=(e.depth[r]>=e.depth[i]?e.depth[r]:e.depth[i])+1,o[2*r+1]=o[2*i+1]=n,e.heap[1]=n++,bM(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,i,n,o,a,s,c=t.dyn_tree,u=t.max_code,d=t.stat_desc.static_tree,l=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,_=0;for(o=0;o<=Qk;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(o=c[2*c[2*(i=e.heap[r])+1]+1]+1)>f&&(o=f,_++),c[2*i+1]=o,i>u||(e.bl_count[o]++,a=0,i>=p&&(a=h[i-p]),s=c[2*i],e.opt_len+=s*(o+a),l&&(e.static_len+=s*(d[2*i+1]+a)));if(0!==_){do{for(o=f-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[f]--,_-=2}while(_>0);for(o=f;0!==o;o--)for(i=e.bl_count[o];0!==i;)(n=e.heap[--r])>u||(c[2*n+1]!==o&&(e.opt_len+=(o-c[2*n+1])*c[2*n],c[2*n+1]=o),i--)}}(e,t),SM(o,u,e.bl_count)}function RM(e,t,r){var i,n,o=-1,a=t[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),t[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=t[2*(i+1)+1],++s<c&&n===a||(s<u?e.bl_tree[2*n]+=s:0!==n?(n!==o&&e.bl_tree[2*n]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=n,0===a?(c=138,u=3):n===a?(c=6,u=3):(c=7,u=4))}function AM(e,t,r){var i,n,o=-1,a=t[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),i=0;i<=r;i++)if(n=a,a=t[2*(i+1)+1],!(++s<c&&n===a)){if(s<u)do{vM(e,n,e.bl_tree)}while(0!=--s);else 0!==n?(n!==o&&(vM(e,n,e.bl_tree),s--),vM(e,16,e.bl_tree),_M(e,s-3,2)):s<=10?(vM(e,17,e.bl_tree),_M(e,s-3,3)):(vM(e,18,e.bl_tree),_M(e,s-11,7));s=0,o=n,0===a?(c=138,u=3):n===a?(c=6,u=3):(c=7,u=4)}}Xk(dM);var CM=!1;function OM(e,t,r,i){_M(e,0+(i?1:0),3),function(e,t,r,i){EM(e),i&&(fM(e,r),fM(e,~r)),Wk.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}Kk._tr_init=function(e){CM||(!function(){var e,t,r,i,n,o=new Array(16);for(r=0,i=0;i<28;i++)for(aM[i]=r,e=0;e<1<<Zk[i];e++)oM[r++]=i;for(oM[r-1]=i,n=0,i=0;i<16;i++)for(dM[i]=n,e=0;e<1<<$k[i];e++)nM[n++]=i;for(n>>=7;i<qk;i++)for(dM[i]=n<<7,e=0;e<1<<$k[i]-7;e++)nM[256+n++]=i;for(t=0;t<=Qk;t++)o[t]=0;for(e=0;e<=143;)rM[2*e+1]=8,e++,o[8]++;for(;e<=255;)rM[2*e+1]=9,e++,o[9]++;for(;e<=279;)rM[2*e+1]=7,e++,o[7]++;for(;e<=287;)rM[2*e+1]=8,e++,o[8]++;for(SM(rM,287,o),e=0;e<qk;e++)iM[2*e+1]=5,iM[2*e]=mM(e,5);sM=new lM(rM,Zk,257,Jk,Qk),cM=new lM(iM,$k,0,qk,Qk),uM=new lM(new Array(0),eM,0,19,7)}(),CM=!0),e.l_desc=new hM(e.dyn_ltree,sM),e.d_desc=new hM(e.dyn_dtree,cM),e.bl_desc=new hM(e.bl_tree,uM),e.bi_buf=0,e.bi_valid=0,yM(e)},Kk._tr_stored_block=OM,Kk._tr_flush_block=function(e,t,r,i){var n,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<Yk;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),IM(e,e.l_desc),IM(e,e.d_desc),a=function(e){var t;for(RM(e,e.dyn_ltree,e.l_desc.max_code),RM(e,e.dyn_dtree,e.d_desc.max_code),IM(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*tM[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=n&&(n=o)):n=o=r+5,r+4<=n&&-1!==t?OM(e,t,r,i):4===e.strategy||o===n?(_M(e,2+(i?1:0),3),TM(e,rM,iM)):(_M(e,4+(i?1:0),3),function(e,t,r,i){var n;for(_M(e,t-257,5),_M(e,r-1,5),_M(e,i-4,4),n=0;n<i;n++)_M(e,e.bl_tree[2*tM[n]+1],3);AM(e,e.dyn_ltree,t-1),AM(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),TM(e,e.dyn_ltree,e.dyn_dtree)),yM(e),i&&EM(e)},Kk._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(oM[r]+Yk+1)]++,e.dyn_dtree[2*pM(t)]++),e.last_lit===e.lit_bufsize-1},Kk._tr_align=function(e){_M(e,2,3),vM(e,256,rM),function(e){16===e.bi_valid?(fM(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)};var NM=function(e,t,r,i){for(var n=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(n=n+t[i++]|0)|0}while(--a);n%=65521,o%=65521}return n|o<<16|0};var wM=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var PM,DM=function(e,t,r,i){var n=wM,o=i+r;e^=-1;for(var a=i;a<o;a++)e=e>>>8^n[255&(e^t[a])];return-1^e},kM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},MM=Gk,UM=Kk,LM=NM,xM=DM,VM=kM,FM=-2,BM=258,jM=262,GM=103,HM=113,zM=666;function KM(e,t){return e.msg=VM[t],t}function WM(e){return(e<<1)-(e>4?9:0)}function XM(e){for(var t=e.length;--t>=0;)e[t]=0}function YM(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(MM.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function JM(e,t){UM._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,YM(e.strm)}function qM(e,t){e.pending_buf[e.pending++]=t}function QM(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function ZM(e,t){var r,i,n=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-jM?e.strstart-(e.w_size-jM):0,u=e.window,d=e.w_mask,l=e.prev,h=e.strstart+BM,p=u[o+a-1],f=u[o+a];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(r=t)+a]===f&&u[r+a-1]===p&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<h);if(i=BM-(h-o),o=h-BM,i>a){if(e.match_start=t,a=i,i>=s)break;p=u[o+a-1],f=u[o+a]}}}while((t=l[t&d])>c&&0!=--n);return a<=e.lookahead?a:e.lookahead}function $M(e){var t,r,i,n,o,a,s,c,u,d,l=e.w_size;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=l+(l-jM)){MM.arraySet(e.window,e.window,l,l,0),e.match_start-=l,e.strstart-=l,e.block_start-=l,t=r=e.hash_size;do{i=e.head[--t],e.head[t]=i>=l?i-l:0}while(--r);t=r=l;do{i=e.prev[--t],e.prev[t]=i>=l?i-l:0}while(--r);n+=l}if(0===e.strm.avail_in)break;if(a=e.strm,s=e.window,c=e.strstart+e.lookahead,u=n,d=void 0,(d=a.avail_in)>u&&(d=u),r=0===d?0:(a.avail_in-=d,MM.arraySet(s,a.input,a.next_in,d,c),1===a.state.wrap?a.adler=LM(a.adler,s,d,c):2===a.state.wrap&&(a.adler=xM(a.adler,s,d,c)),a.next_in+=d,a.total_in+=d,d),e.lookahead+=r,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+3-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<jM&&0!==e.strm.avail_in)}function eU(e,t){for(var r,i;;){if(e.lookahead<jM){if($M(e),e.lookahead<jM&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-jM&&(e.match_length=ZM(e,r)),e.match_length>=3)if(i=UM._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=UM._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(JM(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(JM(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JM(e,!1),0===e.strm.avail_out)?1:2}function tU(e,t){for(var r,i,n;;){if(e.lookahead<jM){if($M(e),e.lookahead<jM&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-jM&&(e.match_length=ZM(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,i=UM._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(JM(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=UM._tr_tally(e,0,e.window[e.strstart-1]))&&JM(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=UM._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(JM(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JM(e,!1),0===e.strm.avail_out)?1:2}function rU(e,t,r,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=n}function iU(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new MM.Buf16(1146),this.dyn_dtree=new MM.Buf16(122),this.bl_tree=new MM.Buf16(78),XM(this.dyn_ltree),XM(this.dyn_dtree),XM(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new MM.Buf16(16),this.heap=new MM.Buf16(573),XM(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new MM.Buf16(573),XM(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function nU(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:HM,e.adler=2===t.wrap?0:1,t.last_flush=0,UM._tr_init(t),0):KM(e,FM)}function oU(e){var t,r=nU(e);return 0===r&&((t=e.state).window_size=2*t.w_size,XM(t.head),t.max_lazy_match=PM[t.level].max_lazy,t.good_match=PM[t.level].good_length,t.nice_match=PM[t.level].nice_length,t.max_chain_length=PM[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function aU(e,t,r,i,n,o){if(!e)return FM;var a=1;if(-1===t&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>9||8!==r||i<8||i>15||t<0||t>9||o<0||o>4)return KM(e,FM);8===i&&(i=9);var s=new iU;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=n+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new MM.Buf8(2*s.w_size),s.head=new MM.Buf16(s.hash_size),s.prev=new MM.Buf16(s.w_size),s.lit_bufsize=1<<n+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new MM.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,oU(e)}PM=[new rU(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if($M(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,JM(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-jM&&(JM(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(JM(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(JM(e,!1),e.strm.avail_out),1)})),new rU(4,4,8,4,eU),new rU(4,5,16,8,eU),new rU(4,6,32,32,eU),new rU(4,4,16,16,tU),new rU(8,16,32,32,tU),new rU(8,16,128,128,tU),new rU(8,32,128,256,tU),new rU(32,128,258,1024,tU),new rU(32,258,258,4096,tU)],zk.deflateInit=function(e,t){return aU(e,t,8,15,8,0)},zk.deflateInit2=aU,zk.deflateReset=oU,zk.deflateResetKeep=nU,zk.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?FM:(e.state.gzhead=t,0):FM},zk.deflate=function(e,t){var r,i,n,o;if(!e||!e.state||t>5||t<0)return e?KM(e,FM):FM;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===zM&&4!==t)return KM(e,0===e.avail_out?-5:FM);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,qM(i,31),qM(i,139),qM(i,8),i.gzhead?(qM(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),qM(i,255&i.gzhead.time),qM(i,i.gzhead.time>>8&255),qM(i,i.gzhead.time>>16&255),qM(i,i.gzhead.time>>24&255),qM(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),qM(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(qM(i,255&i.gzhead.extra.length),qM(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=xM(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(qM(i,0),qM(i,0),qM(i,0),qM(i,0),qM(i,0),qM(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),qM(i,3),i.status=HM);else{var a=8+(i.w_bits-8<<4)<<8;a|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(a|=32),a+=31-a%31,i.status=HM,QM(i,a),0!==i.strstart&&(QM(i,e.adler>>>16),QM(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>n&&(e.adler=xM(e.adler,i.pending_buf,i.pending-n,n)),YM(e),n=i.pending,i.pending!==i.pending_buf_size));)qM(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(e.adler=xM(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=xM(e.adler,i.pending_buf,i.pending-n,n)),YM(e),n=i.pending,i.pending===i.pending_buf_size)){o=1;break}o=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,qM(i,o)}while(0!==o);i.gzhead.hcrc&&i.pending>n&&(e.adler=xM(e.adler,i.pending_buf,i.pending-n,n)),0===o&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=xM(e.adler,i.pending_buf,i.pending-n,n)),YM(e),n=i.pending,i.pending===i.pending_buf_size)){o=1;break}o=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,qM(i,o)}while(0!==o);i.gzhead.hcrc&&i.pending>n&&(e.adler=xM(e.adler,i.pending_buf,i.pending-n,n)),0===o&&(i.status=GM)}else i.status=GM;if(i.status===GM&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&YM(e),i.pending+2<=i.pending_buf_size&&(qM(i,255&e.adler),qM(i,e.adler>>8&255),e.adler=0,i.status=HM)):i.status=HM),0!==i.pending){if(YM(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&WM(t)<=WM(r)&&4!==t)return KM(e,-5);if(i.status===zM&&0!==e.avail_in)return KM(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&i.status!==zM){var s=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&($M(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=UM._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(JM(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(JM(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JM(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,i,n,o,a=e.window;;){if(e.lookahead<=BM){if($M(e),e.lookahead<=BM&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=a[n=e.strstart-1])===a[++n]&&i===a[++n]&&i===a[++n]){o=e.strstart+BM;do{}while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<o);e.match_length=BM-(o-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=UM._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=UM._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(JM(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(JM(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JM(e,!1),0===e.strm.avail_out)?1:2}(i,t):PM[i.level].func(i,t);if(3!==s&&4!==s||(i.status=zM),1===s||3===s)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===s&&(1===t?UM._tr_align(i):5!==t&&(UM._tr_stored_block(i,0,0,!1),3===t&&(XM(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),YM(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(qM(i,255&e.adler),qM(i,e.adler>>8&255),qM(i,e.adler>>16&255),qM(i,e.adler>>24&255),qM(i,255&e.total_in),qM(i,e.total_in>>8&255),qM(i,e.total_in>>16&255),qM(i,e.total_in>>24&255)):(QM(i,e.adler>>>16),QM(i,65535&e.adler)),YM(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},zk.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==GM&&t!==HM&&t!==zM?KM(e,FM):(e.state=null,t===HM?KM(e,-3):0):FM},zk.deflateSetDictionary=function(e,t){var r,i,n,o,a,s,c,u,d=t.length;if(!e||!e.state)return FM;if(2===(o=(r=e.state).wrap)||1===o&&42!==r.status||r.lookahead)return FM;for(1===o&&(e.adler=LM(e.adler,t,d,0)),r.wrap=0,d>=r.w_size&&(0===o&&(XM(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new MM.Buf8(r.w_size),MM.arraySet(u,t,d-r.w_size,r.w_size,0),t=u,d=r.w_size),a=e.avail_in,s=e.next_in,c=e.input,e.avail_in=d,e.next_in=0,e.input=t,$M(r);r.lookahead>=3;){i=r.strstart,n=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+3-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++}while(--n);r.strstart=i,r.lookahead=2,$M(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=c,e.avail_in=a,r.wrap=o,0},zk.deflateInfo="pako deflate (from Nodeca project)";var sU={},cU=Gk,uU=!0,dU=!0;try{String.fromCharCode.apply(null,[0])}catch(e){uU=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){dU=!1}for(var lU=new cU.Buf8(256),hU=0;hU<256;hU++)lU[hU]=hU>=252?6:hU>=248?5:hU>=240?4:hU>=224?3:hU>=192?2:1;function pU(e,t){if(t<65534&&(e.subarray&&dU||!e.subarray&&uU))return String.fromCharCode.apply(null,cU.shrinkBuf(e,t));for(var r="",i=0;i<t;i++)r+=String.fromCharCode(e[i]);return r}lU[254]=lU[254]=1,sU.string2buf=function(e){var t,r,i,n,o,a=e.length,s=0;for(n=0;n<a;n++)55296==(64512&(r=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new cU.Buf8(s),o=0,n=0;o<s;n++)55296==(64512&(r=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},sU.buf2binstring=function(e){return pU(e,e.length)},sU.binstring2buf=function(e){for(var t=new cU.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},sU.buf2string=function(e,t){var r,i,n,o,a=t||e.length,s=new Array(2*a);for(i=0,r=0;r<a;)if((n=e[r++])<128)s[i++]=n;else if((o=lU[n])>4)s[i++]=65533,r+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&r<a;)n=n<<6|63&e[r++],o--;o>1?s[i++]=65533:n<65536?s[i++]=n:(n-=65536,s[i++]=55296|n>>10&1023,s[i++]=56320|1023&n)}return pU(s,i)},sU.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+lU[e[r]]>t?r:t};var fU=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},_U=zk,vU=Gk,mU=sU,SU=kM,yU=fU,EU=Object.prototype.toString;function gU(e){if(!(this instanceof gU))return new gU(e);this.options=vU.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yU,this.strm.avail_out=0;var r=_U.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(SU[r]);if(t.header&&_U.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?mU.string2buf(t.dictionary):"[object ArrayBuffer]"===EU.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=_U.deflateSetDictionary(this.strm,i)))throw new Error(SU[r]);this._dict_set=!0}}function bU(e,t){var r=new gU(t);if(r.push(e,!0),r.err)throw r.msg||SU[r.err];return r.result}gU.prototype.push=function(e,t){var r,i,n=this.strm,o=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,"string"==typeof e?n.input=mU.string2buf(e):"[object ArrayBuffer]"===EU.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new vU.Buf8(o),n.next_out=0,n.avail_out=o),1!==(r=_U.deflate(n,i))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==n.avail_out&&(0!==n.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(mU.buf2binstring(vU.shrinkBuf(n.output,n.next_out))):this.onData(vU.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||0===n.avail_out)&&1!==r);return 4===i?(r=_U.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==i||(this.onEnd(0),n.avail_out=0,!0)},gU.prototype.onData=function(e){this.chunks.push(e)},gU.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=vU.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Hk.Deflate=gU,Hk.deflate=bU,Hk.deflateRaw=function(e,t){return(t=t||{}).raw=!0,bU(e,t)},Hk.gzip=function(e,t){return(t=t||{}).gzip=!0,bU(e,t)};var TU={},IU=s,RU=Ct,AU=q_,CU=a,OU=RegExp.prototype;IU&&CU((function(){return"sy"!==Object.getOwnPropertyDescriptor(OU,"flags").get.call({dotAll:!0,sticky:!0})}))&&RU.f(OU,"flags",{configurable:!0,get:AU});var NU={},wU=Gk,PU=15,DU=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],kU=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],MU=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],UU=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],LU=Gk,xU=NM,VU=DM,FU=function(e,t){var r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S,y,E,g,b,T,I,R,A;r=e.state,i=e.next_in,R=e.input,n=i+(e.avail_in-5),o=e.next_out,A=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),c=r.dmax,u=r.wsize,d=r.whave,l=r.wnext,h=r.window,p=r.hold,f=r.bits,_=r.lencode,v=r.distcode,m=(1<<r.lenbits)-1,S=(1<<r.distbits)-1;e:do{f<15&&(p+=R[i++]<<f,f+=8,p+=R[i++]<<f,f+=8),y=_[p&m];t:for(;;){if(p>>>=E=y>>>24,f-=E,0===(E=y>>>16&255))A[o++]=65535&y;else{if(!(16&E)){if(0==(64&E)){y=_[(65535&y)+(p&(1<<E)-1)];continue t}if(32&E){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}g=65535&y,(E&=15)&&(f<E&&(p+=R[i++]<<f,f+=8),g+=p&(1<<E)-1,p>>>=E,f-=E),f<15&&(p+=R[i++]<<f,f+=8,p+=R[i++]<<f,f+=8),y=v[p&S];r:for(;;){if(p>>>=E=y>>>24,f-=E,!(16&(E=y>>>16&255))){if(0==(64&E)){y=v[(65535&y)+(p&(1<<E)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(b=65535&y,f<(E&=15)&&(p+=R[i++]<<f,(f+=8)<E&&(p+=R[i++]<<f,f+=8)),(b+=p&(1<<E)-1)>c){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=E,f-=E,b>(E=o-a)){if((E=b-E)>d&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=0,I=h,0===l){if(T+=u-E,E<g){g-=E;do{A[o++]=h[T++]}while(--E);T=o-b,I=A}}else if(l<E){if(T+=u+l-E,(E-=l)<g){g-=E;do{A[o++]=h[T++]}while(--E);if(T=0,l<g){g-=E=l;do{A[o++]=h[T++]}while(--E);T=o-b,I=A}}}else if(T+=l-E,E<g){g-=E;do{A[o++]=h[T++]}while(--E);T=o-b,I=A}for(;g>2;)A[o++]=I[T++],A[o++]=I[T++],A[o++]=I[T++],g-=3;g&&(A[o++]=I[T++],g>1&&(A[o++]=I[T++]))}else{T=o-b;do{A[o++]=A[T++],A[o++]=A[T++],A[o++]=A[T++],g-=3}while(g>2);g&&(A[o++]=A[T++],g>1&&(A[o++]=A[T++]))}break}}break}}while(i<n&&o<s);i-=g=f>>3,p&=(1<<(f-=g<<3))-1,e.next_in=i,e.next_out=o,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=p,r.bits=f},BU=function(e,t,r,i,n,o,a,s){var c,u,d,l,h,p,f,_,v,m=s.bits,S=0,y=0,E=0,g=0,b=0,T=0,I=0,R=0,A=0,C=0,O=null,N=0,w=new wU.Buf16(16),P=new wU.Buf16(16),D=null,k=0;for(S=0;S<=PU;S++)w[S]=0;for(y=0;y<i;y++)w[t[r+y]]++;for(b=m,g=PU;g>=1&&0===w[g];g--);if(b>g&&(b=g),0===g)return n[o++]=20971520,n[o++]=20971520,s.bits=1,0;for(E=1;E<g&&0===w[E];E++);for(b<E&&(b=E),R=1,S=1;S<=PU;S++)if(R<<=1,(R-=w[S])<0)return-1;if(R>0&&(0===e||1!==g))return-1;for(P[1]=0,S=1;S<PU;S++)P[S+1]=P[S]+w[S];for(y=0;y<i;y++)0!==t[r+y]&&(a[P[t[r+y]]++]=y);if(0===e?(O=D=a,p=19):1===e?(O=DU,N-=257,D=kU,k-=257,p=256):(O=MU,D=UU,p=-1),C=0,y=0,S=E,h=o,T=b,I=0,d=-1,l=(A=1<<b)-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){f=S-I,a[y]<p?(_=0,v=a[y]):a[y]>p?(_=D[k+a[y]],v=O[N+a[y]]):(_=96,v=0),c=1<<S-I,E=u=1<<T;do{n[h+(C>>I)+(u-=c)]=f<<24|_<<16|v|0}while(0!==u);for(c=1<<S-1;C&c;)c>>=1;if(0!==c?(C&=c-1,C+=c):C=0,y++,0==--w[S]){if(S===g)break;S=t[r+a[y]]}if(S>b&&(C&l)!==d){for(0===I&&(I=b),h+=E,R=1<<(T=S-I);T+I<g&&!((R-=w[T+I])<=0);)T++,R<<=1;if(A+=1<<T,1===e&&A>852||2===e&&A>592)return 1;n[d=C&l]=b<<24|T<<16|h-o|0}}return 0!==C&&(n[h+C]=S-I<<24|64<<16|0),s.bits=b,0},jU=-2,GU=12,HU=30;function zU(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function KU(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new LU.Buf16(320),this.work=new LU.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function WU(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new LU.Buf32(852),t.distcode=t.distdyn=new LU.Buf32(592),t.sane=1,t.back=-1,0):jU}function XU(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,WU(e)):jU}function YU(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?jU:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,XU(e))):jU}function JU(e,t){var r,i;return e?(i=new KU,e.state=i,i.window=null,0!==(r=YU(e,t))&&(e.state=null),r):jU}var qU,QU,ZU=!0;function $U(e){if(ZU){var t;for(qU=new LU.Buf32(512),QU=new LU.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(BU(1,e.lens,0,288,qU,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;BU(2,e.lens,0,32,QU,0,e.work,{bits:5}),ZU=!1}e.lencode=qU,e.lenbits=9,e.distcode=QU,e.distbits=5}function eL(e,t,r,i){var n,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new LU.Buf8(o.wsize)),i>=o.wsize?(LU.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((n=o.wsize-o.wnext)>i&&(n=i),LU.arraySet(o.window,t,r-i,n,o.wnext),(i-=n)?(LU.arraySet(o.window,t,r-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0}NU.inflateReset=XU,NU.inflateReset2=YU,NU.inflateResetKeep=WU,NU.inflateInit=function(e){return JU(e,15)},NU.inflateInit2=JU,NU.inflate=function(e,t){var r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S,y,E,g,b,T,I,R,A=0,C=new LU.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return jU;(r=e.state).mode===GU&&(r.mode=13),a=e.next_out,n=e.output,c=e.avail_out,o=e.next_in,i=e.input,s=e.avail_in,u=r.hold,d=r.bits,l=s,h=c,T=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;d<16;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(2&r.wrap&&35615===u){r.check=0,C[0]=255&u,C[1]=u>>>8&255,r.check=VU(r.check,C,2,0),u=0,d=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=HU;break}if(8!=(15&u)){e.msg="unknown compression method",r.mode=HU;break}if(d-=4,b=8+(15&(u>>>=4)),0===r.wbits)r.wbits=b;else if(b>r.wbits){e.msg="invalid window size",r.mode=HU;break}r.dmax=1<<b,e.adler=r.check=1,r.mode=512&u?10:GU,u=0,d=0;break;case 2:for(;d<16;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(r.flags=u,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=HU;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=HU;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(C[0]=255&u,C[1]=u>>>8&255,r.check=VU(r.check,C,2,0)),u=0,d=0,r.mode=3;case 3:for(;d<32;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}r.head&&(r.head.time=u),512&r.flags&&(C[0]=255&u,C[1]=u>>>8&255,C[2]=u>>>16&255,C[3]=u>>>24&255,r.check=VU(r.check,C,4,0)),u=0,d=0,r.mode=4;case 4:for(;d<16;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(C[0]=255&u,C[1]=u>>>8&255,r.check=VU(r.check,C,2,0)),u=0,d=0,r.mode=5;case 5:if(1024&r.flags){for(;d<16;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(C[0]=255&u,C[1]=u>>>8&255,r.check=VU(r.check,C,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((p=r.length)>s&&(p=s),p&&(r.head&&(b=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),LU.arraySet(r.head.extra,i,o,p,b)),512&r.flags&&(r.check=VU(r.check,i,p,o)),s-=p,o+=p,r.length-=p),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;p=0;do{b=i[o+p++],r.head&&b&&r.length<65536&&(r.head.name+=String.fromCharCode(b))}while(b&&p<s);if(512&r.flags&&(r.check=VU(r.check,i,p,o)),s-=p,o+=p,b)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;p=0;do{b=i[o+p++],r.head&&b&&r.length<65536&&(r.head.comment+=String.fromCharCode(b))}while(b&&p<s);if(512&r.flags&&(r.check=VU(r.check,i,p,o)),s-=p,o+=p,b)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;d<16;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(u!==(65535&r.check)){e.msg="header crc mismatch",r.mode=HU;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=GU;break;case 10:for(;d<32;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}e.adler=r.check=zU(u),u=0,d=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=d,2;e.adler=r.check=1,r.mode=GU;case GU:if(5===t||6===t)break e;case 13:if(r.last){u>>>=7&d,d-=7&d,r.mode=27;break}for(;d<3;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}switch(r.last=1&u,d-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if($U(r),r.mode=20,6===t){u>>>=2,d-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=HU}u>>>=2,d-=2;break;case 14:for(u>>>=7&d,d-=7&d;d<32;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=HU;break}if(r.length=65535&u,u=0,d=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(p=r.length){if(p>s&&(p=s),p>c&&(p=c),0===p)break e;LU.arraySet(n,i,o,p,a),s-=p,o+=p,c-=p,a+=p,r.length-=p;break}r.mode=GU;break;case 17:for(;d<14;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(r.nlen=257+(31&u),u>>>=5,d-=5,r.ndist=1+(31&u),u>>>=5,d-=5,r.ncode=4+(15&u),u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=HU;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;d<3;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}r.lens[O[r.have++]]=7&u,u>>>=3,d-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,I={bits:r.lenbits},T=BU(0,r.lens,0,19,r.lencode,0,r.work,I),r.lenbits=I.bits,T){e.msg="invalid code lengths set",r.mode=HU;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;m=(A=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,S=65535&A,!((v=A>>>24)<=d);){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(S<16)u>>>=v,d-=v,r.lens[r.have++]=S;else{if(16===S){for(R=v+2;d<R;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(u>>>=v,d-=v,0===r.have){e.msg="invalid bit length repeat",r.mode=HU;break}b=r.lens[r.have-1],p=3+(3&u),u>>>=2,d-=2}else if(17===S){for(R=v+3;d<R;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}d-=v,b=0,p=3+(7&(u>>>=v)),u>>>=3,d-=3}else{for(R=v+7;d<R;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}d-=v,b=0,p=11+(127&(u>>>=v)),u>>>=7,d-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=HU;break}for(;p--;)r.lens[r.have++]=b}}if(r.mode===HU)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=HU;break}if(r.lenbits=9,I={bits:r.lenbits},T=BU(1,r.lens,0,r.nlen,r.lencode,0,r.work,I),r.lenbits=I.bits,T){e.msg="invalid literal/lengths set",r.mode=HU;break}if(r.distbits=6,r.distcode=r.distdyn,I={bits:r.distbits},T=BU(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,I),r.distbits=I.bits,T){e.msg="invalid distances set",r.mode=HU;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(s>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=d,FU(e,h),a=e.next_out,n=e.output,c=e.avail_out,o=e.next_in,i=e.input,s=e.avail_in,u=r.hold,d=r.bits,r.mode===GU&&(r.back=-1);break}for(r.back=0;m=(A=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,S=65535&A,!((v=A>>>24)<=d);){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(m&&0==(240&m)){for(y=v,E=m,g=S;m=(A=r.lencode[g+((u&(1<<y+E)-1)>>y)])>>>16&255,S=65535&A,!(y+(v=A>>>24)<=d);){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}u>>>=y,d-=y,r.back+=y}if(u>>>=v,d-=v,r.back+=v,r.length=S,0===m){r.mode=26;break}if(32&m){r.back=-1,r.mode=GU;break}if(64&m){e.msg="invalid literal/length code",r.mode=HU;break}r.extra=15&m,r.mode=22;case 22:if(r.extra){for(R=r.extra;d<R;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;m=(A=r.distcode[u&(1<<r.distbits)-1])>>>16&255,S=65535&A,!((v=A>>>24)<=d);){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(0==(240&m)){for(y=v,E=m,g=S;m=(A=r.distcode[g+((u&(1<<y+E)-1)>>y)])>>>16&255,S=65535&A,!(y+(v=A>>>24)<=d);){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}u>>>=y,d-=y,r.back+=y}if(u>>>=v,d-=v,r.back+=v,64&m){e.msg="invalid distance code",r.mode=HU;break}r.offset=S,r.extra=15&m,r.mode=24;case 24:if(r.extra){for(R=r.extra;d<R;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=HU;break}r.mode=25;case 25:if(0===c)break e;if(p=h-c,r.offset>p){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=HU;break}p>r.wnext?(p-=r.wnext,f=r.wsize-p):f=r.wnext-p,p>r.length&&(p=r.length),_=r.window}else _=n,f=a-r.offset,p=r.length;p>c&&(p=c),c-=p,r.length-=p;do{n[a++]=_[f++]}while(--p);0===r.length&&(r.mode=21);break;case 26:if(0===c)break e;n[a++]=r.length,c--,r.mode=21;break;case 27:if(r.wrap){for(;d<32;){if(0===s)break e;s--,u|=i[o++]<<d,d+=8}if(h-=c,e.total_out+=h,r.total+=h,h&&(e.adler=r.check=r.flags?VU(r.check,n,h,a-h):xU(r.check,n,h,a-h)),h=c,(r.flags?u:zU(u))!==r.check){e.msg="incorrect data check",r.mode=HU;break}u=0,d=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;d<32;){if(0===s)break e;s--,u+=i[o++]<<d,d+=8}if(u!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=HU;break}u=0,d=0}r.mode=29;case 29:T=1;break e;case HU:T=-3;break e;case 31:return-4;default:return jU}return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<HU&&(r.mode<27||4!==t))&&eL(e,e.output,e.next_out,h-e.avail_out),l-=e.avail_in,h-=e.avail_out,e.total_in+=l,e.total_out+=h,r.total+=h,r.wrap&&h&&(e.adler=r.check=r.flags?VU(r.check,n,h,e.next_out-h):xU(r.check,n,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===GU?128:0)+(20===r.mode||15===r.mode?256:0),(0===l&&0===h||4===t)&&0===T&&(T=-5),T},NU.inflateEnd=function(e){if(!e||!e.state)return jU;var t=e.state;return t.window&&(t.window=null),e.state=null,0},NU.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?jU:(r.head=t,t.done=!1,0):jU},NU.inflateSetDictionary=function(e,t){var r,i=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?jU:11===r.mode&&xU(1,t,i,0)!==r.check?-3:eL(e,t,i,i)?(r.mode=31,-4):(r.havedict=1,0):jU},NU.inflateInfo="pako inflate (from Nodeca project)";var tL={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var rL=NU,iL=Gk,nL=sU,oL=tL,aL=kM,sL=fU,cL=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},uL=Object.prototype.toString;function dL(e){if(!(this instanceof dL))return new dL(e);this.options=iL.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new sL,this.strm.avail_out=0;var r=rL.inflateInit2(this.strm,t.windowBits);if(r!==oL.Z_OK)throw new Error(aL[r]);if(this.header=new cL,rL.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=nL.string2buf(t.dictionary):"[object ArrayBuffer]"===uL.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=rL.inflateSetDictionary(this.strm,t.dictionary))!==oL.Z_OK))throw new Error(aL[r])}function lL(e,t){var r=new dL(t);if(r.push(e,!0),r.err)throw r.msg||aL[r.err];return r.result}dL.prototype.push=function(e,t){var r,i,n,o,a,s=this.strm,c=this.options.chunkSize,u=this.options.dictionary,d=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?oL.Z_FINISH:oL.Z_NO_FLUSH,"string"==typeof e?s.input=nL.binstring2buf(e):"[object ArrayBuffer]"===uL.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new iL.Buf8(c),s.next_out=0,s.avail_out=c),(r=rL.inflate(s,oL.Z_NO_FLUSH))===oL.Z_NEED_DICT&&u&&(r=rL.inflateSetDictionary(this.strm,u)),r===oL.Z_BUF_ERROR&&!0===d&&(r=oL.Z_OK,d=!1),r!==oL.Z_STREAM_END&&r!==oL.Z_OK)return this.onEnd(r),this.ended=!0,!1;s.next_out&&(0!==s.avail_out&&r!==oL.Z_STREAM_END&&(0!==s.avail_in||i!==oL.Z_FINISH&&i!==oL.Z_SYNC_FLUSH)||("string"===this.options.to?(n=nL.utf8border(s.output,s.next_out),o=s.next_out-n,a=nL.buf2string(s.output,n),s.next_out=o,s.avail_out=c-o,o&&iL.arraySet(s.output,s.output,n,o,0),this.onData(a)):this.onData(iL.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(d=!0)}while((s.avail_in>0||0===s.avail_out)&&r!==oL.Z_STREAM_END);return r===oL.Z_STREAM_END&&(i=oL.Z_FINISH),i===oL.Z_FINISH?(r=rL.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===oL.Z_OK):i!==oL.Z_SYNC_FLUSH||(this.onEnd(oL.Z_OK),s.avail_out=0,!0)},dL.prototype.onData=function(e){this.chunks.push(e)},dL.prototype.onEnd=function(e){e===oL.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=iL.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},TU.Inflate=dL,TU.inflate=lL,TU.inflateRaw=function(e,t){return(t=t||{}).raw=!0,lL(e,t)},TU.ungzip=lL;var hL={};(0,Gk.assign)(hL,Hk,TU,tL);var pL,fL,_L,vL,mL,SL,yL,EL,gL,bL,TL,IL,RL,AL,CL,OL,NL,wL,PL,DL,kL,ML,UL,LL,xL,VL,FL,BL,jL,GL,HL,zL,KL,WL,XL,YL,JL,qL,QL,ZL,$L,ex,tx,rx,ix,nx,ox,ax=hL,sx=new gk("monitor",0);!function(e){e.RTC_SDK_API_CALL="rtc_sdk_api_call",e.RTC_SDK_CALLBACK="rtc_sdk_callback",e.RTC_GET_CONFIG="rtc_get_config",e.RTC_RECONNECT="rtc_reconnect",e.RTC_RECONNECTED="rtc_reconnected",e.RTC_GET_ACCESS="rtc_get_access",e.RTC_PRE_ICE_STATE="rtc_pre_ice_state",e.RTC_NODE_CHANGE="rtc_node_change",e.RTC_SIGNALING_MSG_ERROR="rtc_signaling_msg_error",e.RTC_SIGNALING="rtc_signaling",e.RTC_JOIN_ROOM="rtc_join_room",e.RTC_LEAVE_ROOM="rtc_leave_room",e.RTC_BEGIN_CREATE_OFFER="rtc_begin_create_offer",e.RTC_CREATE_OFFER="rtc_create_offer",e.RTC_SET_DESCRIPTION="rtc_set_description",e.RTC_RECV_ANSWER="rtc_recv_answer",e.FIRST_REMOTE_AUDIO_RENDER="first_remote_audio_render",e.FIRST_REMOTE_VIDEO_RENDER="first_remote_video_render",e.RTC_PUBLISH_STAT="rtc_publish_stat",e.RTC_SUBSCRIBE_STAT="rtc_subscribe_stat",e.RTC_AUDIO_DEVICE="rtc_audio_device",e.RTC_MEDIA_STATISTICS="rtc_media_statistics",e.RTC_MESSAGE_STATISTICS="rtc_message_statistics",e.RTC_ERROR="rtc_error",e.RTC_INVOKE_STATUS="rtc_invoke_status",e.RTC_FIRST_FRAME="rtc_first_frame",e.RTC_MUTE_REMOTE="rtc_mute_remote",e.SDK_INIT_ENGINE="sdk_init_engine",e.JOIN_ROOM="join_room",e.P2P_CONNECTION_STATUS="p2p_connection_status",e.P2P_CONNECT_CLOSED="p2p_connect_closed",e.RTC_DEVICE_ERROR="rtc_device_error",e.RTC_VIDEO_DEVICE="rtc_video_device",e.RTC_VIDEO_CAPTURE_EVENT="rtc_video_capture_event",e.RTC_ENCODE_FIRST_FRAME="rtc_encode_first_frame",e.RTC_FIRST_FRAME_ENCODED="rtc_first_frame_encoded",e.RTC_SEND_FIRST_PACKET="rtc_send_first_packet",e.RTC_RECV_FIRST_PACKET="rtc_recv_first_packet",e.RTC_RECV_FIRST_FRAME="rtc_recv_first_frame",e.RTC_DECODE_FIRST_FRAME="rtc_decode_first_frame"}(pL||(pL={})),function(e){e.RTC="rtc"}(fL||(fL={})),function(e){e.W_5="5"}(_L||(_L={})),function(e){e.IOS="ios",e.ANDROID="android",e.WEB="web",e.WINDOWS="windows",e.MAC="mac",e.LINUX="linux"}(vL||(vL={})),function(e){e.UNKNOWN="unknown",e.DISCONNECTED="disconnected",e.LAN="lan",e.WIFI="wifi",e.W_2="2g",e.W_3="3g",e.W_4="4g",e.W_5="5g"}(mL||(mL={})),function(e){e.UNKNOWN="unknown",e.BROADCASTER="broadcaster",e.AUDIENCE="audience",e.SILENTAUDIENCE="silentAudience"}(SL||(SL={})),function(e){e.REQUEST="request",e.RESPONSE="response"}(yL||(yL={})),function(e){e.WEBSOCKET_RECONNECTING="websocket reconnecting",e.PEERCONNECTION_RECONNECTING="peerconnection reconnecting",e.DISCONNECTED="DISCONNECTED",e.LAN="LAN",e.WIFI="WIFI",e.W_2="2G",e.W_3="3G",e.W_4="4G",e.W_5="5G",e.UNKNOWN="UNKNOWN"}(EL||(EL={})),function(e){e.WEBSOCKET="websocket",e.NETWORKCHANGED="networkChanged",e.PEERCONNECTION="peerconnection"}(gL||(gL={})),function(e){e.WEBSOCKET_RECONNECTED="websocket reconnected",e.PEERCONNECTION_RECONNECTED="peerconnection reconnected"}(bL||(bL={})),function(e){e.WEBSOCKET="websocket",e.NETWORKCHANGED="networkChanged",e.PEERCONNECTION="peerconnection"}(TL||(TL={})),function(e){e.REQUEST="request",e.RESPONSE="response",e.KCP_REQUEST="kcp request",e.KCP_RESPONSE="kcp response",e.QUIC_REQUEST="quic request",e.QUIC_RESPONSE="quic response"}(IL||(IL={})),function(e){e.NEW="NEW",e.CHECKING="CHECKING",e.CONNECTED="CONNECTED",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.DISCONNECTED="DISCONNECTED",e.CLOSED="CLOSED",e.DATACHANNEL_CONNECTING="DATACHANNEL_CONNECTING",e.DATACHANNEL_OPEN="DATACHANNEL_OPEN",e.DATACHANNEL_CLOSING="DATACHANNEL_CLOSING",e.DATACHANNEL_CLOSED="DATACHANNEL_CLOSED"}(RL||(RL={})),function(e){e.SUCCEED="succeed",e.MESSAGE_ID_ERROR="message id error",e.ZIP_FAILED="zip failed",e.UNZIP_FAILED="unzip failed",e.MESSAGE_KEY_EMPTY="message key empty",e.MESSAGE_KEY_PARSE_FAILED="message key parse failed",e.MESSAGE_KEY_INVALID="message key invalid",e.ENCRYPT_FAILED="encrypt failed",e.DECRYPT_FAILED="decrypt failed",e.MESSAGE_TOO_BIG="message too big",e.INVALID_DATA="invalid data",e.MESSAGE_PARSE_FAILED="message parse failed"}(AL||(AL={})),function(e){e.CALL_JOINROOM="call-joinRoom",e.JOINROOM="joinRoom",e.CALL_RECONNECTED="call-reconnected",e.RECONNECTED="reconnected",e.CALL_PUBLISH="call-publish",e.PUBLISH="publish",e.CALL_UPDATESTREAMATTRIBUTES="call-updateStreamAttributes",e.UPDATESTREAMATTRIBUTES="updateStreamAttributes",e.CALL_UNPUBLISH="call-unpublish",e.UNPUBLISH="unpublish",e.CALL_SUBSCRIBE="call-subscribe",e.SUBSCRIBE="subscribe",e.CALL_UPDATESUBSCRIBE="call-updateSubscribe",e.UPDATESUBSCRIBE="updateSubscribe",e.CALL_UNSUBSCRIBE="call-unsubscribe",e.UNSUBSCRIBE="unsubscribe",e.CALL_UPDATEUSERATTRIBUTES="call-updateUserAttributes",e.UPDATEUSERATTRIBUTES="updateUserAttributes",e.CALL_LEAVEROOM="call-leaveRoom",e.LEAVEROOM="leaveRoom",e.ON_USERCONNECTION="on-userConnection",e.ON_USERDISCONNECTION="on-userDisconnection",e.ON_ONADDSTREAM="on-onAddStream",e.ON_ONPUSHSTREAM="on-onPushStream",e.ON_ONREMOVESTREAM="on-onRemoveStream",e.ON_ONPUSHTRACK="on-onPushTrack",e.ON_ONREMOVETRACK="on-onRemoveTrack",e.ON_ONUPDATEUSERATTRIBUTES="on-onUpdateUserAttributes",e.ON_ONUPDATEROOMATTRIBUTES="on-onUpdateRoomAttributes",e.ON_ONUPDATESTREAMATTRIBUTES="on-onUpdateStreamAttributes",e.ON_STREAMFAILED="on-streamFailed",e.ON_POSTPROCESSINGMESSAGE="on-postProcessingMessage",e.ON_ENGINECONTROLMESSAGE="on-engineControlMessage",e.ON_WEBSOCKETENGINECUSTOMMESSAGE="on-websocketEngineCustomMessage",e.UNKNOWN="unknown",e.CALL_UPDATEPUBLISHSTREAMCHANNEL="call-updatePublishStreamChannel",e.UPDATEPUBLISHSTREAMCHANNEL="updatePublishStreamChannel",e.CALL_UPDATESUBSCRIBESTREAMCHANNEL="call-updateSubscribeStreamChannel",e.UPDATESUBSCRIBESTREAMCHANNEL="updateSubscribeStreamChannel",e.ON_ONSTREAMCHANNELCHANGE="on-onStreamChannelChange",e.P2PDIRECT="p2pdirect",e.INTERNAL_CUSTOM="internal_custom",e.REPORT="report",e.CONNECTION_CONTROL="connection_control",e.ON_INTERNAL_CUSTOM="on_internal_custom",e.CONTROLMESSAGE="controlMessage",e.CALL_LOGIN="call-login",e.LOGIN="login",e.CALL_RECONNECTLOGIN="call-reconnectLogin",e.RECONNECTLOGIN="reconnectLogin",e.CALL_LOGOUT="call-logout",e.LOGOUT="logout",e.CALL_UPDATELOGINTOKEN="call-updateLoginToken",e.UPDATELOGINTOKEN="updateLoginToken",e.CALL_SETSERVERPARAMS="call-setServerParams",e.SETSERVERPARAMS="setServerParams",e.CALL_GETPEERONLINESTATUS="call-getPeerOnlineStatus",e.GETPEERONLINESTATUS="getPeerOnlineStatus",e.ON_ONSCENECONFIG="on-onSceneConfig",e.ON_STREAMCONTROLMESSAGE="on-streamControlMessage",e.CALL_STARTPUSHSTREAM="call-startPushStream",e.STARTPUSHSTREAM="startPushStream",e.CALL_STOPPUSHSTREAM="call-stopPushStream",e.STOPPUSHSTREAM="stopPushStream",e.CALL_STARTPULLSTREAM="call-startPullStream",e.STARTPULLSTREAM="startPullStream",e.CALL_STOPPULLSTREAM="call-stopPullStream",e.STOPPULLSTREAM="stopPullStream",e.CALL_UPDATEPULLSTREAM="call-updatePullStream",e.UPDATEPULLSTREAM="updatePullStream",e.ON_ONSTREAMPUSHEDBYOTHER="on-onStreamPushedByOther",e.CALL_UPDATETOKEN="call-updateToken",e.UPDATETOKEN="updateToken",e.ON_ONTOKENWILLEXPIRE="on-onTokenWillExpire"}(CL||(CL={})),function(e){e.UP="up",e.DOWN="down",e.DIRECT="direct"}(OL||(OL={})),function(e){e.UP="up",e.DOWN="down",e.PRE="pre"}(NL||(NL={})),function(e){e.UP="up",e.DOWN="down",e.PRE="pre"}(wL||(wL={})),function(e){e.W_0="0",e.W_1="1"}(PL||(PL={})),function(e){e.UP="up",e.DOWN="down"}(DL||(DL={})),function(e){e.ANSWER="answer",e.INCRANSWER="incranswer"}(kL||(kL={})),function(e){e.UP="up",e.DOWN="down"}(ML||(ML={})),function(e){e.SUCCESS="success",e.FAIL="fail"}(UL||(UL={})),function(e){e.W_0="0",e.W_1="1"}(LL||(LL={})),function(e){e.LEAVE_ROOM="leave room",e.ACK_FAILED="ack failed",e.SET_ANSWER_SDP_FAILED="set answer sdp failed",e.ICE_FAILED="ice failed",e.STREAM_FAILED="stream failed",e.NETWORK_RECONNECTED="network reconnected",e.JOIN_ROOM_ACK_FAILED="join room ack failed",e.UNKNOWN="unknown"}(xL||(xL={})),function(e){e.SUCCESS="success",e.FAIL="fail",e.IGNORE="ignore"}(VL||(VL={})),function(e){e.LEAVE_ROOM="leave room",e.ACK_FAILED="ack failed",e.SET_ANSWER_SDP_FAILED="set answer sdp failed",e.ICE_FAILED="ice failed",e.STREAM_FAILED="stream failed",e.NETWORK_RECONNECTED="network reconnected",e.ON_STREAM_REMOVE="on stream remove",e.PUBLISH_MUTE="publish mute",e.UNKNOWN="unknown",e.ON_STREAM_REMOVE_CLIENT_UNPUBLISHED="on stream remove:client unpublished",e.ON_STREAM_REMOVE_PUBLISH_FAILED="on stream remove:publish failed",e.ON_STREAM_REMOVE_STREAM_REMOVED="on stream remove:stream removed",e.ON_STREAM_REMOVE_CLIENT_DISCONNECTED="on stream remove:client disconnected",e.ON_STREAM_REMOVE_CLIENT_REPUBLISH="on stream remove:client republish"}(FL||(FL={})),function(e){e.PLAYOUT_DEVICE_SWITCH="playout_device_switch",e.RECORD_DEVICE_SWITCH="record_device_switch",e.UNKNOWN="unknown"}(BL||(BL={})),function(e){e.BEGIN_SEND="begin_send",e.SENT_END="sent_end",e.BEGIN_RECV="begin_recv",e.RECV_END="recv_end"}(jL||(jL={})),function(e){e.AUDIO="audio",e.VIDEO="video",e.SCREEN_VIDEO="screen_video",e.SCREEN_AUDIO="screen_audio"}(GL||(GL={})),function(e){e.LOGIN="login",e.PUBLISHER="publisher",e.UNMUTE="unmute",e.ENABLE="enable",e.PUSH="push",e.PUBLISH="publish",e.ONDEMAND="ondemand",e.SUBSCRIBE="subscribe",e.PUSH_TRACK="push_track",e.REMOTE_UNMUTE="remote_unmute",e.P2P="p2p"}(HL||(HL={})),function(e){e.TIMEOUT="timeout",e.AUDIENCE="audience",e.MUTE="mute",e.DISABLE="disable",e.STOP_PUSH="stop_push",e.UNPUBLISH="unpublish",e.NO_DEMAND="no_demand",e.LEAVE_ROOM="leave_room",e.UNSUBSCRIBE="unsubscribe",e.REMOVE_TRACK="remove_track",e.REMOTE_MUTE="remote_mute",e.USER_LEAVE="user_leave"}(zL||(zL={})),function(e){e.AUDIO="audio",e.VIDEO="video"}(KL||(KL={})),function(e){e.BEGIN="begin",e.END="end"}(WL||(WL={})),function(e){e.BEGIN="begin",e.END="end"}(XL||(XL={})),function(e){e.LEAVE_ROOM="leave_room",e.ACK_FAILED="ack_failed",e.TOKEN_ERROR="token_error",e.SIGNALING_ERROR="signaling_error",e.TIMEOUT_10="timeout_10",e.TIMEOUT_60="timeout_60"}(YL||(YL={})),function(e){e.UNKNOWN="unknown",e.NEW="new",e.CHECKING="checking",e.CONNECTED="connected",e.FAILED="failed",e.SELECTED="selected",e.CLOSING="closing",e.CLOSED="closed",e.UNSELECTED="unselected"}(JL||(JL={})),function(e){e.NOMINAL="Nominal",e.FAIR="Fair",e.SERIOUS="Serious",e.CRITICAL="Critical",e.UNKNWON="Unknwon"}(qL||(qL={})),function(e){e.UNKNOWN="UNKNOWN",e.AUDIO_RECORD="AUDIO_RECORD",e.AUDIO_PLAYOUT="AUDIO_PLAYOUT",e.VIDEO="VIDEO",e.SHARE_AUDIO_RECORD="SHARE_AUDIO_RECORD",e.SHARE_VIDEO="SHARE_VIDEO"}(QL||(QL={})),function(e){e.P2P="p2p",e.P2P_OUTSIDE_ROOM="p2p_outside_room",e.P2SERVER="p2server"}(ZL||(ZL={})),function(e){e.START="start",e.START_CAPTURE_RESULT="start_capture_result",e.STARTED="started",e.RUNNING_FAILED="running_failed",e.STOP="stop",e.STOPPED="stopped"}($L||($L={})),function(e){e.DSHOW="dshow",e.MF="mf",e.AVCAPTURESESSION="avcapturesession",e.CAMERA1="camera1",e.CAMERA2="camera2",e.VECAMERA="vecamera"}(ex||(ex={})),function(e){e.SUCCESS="success",e.CAMERA_DEVICE_NO_PERMISSION="camera_device_no_permission",e.CAMERA_DEVICE_BUSY="camera_device_busy",e.CAMERA_DEVICE_FAILURE="camera_device_failure",e.CAMERA_DEVICE_NOT_FOUND="camera_device_not_found",e.CAMERA_DEVICE_DISCONNECTED="camera_device_disconnected",e.TIMEOUT="timeout",e.ABORT="abort"}(tx||(tx={})),function(e){e.UNKNOWN="unknown",e.MUSIC="music",e.HIGHQUALITY_COMMUNICATION="highquality_communication",e.COMMUNICATION="communication",e.MEDIA="media",e.GAME_STREAMING="game_streaming"}(rx||(rx={})),function(e){e.UNKNOWN="unknown",e.MEDIA="media",e.COMMUNICATION="communication"}(ix||(ix={})),function(e){e.UNKNOWN="unknown",e.SLEEP="Sleep",e.AWAKE="Awake"}(nx||(nx={})),function(e){e.UNKNOWN="unknown",e.PRODUCT="product",e.BOE="boe",e.TEST="test"}(ox||(ox={}));var cx=function(){function e(e){this.monitor=e}return e.prototype.setStats=function(e){var t=this;Object.keys(e).forEach((function(r){t["_"+r]=e[r]})),this.monitor.StartUp()},Object.defineProperty(e.prototype,"event_key",{get:function(){return this._event_key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"device_id",{get:function(){return this._device_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_app_id",{get:function(){return this._rtc_app_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"product_line",{get:function(){return this._product_line},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"report_version",{get:function(){return this._report_version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"os",{get:function(){return this._os},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_sdk_version",{get:function(){return this._rtc_sdk_version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_timestamp",{get:function(){return this._rtc_timestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_sdk_git_commit",{get:function(){return this._rtc_sdk_git_commit},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"report_id",{get:function(){return this._report_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connection_id",{get:function(){return this._connection_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_sid",{get:function(){return this._rtc_sid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"engine_session_id",{get:function(){return this._engine_session_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_business_id",{get:function(){return this._rtc_business_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"project_key",{get:function(){return this._project_key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"network_type",{get:function(){return this._network_type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"app_version",{get:function(){return this._app_version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aid",{get:function(){return this._aid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"device_model",{get:function(){return this._device_model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"device_brand",{get:function(){return this._device_brand},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"common_extra_info",{get:function(){return this._common_extra_info},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"had_selected_p2p",{get:function(){return this._had_selected_p2p},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_env_type",{get:function(){return this._rtc_env_type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"room_id",{get:function(){return this._room_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"user_id",{get:function(){return this._user_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtc_session_id",{get:function(){return this._rtc_session_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"user_agent",{get:function(){return this._user_agent},enumerable:!1,configurable:!0}),e}(),ux=function(e){function t(){var t=e.call(this)||this;return t.report_id=0,t.dataBuffer=[],t.posting=!1,t.report_common={},t.modify_ids={},t.preSucTime=0,t.errSendDelay=100,t.commonStats=new cx(t),WD()||window.addEventListener("beforeunload",(function(){clearTimeout(t.errSendTimer),clearTimeout(t.sucSendTimer),t.send(null,!0)})),t}return Cf(t,e),t.prototype.push=function(e,t){t?this.send(e):(this.dataBuffer.push(e),!this.posting&&!this.errSendTimer&&Date.now()-this.preSucTime>2e3&&(clearTimeout(this.sucSendTimer),this.send()))},t.prototype.unshift=function(e){this.dataBuffer=e.concat(this.dataBuffer)},t.prototype.send=function(e,t){var r=this;if(e||this.dataBuffer.length){var i={data:e||this.dataBuffer.splice(0,4e3),header:this.report_common,from:"web",os:"web",version:"1"},n=new XMLHttpRequest;n.timeout=1e4,n.onreadystatechange=function(){if(4===n.readyState){e||(r.posting=!1);var o=void 0;if(200===n.status||304===n.status)try{o=JSON.parse(n.responseText)}catch(e){}o&&0===o.StatusCode?e||t||r.sucSend():e?r.send(e):(r.unshift(i.data),t?r.send():r.errSend())}};var o=Qx.LOG_SERVER_URL;if(n.open("POST",o,!0),e||(this.posting=!0),!WD()&&location.search.includes("_rtc_autotest_"))this.safeEmit("report_event",i),0!==this.dataBuffer.length?this.sucSend():this.posting=!1;else if(!WD()&&location.search.includes("_rtc_debug_"))n.send(JSON.stringify(i));else{var a=ax.gzip(JSON.stringify(i));n.setRequestHeader("Content-Encoding","gzip"),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.send(a)}}},t.prototype.sucSend=function(){this.errSendDelay=100,this.preSucTime=Date.now(),this.sucSendTimer=setTimeout(this.send.bind(this),2e3)},t.prototype.errSend=function(){var e=this;this.errSendTimer=setTimeout((function(){e.send(),e.errSendTimer=null}),this.errSendDelay),this.errSendDelay*=2},t.prototype.StartUp=function(){var e=this.report_common,t=this.commonStats,r=t.event_key,i=t.device_id,n=t.rtc_app_id,o=t.product_line,a=t.report_version,s=t.os,c=t.rtc_sdk_version,u=t.rtc_timestamp,d=t.rtc_sdk_git_commit,l=t.report_id,h=t.connection_id,p=t.rtc_sid,f=t.engine_session_id,_=t.rtc_business_id,v=t.project_key,m=t.network_type,S=t.app_version,y=t.aid,E=t.device_model,g=t.device_brand,b=t.common_extra_info,T=t.had_selected_p2p,I=t.rtc_env_type,R=t.user_agent;Object.assign(e,{event_key:r,device_id:i,rtc_app_id:n,product_line:o,report_version:a,os:s,rtc_sdk_version:c,rtc_timestamp:u,rtc_sdk_git_commit:d,report_id:l,connection_id:h,rtc_sid:p,engine_session_id:f,rtc_business_id:_,project_key:v,network_type:m,app_version:S,aid:y,device_model:E,device_brand:g,common_extra_info:b,had_selected_p2p:T,rtc_env_type:I,user_agent:R}),this.commonStats.room_id&&(this.modify_ids.room_id=this.commonStats.room_id),this.commonStats.user_id&&(this.modify_ids.user_id=this.commonStats.user_id),this.commonStats.rtc_session_id&&(this.modify_ids.rtc_session_id=this.commonStats.rtc_session_id)},t.prototype.rtcSdkApiCall=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf({event_key:"rtc_sdk_api_call",report_id:this.report_id++,rtc_timestamp:Date.now(),sdk_api_name:e,error_code:t,message:r},this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcSdkCallback=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf({event_key:"rtc_sdk_callback",report_id:this.report_id++,rtc_timestamp:Date.now(),sdk_callback_name:e,error_code:t,message:r},this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcGetConfig=function(e,t,r,i,n,o,a,s){void 0===s&&(s={});var c=Zf(Zf({event_key:"rtc_get_config",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,elapse:r,host:i,type:n,config_id:o,enable_cloud_proxy:a},this.modify_ids),{common_extra_info:JSON.stringify(s)});this.push(c)},t.prototype.rtcReconnect=function(e,t,r,i,n){void 0===n&&(n={});var o=Zf(Zf({event_key:"rtc_reconnect",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,reconnect_id:r,reconnect_type:i},this.modify_ids),{common_extra_info:JSON.stringify(n)});this.push(o)},t.prototype.rtcReconnected=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf({event_key:"rtc_reconnected",report_id:this.report_id++,rtc_timestamp:Date.now(),message:e,reconnect_type:t},this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcGetAccess=function(e,t,r,i,n,o,a){void 0===a&&(a={});var s=Zf(Zf({event_key:"rtc_get_access",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,elapse:r,type:i,host:n,connect_session_id:o},this.modify_ids),{common_extra_info:JSON.stringify(a)});this.push(s)},t.prototype.rtcPreIceState=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf({event_key:"rtc_pre_ice_state",report_id:this.report_id++,rtc_timestamp:Date.now(),message:e,ice_state:t},this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcNodeChange=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf({event_key:"rtc_node_change",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,reason:r},this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcSignalingMsgError=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf({event_key:"rtc_signaling_msg_error",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,reason:r},this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcSignaling=function(e,t,r,i,n,o){void 0===o&&(o={});var a=Zf(Zf({event_key:"rtc_signaling",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,signaling_event:r,signaling_type:i,direction:n},this.modify_ids),{common_extra_info:JSON.stringify(o)});this.push(a)},t.prototype.rtcJoinRoom=function(e,t,r,i,n){void 0===n&&(n={});var o=Zf(Zf({event_key:"rtc_join_room",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,deviceModel:t,deviceManufacturer:r,elapse:i},this.modify_ids),{common_extra_info:JSON.stringify(n)});this.push(o)},t.prototype.rtcLeaveRoom=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf({event_key:"rtc_leave_room",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,elapse:r},this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcBeginCreateOffer=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf({event_key:"rtc_begin_create_offer",report_id:this.report_id++,rtc_timestamp:Date.now(),direction:e,stream_id:t,stream_user_id:r},this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcCreateOffer=function(e,t,r,i,n,o){void 0===o&&(o={});var a=Zf(Zf({event_key:"rtc_create_offer",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,direction:t,stream_id:r,stream_user_id:i,elapse:n},this.modify_ids),{common_extra_info:JSON.stringify(o)});this.push(a)},t.prototype.rtcSetDescription=function(e,t,r,i,n,o,a,s){void 0===s&&(s={});var c=Zf(Zf({event_key:"rtc_set_description",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,message:t,is_local:r,direction:i,stream_id:n,stream_user_id:o,elapse:a},this.modify_ids),{common_extra_info:JSON.stringify(s)});this.push(c)},t.prototype.rtcRecvAnswer=function(e,t,r,i,n,o,a,s){void 0===s&&(s={});var c=Zf(Zf({event_key:"rtc_recv_answer",report_id:this.report_id++,rtc_timestamp:Date.now(),error_code:e,answer_type:t,sequence_id:r,message:i,direction:n,stream_id:o,stream_user_id:a},this.modify_ids),{common_extra_info:JSON.stringify(s)});this.push(c)},t.prototype.firstRemoteAudioRender=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf({event_key:"first_remote_audio_render",report_id:this.report_id++,rtc_timestamp:Date.now(),stream_id:e,stream_user_id:t},this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.firstRemoteVideoRender=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf({event_key:"first_remote_video_render",report_id:this.report_id++,rtc_timestamp:Date.now(),stream_id:e,stream_user_id:t},this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcPublishStat=function(e,t,r,i,n){void 0===n&&(n={});var o=Zf(Zf({event_key:"rtc_publish_stat",report_id:this.report_id++,rtc_timestamp:Date.now(),result:e,is_screen:t,start:r,message:i},this.modify_ids),{common_extra_info:JSON.stringify(n)});this.push(o)},t.prototype.rtcSubscribeStat=function(e,t,r,i,n){void 0===n&&(n={});var o=Zf(Zf({event_key:"rtc_subscribe_stat",report_id:this.report_id++,rtc_timestamp:Date.now(),result:e,start:t,message:r,stream_user_id:i},this.modify_ids),{common_extra_info:JSON.stringify(n)});this.push(o)},t.prototype.rtcAudioDevice=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf({event_key:"rtc_audio_device",report_id:this.report_id++,rtc_timestamp:Date.now(),audio_event:e,message:t,error_code:r},this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcMediaStatistics=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_media_statistics",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcMessageStatistics=function(e,t,r,i){void 0===i&&(i={});var n=Zf(Zf(Zf(Zf(Zf({event_key:"rtc_message_statistics",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),{media_server_ip:r}),this.modify_ids),{common_extra_info:JSON.stringify(i)});this.push(n)},t.prototype.rtcError=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf({event_key:"rtc_error",report_id:this.report_id++,rtc_timestamp:Date.now(),message:e,error_code:t},this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcInvokeStatus=function(e,t,r,i,n,o){void 0===o&&(o={});var a=Zf(Zf({event_key:"rtc_invoke_status",report_id:this.report_id++,rtc_timestamp:Date.now(),message:e,error_code:t,sdk_api_name:r,stream_id:i,elapse:n},this.modify_ids),{common_extra_info:JSON.stringify(o)});this.push(a)},t.prototype.rtcFirstFrame=function(e,t){void 0===t&&(t={});var r=Zf(Zf(Zf({event_key:"rtc_first_frame",report_id:this.report_id++,rtc_timestamp:Date.now()},e),this.modify_ids),{common_extra_info:JSON.stringify(t)});sx.print("rtcFirstFrame",JSON.stringify(e)),this.push(r)},t.prototype.rtcMuteRemote=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_mute_remote",report_id:this.report_id++,rtc_timestamp:Date.now()},e),{media_type:t}),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.sdkInitEngine=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf({event_key:"sdk_init_engine",report_id:this.report_id++,rtc_timestamp:Date.now(),start:e,type:t},this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.joinRoom=function(e,t,r,i,n){void 0===n&&(n={});var o=Zf(Zf({event_key:"join_room",report_id:this.report_id++,rtc_timestamp:Date.now(),type:e,start:t,result:r,reason:i},this.modify_ids),{common_extra_info:JSON.stringify(n)});this.push(o)},t.prototype.p2pConnectionStatus=function(e,t,r,i,n,o){void 0===o&&(o={});var a=Zf(Zf({event_key:"p2p_connection_status",report_id:this.report_id++,rtc_timestamp:Date.now(),room_id:e,user_id:t,peer_user_id:r,status:i,elapse:n},this.modify_ids),{common_extra_info:JSON.stringify(o)});this.push(a)},t.prototype.p2pConnectClosed=function(e,t){void 0===t&&(t={});var r=Zf(Zf({event_key:"p2p_connect_closed",report_id:this.report_id++,rtc_timestamp:Date.now(),p2p_selected:e},this.modify_ids),{common_extra_info:JSON.stringify(t)});this.push(r)},t.prototype.rtcDeviceError=function(e,t,r,i,n,o,a,s,c,u,d,l,h,p,f,_,v){void 0===v&&(v={});var m=Zf(Zf({event_key:"rtc_device_error",report_id:this.report_id++,rtc_timestamp:Date.now(),device_type:e,device_stage:t,error_code:r,system_error_code:i,system_api:n,call_parameters:o,location:a,message:s,media_device_id:c,media_device_name:u,elapse:d,scenario:l,event_session_id:h,device_pid:p,device_vid:f,media_mode:_},this.modify_ids),{common_extra_info:JSON.stringify(v)});this.push(m)},t.prototype.rtcVideoDevice=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf({event_key:"rtc_video_device",report_id:this.report_id++,rtc_timestamp:Date.now(),media_device_id:e,media_device_name:t},this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcVideoCaptureEvent=function(e,t){void 0===t&&(t={});var r=Zf(Zf(Zf({event_key:"rtc_video_capture_event",report_id:this.report_id++,rtc_timestamp:Date.now()},e),this.modify_ids),{common_extra_info:JSON.stringify(t)});this.push(r)},t.prototype.rtcEncodeFirstFrame=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_encode_first_frame",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcFirstFrameEncoded=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_first_frame_encoded",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcSendFirstPacket=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_send_first_packet",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcRecvFirstPacket=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_recv_first_packet",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcRecvFirstFrame=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_recv_first_frame",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t.prototype.rtcDecodeFirstFrame=function(e,t,r){void 0===r&&(r={});var i=Zf(Zf(Zf(Zf({event_key:"rtc_decode_first_frame",report_id:this.report_id++,rtc_timestamp:Date.now()},e),t),this.modify_ids),{common_extra_info:JSON.stringify(r)});this.push(i)},t}(Tk),dx=new ux,lx=new ux,hx=new ux,px=dx.commonStats,fx=lx.commonStats,_x=hx.commonStats,vx={default:dx,rtm:lx,outsideRoom:hx};function mx(e){void 0===e&&(e="default");for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,i,n){if("function"==typeof n.value){var o=n.value;n.value=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a={};t.forEach((function(e,t){a[e]=r[t]})),"joinRoom"===i&&px.setStats({room_id:r[1]}),vx[e].rtcSdkApiCall(i,0,JSON.stringify(QD(r)),a);var s=o.apply(this,r);return"function"==typeof(null==s?void 0:s.then)?s.then((function(t){return vx[e].rtcSdkCallback(i,0,JSON.stringify(QD([t||{}]))),t})).catch((function(t){throw vx[e].rtcSdkCallback(i,t.code,JSON.stringify(t.message)),t})):(vx[e].rtcSdkCallback(i,0,JSON.stringify(QD([s||{}]))),s)}}}}function Sx(e,t,r){void 0===r&&(r=0),(e===u_.onUserMessageReceivedOutsideRoom||e===u_.onUserBinaryMessageReceivedOutsideRoom?lx:dx).rtcSdkCallback(e,r,JSON.stringify(t))}function yx(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=!1),(i?lx:dx).rtcInvokeStatus(JSON.stringify(t),r,e,"",0)}var Ex="RTC_DEVICE_ID",gx="RTC_ACCESS_NODE",bx="RTC_ACCESS_URLS",Tx="RTC_H264_BLACK_LIST",Ix="engine_BAC",Rx=function(){function e(){}return e.prototype.get=function(e){var t=localStorage.getItem(e);if(!t)return null;try{var r=JSON.parse(t);return r.ttl>0&&Date.now()-r.saveTime>r.ttl?(this.delete(e),null):r.message}catch(e){return null}},e.prototype.set=function(e,t,r){void 0===r&&(r=-1);var i={ttl:r,saveTime:Date.now(),message:t};try{return localStorage.setItem(e,JSON.stringify(i)),!0}catch(e){return!1}},e.prototype.delete=function(e){try{return localStorage.removeItem(e),!0}catch(e){return!1}},e}(),Ax=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cf(t,e),t.prototype.getDeviceId=function(){if(WD())return"";var e=this.get(Ex);return e||(e=BD()),this.set(Ex,e),e},t.prototype.setDeviceId=function(e){return[px,fx,_x].forEach((function(t){return t.setStats({device_id:e})})),this.set(Ex,e),e},t.prototype.getAccessNode=function(e){return this.get("".concat(gx,"_").concat(e,"-VolcEngine"))},t.prototype.setAccessNode=function(e,t,r){return this.set("".concat(gx,"_").concat(e,"-VolcEngine"),t,1e3*r)},t.prototype.clearAccessNode=function(e){this.delete("".concat(gx,"_").concat(e,"-VolcEngine"))},t.prototype.getAccessUrls=function(){return this.get("".concat(bx,"-VolcEngine"))},t.prototype.setAccessUrls=function(e){var t=e.map((function(e){var t=e.host,r=e.path;return"https://".concat(t).concat(r)}));return this.set("".concat(bx,"-VolcEngine"),t)},t.prototype.clearAccessUrls=function(){this.delete("".concat(bx,"-VolcEngine"))},t.prototype.getH264BlackList=function(){return this.get(Tx)},t.prototype.setH264BlackList=function(e){return this.set(Tx,e)},t.prototype.getAudioProfile=function(){return this.get(Ix)},t.prototype.setAudioProfile=function(e){return this.set(Ix,e)},t}(Rx),Cx=new Ax,Ox="access.rtc.volcvideo.com,access2-hl.rtc.volcvideo.com,rtcg-access.volcvideos.com".split(",");function Nx(e){return void 0===e&&(e=""),"https://".concat(e,"/dispatch/v1/AccessInfo?Action=GetAccessInfo")}var wx="https://web-log-report.rtc.volcvideo.com/video/v1/webrtc_log/",Px="common.rtc.volcvideo.com,rtcg.volcvideos.com".split(","),Dx={VERSION:"4.44.0",ICE_CONFIG_REQUEST_URLS_INTERNAL:Ox.map(Nx),ICE_CONFIG_REQUEST_URLS:[],EXPECTED_ADDR:"",LOG_SERVER_URL:wx,CONFIG_REQUEST_DOMAINS:Px,DEVICE_ID:""};function kx(e,t){if("VERSION"!==e)return"ICE_CONFIG_REQUEST_URLS"===e?("string"==typeof t&&(t=[t]),void(Dx.ICE_CONFIG_REQUEST_URLS=t.map(Nx))):void("LOG_SERVER_URL"!==e||t!==Gf.overseas?"LOG_SERVER_URL"!==e||t!==Gf.domestic?"LOG_SERVER_URL"!==e||"string"!=typeof t?("DEVICE_ID"===e&&Cx.setDeviceId(t),Dx[e]=t):Dx.LOG_SERVER_URL=t:Dx.LOG_SERVER_URL=wx:Dx.LOG_SERVER_URL="https://web-log-report.volcvideos.com/video/v1/webrtc_log//")}function Mx(e){return"DEVICE_ID"===e?Cx.getDeviceId():Dx[e]}function Ux(e,t){var r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S;return{type:"transcode",action:e,transcodeMeta:{transcode:{url:t.url},control:{protocol:"2.0"},audio:{codec:(null===(r=t.audio)||void 0===r?void 0:r.codec)||Yx.audio.codec,bitRate:1e3*((null===(i=t.audio)||void 0===i?void 0:i.kBitRate)||Yx.audio.kBitRate),sampleRate:1e3*((null===(n=t.audio)||void 0===n?void 0:n.sampleRate)||Yx.audio.sampleRate),channels:(null===(o=t.audio)||void 0===o?void 0:o.channels)||Yx.audio.channels,profile:(null===(a=t.audio)||void 0===a?void 0:a.AACProfile)||Yx.audio.AACProfile},video:{codec:(null===(s=t.video)||void 0===s?void 0:s.codec)||Yx.video.codec,fps:(null===(c=t.video)||void 0===c?void 0:c.fps)||Yx.video.fps,gop:(null===(u=t.video)||void 0===u?void 0:u.gop)||Yx.video.gop,lowLatency:null!==(l=null===(d=t.video)||void 0===d?void 0:d.lowLatency)&&void 0!==l?l:Yx.video.lowLatency,bitRate:1e3*((null===(h=t.video)||void 0===h?void 0:h.kBitRate)||Yx.video.kBitRate),width:(null===(p=t.video)||void 0===p?void 0:p.width)||Yx.video.width,height:(null===(f=t.video)||void 0===f?void 0:f.height)||Yx.video.height},layout:{canvas:{bgnd:(null===(_=t.layout)||void 0===_?void 0:_.backgroundColor)||Yx.layout.backgroundColor},regions:(null===(m=null===(v=t.layout)||void 0===v?void 0:v.regions)||void 0===m?void 0:m.map((function(e){return{alpha:Math.min(Math.max(+e.alpha,0),1),uid:e.userId,zorder:e.zorder,x:Math.min(Math.max(+e.x,0),1),y:Math.min(Math.max(+e.y,0),1),w:Math.min(Math.max(+e.w,0),1),h:Math.min(Math.max(+e.h,0),1),renderMode:e.renderMode||1,contentControl:e.contentControl||0,screen:e.isScreenStream,local_user:e.isLocalUser}})))||[],app_data:(null===(S=t.layout)||void 0===S?void 0:S.appData)||Yx.layout.appData}}}}function Lx(e,t,r){var i,n,o,a,s,c,u,d,l;return{type:"publicstream",action:t,publicStreamID:e,publicStreamMeta:{audio:{},video:{fps:(null===(i=r.video)||void 0===i?void 0:i.fps)||15,bitrate:1e3*((null===(n=r.video)||void 0===n?void 0:n.kBitRate)||40),width:(null===(o=r.video)||void 0===o?void 0:o.width)||640,height:(null===(a=r.video)||void 0===a?void 0:a.height)||360},layout:{layoutMode:2,interpolationMode:(null===(s=r.layout)||void 0===s?void 0:s.interpolationMode)||Kf.PREV_FRAME,canvas:{bgColor:(null===(c=r.layout)||void 0===c?void 0:c.backgroundColor)||"#000000",bgImage:(null===(u=r.layout)||void 0===u?void 0:u.backgroundImage)||""},regions:(null===(l=null===(d=r.layout)||void 0===d?void 0:d.regions)||void 0===l?void 0:l.map((function(e){return{roomId:e.roomId,userId:e.userId,alterImage:e.alertImage||"",alpha:e.alpha,x:Math.min(Math.max(+e.x,0),1),y:Math.min(Math.max(+e.y,0),1),w:Math.min(Math.max(+e.w,0),1),h:Math.min(Math.max(+e.h,0),1),zorder:e.zorder,renderMode:void 0===e.renderMode?1:e.renderMode,streamType:e.isScreenStream?1:0,mediaType:e.mediaType||0,sourceCrop:e.sourceCrop}})))||[]}}}}var xx,Vx,Fx,Bx,jx,Gx,Hx,zx,Kx,Wx,Xx,Yx={url:"",video:{codec:"H264",width:640,height:360,fps:30,gop:60,kBitRate:600,lowLatency:!0},audio:{codec:"AAC",kBitRate:64,sampleRate:48,channels:2,AACProfile:"LC"},layout:{regions:[],appData:"",backgroundColor:"#000000"}},Jx={width:640,height:360,frameRate:30,maxKbps:600},qx={width:1920,height:1080,frameRate:15,maxKbps:3e3},Qx=Dx;!function(e){e.streamRemovedBySchedule308="stream removed",e.clientRePublish="client republish",e.publishStreamFaied="publish failed",e.clientUnPublish="client unpublished",e.clientDisconnected="client disconnected",e.videoMuted="video muted"}(xx||(xx={})),function(e){e.PushLimitWarn="PushLimitWarn"}(Vx||(Vx={})),function(e){e.ON_ADD_STREAM="onAddStream",e.ON_REMOVE_STREAM="onRemoveStream",e.USER_DISCONNECTION="userDisconnection",e.USER_CONNECTION="userConnection",e.ON_UPDATE_STREAM_ATTRIBUTES="onUpdateStreamAttributes",e.ON_UPDATE_ROOM_ATTRIBUTES="onUpdateRoomAttributes",e.ON_PUSH_TRACK="onPushTrack",e.ON_REMOVE_TRACK="onRemoveTrack",e.ON_CUSTOM_MESSAGE="onCustomMessage",e.NODE_CHANGE="nodeChange",e.USER_MESSAGE_RECEIVED="userMessageReceived",e.USER_BINARY_MESSAGE_RECEIVED="userBinaryMessageReceived",e.USER_MESSAGE_RECEIVED_OUTSIDE_ROOM="userMessageReceivedOutsideRoom",e.USER_BINARY_MESSAGE_RECEIVED_OUTSIDE_ROOM="userBinaryMessageReceivedOutsideRoom",e.POST_PROCESSING_MESSAGE="postProcessingMessage",e.ON_USER_TOKEN_WILL_EXPIRE="onUserTokenWillExpire",e.STREAM_CONTROL_MESSAGE="streamControlMessage",e.ON_SCENE_CONFIG="onSceneConfig"}(Fx||(Fx={})),function(e){e.RSCP="RSCP"}(Bx||(Bx={})),function(e){e.ON_CONNECTION_STATE_CHANGE="onConnectionStateChange",e.ABNORMAL_DISCONNECTION="normalConnection"}(jx||(jx={})),function(e){e.userLeave="userLeave",e.connectionLost="connectionLost",e.userDuplicateLogin="userDuplicateLogin",e.kickedByAdmin="kickedByAdmin",e.roleChanged="roleChanged",e.onUserTokenDidExpire="onUserTokenDidExpire"}(Gx||(Gx={})),function(e){e[e.roomDismissByAdmin=2]="roomDismissByAdmin"}(Hx||(Hx={})),function(e){e[e.SEND=0]="SEND",e[e.FEEDBACK=1]="FEEDBACK"}(Kx||(Kx={})),function(e){e[e.P2P=0]="P2P",e[e.SIGNAL=1]="SIGNAL",e[e.BROADCAST=2]="BROADCAST",e[e.BUSINESS_SERVER=3]="BUSINESS_SERVER"}(Wx||(Wx={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.TIMEOUT=1]="TIMEOUT",e[e.BROKEN=2]="BROKEN",e[e.NO_RECEIVER=3]="NO_RECEIVER",e[e.NO_RELAYPATH=4]="NO_RELAYPATH",e[e.SEND_TO_SERVER_ERROR=17]="SEND_TO_SERVER_ERROR",e[e.SERVER_RESPONSE_ERROR=18]="SERVER_RESPONSE_ERROR",e[e.NOT_JOIN=100]="NOT_JOIN",e[e.INIT=101]="INIT",e[e.NO_CONNECTION=102]="NO_CONNECTION",e[e.EXCEED_MAX_LENGTH=103]="EXCEED_MAX_LENGTH",e[e.EMPTY_USER=104]="EMPTY_USER",e[e.NOT_LOGIN=105]="NOT_LOGIN",e[e.SERVER_PARAMS_NOTSET=106]="SERVER_PARAMS_NOTSET",e[e.UNKNOWN=1e3]="UNKNOWN"}(Xx||(Xx={}));var Zx,$x,eV=((zx={})[Xx.SUCCESS]=[0,"success"],zx[Xx.TIMEOUT]=[oP.USER_MESSAGE_TIMEOUT,"timeout, failed to send."],zx[Xx.BROKEN]=[oP.USER_MESSAGE_BROKEN,"dataChannel broken, failed to send."],zx[Xx.NO_RECEIVER]=[oP.USER_MESSAGE_NO_RECEIVER,"cannot find the receiver."],zx[Xx.NO_RELAYPATH]=[oP.USER_MESSAGE_NO_RELAYPATH,"cannot find relay path."],zx[Xx.SEND_TO_SERVER_ERROR]=[oP.USER_MESSAGE_SEND_TO_SERVER_ERROR,"failed to send to business server."],zx[Xx.SERVER_RESPONSE_ERROR]=[oP.USER_MESSAGE_SERVER_RESPONSE_ERROR,"business server response error."],zx[Xx.NOT_JOIN]=[oP.USER_MESSAGE_NOT_JOIN,"not join room"],zx[Xx.INIT]=[oP.USER_MESSAGE_INIT,"not init."],zx[Xx.NO_CONNECTION]=[oP.USER_MESSAGE_NO_CONNECTION,"no connection."],zx[Xx.EXCEED_MAX_LENGTH]=[oP.USER_MESSAGE_EXCEED_MAX_LENGTH,"message exceeds max length."],zx[Xx.EMPTY_USER]=[oP.USER_MESSAGE_EMPTY_USER,"user id is empty."],zx[Xx.NOT_LOGIN]=[oP.USER_MESSAGE_NOT_LOGIN,"not login."],zx[Xx.SERVER_PARAMS_NOTSET]=[oP.USER_MESSAGE_SERVER_PARAMS_NOTSET,"server param is not set."],zx[Xx.UNKNOWN]=[oP.USER_MESSAGE_UNKNOWN,"unknown."],zx),tV=new gk("DataChannelSignaling",3);!function(e){e[e.SEND=0]="SEND",e[e.ACK=1]="ACK"}(Zx||(Zx={})),function(e){e[e.C2S=0]="C2S",e[e.C2C=1]="C2C",e[e.C2GW=2]="C2GW",e[e.C2CDirect=3]="C2CDirect",e[e.C2RTM=4]="C2RTM"}($x||($x={}));var rV=function(e){function t(t){var r=e.call(this)||this;return r._dataChannel=t,r._singlingCache=new Map,r._p2pCache=new Map,r._rttIds={},r._p2pMessageId=0,r._clearDataChannelListener=r._handleHandler(),window.__rtc_mock_signaling__=r.emit.bind(r),r}return Cf(t,e),t.prototype.destroy=function(){this._dataChannel&&(this._clearDataChannelListener(),this._dataChannel.close()),this._singlingCache.clear(),this._p2pCache.clear(),this._p2pMessageId=0,this._rttIds={}},t.prototype.sendSignaling=function(e,t,r){var i=this;return dx.rtcSignaling(0,JSON.stringify(t),"call-".concat(e),"Send",OL.UP),new Promise((function(n,o){var a=i._genHeader(r);a.id=YD();var s=a.id.join("-"),c=setTimeout((function(){i._singlingCache.delete(s),o(new dP(oP.TIME_OUT,"".concat(e," message time out")))}),6e4);i._singlingCache.set(s,{signalingType:e,success:function(e){clearTimeout(c),n(e)},error:function(e){clearTimeout(c),o(e)}}),tV.print("Signal",">>>>>> [".concat(e,"][").concat(s,"]"),t),i._sendMessage(e,a,t)}))},t.prototype.sendPingSignaling=function(){return this.sendSignaling("CheckConnectivity",{ts:Date.now()},{functionType:$x.C2GW})},t.prototype.sendP2PMessage=function(e,t){var r=e.msg,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(e,["msg"]);return e_(this,void 0,void 0,(function(){var e,n,o,a,s;return t_(this,(function(c){switch(c.label){case 0:return e=r instanceof ArrayBuffer,n=this._sendP2PMessage,o=[Zf({ver:1,id:this._p2pMessageId++,time:Date.now(),dir:Kx.SEND,type:Wx.P2P,err:Xx.SUCCESS},i)],s={binary:e},e?[4,XD.ab2b64str(r)]:[3,2];case 1:return a=c.sent(),[3,3];case 2:a=r,c.label=3;case 3:return[2,n.apply(this,[Zf.apply(void 0,o.concat([(s.msg=a,s)])),t])]}}))}))},t.prototype._sendP2PMessage=function(e,t){var r=this;return void 0===t&&(t={}),qD(e.msg)?this._rttIds[e.id]=e.id:e.dir===Kx.SEND&&tV.print("_sendP2PMessage [DC Signaling p2p >>]",JSON.stringify(e)),new Promise((function(i,n){var o=r._genHeader(Zf(Zf({needAck:!0,functionType:$x.C2C},t),{id:YD()}));if(e.dir===Kx.SEND){var a=setTimeout((function(){r._p2pCache.delete(e.id),n(new dP(oP.TIME_OUT,"P2P message timeout"))}),6e4);r._p2pCache.set(e.id,{success:function(e){clearTimeout(a),i(e)},error:function(e){clearTimeout(a);var t=i_(eV[e.err]||[oP.USER_MESSAGE_UNKNOWN,"err: ".concat(e.err,", msg: ").concat(e.msg)],2),r=t[0],i=t[1];n({code:r,message:e.msg||i})}})}r._sendMessage("p2p",o,e)}))},t.prototype._sendMessage=function(e,t,r){if(!this._dataChannel||"open"!==this._dataChannel.readyState)throw new dP(oP.SIGNALING_CHANNEL_NOT_OPEN,"DataChannel not open");var i=t.version+(+t.zip<<5)+(+t.encrypt<<6),n=+t.needAck+(+t.direction<<1)+(+t.functionType<<2)+(+t.binary<<6),o=XD.str2ab(JSON.stringify([e,r])),a=KD(Uint8Array,n_([i,n],i_(t.id||[]),!1),new Uint8Array(o));this._dataChannel.send(a.buffer)},t.prototype._dispartData=function(e){var t=new Uint8Array(e),r=0,i=t[r++],n=t[r++],o={version:15&i,zip:16==(16&i),encrypt:32==(32&i),needAck:1==(1&n),direction:(2&n)>>1,functionType:(60&n)>>2,binary:64==(64&n)};if(o.needAck||o.direction===Zx.ACK){for(;r<=6;r++)if(128!=(128&t[r])){r++;break}o.id=Array.from(t.slice(2,r))}return{header:o,data:t.slice(r)}},t.prototype._feedbackSignaling=function(e,t){var r=this._genHeader({needAck:!0,direction:Zx.ACK,id:e.split("-").map((function(e){return+e}))});tV.print("Signal",">>>>>> [".concat(t,"-res][").concat(e,"]")),this._sendMessage("".concat(t,"-res"),r,"")},t.prototype._handleMessage=function(e){var t,r;return e_(this,void 0,void 0,(function(){var i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S,y,E,g,b,T,I,R,A,C,O,N,w,P,D,k,M,U,L,x;return t_(this,(function(V){switch(V.label){case 0:i=this._dispartData(e),n=i.header,o=i.data,n.zip&&((a=new ax.Inflate).push(o,!0),o=a.result),s=XD.ab2str(o),c=[];try{c=JSON.parse(s)}catch(e){return e instanceof Error&&dx.rtcSignalingMsgError(-1,e.message,AL.MESSAGE_PARSE_FAILED),[2]}switch(n.functionType){case $x.C2S:return[3,1];case $x.C2C:return[3,6];case $x.C2GW:return[3,18]}return[3,19];case 1:return u=(null===(t=n.id)||void 0===t?void 0:t.join("-"))||"",n.direction!==Zx.ACK?[3,2]:(this._handleAckMessage(u,c[0]||{},s),[3,5]);case 2:return Array.isArray(c)?(d=c[0],c=c[1],tV.print("Signal","<<<<<< ".concat(d),c,u),this._feedbackSignaling(u,d),c.binary&&"string"==typeof c.message?(l=c,[4,XD.b64str2ab(c.message)]):[3,4]):[3,5];case 3:l.message=V.sent(),V.label=4;case 4:this.emit(d,Zf({},c)),dx.rtcSignaling(0,s,"on-".concat(d),"Recv",OL.DOWN),V.label=5;case 5:return[3,19];case 6:switch(Array.isArray(c)&&(c=c[1]),h=null==c?void 0:c.id,this._rttIds[h]||(null==c?void 0:c.dir)===Kx.FEEDBACK||qD(null==c?void 0:c.msg)?delete this._rttIds[h]:tV.print("Signal","<<<<<< p2p response",c),c.dir){case Kx.SEND:return[3,7];case Kx.FEEDBACK:return[3,16]}return[3,17];case 7:return qD(null==c?void 0:c.msg)?[3,15]:(f=(p=c).binary,_=p.msg,v=p.room,m=p.to,S=p.from,y=""===v?f?Fx.USER_BINARY_MESSAGE_RECEIVED_OUTSIDE_ROOM:Fx.USER_MESSAGE_RECEIVED_OUTSIDE_ROOM:f?Fx.USER_BINARY_MESSAGE_RECEIVED:Fx.USER_MESSAGE_RECEIVED,m?[3,11]:(E=this.emit,g=[Fx.ON_CUSTOM_MESSAGE],L={clientId:S,binary:f},f?[4,XD.b64str2ab(_)]:[3,9]));case 8:return b=V.sent(),[3,10];case 9:b=_,V.label=10;case 10:return E.apply(this,g.concat([(L.message=b,L)])),[3,15];case 11:return T=this.emit,I=[y],R=[Zf({},c)],x={},f?[4,XD.b64str2ab(_)]:[3,13];case 12:return A=V.sent(),[3,14];case 13:A=_,V.label=14;case 14:T.apply(this,I.concat([Zf.apply(void 0,R.concat([(x.msg=A,x)]))])),V.label=15;case 15:return this._sendP2PMessage(Zf(Zf({},c),{dir:Kx.FEEDBACK,msg:""})),[3,17];case 16:return(C=this._p2pCache.get(c.id))&&(this._p2pCache.delete(c.id),c.err===Xx.SUCCESS?C.success(c.id):C.error(c)),[3,17];case 17:return[3,19];case 18:if(n.direction===Zx.ACK)O=(null===(r=n.id)||void 0===r?void 0:r.join("-"))||"",this._handleAckMessage(O,c[0]||{},s);else if(N=i_(c,2),w=N[0],P=N[1],D=void 0===P?{}:P,"RXMediaMsg"===w&&(k=D.type,M=D.data,dx.rtcSignaling(0,s,"on-".concat(k),"Recv",OL.DOWN),"RSCP"===k))try{U=JSON.parse(M),Array.isArray(U)&&this.emit(k,U)}catch(e){}V.label=19;case 19:return[2]}}))}))},t.prototype._handleHandler=function(){var e=this,t=function(t){tV.print("_handleHandler","dataChannel close",t),e.emit("close",t)},r=function(t){tV.print("_handleHandler","dataChannel error",t),e.emit("close",t)},i=function(t){e._handleMessage(t.data)};return this._dataChannel.addEventListener("close",t),this._dataChannel.addEventListener("error",r),this._dataChannel.addEventListener("message",i),function(){e._dataChannel.removeEventListener("close",t),e._dataChannel.removeEventListener("error",r),e._dataChannel.removeEventListener("message",i)}},t.prototype._genHeader=function(e){return void 0===e&&(e={}),Zf({version:2,zip:!1,encrypt:!1,needAck:!0,direction:Zx.SEND,functionType:$x.C2S,binary:!1},e)},t.prototype._handleAckMessage=function(e,t,r){var i=this._singlingCache.get(e);i&&(this._singlingCache.delete(e),200===t.code?i.success(t):i.error(t),tV.print("Signal","<<<<<< [".concat(i.signalingType,"-ack]"),t)),dx.rtcSignaling(0,r,null==i?void 0:i.signalingType,"Ack",OL.DOWN)},t}(mk.exports.EventEmitter),iV=function(){function e(){this.isSending=!1}return e.prototype.ajax=function(e){var t=this,r=e.method,i=e.url,n=e.body,o=void 0===n?{}:n,a=e.headers,s=void 0===a?{}:a,c=e.stringify,u=void 0===c||c;return new Promise((function(e,n){var a,c;t.isSending=!0;var d=new XMLHttpRequest;d.open(r,i,!0);try{for(var l=r_(Object.entries(s)),h=l.next();!h.done;h=l.next()){var p=i_(h.value,2),f=p[0],_=p[1];d.setRequestHeader(f,_)}}catch(e){a={error:e}}finally{try{h&&!h.done&&(c=l.return)&&c.call(l)}finally{if(a)throw a.error}}d.onreadystatechange=function(){4===d.readyState&&(t.isSending=!1,200===d.status?e(JSON.parse(d.responseText)):n({message:d.statusText,code:d.status})),0===d.status&&n({code:0,message:"Request abort"})},d.onerror=function(e){t.isSending=!1,n({code:-1,message:d.responseText||"unknown"})},t.timeout&&(d.timeout=t.timeout),u&&(o=JSON.stringify(o)),d.send(o),t.xhr=d}))},e.prototype.get=function(e,t){return this.ajax({method:"GET",url:e,headers:t})},e.prototype.post=function(e,t,r,i){return this.ajax({method:"POST",url:e,body:t,headers:r,stringify:i})},e.prototype.abort=function(){var e;null===(e=this.xhr)||void 0===e||e.abort()},e}(),nV=new gk("ICE Request",3),oV=function(){function e(){this._request=new iV}return e.prototype.getAccessNode=function(e,t,r,i,n,o,a){return e_(this,void 0,void 0,(function(){var s;return t_(this,(function(c){return(s=Cx.getAccessNode(e))?(this.getAccessNodeFromServer(e,t,r,i,n,o,a),yx("es.R.node.cache",s),Array.isArray(s)?[2,Promise.resolve(s)]:[2,Promise.resolve([s])]):[2,this.getAccessNodeFromServer(e,t,r,i,n,o,a)]}))}))},e.prototype.getAccessNodeFromServer=function(e,t,r,i,n,o,a){return e_(this,void 0,void 0,(function(){var s,c,u=this;return t_(this,(function(d){return s=Cx.getAccessUrls(),c=!0,yx("es.R.req.cache.urls",s),(null==s?void 0:s.length)>0||(s=Qx.ICE_CONFIG_REQUEST_URLS,c=!1,yx("es.R.req.external.urls",s)),(null==s?void 0:s.length)>0||(s=Qx.ICE_CONFIG_REQUEST_URLS_INTERNAL,c=!1,yx("es.R.req.internal.urls",s)),[2,this.getICEConfigFromServer(s,e,t,r,i,n,o,a).then((function(t){var r=t.nodes;return Cx.setAccessNode(e,r,t.ttl||11200),t.dispatchDomains&&Cx.setAccessUrls(t.dispatchDomains),r})).catch((function(s){if(c)return yx("es.R.req.fallback",""),Cx.clearAccessUrls(),u.getAccessNodeFromServer(e,t,r,i,n,o,a);throw s}))]}))}))},e.prototype.getICEConfigFromServer=function(e,t,r,i,n,o,a,s){var c;return e_(this,void 0,void 0,(function(){var r,u,d,l=this;return t_(this,(function(h){return r={appID:t,userID:i,deviceID:n,connectSessionID:HD(),os:"web",sdkVersion:Qx.VERSION,expectedAddr:Mx("EXPECTED_ADDR"),productPlatform:"VolcEngine",enableCloudProxy:s},o&&a&&(r.feedbackInfo=[{feedbackIP:null===(c=a.publicIPs[0])||void 0===c?void 0:c.ip,feedbackReason:{type:"NODE_CHANGED",reason:o}}],delete r.expectedAddr),u=Date.now(),dx.rtcGetAccess(0,JSON.stringify(r),0,IL.REQUEST,e.join(","),r.connectSessionID),d=e.map((function(e,t){return e_(l,void 0,void 0,(function(){var i,n,o;return t_(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this._request.post(e,r)];case 1:return i=a.sent(),[3,3];case 2:throw n=a.sent(),new dP(oP.ICE_SERVER_WRONG,"get ICE config failed",n);case 3:if(200!==i.code)throw new dP(oP.ICE_SERVER_WRONG,"get ICE config failed",{server_code:i.code,message:JSON.stringify(i)});if(!(o=i.nodes[0]))throw new dP(oP.ICE_SERVER_WRONG,"ICE config server return empty nodes",{code:i.code,message:JSON.stringify(i)});return[2,{result:i,firstNode:o,index:t}]}}))}))})),[2,$D(d).then((function(t){var i=t.result;t.firstNode;var n=t.index;return dx.rtcGetAccess(200,JSON.stringify(i),Date.now()-u,IL.RESPONSE,e[n],r.connectSessionID),i})).catch((function(t){var i,n,o=null===(i=t[0])||void 0===i?void 0:i.error;throw dx.rtcGetAccess(+((null==o?void 0:o.code)||(null==o?void 0:o.server_code)),null===(n=t[0])||void 0===n?void 0:n.message,Date.now()-u,IL.RESPONSE,e.join(","),r.connectSessionID,{error:JSON.stringify(o)}),t}))]}))}))},e.prototype.abort=function(){this._request.isSending&&(nV.print("abort","HTTP Request of [getICEConfigFromServer] abort"),this._request.abort())},e}(),aV=function(){function e(){this._request=new iV}return e.prototype.getH264BlackList=function(){var e=this,t={keys:["web_h264_black_list"],labelSelector:"",sdkVersion:"4.44.0",deviceType:"web"};this._request.timeout=800;var r=Qx.CONFIG_REQUEST_DOMAINS.map((function(e){return"https://".concat(e,"/decision/v1/multi")}));dx.rtcGetConfig(0,JSON.stringify(t),0,r.join(","),yL.REQUEST,"",!1);var i=r.map((function(r,i){return e_(e,void 0,void 0,(function(){var e;return t_(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._request.post(r,t)];case 1:return e=n.sent(),[3,3];case 2:throw n.sent(),new dP(oP.ICE_SERVER_WRONG,"get config failed");case 3:if(!Array.isArray(null==e?void 0:e.web_h264_black_list))throw new dP(oP.ICE_SERVER_WRONG,"get config failed");return[2,{result:e,index:i}]}}))}))}));return new Promise((function(e){$D(i).then((function(t){var i=t.result,n=t.index;Cx.setH264BlackList(i.web_h264_black_list),dx.rtcGetConfig(200,JSON.stringify(i),0,r[n],yL.RESPONSE,"",!1),e(i.web_h264_black_list)})).catch((function(t){dx.rtcGetConfig(500,t.message,0,"",yL.RESPONSE,"",!1),e(Cx.getH264BlackList()||[])}))}))},e.prototype.getAudioProfile=function(){var e=this,t={keys:["engine_BAC"],labelSelector:"",sdkVersion:"4.44.0",deviceType:"web"},r=Qx.CONFIG_REQUEST_DOMAINS.map((function(e){return"https://".concat(e,"/decision/v1/multi")}));dx.rtcGetConfig(0,JSON.stringify(t),0,r.join(","),yL.REQUEST,"",!1);var i=r.map((function(r,i){return e_(e,void 0,void 0,(function(){var e;return t_(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._request.post(r,t)];case 1:return e=n.sent(),[3,3];case 2:throw n.sent(),new dP(oP.ICE_SERVER_WRONG,"get config failed");case 3:if(!Array.isArray(null==e?void 0:e.engine_BAC))throw new dP(oP.ICE_SERVER_WRONG,"get config failed");return[2,{result:e,index:i}]}}))}))}));return new Promise((function(e){$D(i).then((function(t){var i=t.result,n=t.index;Cx.setAudioProfile(i.engine_BAC),dx.rtcGetConfig(200,JSON.stringify(i),0,r[n],yL.RESPONSE,"",!1),e(i.engine_BAC)})).catch((function(t){dx.rtcGetConfig(500,t.message,0,"",yL.RESPONSE,"",!1),e(Cx.getAudioProfile()||[])}))}))},e}(),sV={},cV={},uV={exports:{}},dV=uV.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(dV).forEach((function(e){dV[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))})),function(e){var t=function(e){return String(Number(e))===e?Number(e):e},r=function(e,r,i){var n=e.name&&e.names;e.push&&!r[e.push]?r[e.push]=[]:n&&!r[e.name]&&(r[e.name]={});var o=e.push?{}:n?r[e.name]:r;!function(e,r,i,n){if(n&&!i)r[n]=t(e[1]);else for(var o=0;o<i.length;o+=1)null!=e[o+1]&&(r[i[o]]=t(e[o+1]))}(i.match(e.reg),o,e.names,e.name),e.push&&r[e.push].push(o)},i=uV.exports,n=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},o=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(n).forEach((function(e){var t=e[0],n=e.slice(2);"m"===t&&(o.push({rtp:[],fmtp:[]}),a=o[o.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var c=i[t][s];if(c.reg.test(n))return r(c,a,n)}})),t.media=o,t};var o=function(e,r){var i=r.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&r.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var r=[],i=e.split(" ").map(t),n=0;n<i.length;n+=3)r.push({component:i[n],ip:i[n+1],port:i[n+2]});return r},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var r,i=!1;return"~"!==e[0]?r=t(e):(r=t(e.substring(1,e.length)),i=!0),{scid:r,paused:i}}))}))}}(cV);var lV=uV.exports,hV=/%[sdv%]/g,pV=function(e){var t=1,r=arguments,i=r.length;return e.replace(hV,(function(e){if(t>=i)return e;var n=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return""}}))},fV=function(e,t,r){var i=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var n=0;n<t.names.length;n+=1){var o=t.names[n];t.name?i.push(r[t.name][o]):i.push(r[t.names[n]])}else i.push(r[t.name]);return pV.apply(null,i)},_V=["v","o","s","i","u","e","p","c","b","t","r","z","a"],vV=["i","c","b","a"],mV=cV,SV=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||_V,i=t.innerOrder||vV,n=[];return r.forEach((function(t){lV[t].forEach((function(r){r.name in e&&null!=e[r.name]?n.push(fV(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){n.push(fV(t,r,e))}))}))})),e.media.forEach((function(e){n.push(fV("m",lV.m[0],e)),i.forEach((function(t){lV[t].forEach((function(r){r.name in e&&null!=e[r.name]?n.push(fV(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){n.push(fV(t,r,e))}))}))}))})),n.join("\r\n")+"\r\n"},yV=sV.write=SV,EV=sV.parse=mV.parse;sV.parseParams=mV.parseParams,sV.parseFmtpConfig=mV.parseFmtpConfig,sV.parsePayloads=mV.parsePayloads,sV.parseRemoteCandidates=mV.parseRemoteCandidates,sV.parseImageAttributes=mV.parseImageAttributes,sV.parseSimulcastStreamList=mV.parseSimulcastStreamList;var gV=function(){function e(e){this._iceConfigNode=e}return e.prototype.modifyByIceNode=function(e){var t,r=this._iceConfigNode.iceParams,i=sV.parse(e);return null===(t=i.media)||void 0===t||t.forEach((function(e){e.iceUfrag=null==r?void 0:r.clientIceUfrag,e.icePwd=null==r?void 0:r.clientIcePwd,e.iceOptions="renomination"})),sV.write(i)},e}(),bV=function(){function e(e){this._iceConfigNode=e}return e.prototype.getServerUfrag=function(){return e_(this,void 0,void 0,(function(){var e,t;return t_(this,(function(r){switch(r.label){case 0:return e=this._iceConfigNode.iceParams,t=this,[4,CV(e.serverIceUfrag)];case 1:return t._iceUfrag=r.sent(),px.setStats({connection_id:this._iceUfrag}),[2]}}))}))},e.prototype.modifyByIceNode=function(e){var t,r=this,i=this._iceConfigNode.certFingerprint,n=sV.parse(e);return(null==n?void 0:n.fingerprint)&&(n.fingerprint={type:"sha-256",hash:i}),null===(t=null==n?void 0:n.media)||void 0===t||t.forEach((function(e){return r.modifyMlineByIceNode(e)})),sV.write(n)},e.prototype.modifyMlineByIceNode=function(e){var t=this._iceConfigNode,r=t.publicIPs,i=t.certFingerprint,n=t.iceParams;e.fingerprint&&(e.fingerprint={type:"sha-256",hash:i}),e.icePwd=n.serverIcePwd,e.iceUfrag=this._iceUfrag,e.setup="active",this._candidates||(this._candidates=AV(r)),e.candidates=this._candidates,e.iceOptions="renomination","application"===e.type&&(e.sctpmap={sctpmapNumber:5e3,app:"webrtc-datachannel",maxMessageSize:262144})},e}();function TV(e,t){var r,i=sV.parse(e),n=[];return i.media=i.media.map((function(e){return t.includes(e.mid+"")?(e.direction="inactive",e.port=0,delete e.ext,delete e.ssrcs,delete e.ssrcGroups,delete e.simulcast,delete e.simulcast_03,delete e.rids,delete e.extmapAllowMixed,delete e.bundleOnly):"inactive"!==e.direction&&n.push(e.mid),e})),(null===(r=i.groups)||void 0===r?void 0:r[0])&&(i.groups[0].mids=n.join(" ")),i}var IV=function(e,t,r){var i,n;try{var o=sV.parse(e),a=sV.parse(t),s="".concat(null===(i=a.groups)||void 0===i?void 0:i[0].mids).split(" "),c="".concat(null===(n=o.groups)||void 0===n?void 0:n[0].mids).split(" "),u={};s.forEach((function(e){return u[e]=e}));var d={};c.forEach((function(e){u[e]||(d[e]=e)}));var l="",h="";return o.media=o.media.filter((function(e){return d[e.mid]&&"audio"===e.type?l="".concat(e.mid):d[e.mid]&&"video"===e.type&&(h="".concat(e.mid)),d[e.mid]})),delete o.groups,delete o.msidSemantic,o.invalid=[{value:"realx-exts:rscp"}],{partialSdp:sV.write(o),audioMid:l,videoMid:h}}catch(e){return null}},RV=function(e,t){var r;try{var i=sV.parse(e),n=[];return null===(r=i.media)||void 0===r||r.forEach((function(e){(null==t?void 0:t.includes("".concat(e.mid)))&&n.push(e)})),i.media=n,delete i.groups,delete i.msidSemantic,sV.write(i)}catch(e){return""}},AV=function(e){if(!Array.isArray(e))return[];var t=0,r=2130706431,i=[];return e.forEach((function(e){var n={component:1,ip:e.ip,type:"host",generation:e.generation};e.udpPorts&&e.udpPorts.forEach((function(e){i.push(Zf(Zf({},n),{foundation:t++,transport:"udp",port:e,priority:r}))})),e.tcpPorts&&e.tcpPorts.forEach((function(e){i.push(Zf(Zf({},n),{foundation:t++,transport:"tcp",port:e,tcptype:"passive",priority:2130705431}))}))})),i},CV=function(e){return e_(void 0,void 0,void 0,(function(){var t,r,i,n,o,a,s;return t_(this,(function(c){switch(c.label){case 0:return t=new TextEncoder,r=t.encode("PREC"),n=Uint8Array.bind,[4,XD.b64str2ab(e)];case 1:return i=new(n.apply(Uint8Array,[void 0,c.sent()])),o=t.encode(Date.now().toString()).slice(-4),(a=new Uint8Array(2))[0]=0,a[1]=1,s=KD(Uint8Array,r,i,o,a),[4,XD.ab2b64str(s.buffer)];case 2:return[2,c.sent()]}}))}))};function OV(e,t){var r=1,i=e;(e.width>t.width||e.height>t.height)&&(r=e.width/e.height>t.width/t.height?e.width/t.width:e.height/t.height,i={width:Math.floor(e.width/r),height:Math.floor(e.height/r)});return Zf(Zf({},i),{scaleResolutionDownBy:r})}var NV=[{sub_index:0,video_index:0,framerate:30,height:1080,maxkbps:3e3,width:1920},{sub_index:1,video_index:0,framerate:30,height:720,maxkbps:1200,width:1280},{sub_index:2,video_index:0,framerate:30,height:630,maxkbps:1100,width:1120},{sub_index:3,video_index:0,framerate:30,height:540,maxkbps:1e3,width:960},{sub_index:4,video_index:1,framerate:30,height:450,maxkbps:800,width:800},{sub_index:5,video_index:1,framerate:30,height:360,maxkbps:600,width:640},{sub_index:6,video_index:1,framerate:30,height:270,maxkbps:400,width:480},{sub_index:7,video_index:2,framerate:15,height:180,maxkbps:300,width:320},{sub_index:8,video_index:2,framerate:15,height:144,maxkbps:200,width:256},{sub_index:9,video_index:3,framerate:15,height:90,maxkbps:100,width:160}],wV=[{width:1920,height:1080,maxLayers:3,totalPixels:2073600},{width:1280,height:720,maxLayers:3,totalPixels:921600},{width:960,height:540,maxLayers:3,totalPixels:518400},{width:640,height:360,maxLayers:2,totalPixels:230400},{width:480,height:270,maxLayers:2,totalPixels:129600},{width:320,height:180,maxLayers:1,totalPixels:57600},{width:0,height:0,maxLayers:1,totalPixels:0}];var PV={width:160,height:90,frameRate:15,maxkbps:100},DV={width:480,height:270,frameRate:30,maxkbps:400};function kV(e){if(!e.length)return[];var t=e.shift(),r=t.width/t.height,i=0,n=0,o=Zf(Zf({},t),{video_index:n,sub_index:i++});delete o.rid;for(var a=[o],s=0,c=0;c<NV.length;c++)if(NV[c].height<t.height){s=c;break}var u=e.shift();for(c=s;c<NV.length;c++){var d=NV[c];if(u&&d.height<=(null==u?void 0:u.height)){var l=d.height===(null==u?void 0:u.height),h=Zf(Zf({},u),{video_index:++n,sub_index:i++});if(delete h.rid,a.push(h),u=e.shift(),l)continue}a.push(Zf(Zf({},d),{width:Math.floor(d.height*r),video_index:n,sub_index:i++}))}return a}var MV,UV,LV,xV,VV,FV="safari"===(MV="none",WD()||(null!==window.navigator.userAgent.match("Firefox")?MV="mozilla":null!==window.navigator.userAgent.match("Chrome")?(MV="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(MV="electron")):(null!==window.navigator.userAgent.match("Safari")||null!==window.navigator.userAgent.match("AppleWebKit"))&&(MV="safari")),MV);!function(e){e.codec="codec",e.inboundRtp="inbound-rtp",e.outboundRtp="outbound-rtp",e.remoteInboundRtp="remote-inbound-rtp",e.remoteOutboundRtp="remote-outbound-rtp",e.mediaSource="media-source",e.csrc="csrc",e.peerConnection="peer-connection",e.dataChannel="data-channel",e.stream="stream",e.track="track",e.transceiver="transceiver",e.sender="sender",e.receiver="receiver",e.transport="transport",e.sctpTransport="sctp-transport",e.candidatePair="candidate-pair",e.localCandidate="local-candidate",e.remoteCandidate="remote-candidate",e.certificate="certificate",e.iceServer="ice-server"}(UV||(UV={})),function(e){e[e.encode=0]="encode",e[e.decode=1]="decode"}(LV||(LV={})),function(e){e[e.none=0]="none",e[e.cpu=1]="cpu",e[e.bandwidth=2]="bandwidth",e[e.other=3]="other"}(xV||(xV={})),function(e){e[e.unknown=0]="unknown",e[e.controlling=1]="controlling",e[e.controlled=2]="controlled"}(VV||(VV={}));var BV,jV=function(){function e(e){this.peer=e,this.stats=[]}return e.prototype.handleCodec=function(e){return e},e.prototype.handleInboundRtp=function(e){return e},e.prototype.handleOutboundRtp=function(e){var t=e.ssrc;return t&&(e.rtxSsrc=t),e},e.prototype.handleRemoteInboundRtp=function(e){return e},e.prototype.handleRemoteOutboundRtp=function(e){return e},e.prototype.handleMediaSource=function(e){return e},e.prototype.handleCsrc=function(e){return e},e.prototype.handlePeerConnection=function(e){return e},e.prototype.handleDataChannel=function(e){return e},e.prototype.handleStream=function(e){return e},e.prototype.handleTrack=function(e){return e},e.prototype.handleTransceiver=function(e){return e},e.prototype.handleSender=function(e){return e},e.prototype.handleReceiver=function(e){return e},e.prototype.handleTransport=function(e){return e},e.prototype.handleSctpTransport=function(e){return e},e.prototype.handleCandidatePair=function(e){return e},e.prototype.handleLocalCandidate=function(e){return e},e.prototype.handleRemoteCandidate=function(e){return e},e.prototype.handleCertificate=function(e){return e},e.prototype.handleIceServer=function(e){return e},e.prototype.processStats=function(e){var t=this;e.forEach((function(e){var r;switch(e.type){case UV.candidatePair:r=t.handleCandidatePair;break;case UV.certificate:r=t.handleCertificate;break;case UV.remoteCandidate:r=t.handleRemoteCandidate;break;case UV.remoteInboundRtp:r=t.handleInboundRtp;break;case UV.remoteOutboundRtp:r=t.handleOutboundRtp;break;case UV.sctpTransport:r=t.handleSctpTransport;break;case UV.sender:r=t.handleSender;break;case UV.stream:r=t.handleStream;break;case UV.track:r=t.handleTrack;break;case UV.transceiver:r=t.handleTransceiver;break;case UV.transport:r=t.handleTransport;break;case UV.codec:r=t.handleCodec;break;case UV.csrc:r=t.handleCsrc;break;case UV.dataChannel:r=t.handleDataChannel;break;case UV.iceServer:r=t.handleIceServer;break;case UV.mediaSource:r=t.handleMediaSource;break;case UV.outboundRtp:r=t.handleOutboundRtp;break;case UV.inboundRtp:r=t.handleInboundRtp;break;case UV.peerConnection:r=t.handlePeerConnection;break;case UV.receiver:r=t.handleReceiver;break;case UV.localCandidate:r=t.handleLocalCandidate;break;default:r=function(e){return e}}r=r.bind(t),t.stats.push(r(e))}))},e.prototype.getExtraStats=function(e){return e_(this,void 0,void 0,(function(){var t=this;return t_(this,(function(r){return[2,new Promise((function(r,i){if(FV||void 0!==window.InstallTrigger)return r(t.stats);try{t.peer.getStats((function(i){i.result().forEach((function(r){if(!GV.includes(r.type)){var i={};r.names().forEach((function(e){i[e]=r.stat(e)})),i.id=r.id,i.type=r.type,i.timestamp=r.timestamp,"ssrc"===i.type&&e&&e.id?e.id===i.googTrackId&&t.stats.push(i):t.stats.push(i)}})),r(t.stats)}))}catch(e){i(e)}}))]}))}))},e.prototype.getStats=function(e,t){return e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:return i.trys.push([0,7,,8]),[4,this.peer.getStats(e)];case 1:r=i.sent(),this.processStats(r),i.label=2;case 2:return i.trys.push([2,5,,6]),t?[3,4]:[4,this.getExtraStats(e)];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return i.sent(),[3,6];case 6:return[3,8];case 7:return i.sent(),[3,8];case 8:return[2,this.stats]}}))}))},e}(),GV=["codec","inbound-rtp","outbound-rtp","remote-inbound-rtp","remote-outbound-rtp","media-source","csrc","peer-connection","data-channel","stream","track","transceiver","sender","receiver","transport","sctp-transport","candidate-pair","local-candidate","remote-candidate","certificate","ice-server"],HV=function(e,t,r){return e_(void 0,void 0,void 0,(function(){var i;return t_(this,(function(n){switch(n.label){case 0:return i=[],e instanceof RTCPeerConnection?[4,new jV(e).getStats(t,r)]:[2,i];case 1:return[2,i=n.sent()]}}))}))},zV=function(){return e_(void 0,void 0,void 0,(function(){var e,t,r,i,n,o,a;return t_(this,(function(s){switch(s.label){case 0:if(BV)return[2,BV];e=[],s.label=1;case 1:return s.trys.push([1,5,,6]),[4,ZD()];case 2:return(t=s.sent())?(null==t?void 0:t.includes("level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f"))?(r=navigator.userAgent.toLowerCase(),i=!1,n=["heytapbrowser","mqqbrowser","miuibrowser"],[4,(new aV).getH264BlackList()]):[3,4]:[2,e];case 3:for(o=s.sent(),n.push.apply(n,n_([],i_(o),!1)),a=0;a<n.length;a++)r.includes(n[a])&&(i=!0);!i&&e.push("H264"),s.label=4;case 4:return(null==t?void 0:t.includes("VP8"))&&e.push("vp8"),BV=e,[2,e];case 5:return s.sent(),[2,e];case 6:return[2]}}))}))},KV=function(){return"undefined"!=typeof TransformStream&&void 0!==RTCRtpSender.prototype.createEncodedStreams&&void 0!==RTCRtpReceiver.prototype.createEncodedStreams},WV=new gk("BasicHandler",3),XV=KV(),YV={iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",encodedInsertableStreams:!!XV||void 0},JV=function(e){function t(t,r){var i=e.call(this)||this;return i.monitor=t,i._peerConnection=new RTCPeerConnection(YV),i._dataChannel=i._peerConnection.createDataChannel("signaling",{negotiated:!0,id:100}),i._context=r,i._dataChannel.binaryType="arraybuffer",i._peerConnection.ontrack=function(e){var t,r;WV.print("constructor","pc.ontrack ".concat(e.track.kind," ").concat(e.track.id," ").concat(null===(r=null===(t=e.streams)||void 0===t?void 0:t[0])||void 0===r?void 0:r.id)),i.emit("ontrack",e)},i._peerConnection.onconnectionstatechange=function(e){WV.print("constructor","onconnectionstatechange ".concat(i._peerConnection.iceConnectionState," -> ").concat(i._peerConnection.connectionState)),"failed"!==i._peerConnection.iceConnectionState&&"closed"!==i._peerConnection.iceConnectionState&&"failed"!==i._peerConnection.connectionState||i.emit("disconnect")},i._peerConnection.oniceconnectionstatechange=function(){var e=i._peerConnection.iceConnectionState;t.rtcPreIceState(e,RL["".concat(e.toUpperCase())])},i}return Cf(t,e),t.prototype.connect=function(e){var t;return e_(this,void 0,void 0,(function(){var r,i,n,o=this;return t_(this,(function(a){switch(a.label){case 0:return WV.print("connect","invoke connect"),[4,this._peerConnection.createOffer()];case 1:return r=a.sent(),this._localSdp=new gV(e),[4,this.setLocalDescription(r.sdp)];case 2:return a.sent(),(i=null===(t=this._peerConnection)||void 0===t?void 0:t.sctp)&&(i.onstatechange=function(){o.monitor.rtcInvokeStatus("sctp state change TO: ".concat(i.state),0,"sctp","",0)},i.transport&&(i.transport.onstatechange=function(){var e;o.monitor.rtcInvokeStatus("dtls state change TO: ".concat(null===(e=null==i?void 0:i.transport)||void 0===e?void 0:e.state),0,"dtls","",0)})),this._remoteSdp=new bV(e),[4,this._remoteSdp.getServerUfrag()];case 3:return a.sent(),n=this._remoteSdp.modifyByIceNode(r.sdp),[4,this.setRemoteDescription(n)];case 4:return a.sent(),[4,new Promise((function(e,t){o._dataChannel.onopen=function(){WV.print("connect","dataChannel open"),yx("es.dc.open",""),e("")},o._dataChannel.onerror=function(e){dx.rtcSignalingMsgError(e.error.sdpLineNumber,e.error.errorDetail,AL.INVALID_DATA),yx("es.dc.error",""),t(e)},o._dataChannel.onclose=function(e){yx("es.dc.close",""),t(e)},o._peerConnection.addEventListener("connectionstatechange",(function(e){"failed"!==o._peerConnection.iceConnectionState&&"closed"!==o._peerConnection.iceConnectionState&&"failed"!==o._peerConnection.connectionState||t(e)}))}))];case 5:return a.sent(),WV.print("connect","dataChannel establish success"),[2,this._dataChannel]}}))}))},t.prototype.disconnect=function(){this._peerConnection.close(),this._dataChannel.close(),this._peerConnection.ontrack=null},t.prototype.destroy=function(){this.disconnect(),this._localSdp=void 0,this._remoteSdp=void 0,this._context=void 0},t.prototype._simulcast=function(e,t,r,i,n){var o=[],a=function(e){for(var t=0,r=e.width*e.height,i=0;i<wV.length;i++)if(r>=wV[i].totalPixels){t=i;break}if(0===t)return wV[t].maxLayers;var n=wV[t-1].totalPixels;return(n-r)/(n-wV[t].totalPixels)<.1?wV[t-1].maxLayers:wV[t].maxLayers}(t);WV.print("simulcast() ","maxLayers: %o",a),1===e.videoEncodeConfig.length?(o=function(e,t){var r=[];if(t<=1)return r;var i=1,n=1;return e.width/e.height>16/9?(i=e.width/PV.width,n=e.width/DV.width):(i=e.height/PV.height,n=e.height/DV.height),r.push({maxkbps:PV.maxkbps,scaleResolutionDownBy:i,frameRate:PV.frameRate,width:Math.floor(e.width/i),height:Math.floor(e.height/i)}),t<=2||i>2&&r.unshift({maxkbps:DV.maxkbps,scaleResolutionDownBy:n,frameRate:DV.frameRate,width:Math.floor(e.width/n),height:Math.floor(e.height/n)}),r}(r,a),WV.print("simulcast() ","simulcastLayers: %o",o)):(o=e.videoEncodeConfig.slice(1).slice(1-a).map((function(e){return Zf({frameRate:e.frameRate||15,maxkbps:e.maxKbps||600},OV(r,e))})),WV.print("simulcast() ","simulcastLayers2: %o",o)),o.forEach((function(e,t){var r={maxBitrate:1e3*e.maxkbps,scaleResolutionDownBy:e.scaleResolutionDownBy,rid:"".concat(t+1),maxFramerate:e.frameRate};i.sendEncodings&&i.sendEncodings.unshift(r),n.push({width:e.width,height:e.height,framerate:e.frameRate,maxkbps:e.maxkbps,rid:"".concat(t+1)})}))},t.prototype.publish=function(e,t){return e_(this,void 0,void 0,(function(){var r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S,y,E,g,b,T,I,R,A,C,O,N,w,P;return t_(this,(function(D){switch(D.label){case 0:return r=e.stream,i=e.videoTrack,n=e.audioTrack,o=e.enableSimulcast,a=e.pubAudio,s=e.pubVideo,c={},u=[],d=[],Array.isArray(null==e?void 0:e.videoEncodeConfig)&&e.videoEncodeConfig.length&&(l=null==i?void 0:i.getTrack(),h={width:640,height:360,frameRate:30},l&&(p=null==l?void 0:l.getSettings(),h={width:Math.floor(p.width),height:Math.floor(p.height),frameRate:Math.floor(p.frameRate)}),f=null==e?void 0:e.videoEncodeConfig[0],_=OV(h,f),e.prevScaleResolutionDownBy=_.scaleResolutionDownBy,e.videoInputConfig=h,v={maxBitrate:1e3*f.maxKbps,scaleResolutionDownBy:_.scaleResolutionDownBy,rid:"0",maxFramerate:f.frameRate||15},c.sendEncodings=[v],u.push({width:_.width,height:_.height,framerate:f.frameRate,maxkbps:f.maxKbps,rid:"0"}),o&&(this._simulcast(e,_,h,c,u),(null==t?void 0:t.simulcastOnDemand)&&(d=kV(n_([],i_(u),!1))),WV.print("subVideoDesc","desc: %o ",d))),WV.print("publish videoTransceiverInit videoDescriptions","",c,u),m=null==n?void 0:n.getTrack(),(null==n?void 0:n.mixType)!==a_.PLAYOUT&&(null==n?void 0:n.mixedAudioTrack)&&(m=null==n?void 0:n.mixedAudioTrack),e.audioTransceiver=this._peerConnection.addTransceiver(a&&m?m:"audio",{direction:"sendonly",streams:[r]}),S=e.audioTransceiver,(null==t?void 0:t.audioRed)&&RTCRtpSender.getCapabilities&&S.setCodecPreferences&&(WV.print("publish","publish audio red is true"),(y=(RTCRtpSender.getCapabilities("audio")||{}).codecs)&&(E=y.findIndex((function(e){return"audio/red"===e.mimeType})),g=i_(y.splice(E,1),1),b=g[0],y.unshift(b),S.setCodecPreferences(y),WV.print("publish","audio preferences codecs",y))),XV&&e.initAudioEncodedTransform(),T=null==i?void 0:i.getTrack(),e.videoTransceiver=this._peerConnection.addTransceiver(s&&T?T:"video",Zf({direction:"sendonly",streams:[r]},c)),XV&&e.initVideoEncodedTransform(),WV.print("sender.getParameters()",e.videoTransceiver.sender.getParameters()),I=zD(),dx.rtcBeginCreateOffer(NL.UP,e.streamId,e.userId),[4,this._peerConnection.createOffer()];case 1:if(R=D.sent(),A=EV(R.sdp),C=A.media.find((function(e){return"audio"===e.type})),(O=null==C?void 0:C.rtp.find((function(e){return"opus"===e.codec})))&&C&&(N=C.fmtp.find((function(e){return e.payload===O.payload})))&&this._context&&(N.config+=this._context.audioProfileManager.getOpusConfigStr()),w=yV(A),dx.rtcCreateOffer(0,wL.UP,e.streamId,e.userId,zD()-I),P=IV(w,this.getLocalDescriptionSdp(),this._context),!R.sdp||!P)throw new dP(oP.ADD_TRANSCEIVER_FAILED,"createOffer failed");return[2,Zf(Zf({sdp:w},P),{type:"incroffer",semantics:"unified-plan",videoDescriptions:u,subVideoDescriptions:d})]}}))}))},t.prototype.updateScaleResolutionDownBy=function(e){var t,r,i;return e_(this,void 0,void 0,(function(){var n,o,a,s,c,u,d;return t_(this,(function(l){return WV.print("updateScaleResolutionDownBy()"),n=null===(t=e.videoTrack)||void 0===t?void 0:t.getTrack(),o=e.videoTransceiver,n&&e.pubVideo&&o?(a=null==n?void 0:n.getSettings(),s={width:Math.floor(a.width),height:Math.floor(a.height),frameRate:Math.floor(a.frameRate)},(c=OV(s,e.videoEncodeConfig[0])).scaleResolutionDownBy===e.prevScaleResolutionDownBy&&WV.print("updateScaleResolutionDownBy()","no change %o",e.prevScaleResolutionDownBy),(u=null===(r=o.sender)||void 0===r?void 0:r.getParameters())&&(d=c.scaleResolutionDownBy/e.prevScaleResolutionDownBy,u.encodings=null===(i=null==u?void 0:u.encodings)||void 0===i?void 0:i.map((function(t){var r;Math.max(t.scaleResolutionDownBy=(t.scaleResolutionDownBy||1)*d,1);var i=+t.rid||0;return t.maxFramerate=(null===(r=e.videoEncodeConfig[i])||void 0===r?void 0:r.frameRate)||t.maxFramerate,t})),e.prevScaleResolutionDownBy=c.scaleResolutionDownBy,e.videoInputConfig=s,null==o||o.sender.setParameters(u)),[2]):(WV.print("updateScaleResolutionDownBy()","no pub"),[2])}))}))},t.prototype.subscribe=function(e,t){return e_(this,void 0,void 0,(function(){var r,i,n,o,a;return t_(this,(function(s){switch(s.label){case 0:return r="incroffer",i="unified-plan",t?[2,{sdp:this.getLocalDescriptionSdp(),partialSdp:RV(this.getLocalDescriptionSdp(),[t.audioMid,t.videoMid]),audioMid:t.audioMid,videoMid:t.videoMid,type:r,semantics:i}]:(e.audioTransceiver=this._peerConnection.addTransceiver("audio",{direction:"recvonly"}),XV&&e.initAudioEncodedTransform(),e.videoTransceiver=this._peerConnection.addTransceiver("video",{direction:"recvonly"}),XV&&e.initVideoEncodedTransform(),n=zD(),dx.rtcBeginCreateOffer(NL.DOWN,e.streamId,e.userId),[4,this._peerConnection.createOffer()]);case 1:if(o=s.sent(),dx.rtcCreateOffer(0,wL.DOWN,e.streamId,e.userId,zD()-n),a=IV(o.sdp,this.getLocalDescriptionSdp()),!o.sdp||!a)throw new dP(oP.ADD_TRANSCEIVER_FAILED,"createOffer failed");return[2,Zf(Zf({sdp:o.sdp},a),{type:r,semantics:i})]}}))}))},t.prototype.setAnswerSdp=function(e,t,r,i,n){var o;return e_(this,void 0,void 0,(function(){var a,s,c,u,d,l,h=this;return t_(this,(function(p){switch(p.label){case 0:return dx.rtcRecvAnswer(0,kL.INCRANSWER,0,t,n,i.streamId,i.userId),a=this._peerConnection.remoteDescription,s=sV.parse(null==a?void 0:a.sdp),c=null===(o=s.media)||void 0===o?void 0:o.reduce((function(e,t){return e[t.mid]=t,e}),{}),sV.parse(t).media.forEach((function(e){return c[e.mid]=e})),u=[],d=sV.parse(e),l=d.media.map((function(e){var t;r&&r[e.mid]&&(e.mid=r[e.mid]),"inactive"!==e.direction&&u.push(e.mid);var i=c[e.mid];return null===(t=h._remoteSdp)||void 0===t||t.modifyMlineByIceNode(i),e.bundleOnly||(i.port=e.port),i})),s.media=l,d.groups=[{mids:u.join(" "),type:"BUNDLE"}],s.groups=d.groups,[4,this.setLocalDescription(sV.write(d),i,n)];case 1:return p.sent(),[4,this.setRemoteDescription(sV.write(s),i,n)];case 2:return p.sent(),[2]}}))}))},t.prototype.setLocalDescription=function(e,t,r){var i,n;return e_(this,void 0,void 0,(function(){var o,a,s,c,u,d,l;return t_(this,(function(h){switch(h.label){case 0:o=null===(i=this._localSdp)||void 0===i?void 0:i.modifyByIceNode(e),a=new RTCSessionDescription({type:"offer",sdp:o}),s=zD(),c=r||DL.UP,u=(null==t?void 0:t.streamId)||"",d=(null===(n=t)||void 0===n?void 0:n.userId)||"",h.label=1;case 1:return h.trys.push([1,3,,4]),WV.print("setOffer","set offer: ",a),[4,this._peerConnection.setLocalDescription(a)];case 2:return h.sent(),dx.rtcSetDescription(0,a.sdp,PL.W_1,c,u,d,zD()-s,{type:"offer"}),[3,4];case 3:throw(l=h.sent())instanceof Error&&dx.rtcSetDescription(-1,l.message,PL.W_1,c,u,d,zD()-s,{type:"offer"}),l;case 4:return[2]}}))}))},t.prototype.setRemoteDescription=function(e,t,r){var i;return e_(this,void 0,void 0,(function(){var n,o,a,s,c,u;return t_(this,(function(d){switch(d.label){case 0:n=new RTCSessionDescription({type:"answer",sdp:e}),o=zD(),a=r||DL.UP,s=(null==t?void 0:t.streamId)||"",c=(null===(i=t)||void 0===i?void 0:i.userId)||"",d.label=1;case 1:return d.trys.push([1,3,,4]),WV.print("setAnswer","set answer: ",n),[4,this._peerConnection.setRemoteDescription(n)];case 2:return d.sent(),dx.rtcSetDescription(0,n.sdp,PL.W_0,a,s,c,zD()-o,{type:"answer"}),[3,4];case 3:throw(u=d.sent())instanceof Error&&dx.rtcSetDescription(-1,u.message,PL.W_0,a,s,c,zD()-o,{type:"answer"}),u;case 4:return[2]}}))}))},t.prototype.getLocalDescriptionSdp=function(){var e,t,r,i;if(null===(t=null===(e=this._peerConnection)||void 0===e?void 0:e.localDescription)||void 0===t?void 0:t.sdp)return null===(i=null===(r=this._peerConnection)||void 0===r?void 0:r.localDescription)||void 0===i?void 0:i.sdp;throw Error()},t.prototype.getRemoteDescriptionSdp=function(){var e,t,r,i;if(null===(t=null===(e=this._peerConnection)||void 0===e?void 0:e.remoteDescription)||void 0===t?void 0:t.sdp)return null===(i=null===(r=this._peerConnection)||void 0===r?void 0:r.remoteDescription)||void 0===i?void 0:i.sdp;throw Error()},t.prototype.closeMLine=function(e){var t,r;return e_(this,void 0,void 0,(function(){var i,n,o,a,s=this;return t_(this,(function(c){switch(c.label){case 0:return WV.print("closeMids","closeMids: ",e),i=this.getLocalDescriptionSdp(),n=TV(i,e),o=this.getRemoteDescriptionSdp(),a=TV(o,e),[4,this._peerConnection.createOffer()];case 1:return c.sent(),[4,this.setLocalDescription(sV.write(n))];case 2:return c.sent(),(null===(t=null==n?void 0:n.media)||void 0===t?void 0:t.length)!==(null===(r=null==a?void 0:a.media)||void 0===r?void 0:r.length)&&n.media.slice(a.media.length).forEach((function(e){var t;null===(t=s._remoteSdp)||void 0===t||t.modifyMlineByIceNode(e),a.media.push(e)})),Array.isArray(n.media)&&Array.isArray(a.media)&&n.media.forEach((function(e,t){a.media[t]&&(a.media[t].mid=e.mid)})),[4,this.setRemoteDescription(sV.write(a))];case 3:return c.sent(),[2]}}))}))},t.prototype.getDefaultSdp=function(){return e_(this,void 0,void 0,(function(){var e;return t_(this,(function(t){switch(t.label){case 0:return[4,ZD()];case 1:if(!(e=t.sent()))throw new dP(oP.NOT_SUPPORTED,"Get offer Error");return[2,{sdp:e,semantics:"unified-plan",type:"offer"}]}}))}))},t.prototype.getStats=function(e,t){return HV(this._peerConnection,e,t)},t.prototype.rollback=function(e,t){var r;return e_(this,void 0,void 0,(function(){return t_(this,(function(i){switch(i.label){case 0:return WV.print("rollback()","signalingState: %o",this._peerConnection.signalingState),"stable"!==this._peerConnection.signalingState?[3,2]:[4,null===(r=this._peerConnection)||void 0===r?void 0:r.setLocalDescription(new RTCSessionDescription({sdp:e,type:"offer"}))];case 1:i.sent(),i.label=2;case 2:return[4,this.closeMLine(t)];case 3:return i.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"pc",{get:function(){return this._peerConnection},enumerable:!1,configurable:!0}),t}(mk.exports.EventEmitter),qV=new gk("Locker",2),QV=1,ZV=function(){function e(e){this.lockingPromise=Promise.resolve(),this.locks=0,this.name="",this.lockId=QV++,e&&(this.name=e),qV.print("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}return Object.defineProperty(e.prototype,"isLocked",{get:function(){return this.locks>0},enumerable:!1,configurable:!0}),e.prototype.lock=function(){var e,t=this;this.locks+=1,qV.print("[lock-".concat(this.name,"-").concat(this.lockId,"] locked, current queue ").concat(this.locks,"."));var r=new Promise((function(r){e=function(){t.locks-=1,qV.print("[lock-".concat(t.name,"-").concat(t.lockId,"] unlocked, current queue ").concat(t.locks,".")),r()}})),i=this.lockingPromise.then((function(){return e}));return this.lockingPromise=this.lockingPromise.then((function(){return r})),i},e}(),$V=I,eF=ic,tF=Pm.exports.getWeakData,rF=kt,iF=G,nF=lc,oF=Wc,aF=xe,sF=Or.set,cF=Or.getterFor,uF=ba.find,dF=ba.findIndex,lF=$V([].splice),hF=0,pF=function(e){return e.frozen||(e.frozen=new fF)},fF=function(){this.entries=[]},_F=function(e,t){return uF(e.entries,(function(e){return e[0]===t}))};fF.prototype={get:function(e){var t=_F(this,e);if(t)return t[1]},has:function(e){return!!_F(this,e)},set:function(e,t){var r=_F(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=dF(this.entries,(function(t){return t[0]===e}));return~t&&lF(this.entries,t,1),!!~t}};var vF,mF={getConstructor:function(e,t,r,i){var n=e((function(e,n){nF(e,o),sF(e,{type:t,id:hF++,frozen:void 0}),null!=n&&oF(n,e[i],{that:e,AS_ENTRIES:r})})),o=n.prototype,a=cF(t),s=function(e,t,r){var i=a(e),n=tF(rF(t),!0);return!0===n?pF(i).set(t,r):n[i.id]=r,e};return eF(o,{delete:function(e){var t=a(this);if(!iF(e))return!1;var r=tF(e);return!0===r?pF(t).delete(e):r&&aF(r,t.id)&&delete r[t.id]},has:function(e){var t=a(this);if(!iF(e))return!1;var r=tF(e);return!0===r?pF(t).has(e):r&&aF(r,t.id)}}),eF(o,r?{get:function(e){var t=a(this);if(iF(e)){var r=tF(e);return!0===r?pF(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return s(this,e,t)}}:{add:function(e){return s(this,e,!0)}}),n}},SF=n,yF=I,EF=ic,gF=Pm.exports,bF=yS,TF=mF,IF=G,RF=Vm,AF=Or.enforce,CF=or,OF=!SF.ActiveXObject&&"ActiveXObject"in SF,NF=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},wF=bF("WeakMap",NF,TF);if(CF&&OF){vF=TF.getConstructor(NF,"WeakMap",!0),gF.enable();var PF=wF.prototype,DF=yF(PF.delete),kF=yF(PF.has),MF=yF(PF.get),UF=yF(PF.set);EF(PF,{delete:function(e){if(IF(e)&&!RF(e)){var t=AF(this);return t.frozen||(t.frozen=new vF),DF(this,e)||t.frozen.delete(e)}return DF(this,e)},has:function(e){if(IF(e)&&!RF(e)){var t=AF(this);return t.frozen||(t.frozen=new vF),kF(this,e)||t.frozen.has(e)}return kF(this,e)},get:function(e){if(IF(e)&&!RF(e)){var t=AF(this);return t.frozen||(t.frozen=new vF),kF(this,e)?MF(this,e):t.frozen.get(e)}return MF(this,e)},set:function(e,t){if(IF(e)&&!RF(e)){var r=AF(this);r.frozen||(r.frozen=new vF),kF(this,e)?UF(this,e,t):r.frozen.set(e,t)}else UF(this,e,t);return this}})}var LF=function(e){function t(){var t=e.call(this)||this;return t._hasVideoPermission=!1,t._hasAudioPermission=!1,t.inited=!1,t.deviceMap={audioinput:new Map,audiooutput:new Map,videoinput:new Map},t._handleDeviceChange=t._handleDeviceChange.bind(t),!WD()&&t.refreshDevices(),t}return Cf(t,e),t.prototype.refreshDevices=function(){return e_(this,void 0,void 0,(function(){var e=this;return t_(this,(function(t){switch(t.label){case 0:return navigator.mediaDevices?[4,navigator.mediaDevices.enumerateDevices()]:[2];case 1:return t.sent().forEach((function(t){var r;null===(r=e.deviceMap[t.kind])||void 0===r||r.set(t.deviceId,t)})),this.inited||this.initListener(),this.inited=!0,[2]}}))}))},t.prototype.initListener=function(){var e;return e_(this,void 0,void 0,(function(){return t_(this,(function(t){return"function"==typeof(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.addEventListener)&&navigator.mediaDevices.addEventListener("devicechange",this._handleDeviceChange),[2]}))}))},t.prototype._handleDeviceChange=function(){return e_(this,void 0,void 0,(function(){var e,t,r=this;return t_(this,(function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:return e=i.sent(),t=Array.from(n_(n_(n_([],i_(this.deviceMap.audioinput.values()),!1),i_(this.deviceMap.videoinput.values()),!1),i_(this.deviceMap.audiooutput.values()),!1)),e.forEach((function(e){var t=r.deviceMap[e.kind].get(e.deviceId);r.deviceMap[e.kind].set(e.deviceId,e),t||(e.kind.includes("video")?r.emit(u_.onVideoDeviceStateChanged,{mediaDeviceInfo:e,deviceState:"active"}):e.kind.includes("audio")&&r.emit(u_.onAudioDeviceStateChanged,{mediaDeviceInfo:e,deviceState:"active"}))})),t.forEach((function(t){e.find((function(e){return e.deviceId===t.deviceId&&e.kind===t.kind}))||(r.deviceMap[t.kind].delete(t.deviceId),t.kind.includes("video")?r.emit(u_.onVideoDeviceStateChanged,{mediaDeviceInfo:t,deviceState:"inactive"}):t.kind.includes("audio")&&r.emit(u_.onAudioDeviceStateChanged,{mediaDeviceInfo:t,deviceState:"inactive"}))})),[2]}}))}))},t.prototype.getVideoPermission=function(){return e_(this,void 0,void 0,(function(){var e=this;return t_(this,(function(t){switch(t.label){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new dP(oP.NOT_SUPPORTED,"GetUserMedia not supported");if(this.hasVideoPermission)return[2,!0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(t){t&&(t.getTracks().forEach((function(e){return e.stop()})),e.hasVideoPermission=!0,e.inited||e.refreshDevices())}))];case 2:case 3:return t.sent(),[3,4];case 4:return[2,this.hasVideoPermission]}}))}))},t.prototype.getAudioPermission=function(){return e_(this,void 0,void 0,(function(){var e=this;return t_(this,(function(t){switch(t.label){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new dP(oP.NOT_SUPPORTED,"GetUserMedia not supported");if(this.hasAudioPermission)return[2,!0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(t){t&&(t.getTracks().forEach((function(e){return e.stop()})),e.hasAudioPermission=!0,e.inited||e.refreshDevices())}))];case 2:case 3:return t.sent(),[3,4];case 4:return[2,this.hasAudioPermission]}}))}))},t.prototype.enumerateDevices=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.getAudioPermission()];case 1:case 2:return e.sent(),[3,3];case 3:return e.trys.push([3,5,,6]),[4,this.getVideoPermission()];case 4:case 5:return e.sent(),[3,6];case 6:return[4,this.refreshDevices()];case 7:return e.sent(),[2,Array.from(n_(n_(n_([],i_(this.deviceMap.audioinput.values()),!1),i_(this.deviceMap.videoinput.values()),!1),i_(this.deviceMap.audiooutput.values()),!1))]}}))}))},t.prototype.enumerateAudioCaptureDevices=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return[4,this.refreshDevices()];case 1:return e.sent(),[2,Array.from(this.deviceMap.audioinput.values())]}}))}))},t.prototype.enumerateVideoCaptureDevices=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return[4,this.refreshDevices()];case 1:return e.sent(),[2,Array.from(this.deviceMap.videoinput.values())]}}))}))},t.prototype.enumerateAudioPlaybackDevices=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return[4,this.refreshDevices()];case 1:return e.sent(),[2,Array.from(this.deviceMap.audiooutput.values())]}}))}))},t.prototype.getDeviceById=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return[4,this.enumerateDevices()];case 1:return[2,t.sent().find((function(t){return t.deviceId===e}))]}}))}))},Object.defineProperty(t.prototype,"hasAudioPermission",{get:function(){return this._hasAudioPermission},set:function(e){if(!e)throw new dP(oP.NO_PERMISSION,"Cannot revoke audio permission");this.refreshDevices(),this._hasAudioPermission=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVideoPermission",{get:function(){return this._hasVideoPermission},set:function(e){if(!e)throw new dP(oP.NO_PERMISSION,"Cannot revoke Video permission");this.inited||this.refreshDevices(),this._hasVideoPermission=!0},enumerable:!1,configurable:!0}),t}(Tk),xF=new LF,VF=function(){function e(){}return e.prototype.getAudioContextInstance=function(){if(!this._audioContextInstance){var e=window.AudioContext||window.webkitAudioContext;this._audioContextInstance=new e}return this._audioContextInstance},e}(),FF=function(){function e(e){var t=BF.getAudioContextInstance();if(e instanceof MediaStreamTrack){var r=new MediaStream;r.addTrack(e),this._audioSource=t.createMediaStreamSource(r)}else e instanceof AudioNode?this._audioSource=e:(this._audioSource=t.createMediaElementSource(e),this._audioSource.connect(t.destination));var i=t.createAnalyser();this._audioSource.connect(i),this._analyserNode=i}return e.prototype.getAudioLevel=function(){var e=new Uint8Array(2048);this._analyserNode.getByteTimeDomainData(e);var t=0;return e.forEach((function(e){return t=Math.max(t,Math.abs(e-128))})),t/128*255},e.prototype.destroy=function(){this._audioSource.disconnect(),this._analyserNode.disconnect()},e}(),BF=new VF,jF=new gk("VERTC",0),GF=new WeakMap,HF=function(e){return GF.get(e)},zF=function(e){function t(t,r){var i=e.call(this)||this;return i._trackId=t,i.mediaType=r,i}return Cf(t,e),t.prototype.getId=function(){return this._trackId},t}(Tk),KF=function(e){function t(t,r,i){var n=e.call(this,r,i)||this;return n._mediaTrack=t,n._initListeners(),n}return Cf(t,e),t.prototype.getTrack=function(){return this._mediaTrack},t.prototype.setTrack=function(e){this._mediaTrack=e},t.prototype.close=function(){var e;return null===(e=this._mediaTrack)||void 0===e?void 0:e.stop()},t.prototype._initListeners=function(){var e=this;this._mediaTrack instanceof MediaStreamTrack&&this._mediaTrack.addEventListener("ended",(function(){dx.rtcError("track-ended mediaType: ".concat(e._mediaTrack.kind),-1001),e.emit("track-ended",e)}))},t}(zF),WF=function(e){function t(t,r,i){var n=e.call(this,r,i)||this;return n._mediaTrack=t,n}return Cf(t,e),t.prototype.getTrack=function(){return this._mediaTrack},t}(zF),XF=function(e){function t(t,r){var i=e.call(this,t,r,"video")||this;return i.dummy=!1,i}return Cf(t,e),t.prototype.updateVideoCaptureConfig=function(){var e;return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return this.videoCaptureConfig?(jF.print("updateVideoEncoderConfig","update localVideoTrack: ",this.videoCaptureConfig),[4,null===(e=this.getTrack())||void 0===e?void 0:e.applyConstraints(this.videoCaptureConfig)]):[2];case 1:return t.sent(),[2]}}))}))},t.prototype.replaceTrack=function(e){this.setTrack(e)},t}(KF),YF=function(e){function t(t,r){var i=e.call(this,t,r,"audio")||this;return i.mixType=a_.PLAYOUT_AND_PUBLISH,i}return Cf(t,e),t.prototype.getAudioLevel=function(){return this._audioLevelFetcher||(this._audioLevelFetcher=new FF(this.getTrack())),this._audioLevelFetcher.getAudioLevel()},t.prototype.updateAudioCaptureConfig=function(){var e;return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return this.audioCaptureConfig?(jF.print("updateAudioCaptureConfig","update localAudioTrack: ",this.audioCaptureConfig),[4,null===(e=this.getTrack())||void 0===e?void 0:e.applyConstraints(this.audioCaptureConfig)]):[2];case 1:return t.sent(),[2]}}))}))},t}(KF),JF=function(e){function t(t,r){return e.call(this,t,r,"video")||this}return Cf(t,e),t}(WF),qF=function(e){function t(t,r){return e.call(this,t,r,"audio")||this}return Cf(t,e),t.prototype.getAudioLevel=function(){return this._audioLevelFetcher||(this._audioLevelFetcher=new FF(this.getTrack())),this._audioLevelFetcher.getAudioLevel()},t}(WF),QF=function(e){function t(t,r){return e.call(this,t,r)||this}return Cf(t,e),t}(YF),ZF=function(e){function t(t,r){return e.call(this,t,r)||this}return Cf(t,e),t}(XF),$F=function(e){function t(t,r){return e.call(this,t,r)||this}return Cf(t,e),t}(XF),eB=function(e){function t(t,r){return e.call(this,t,r)||this}return Cf(t,e),t}(YF),tB=function(e){function t(t,r){return e.call(this,t,r)||this}return Cf(t,e),t}(XF),rB=function(e){function t(t,r){return e.call(this,t,r)||this}return Cf(t,e),t}(YF);function iB(e){var t;return e_(this,void 0,void 0,(function(){var r,i,n,o,a,s;return t_(this,(function(c){switch(c.label){case 0:i=(null===(t=null==e?void 0:e.deviceId)||void 0===t?void 0:t.exact)||"default",c.label=1;case 1:return c.trys.push([1,3,,4]),jF.print("createCameraVideoTrack","constraints:",e),dx.rtcVideoCaptureEvent({event_type:$L.START,media_device_id:i}),n=zD(),[4,navigator.mediaDevices.getUserMedia({video:e})];case 2:return r=c.sent(),dx.rtcVideoCaptureEvent({event_type:$L.START_CAPTURE_RESULT,media_device_id:i,reason:tx.SUCCESS,elapse:zD()-n}),xF.hasVideoPermission=!0,[3,4];case 3:throw o=c.sent(),dx.rtcVideoCaptureEvent({event_type:$L.RUNNING_FAILED,media_device_id:i,error_code:o.code,reason:o.name+o.message}),new dP(oP.GET_VIDEO_TRACK_FAILED,"throw error from getUserMedia",o);case 4:return a=r.getVideoTracks()[0],GF.set(a,r),(s=new ZF(a,HD())).videoCaptureConfig=e,[2,s]}}))}))}function nB(e,t){var r;return e_(this,void 0,void 0,(function(){var i,n,o,a,s;return t_(this,(function(c){switch(c.label){case 0:jF.print("createCameraVideoTrack","constraints:",e),n=(null===(r=null==e?void 0:e.deviceId)||void 0===r?void 0:r.exact)||"default",e.sampleRate=e.sampleRate||(null==t?void 0:t.sampleRate),e.channelCount=e.channelCount||(null==t?void 0:t.channel),e.autoGainControl=e.autoGainControl||(null==t?void 0:t.agc),e.noiseSuppression=e.noiseSuppression||(null==t?void 0:t.ans),e.echoCancellation=e.echoCancellation||(null==t?void 0:t.aec),c.label=1;case 1:return c.trys.push([1,3,,4]),dx.rtcVideoCaptureEvent({event_type:$L.START,media_device_id:n}),o=zD(),[4,navigator.mediaDevices.getUserMedia({audio:e})];case 2:return i=c.sent(),dx.rtcVideoCaptureEvent({event_type:$L.START_CAPTURE_RESULT,media_device_id:n,reason:tx.SUCCESS,elapse:zD()-o}),xF.hasAudioPermission=!0,[3,4];case 3:throw a=c.sent(),dx.rtcVideoCaptureEvent({event_type:$L.RUNNING_FAILED,media_device_id:n,error_code:a.code,reason:a.name+a.message}),new dP(oP.GET_AUDIO_TRACK_FAILED,"throw error from getUserMedia",a);case 4:return s=i.getAudioTracks()[0],GF.set(s,i),[2,new QF(s,HD())]}}))}))}function oB(e){return void 0===e&&(e=!1),e_(this,void 0,void 0,(function(){var t,r,i;return t_(this,(function(n){switch(n.label){case 0:jF.print("createScreenStream","withAudio:",e),n.label=1;case 1:return n.trys.push([1,3,,4]),dx.rtcVideoCaptureEvent({event_type:$L.START,media_device_id:"screen"}),r=zD(),[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:e})];case 2:return t=n.sent(),dx.rtcVideoCaptureEvent({event_type:$L.START_CAPTURE_RESULT,media_device_id:"screen",reason:tx.SUCCESS,elapse:zD()-r}),[3,4];case 3:throw i=n.sent(),dx.rtcVideoCaptureEvent({event_type:$L.RUNNING_FAILED,media_device_id:"screen",error_code:i.code,reason:i.name+i.message}),new dP(oP.GET_SCREEN_TRACK_FAILED,"throw error from getDisplayMedia",i);case 4:return[2,t]}}))}))}Wi({target:"Number",stat:!0},{isNaN:function(e){return e!=e}}),new gk("Stats",2);var aB,sB,cB,uB,dB,lB,hB,pB,fB,_B,vB=function(){function e(e,t,r,i){this._client=e,this._handler=t,this.dataChannelRTT={},this._rttTimer={},this._remoteStreamStasEvtIntervals={},this._remoteStreamAudioStallInterval={},this._localStreamStasEvtIntervals={},this._videoInWaiting={},this.monitor=r,this._audioStallInterval=((null==i?void 0:i.audio_stall_interval)||200)/2,this._audioStallRatio=(null==i?void 0:i.audio_stall_ratio)||.6}return e.prototype.setRemoteStreamStatsEvtInterval=function(e,t){var r,i;return e_(this,void 0,void 0,(function(){var t,n,o,a,s,c,u,d,l,h,p,f=this;return t_(this,(function(_){switch(_.label){case 0:return t={audio:{},video:{},remoteStream:e},n=null===(r=e.audioTrack)||void 0===r?void 0:r.getTrack(),o=null===(i=e.videoTrack)||void 0===i?void 0:i.getTrack(),this.getRemoteVideoStats(o,t),[4,this.getRemoteAudioStats(n,t)];case 1:return _.sent(),this.delRemoteStreamStatsEvtInterval(e),a=0,s=0,this._audioStallInterval>0&&void 0!==t.audio.concealedSamples&&(c=t.audio.concealedSamples,u=t.audio.totalSamplesReceived,t.audio.silentConcealedSamples,d=zD(),l={isStall:!1,counted:!1,diff:0},h=.5*this._audioStallInterval,this._remoteStreamAudioStallInterval[e.streamId]=setInterval((function(){return e_(f,void 0,void 0,(function(){var t,r,i,o,p,f,_,v,m,S,y;return t_(this,(function(E){switch(E.label){case 0:return t=zD(),(r=t-d)<h?[2]:(i=e.hasAudio,o=e.subAudio,i&&o?[4,this._handler.getStats(n,!0)]:(l.isStall=!1,l.counted=!1,[2]));case 1:for(p=E.sent(),f=p.length,_=0;_<f;_++)if(v=p[_],m=v.concealedSamples,S=v.totalSamplesReceived,"inbound-rtp"===v.type){y=S-u,m-c>=this._audioStallRatio*y?(l.isStall?(l.counted?s+=r:(s=s+l.diff+r,a++),l.counted=!0):(l.counted=!1,l.diff=r),l.isStall=!0):(l.isStall=!1,l.counted=!1),c=m,u=S,d=t;break}return[2]}}))}))}),this._audioStallInterval)),p=function(){return e_(f,void 0,void 0,(function(){var r,i,n,o,c,u;return t_(this,(function(d){switch(d.label){case 0:return r=null===(c=e.audioTrack)||void 0===c?void 0:c.getTrack(),i=null===(u=e.videoTrack)||void 0===u?void 0:u.getTrack(),[4,this.getRemoteAudioStats(r,t,a,s)];case 1:return n=d.sent(),a=0,s=0,[4,this.getRemoteVideoStats(i,t)];case 2:return o=d.sent(),[2,{audioStats:n,videoStats:o,isScreen:e.isScreen,userId:e.userId}]}}))}))},this._remoteStreamStasEvtIntervals[e.streamId]=setInterval((function(){return e_(f,void 0,void 0,(function(){var e;return t_(this,(function(t){switch(t.label){case 0:return[4,p()];case 1:return e=t.sent(),this._client.emit("onRemoteStreamStats",e),[2]}}))}))}),2e3),[2]}}))}))},e.prototype.delRemoteStreamStatsEvtInterval=function(e){clearInterval(this._remoteStreamStasEvtIntervals[e.streamId]),clearInterval(this._remoteStreamAudioStallInterval[e.streamId]),delete this._remoteStreamAudioStallInterval[e.streamId]},e.prototype.unsubscribe=function(e){this.delRemoteStreamStatsEvtInterval(e),clearTimeout(this._rttTimer[e.userId]),this._videoInWaiting[e.streamId]=!1},e.prototype.getRemoteAudioStats=function(e,t,r,i){return e_(this,void 0,void 0,(function(){var n,o,a,s,c,u,d,l,h,p,f,_;return t_(this,(function(v){switch(v.label){case 0:return n={},o={timestamp:Date.now()},a=t.remoteStream,s=a.streamId,c=a.userId,u=a.isScreen,d=a.audioMid,l=a.subMediaType,h=a._attributes,p={media_type:"audio",is_screen:!!u,direction:"down",stream_id:s,stream_user_id:c,vid:d,connection_status:navigator.onLine,mute_state:tk(l)?"mute_state_off":"mute_state_on",remote_user_capture_state:h.localaudio?"capture_state_on":"capture_state_off",remote_user_mute_state:h.localaudio&&h.audiostream?"mute_state_off":"mute_state_on"},e&&this._handler?[4,this._handler.getStats(e)]:[2,n];case 1:return(f=v.sent()).length?(f.forEach((function(e){var t=e.type,r=e.packetsLost,i=e.packetsReceived,a=e.bytesReceived,s=e.jitterBufferDelay,c=e.jitterBufferEmittedCount,u=e.clockRate,d=e.channels,l=e.totalSamplesReceived,h=e.concealedSamples,f=e.silentConcealedSamples,_=e.concealmentEvents,v=e.totalRoundTripTime,m=e.state,S=e.currentRoundTripTime,y=e.audioLevel,E=e.totalAudioEnergy,g=e.totalSamplesDuration,b=e.mimeType,T=e.googDecodingNormal,I=e.fecPacketsReceived,R=e.availableIncomingBitrate,A=e.availableOutgoingBitrate,C=e.bytesSent,O=e.nominated,N=e.id,w=e.writable,P=e.jitter,D=e.candidateType,k=e.ip,M=e.address,U=e.networkType,L=e.port,x=e.protocol,V=e.audioOutputLevel,F=e.requestsReceived,B=e.responsesReceived,j=e.requestsSent,G=e.consentRequestsSent,H=e.responsesSent,z=e.ssrc,K=e.kind;"inbound-rtp"===t?(o.packetsLost=r,o.packetsReceived=i,p.packetsReceived=i,o.bytesReceived=a,p.bytes=a,void 0!==s&&(n.jitterBufferDelay=s/c*1e3,p.average_jitter_buffer_delay_ms=n.jitterBufferDelay),void 0!==l&&(o.totalSamplesReceived=l,n.concealedSamples=h,o.concealedSamples=h,o.silentConcealedSamples=f,p.concealedSamples=h,n.concealmentEvents=_,p.totalSamplesReceived=l),void 0!==I&&(p.fec_packets_received=I),p.jitter=1e3*P,p.ssrc=z):"codec"===t?(n.recordSampleRate=u,d&&(n.numChannels=d),p.codecName=b):"candidate-pair"===t?(p.ice_available_incoming_bitrate=R,p.ice_available_outgoing_bitrate=A,p.ice_bytes_received=a,p.ice_bytes_sent=C,p.ice_nominated=+O,p.ice_pair_id=N,p.ice_pair_rtt=S,p.rtt=1e3*S,p.ice_pair_state=m,p.ice_pair_writable=w,p.recv_ping_requests=F,p.recv_ping_responses=B,p.sent_ping_requests_before_first_response=j,p.sent_ping_requests_total=j+(G||0),p.sent_ping_responses=H,"succeeded"===m&&(n.rtt=1e3*S,n.total_rtt=1e3*v)):"track"===t&&"audio"===K?(p.audio_level=-10*Math.log10(Math.pow(y,2)),p.volume=255*y,p.total_audio_energy=E,p.totalAudioDuration=g):"ssrc"===t?(p.decodingNormal=T,p.recvAudioLevel=V):"local-candidate"===t?(p.local_candidate_type=D,p.local_ip=k||M,p.local_network_type=U,p.local_port=L,p.protocol=x):"remote-candidate"===t&&(p.remote_candidate_type=D,p.remote_ip=k||M,p.remote_port=L)})),(_=t.audio).timestamp?(n.audioLossRate=(o.packetsLost-_.packetsLost)/(o.packetsReceived-_.packetsReceived+(o.packetsLost-_.packetsLost)),n.audioLossRate=Number.isNaN(n.audioLossRate)?0:n.audioLossRate,p.packetsLost=Math.round(o.packetsLost-_.packetsLost),p.fraction_lost=n.audioLossRate,p.packets_lost_rate=n.audioLossRate,n.statsInterval=o.timestamp-_.timestamp,p.stats_interval=n.statsInterval,n.receivedKBitrate=(o.bytesReceived-_.bytesReceived||0)/n.statsInterval,p.bitrate=Math.round(8e3*n.receivedKBitrate),p.bandwidth=Math.round(p.bitrate/1024),void 0!==o.concealedSamples&&(p.interval_concealed_samples=o.concealedSamples-_.concealedSamples,p.interval_samples_received=o.totalSamplesReceived-_.totalSamplesReceived,p.interval_silent_concealed_samples=o.silentConcealedSamples-_.silentConcealedSamples,n.receivedSampleRate=1e3*p.interval_samples_received/n.statsInterval),t.audio=o,this._audioStallInterval>0&&void 0!==o.concealedSamples&&(p.concealedSamples===p.interval_concealed_samples&&p.totalSamplesReceived===p.interval_samples_received?(p.stall_count=0,p.stall_duration=0):(p.stall_count=r,p.stall_duration=i),n.stallCount=p.stall_count,n.stallDuration=p.stall_duration),this.monitor.rtcMediaStatistics(p,{}),[2,n]):(t.audio=o,[2,n])):[2,n]}}))}))},e.prototype.getRemoteVideoStats=function(e,t){return e_(this,void 0,void 0,(function(){var r,i,n,o,a,s,c,u,d,l,h,p;return t_(this,(function(f){switch(f.label){case 0:return r={},i={timestamp:Date.now()},n=t.remoteStream,o=n.streamId,a=n.userId,s=n.isScreen,c=n.subMediaType,u=n._attributes,d={media_type:"video",is_screen:!!s,direction:"down",stream_id:o,stream_user_id:a,vid:t.remoteStream.videoMid,connection_status:navigator.onLine,mute_state:rk(c)?"mute_state_off":"mute_state_on",remote_user_capture_state:u.localvideo?"capture_state_on":"capture_state_off",remote_user_mute_state:u.localvideo&&u.videostream?"mute_state_off":"mute_state_on"},e&&this._handler?(r.isScreen=s,[4,this._handler.getStats(e)]):[2,r];case 1:return(l=f.sent()).length?(l.forEach((function(e){var t=e.type,n=e.frameHeight,o=e.frameWidth,a=e.packetsLost,s=e.packetsReceived,c=e.bytesReceived,u=e.framesDecoded,l=e.jitterBufferDelay,h=e.jitterBufferEmittedCount,p=e.mimeType,f=e.firCount,_=e.availableIncomingBitrate,v=e.availableOutgoingBitrate,m=e.bytesSent,S=e.nominated,y=e.id,E=e.currentRoundTripTime,g=e.state,b=e.writable,T=e.candidateType,I=e.ip,R=e.address,A=e.networkType,C=e.port,O=e.nackCount,N=e.pliCount,w=e.protocol,P=e.requestsReceived,D=e.responsesReceived,k=e.requestsSent,M=e.consentRequestsSent,U=e.responsesSent,L=e.ssrc;e.kind;var x=e.jitter,V=e.framesReceived,F=e.keyFramesDecoded,B=e.totalDecodeTime,j=e.decoderImplementation,G=e.lastPacketReceivedTimestamp;"inbound-rtp"===t?(i.packetsLost=a,d.packetsLost=a,i.packetsReceived=s,d.packetsReceived=s,i.bytesReceived=c,d.bytes=c,i.framesDecoded=u,void 0!==l&&(i.jitterBufferDelay=l/h*1e3,d.average_jitter_buffer_delay_ms=i.jitterBufferDelay),d.fir_count=f,d.nackCount=O,i.nackCount=O,d.pli_count=N,d.ssrc=L,d.jitter=x,d.framesReceived=V,i.framesReceived=V,d.framesDecoded=u,d.key_frames_decoded=F,d.total_decode_time=B,d.decoder_name=j,d.last_packet_received_timestamp=G):"track"===t&&void 0!==o?(r.width=o,d.frame_size_width=o,r.height=n,d.frame_size_height=n,void 0!==V&&(d.framesReceived=V,i.framesReceived=V)):"codec"===t?d.codecName=p:"candidate-pair"===t?(d.ice_available_incoming_bitrate=_,d.ice_available_outgoing_bitrate=v,d.ice_bytes_received=c,d.ice_bytes_sent=m,d.ice_nominated=+S,d.ice_pair_id=y,d.ice_pair_rtt=E,d.rtt=1e3*E,r.rtt=d.rtt,d.ice_pair_state=g,d.ice_pair_writable=b,d.recv_ping_requests=P,d.recv_ping_responses=D,d.sent_ping_requests_before_first_response=k,d.sent_ping_requests_total=k+(M||0),d.sent_ping_responses=U):"local-candidate"===t?(d.local_candidate_type=T,d.local_ip=I||R,d.local_network_type=A,d.local_port=C,d.protocol=w):"remote-candidate"===t&&(d.remote_candidate_type=T,d.remote_ip=I||R,d.remote_port=C)})),h=t.video,p=t.remoteStream,h.timestamp?(r.videoLossRate=(i.packetsLost-h.packetsLost)/(i.packetsReceived-h.packetsReceived+(i.packetsLost-h.packetsLost)),r._retransmittedRate=(i.nackCount-h.nackCount)/(i.packetsReceived-h.packetsReceived+(i.packetsLost-h.packetsLost)),r.videoLossRate=Number.isNaN(r.videoLossRate)?0:r.videoLossRate,d.fraction_lost=r.videoLossRate,d.packets_lost_rate=r.videoLossRate,r.statsInterval=i.timestamp-h.timestamp,d.stats_interval=r.statsInterval,r.receivedKBitrate=(i.bytesReceived-h.bytesReceived||0)/r.statsInterval,d.bitrate=Math.round(8e3*r.receivedKBitrate),d.bandwidth=Math.round(d.bitrate/1024),r.decoderOutputFrameRate=1e3*(i.framesDecoded-h.framesDecoded)/r.statsInterval,r.receivedFrameRate=1e3*(i.framesReceived-h.framesReceived)/r.statsInterval,d.frame_rate_decoded=Math.round(r.decoderOutputFrameRate),d.frame_rate_received=d.frame_rate_decoded,t.video=i,this.processStall(p,d,r,s),this.monitor.rtcMediaStatistics(d,{}),[2,r]):(t.video=i,[2,r])):[2,r]}}))}))},e.prototype.processStall=function(e,t,r,i){var n=0,o=0,a=0;if(e.recordedVideoFrames){e.recordedVideoFrames.forEach((function(e){e.isStall&&(n+=e.stallCount,o+=e.stallDuration),a=e.playTime})),e.recordedVideoFrames.length||(o=2e3,n=this._videoInWaiting[e.streamId]?0:1,this._videoInWaiting[e.streamId]=!0);var s=e.recordedVideoFrames.pop();s&&(s.isStall?this._videoInWaiting[e.streamId]=!0:this._videoInWaiting[e.streamId]=!1),e.recordedVideoFrames=[]}t.stall_count=n,i?(t.stuck_length=o,t.stall_duration=void 0):(t.stall_duration=o,t.stuck_length=void 0),t.play_time=a,r.stallCount=n,r.stallDuration=o},e.prototype.setLocalStreamStatsEvtInterval=function(e){var t,r,i=this,n={audio:{},video:{},localStream:e},o=null===(t=e.audioTrack)||void 0===t?void 0:t.getTrack(),a=null===(r=e.videoTrack)||void 0===r?void 0:r.getTrack();this.getAudioStats(o,n),this.getVideoStats(a,n),this.delLocalStreamStatsEvtInterval(e);this._localStreamStasEvtIntervals[e.streamId]=setInterval((function(){return e_(i,void 0,void 0,(function(){var t;return t_(this,(function(r){switch(r.label){case 0:return[4,e_(i,void 0,void 0,(function(){var t,r,i,o,a,s;return t_(this,(function(c){switch(c.label){case 0:return t=null===(a=e.audioTrack)||void 0===a?void 0:a.getTrack(),r=null===(s=e.videoTrack)||void 0===s?void 0:s.getTrack(),[4,this.getAudioStats(t,n)];case 1:return i=c.sent(),[4,this.getVideoStats(r,n)];case 2:return o=c.sent(),[2,{audioStats:i,videoStats:o,isScreen:e.isScreen}]}}))}))];case 1:return t=r.sent(),this._client.emit("onLocalStreamStats",t),[2]}}))}))}),2e3)},e.prototype.delLocalStreamStatsEvtInterval=function(e){clearInterval(this._localStreamStasEvtIntervals[e.streamId])},e.prototype.unpublish=function(e){this.delLocalStreamStatsEvtInterval(e)},e.prototype.getAudioStats=function(e,t){return e_(this,void 0,void 0,(function(){var r,i,n,o,a,s,c,u,d,l;return t_(this,(function(h){switch(h.label){case 0:return r={},i={timestamp:Date.now()},n=t.localStream,o=n.streamId,a=n.audioMid,s=n.isScreen,c=n.pubAttributes,u={media_type:"audio",is_screen:!!s,direction:"up",stream_id:o,vid:a,connection_status:navigator.onLine,capture_state:c.localaudio?"capture_state_on":"capture_state_off"},e&&this._handler?[4,this._handler.getStats(e)]:[2,r];case 1:return(d=h.sent()).length?(d.forEach((function(e){var t=e.type,n=e.packetsSent,o=e.packetsLost,a=e.bytesSent,s=e.clockRate,c=e.roundTripTime,d=e.channels,l=e.audioLevel,h=e.googRtt,p=e.mimeType,f=e.availableIncomingBitrate,_=e.availableOutgoingBitrate,v=e.bytesReceived,m=e.nominated,S=e.id,y=e.currentRoundTripTime,E=e.state,g=e.writable,b=e.requestsReceived,T=e.responsesReceived,I=e.requestsSent,R=e.consentRequestsSent,A=e.responsesSent,C=e.jitter,O=e.candidateType,N=e.ip,w=e.address,P=e.networkType,D=e.port,k=e.protocol,M=e.nackCount,U=e.retransmittedBytesSent,L=e.retransmittedPacketsSent,x=e.roundTripTimeMeasurements,V=e.audioInputLevel,F=e.ssrc,B=e.totalAudioEnergy,j=e.totalSamplesDuration,G=e.mediaType,H=e.fractionLost;"outbound-rtp"===t?(i.packetsSent=n,i.bytesSent=a,u.bytes=a,u.packetsSent=n,u.nackCount=M,u.ssrc=F,u.retransmitted_bytes_sent=U,u.retransmitted_packets_sent=L,i.retransmittedPacketsSent=L):"remote-inbound-rtp"===t?(i.packetsLost=o,u.packetsLost=o,u.jitter=1e3*C,r.rtt=1e3*c,u.rtt=r.rtt,u.round_trip_time_measurements=x,r._fractionLost=H||0):"codec"===t?(r.recordSampleRate=s,r.numChannels=d,u.codecName=p):"media-source"===t?(u.audio_level=-10*Math.log10(Math.pow(l,2)),u.volume=255*l,u.total_audio_energy=B,u.total_samples_duration=j):"ssrc"===t&&"audio"===G?(u.audio_network_elapse=h,u.send_level=V):"candidate-pair"===t?(u.ice_available_incoming_bitrate=f,u.ice_available_outgoing_bitrate=_,u.ice_bytes_received=v,u.ice_bytes_sent=a,u.ice_nominated=+m,u.ice_pair_id=S,u.ice_pair_rtt=y,u.ice_pair_state=E,u.ice_pair_writable=g,u.recv_ping_requests=b,u.recv_ping_responses=T,u.sent_ping_requests_before_first_response=I,u.sent_ping_requests_total=I+(R||0),u.sent_ping_responses=A):"local-candidate"===t?(u.local_candidate_type=O,u.local_ip=N||w,u.local_network_type=P,u.local_port=D,u.protocol=k):"remote-candidate"===t&&(u.remote_candidate_type=O,u.remote_ip=N||w,u.remote_port=D)})),(l=t.audio).timestamp?(void 0!==i.packetsLost&&(r.audioLossRate=(i.packetsLost-l.packetsLost)/(i.packetsSent-l.packetsSent),r.audioLossRate=Number.isNaN(r.audioLossRate)?0:r.audioLossRate,u.fraction_lost=r.audioLossRate),r.statsInterval=i.timestamp-l.timestamp,u.stats_interval=r.statsInterval,r.sendKBitrate=(i.bytesSent-l.bytesSent||0)/r.statsInterval*8,u.bitrate=Math.round(1e3*r.sendKBitrate),u.bandwidth=Math.round(u.bitrate/1024),t.audio=i,this.monitor.rtcMediaStatistics(u,{}),r._retransmittedRate=(i.retransmittedPacketsSent-l.retransmittedPacketsSent)/(i.packetsSent-l.packetsSent),r._fractionLost=Math.max(r._fractionLost,r.audioLossRate),[2,r]):(t.audio=i,[2,r])):[2,r]}}))}))},e.prototype.getVideoStats=function(e,t){return e_(this,void 0,void 0,(function(){var r,i,n,o,a,s,c,u,d,l,h,p,f,_;return t_(this,(function(v){switch(v.label){case 0:return r={},i={timestamp:Date.now(),simulcast:{}},n=t.localStream,o=n.streamId,a=n.videoMid,s=n.isScreen,c=n.pubAttributes,u=n.enableSimulcast,d={media_type:"video",is_screen:!!s,direction:"up",stream_id:o,vid:a,connection_status:navigator.onLine,capture_state:c.localvideo?"capture_state_on":"capture_state_off"},e&&this._handler?(r.isScreen=s,[4,this._handler.getStats(e)]):[2,r];case 1:return(l=v.sent()).length?(h=0,l.forEach((function(e){var t=e.type,n=e.framesEncoded,o=e.packetsLost,a=e.bytesSent,s=e.framesSent,c=e.roundTripTime,l=e.mimeType,p=e.frameWidth,f=e.frameHeight,_=e.packetsSent,v=e.googActualEncBitrate,m=e.googAvailableReceiveBandwidth,S=e.googAvailableSendBandwidth,y=e.googAvgEncodeMs,E=e.googBucketDelay,g=e.googEncodeUsagePercent,b=e.googFrameRateInput,T=e.availableIncomingBitrate,I=e.availableOutgoingBitrate,R=e.bytesReceived,A=e.nominated,C=e.id,O=e.currentRoundTripTime,N=e.state,w=e.writable,P=e.candidateType,D=e.ip,k=e.address,M=e.networkType,U=e.port,L=e.nackCount,x=e.pliCount,V=e.protocol,F=e.qpSum,B=e.requestsReceived,j=e.responsesReceived,G=e.googRetransmitBitrate,H=e.requestsSent,z=e.consentRequestsSent,K=e.responsesSent,W=e.ssrc,X=e.googTargetEncBitrate,Y=e.googTransmitBitrate,J=e.googRtt,q=e.retransmittedPacketsSent,Q=e.encoderImplementation,Z=e.jitter,$=e.rid,ee=e.fractionLost;"outbound-rtp"===t?(u&&($?i.simulcast[$]=e:i.simulcast[h]=e,h++),i.framesEncoded=n,i.bytesSent=a,i.framesSent=s,d.bytes=a,i.packetsSent=_,d.packetsSent=_,d.nackCount=L,d.pli_count=x,d.qp_sum=F,d.ssrc=W,d.retransmitted_packets_sent=q,i.retransmittedPacketsSent=q,d.encoder_implementation=Q):"track"===t?(r.encodedFrameWidth=p,r.encodedFrameHeight=f,d.frame_size_height=f,d.frame_size_width=p):"remote-inbound-rtp"===t?(i.packetsLost=o,r.rtt=1e3*c,d.rtt=r.rtt,d.jitter=Z,d.packetsLost=o,r._fractionLost=ee||0):"codec"===t?(r.codecType=l,d.codecName=l):"candidate-pair"===t?(d.ice_available_incoming_bitrate=T,d.ice_available_outgoing_bitrate=I,d.ice_bytes_received=R,d.ice_bytes_sent=a,d.ice_nominated=+A,d.ice_pair_id=C,d.ice_pair_rtt=O,d.ice_pair_state=N,d.ice_pair_writable=w,d.recv_ping_requests=B,d.recv_ping_responses=j,d.sent_ping_requests_before_first_response=H,d.sent_ping_requests_total=H+z,d.sent_ping_responses=K):"local-candidate"===t?(d.local_candidate_type=P,d.local_ip=D||k,d.local_network_type=M,d.local_port=U,d.protocol=V):"remote-candidate"===t?(d.remote_candidate_type=P,d.remote_ip=D||k,d.remote_port=U):"VideoBwe"===t?(d.encBitratebps=v,d.available_receive_bandwidth=m,d.available_send_bandwidth=S,d.bucket_delay=E,d.retransmitBitratebps=G,d.targetEncBitratebps=X,d.transmit_bitrate=Y,r._sendBandWidth=+S):"ssrc"===t&&(d.video_network_elapse=J,d.avg_encode_ms=y,d.encodeUsage=g,d.frame_rate_input=b,d.orignal_input_Framerate=+b)})),(p=t.video).timestamp?(r.statsInterval=i.timestamp-p.timestamp,d.stats_interval=r.statsInterval,f=Object.keys(i.simulcast),u?(d.sim_enc_width=[],d.sim_enc_height=[],d.sim_enc_bps=[],d.sim_enc_framerate=[],d.sim_rids=[],d.sim_enc_bandwidth=[],d.sim_sent_framerate=[],d.sim_fraction_lost=[],_=!1,f.sort((function(e,t){return+e-+t})).forEach((function(e){var t=i.simulcast[e],n=t.frameWidth,o=t.frameHeight,a=t.bytesSent,s=t.framesEncoded,c=t.framesSent,u=t.packetsLost,l=t.packetsSent,h=t.qualityLimitationReason,f=t.qualityLimitationDurations,v=t.qualityLimitationResolutionChanges,m=t.retransmittedPacketsSent;void 0!==h&&(d.sim_qualityLimitationReason||(d.sim_qualityLimitationReason=[],d.sim_qualityLimitationDurations=[],d.sim_qualityLimitationResolutionChanges=[]),d.sim_qualityLimitationReason.push(h),d.sim_qualityLimitationDurations.push(f),d.sim_qualityLimitationResolutionChanges.push(v));var S=p.simulcast[e];if(d.sim_enc_width.push(n||0),d.sim_enc_height.push(o||0),S){var y=(a-S.bytesSent||0)/r.statsInterval;d.sim_enc_bps.push(Math.round(8e3*y)),d.sim_enc_bandwidth.push(Math.round(8e3*y/1024));var E=1e3*(s-S.framesEncoded)/r.statsInterval;d.sim_enc_framerate.push(Math.round(E)),d.sim_rids.push(e);var g=void 0!==c?c-S.framesSent:s-S.framesEncoded,b=1e3*g/r.statsInterval;d.sim_sent_framerate.push(Math.round(b));var T=(u-S.packetsLost)/(l-S.packetsSent);r._retransmittedRate=(m-S.retransmittedPacketsSent)/(l-S.packetsSent),T=Number.isNaN(T)?0:T,d.sim_fraction_lost.push(T),n>0&&!_&&(r.sentKBitrate=8*y,r.encoderOutputFrameRate=E,r.encodedFrameCount=g,r.sentFrameRate=b,r.videoLossRate=T,_=!0)}})),this.monitor.rtcMediaStatistics(d,{})):(r.encodedFrameCount=void 0!==i.framesSent?i.framesSent-p.framesSent:i.framesEncoded-p.framesEncoded,r.sentKBitrate=(i.bytesSent-p.bytesSent||0)/r.statsInterval*8,d.bitrate=Math.round(1e3*r.sentKBitrate),d.bandwidth=Math.round(d.bitrate/1024),r.encoderOutputFrameRate=1e3*(i.framesEncoded-p.framesEncoded)/r.statsInterval,d.frame_rate_encoded=Math.round(r.encoderOutputFrameRate),r.sentFrameRate=1e3*r.encodedFrameCount/r.statsInterval,d.frame_rate_sent=Math.round(r.sentFrameRate),r.videoLossRate=(i.packetsLost-p.packetsLost)/(i.packetsSent-p.packetsSent),r.videoLossRate=Number.isNaN(r.videoLossRate)?0:r.videoLossRate,d.fraction_lost=r.videoLossRate,r._retransmittedRate=(i.retransmittedPacketsSent-p.retransmittedPacketsSent)/(i.packetsSent-p.packetsSent),this.monitor.rtcMediaStatistics(d,{})),t.video=i,r._fractionLost=Math.max(r._fractionLost,r.videoLossRate),[2,r]):(t.video=i,[2,r])):[2,r]}}))}))},e.prototype.getDataChannelRTT=function(e){var t,r=this,i=zD();null===(t=this._client.sendUserMessage(e,"__web__rtc__rtt__"))||void 0===t||t.then((function(t){if("timeout"!==t){var n=Date.now()-i;n>0&&n<2e3&&(r.dataChannelRTT[e]=n)}else clearTimeout(r._rttTimer[e])})).catch((function(){clearTimeout(r._rttTimer[e])})),clearTimeout(this._rttTimer[e]),this._rttTimer[e]=setTimeout((function(){r.getDataChannelRTT(e)}),2e3)},e.prototype.destroy=function(){var e=this;Object.keys(this._localStreamStasEvtIntervals).forEach((function(t){clearInterval(e._localStreamStasEvtIntervals[t])})),Object.keys(this._remoteStreamStasEvtIntervals).forEach((function(t){clearInterval(e._remoteStreamStasEvtIntervals[t])})),Object.keys(this._rttTimer).forEach((function(t){clearTimeout(e._rttTimer[t])})),Object.keys(this._remoteStreamAudioStallInterval).forEach((function(t){clearTimeout(e._remoteStreamAudioStallInterval[t])})),this._rttTimer={},this.dataChannelRTT={},this._videoInWaiting={}},e}();!function(e){e[e.NONE=0]="NONE"}(aB||(aB={})),function(e){e[e.CHANNEL_PROFILE_COMMUNICATION=0]="CHANNEL_PROFILE_COMMUNICATION",e[e.CHANNEL_PROFILE_LIVE_BROADCASTING=1]="CHANNEL_PROFILE_LIVE_BROADCASTING"}(sB||(sB={})),function(e){e.RESUBSCRIBE="resubscribe",e.STREAM_FAILED="stream_failed",e.SUBSCRIBE_PUSH_TRACK="subscribe_push_track",e.REMOVE_PUSH_TRACK="remove_push_track",e.VIDEO_FIRST_FRAME="video_first_frame",e.ON_USER_PUBLISH_STATE_CHANGE="on_user_publish_state_change",e.ON_USER_START_AUDIO_CAPTURE="on_user_start_audio_capture",e.ON_USER_STOP_AUDIO_CAPTURE="on_user_stop_audio_capture",e.ON_USER_START_VIDEO_CAPTURE="on_user_start_video_capture",e.ON_USER_STOP_VIDEO_CAPTURE="on_user_stop_video_capture",e.ON_SEI_MESSAGED_RECEIVED="on_sei_messaged_received",e.ON_PUBLISH_RESULT="on_publish_result",e.ON_UPDATE_TOKEN_SUCCESS="on_update_token_success",e.ON_REMOTE_STREAM_STATS="ON_REMOTE_STREAM_STATS",e.ON_LOCAL_STREAM_STATS="ON_LOCAL_STREAM_STATS",e.ON_USER_LEAVE="on_user_leave",e.ON_ROOM_ERROR="on_room_error",e.ON_NETWORK_QUALITY="on_network_quality",e.ON_SIMULCAST_SUBSCRIBE_FALLBACK="on_simulcast_subscribe_fallback",e.ON_REMOTE_VIDEO_SIZE_CHANGED="on_remote_video_size_changed",e.RECONNECT_FAILED="reconnect_failed"}(cB||(cB={})),function(e){e.TranscodeStateChanged="TranscodeStateChanged",e.TranscodeStarted="TranscodeStarted",e.TranscodeUpdated="TranscodeUpdated",e.TranscodeStoped="TranscodeStoped"}(uB||(uB={})),function(e){e[e.START=1]="START",e[e.START_SUCCESS=2]="START_SUCCESS",e[e.START_FAILED=3]="START_FAILED",e[e.UPDATE=4]="UPDATE",e[e.UPDATE_SUCCESS=5]="UPDATE_SUCCESS",e[e.UPDATE_FAILED=6]="UPDATE_FAILED",e[e.STOP=7]="STOP",e[e.STOP_SUCCESS=8]="STOP_SUCCESS",e[e.STOP_FAILED=9]="STOP_FAILED"}(dB||(dB={})),function(e){e[e.PUB=0]="PUB",e[e.UNPUB=1]="UNPUB"}(lB||(lB={})),function(e){e[e.SUB=0]="SUB",e[e.UNSUB=1]="UNSUB"}(hB||(hB={})),function(e){e[e.communication=0]="communication",e[e.live_broadcasting=1]="live_broadcasting",e[e.game=2]="game",e[e.cloud_game=3]="cloud_game",e[e.low_latency=4]="low_latency",e[e.chat=5]="chat",e[e.chat_room=6]="chat_room",e[e.lw_together=7]="lw_together",e[e.game_hd=8]="game_hd",e[e.co_host=9]="co_host",e[e.interactive_podcast=10]="interactive_podcast",e[e.ktv=11]="ktv",e[e.chorus=12]="chorus",e[e.vr_chat=13]="vr_chat",e[e.game_streaming=14]="game_streaming",e[e.lan_live_streaming=15]="lan_live_streaming",e[e.meeting=16]="meeting",e[e.meeting_room=17]="meeting_room",e[e.classroom=18]="classroom"}(fB||(fB={})),function(e){e.IES_living="IES_living",e.FeedShare="FeedShare",e.fluent="fluent",e.IES_chatroom="IES_chatroom",e.standard="standard",e.IES_PK="IES_PK",e.IES_KTV="IES_KTV"}(_B||(_B={}));var mB,SB=((pB={})[qf.communication]=[fB.communication],pB[qf.chat]=[fB.communication],pB[qf.chatRoom]=[fB.live_broadcasting,_B.IES_chatroom],pB[qf.coHost]=[fB.live_broadcasting,_B.IES_PK],pB[qf.meeting]=[fB.meeting],pB[qf.classRoom]=[fB.communication],pB),yB=new gk("MediaServerClient",2),EB=5e3;!function(e){e.DISCONNECTED="disconnected",e.DISCONNECTING="disconnecting",e.CONNECTED="connected",e.CONNECTING="connecting"}(mB||(mB={}));var gB=function(e,t){yB.print(e,"userId: %o, subAudio: %o, subVideo: %o, paused: %o, audioMid: %o, videoMid: %o, workaround_1_: %o, sequenceId: %o",t.userId,t.subAudio,t.subVideo,t.paused,t.audioMid,t.videoMid,t._workaround_1_,t.sequenceId)},bB=function(e){function t(t,r){void 0===r&&(r=dx);var i=e.call(this)||this;return i._ontrackCallbackMap=new Map,i._pubConfig={},i._subConfig={},i._roomProfile=qf.communication,i.monitor=r,i._pubSubLock=new ZV("pubSubLock"),i._joinLeaveLock=new ZV("joinLeaveLock"),i._state=mB.DISCONNECTED,i._roomAttributes={multiChatMode:!1,bigRoomMode:!1},i._context=t,i}return Cf(t,e),t.prototype._addHandlerEvents=function(){var e,t=this;null===(e=this._handler)||void 0===e||e.once("disconnect",(function(){yB.print("emit ABNORMAL_DISCONNECTION ice"),t.safeEmit(jx.ABNORMAL_DISCONNECTION)}))},t.prototype._addSignalEventHandler=function(){var e,t=this;[Fx.ON_ADD_STREAM,Fx.ON_REMOVE_STREAM,Fx.USER_CONNECTION,Fx.USER_DISCONNECTION,Fx.ON_UPDATE_STREAM_ATTRIBUTES,Fx.ON_UPDATE_ROOM_ATTRIBUTES,Fx.ON_PUSH_TRACK,Fx.ON_REMOVE_TRACK,Fx.NODE_CHANGE,Fx.ON_CUSTOM_MESSAGE,Fx.USER_MESSAGE_RECEIVED,Fx.USER_BINARY_MESSAGE_RECEIVED,Fx.POST_PROCESSING_MESSAGE,Fx.ON_USER_TOKEN_WILL_EXPIRE,Fx.STREAM_CONTROL_MESSAGE,Fx.ON_SCENE_CONFIG,Bx.RSCP].forEach((function(e){var r;null===(r=t._dataChannelSignal)||void 0===r||r.on(e,(function(r){t.safeEmit(e,r)}))})),null===(e=this._dataChannelSignal)||void 0===e||e.once("close",(function(){yB.print("emit ABNORMAL_DISCONNECTION datachannel"),t.safeEmit(jx.ABNORMAL_DISCONNECTION)}))},t.prototype._removeSignalEventHandler=function(){var e,t;null===(e=this._dataChannelSignal)||void 0===e||e.removeAllListeners(),null===(t=this._handler)||void 0===t||t.removeAllListeners()},Object.defineProperty(t.prototype,"connectionState",{get:function(){return this._state},set:function(e){this._state!==e&&(this.safeEmit(jx.ON_CONNECTION_STATE_CHANGE,{prev:this._state,next:e}),this._state=e)},enumerable:!1,configurable:!0}),t.prototype.connect=function(e,t,r,i){var n;return void 0===t&&(t=""),void 0===r&&(r=""),void 0===i&&(i={}),e_(this,void 0,void 0,(function(){var o,a,s,c,u,d=this;return t_(this,(function(l){switch(l.label){case 0:return this.connectionState=mB.CONNECTING,this._appId=e,this._handler&&(this._removeSignalEventHandler(),this._handler.destroy()),i.node?(o=[i.node],yx("es.join.nodeChange",i),[3,3]):[3,1];case 1:return Promise.resolve().then((function(){return d.emit("onGetIceConfigHook")})),this._iceConfigRequestManager=new oV,[4,null===(n=this._iceConfigRequestManager)||void 0===n?void 0:n.getAccessNode(e,t,r,Cx.getDeviceId(),null==i?void 0:i.reason,null==i?void 0:i.feedbackNode,this._useCloudProxy)];case 2:if(!(o=l.sent()))throw yx("es.join.getNodeFailed",""),new dP(oP.ICE_SERVER_WRONG,"get ICE config failed");yx("es.join.getNodeSuccess",o),l.label=3;case 3:this._addHandlerEvents(),Promise.resolve().then((function(){return d.emit("onEstablishConnectionHook")})),l.label=4;case 4:return l.trys.push([4,6,,7]),s=!1,c=o.map((function(e){var t=new JV(d.monitor,d._context);return t.connect(e).then((function(r){s?t.destroy():(s=!0,a=r,d.safeEmit("prevIceNode",e),d._handler=t,d._addHandlerEvents())})).catch((function(e){t.destroy()}))})),[4,$D(c)];case 5:return l.sent(),yB.print("join","establish peerConnection success"),[3,7];case 6:throw u=l.sent(),this.connectionState=mB.DISCONNECTED,new dP(oP.ESTABLISH_DATACHANNEL_FAILED,"establish dataChannel failed",u);case 7:if(!a)throw this.connectionState=mB.DISCONNECTED,new dP(oP.ESTABLISH_DATACHANNEL_FAILED,"establish dataChannel failed");return this._dataChannelSignal=new rV(a),this._addSignalEventHandler(),this._dataChannelSignal.sendPingSignaling(),[2]}}))}))},t.prototype.join=function(e,t,r,i){var n,o,a,s,c,u,d,l,h,p;return void 0===t&&(t={}),void 0===r&&(r=!1),e_(this,void 0,void 0,(function(){var f,_,v,m,S,y,E,g=this;return t_(this,(function(b){switch(b.label){case 0:return yB.print("join()","info: %o, params: %o, reconnect: %o, controlMessage: %o",e,t,r,i),this._appId=e.appId,this._token=e.token,this._roomId=e.roomId,this._clientId=e.userInfo.userId,this._businessId=e.userInfo.businessId,this._userInfo=e.userInfo,this._useCloudProxy=e.useCloudProxy,this._roomProfile=e.roomProfile,this._sessionId=t.sessionId,[4,this.connect(this._appId,this._roomId,this._clientId,t)];case 1:return b.sent(),[4,null===(n=this._handler)||void 0===n?void 0:n.getDefaultSdp()];case 2:return f=b.sent(),y={Authorization:XD.token2auth(this._appId,this._roomId,this._clientId,this._token),sessionId:this._sessionId||"",timestamp:Date.now(),controlMessage:i,userAttributes:{extra_info:this._userInfo.extraInfo,role:this._userInfo.role}},E={},[4,zV()];case 3:y.params=(E.supportedCodecs=b.sent(),E.deviceType="web",E.userAgent=window.navigator.userAgent,E.sdkVersion=Qx.VERSION,E.deviceId=Cx.getDeviceId(),E.appId=this._appId,E.roomId=this._roomId,E.userId=this._clientId,E.businessId=this._businessId,E.enable_cloud_proxy=this._useCloudProxy,E.channelProfile=SB[this._roomProfile]?SB[this._roomProfile][0]:0,E),y.options={enableUnBundleMode:!0,supportTokenExpireCallBack:!0,enableSceneConfigV2:!0},y.sdpInfo=f,_=y,Promise.resolve().then((function(){return g.emit("onSendingJoinMessageHook")})),b.label=4;case 4:return b.trys.push([4,6,,7]),v=r?"reconnected":"joinRoom",[4,this._dataChannelSignal.sendSignaling(v,_)];case 5:return m=b.sent(),yB.print("join","send join message success"),this._authorization=_.Authorization,this.connectionState=mB.CONNECTED,this._statsReport=new vB(this,this._handler,this.monitor,null===(o=m.config)||void 0===o?void 0:o.engine_WEB),this._pubConfig.audioRed=!!(null===(s=null===(a=m.config)||void 0===a?void 0:a.engine_WEB)||void 0===s?void 0:s.pub_audio_red),this._subConfig.muteReplaceUnsub=!!(null===(c=m.config)||void 0===c?void 0:c.mute_replace_unsub),this._pubConfig.simulcastOnDemand=!!(null===(l=null===(d=null===(u=m.config)||void 0===u?void 0:u.engine_VPM)||void 0===d?void 0:d.ondemand)||void 0===l?void 0:l.enable),null===(h=this._context)||void 0===h||h.audioProfileManager.updateEngineBAC(null===(p=m.config)||void 0===p?void 0:p.engine_BAC),[2,m];case 6:if(S=b.sent(),this.connectionState=mB.DISCONNECTED,(null==S?void 0:S.code)>=700&&(null==S?void 0:S.code)<800)throw new dP(oP.INVALID_TOKEN,(null==S?void 0:S.message)||"Invalid token");if(200!==(null==S?void 0:S.code))throw new dP(oP.JOIN_ROOM_FAILED,(null==S?void 0:S.message)||"Join room failed");return[3,7];case 7:return[2]}}))}))},t.prototype.publish=function(e){var t,r,i,n,o,a;return e_(this,void 0,void 0,(function(){var s,c,u,d,l,h,p,f,_,v,m;return t_(this,(function(S){switch(S.label){case 0:yB.print("publish()","localStream: %o",e),s=e.videoTrack,c=e.audioTrack,u=zD(),d="",l="",h="",S.label=1;case 1:return S.trys.push([1,5,,8]),[4,null===(t=this._handler)||void 0===t?void 0:t.publish(e,this._pubConfig)];case 2:if(!(p=S.sent()))throw new dP(oP.ADD_TRANSCEIVER_FAILED,"add transceiver failed");return d=p.audioMid,l=p.videoMid,h=p.sdp,e.pubAttributes={localaudio:!!c,localvideo:!!s,videostream:e.pubVideo,audiostream:e.pubAudio,extvideo:!!(s instanceof tB),extaudio:!!(c instanceof rB)},f={attributes:Zf({videoDescriptions:p.videoDescriptions},e.pubAttributes),audio:!0,video:!0,screen:e.isScreen,audioMid:d,videoMid:l,sdpInfo:{msid:e.stream.id,type:p.type,sdp:p.partialSdp,semantics:p.semantics}},e.enableSimulcast&&this._pubConfig.simulcastOnDemand&&(f.attributes.subVideoDescriptions=p.subVideoDescriptions),[4,null===(r=this._dataChannelSignal)||void 0===r?void 0:r.sendSignaling("publish",f)];case 3:if(200!==(null==(_=S.sent())?void 0:_.code))throw new dP(oP.PUBLISH_FAILED,(null==_?void 0:_.message)||"publish failed");return v=null===(i=null==_?void 0:_.relayMessage)||void 0===i?void 0:i.sdp,[4,null===(n=this._handler)||void 0===n?void 0:n.setAnswerSdp(p.sdp,v,void 0,e,DL.UP)];case 4:return S.sent(),e.streamId=_.streamId,e.videoMid=l,e.audioMid=d,e.subVideoDescriptions=p.subVideoDescriptions,this.monitor.rtcPublishStat(UL.SUCCESS,LL.W_0,u,xL.UNKNOWN),null===(o=this._statsReport)||void 0===o||o.setLocalStreamStatsEvtInterval(e),[2];case 5:return(m=S.sent())instanceof Error&&this.monitor.rtcPublishStat(UL.FAIL,LL.W_0,u,m.message),d&&l?[4,null===(a=this._handler)||void 0===a?void 0:a.rollback(h,[d,l])]:[3,7];case 6:S.sent(),S.label=7;case 7:throw m;case 8:return[2]}}))}))},t.prototype.updatePubTrack=function(e){var t,r,i,n,o,a;return e_(this,void 0,void 0,(function(){var s,c,u,d,l,h,p,f,_,v,m,S,y,E,g,b,T,I,R,A,C,O,N,w,P,D,k;return t_(this,(function(M){switch(M.label){case 0:yB.print("updatePubTrack()","localStream: %o",e),s=e.videoTrack,c=e.audioTrack,u=e.pubAudio,d=e.pubVideo,l=null==c?void 0:c.getTrack(),h=null==s?void 0:s.getTrack(),d&&h?null===(t=e.videoTransceiver)||void 0===t||t.sender.replaceTrack(h):null===(r=e.videoTransceiver)||void 0===r||r.sender.replaceTrack(null),null===(i=this._handler)||void 0===i||i.updateScaleResolutionDownBy(e),u&&l?(f=(p=c).mixType,(_=p.mixedAudioTrack)&&f!==a_.PLAYOUT&&!0===l.enabled&&(l=_),null===(n=e.audioTransceiver)||void 0===n||n.sender.replaceTrack(l)):null===(o=e.audioTransceiver)||void 0===o||o.sender.replaceTrack(null),v={localaudio:!!c,localvideo:!!s,videostream:d,audiostream:u,extvideo:!!(s instanceof tB),extaudio:!!(c instanceof rB)},m={};try{for(S=r_(Object.entries(v)),y=S.next();!y.done;y=S.next())E=i_(y.value,2),g=E[0],(b=E[1])!==Reflect.get(e.pubAttributes,g)&&Reflect.set(m,g,b)}catch(e){D={error:e}}finally{try{y&&!y.done&&(k=S.return)&&k.call(S)}finally{if(D)throw D.error}}return Object.keys(m).length?(e.observer&&(T=e.observer,I=m.audiostream,R=m.videostream,A=m.localaudio,O=m.extaudio,N=m.extvideo,void 0!==(C=m.localvideo)?void 0!==N?T.setPushVideo(N):T.setEnableVideo(C):void 0!==R&&T.setUnmuteVideo(R),void 0!==A?void 0!==O?T.setPushAudio(O):T.setEnableAudio(A):void 0!==I&&T.setUnmuteAudio(I)),e.pubAttributes=v,w={roomId:this._roomId,streamId:e.streamId,attributes:m},[4,null===(a=this._dataChannelSignal)||void 0===a?void 0:a.sendSignaling("updateStreamAttributes",w)]):[2];case 1:if(200!==(null==(P=M.sent())?void 0:P.code))throw new dP(oP.UPDATE_TRACK_FAILED,(null==P?void 0:P.message)||"update track failed");return[2]}}))}))},t.prototype.updateToken=function(e){var t,r,i;return e_(this,void 0,void 0,(function(){var n,o;return t_(this,(function(a){switch(a.label){case 0:if(yB.print("updateToken()","newToken: %o",e),this._token=e,!this._appId||!(null===(t=this._userInfo)||void 0===t?void 0:t.userId)||!this._roomId)return[2];n={roomId:this._roomId,userId:null===(r=this._userInfo)||void 0===r?void 0:r.userId,appId:this._appId,token:"Bearer ".concat(e)},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null===(i=this._dataChannelSignal)||void 0===i?void 0:i.sendSignaling("updateToken",n)];case 2:if(200!==(null==(o=a.sent())?void 0:o.code))throw new dP(oP.UPDATE_TOKEN_WITH_INVALID_TOKEN,"invoke updateToken with an invalid token");return[3,4];case 3:throw a.sent(),new dP(oP.UPDATE_TOKEN_WITH_INVALID_TOKEN,"invoke updateToken with an invalid token");case 4:return[2]}}))}))},t.prototype.unpublish=function(e){var t,r,i;return e_(this,void 0,void 0,(function(){var n,o;return t_(this,(function(a){switch(a.label){case 0:return yB.print("unpublish()","localStream: %o",e),n={roomId:this._roomId,initStreamId:e.initStreamId,streamId:e.streamId},[4,null===(t=this._dataChannelSignal)||void 0===t?void 0:t.sendSignaling("unpublish",n)];case 1:if(200!==(null==(o=a.sent())?void 0:o.code))throw new dP(oP.UNPUBLISH_FAILED,(null==o?void 0:o.message)||"unpublish failed");return[4,null===(r=this._handler)||void 0===r?void 0:r.closeMLine([e.videoMid||"",e.audioMid||""])];case 2:return a.sent(),null===(i=this._statsReport)||void 0===i||i.unpublish(e),[2]}}))}))},t.prototype.subscribe=function(e,t,r){var i,n,o,a,s,c,u,d,l;return e_(this,void 0,void 0,(function(){var h,p,f,_,v,m,S,y,E,g,b,T,I,R,A,C,O,N,w,P;return t_(this,(function(D){switch(D.label){case 0:if(e.hasSubscribed)return[2,this._updateSubTrack(e,t,hB.SUB)];if(yB.print("subscribe()","mediaType: %o",t),gB("subscribe()",e),h=!1,p=!1,tk(t)&&(p=!0),rk(t)&&(h=!0),!h&&this._multiChatMode())return[2];f=zD(),_=e.audioMid,v=e.videoMid,S=!1,D.label=1;case 1:return D.trys.push([1,12,,15]),_&&v?(S=!0,[4,null===(i=this._handler)||void 0===i?void 0:i.subscribe(e,{audioMid:_,videoMid:v})]):[3,3];case 2:return m=D.sent(),[3,5];case 3:return[4,null===(n=this._handler)||void 0===n?void 0:n.subscribe(e)];case 4:if(!(m=D.sent()))throw new dP(oP.ADD_TRANSCEIVER_FAILED,"add transceiver failed");_=m.audioMid,v=m.videoMid,D.label=5;case 5:return y={audio:!this._multiChatMode(),video:!0,data:!0,screen:e.isScreen,browser:"chrome-stable",videoMid:v,audioMid:_,sdpInfo:{sdp:null==m?void 0:m.partialSdp,semantics:null==m?void 0:m.semantics,type:null==m?void 0:m.type},streamUserId:e.userId,streamId:e.streamId,config:{enableMediaType:{audio:!!this._multiChatMode()||p,video:h},qualityLayer:{spatialLayer:(null==r?void 0:r.spatialLayer)||0,temporalLayer:0,spatialSubLayer:(null==r?void 0:r.spatialSubLayer)||-1}}},[4,null===(o=this._dataChannelSignal)||void 0===o?void 0:o.sendSignaling("subscribe",y)];case 6:if(200!==(null==(E=D.sent())?void 0:E.code))throw new dP(oP.SUBSCRIBE_FAILED,(null==E?void 0:E.message)||"subscribe failed");return g=[],b=!this._multiChatMode(),!(e.audioMid&&e.videoMid)&&g.push(new Promise((function(t,r){var i=setTimeout((function(){return r(new dP(oP.TIME_OUT,"wait video timeout for userId: ".concat(e.userId)))}),EB);e.on("ontrack",(function r(n){"video"===n.mediaType&&(yB.print("remoteStream ".concat(e.userId," received video track")),e.off("ontrack",r),clearTimeout(i),t(0))}))}))),b&&g.push(new Promise((function(t,r){var i=setTimeout((function(){return r(new dP(oP.TIME_OUT,"wait audio timeout for userId: ".concat(e.userId)))}),EB);e.on("ontrack",(function r(n){"audio"===n.mediaType&&(yB.print("remoteStream ".concat(e.userId," received audio track")),e.off("ontrack",r),clearTimeout(i),t(0))}))}))),T=function(t){e.ontrack(t)},null===(a=this._handler)||void 0===a||a.on("ontrack",T),this._ontrackCallbackMap.set(e,T),I=null==E?void 0:E.relayMessage,R=I.audioMid,A=I.videoMid,C=I.sequenceId,O=I.sdp,S&&_!==R?(yB.print("subscribe","mid mot match",_,R),[4,null===(s=this._handler)||void 0===s?void 0:s.closeMLine([_,v])]):[3,9];case 7:return D.sent(),[4,null===(c=this._handler)||void 0===c?void 0:c.subscribe(e)];case 8:if(!(m=D.sent()))throw new dP(oP.ADD_TRANSCEIVER_FAILED,"add transceiver failed");_=m.audioMid,v=m.videoMid,D.label=9;case 9:return(P={})[_]=R,P[v]=A,N=P,e.videoMid=A,e.audioMid=R,e.sequenceId=C,e._workaround_1_=!1,e.paused=!1,e.subMediaType=t,e.hasSubscribed=!0,[4,null===(u=this._handler)||void 0===u?void 0:u.setAnswerSdp(null==m?void 0:m.sdp,O,N,e,DL.DOWN)];case 10:return D.sent(),[4,Promise.all(g)];case 11:return D.sent(),this._multiChatMode()||(e.subAudio=p),e.subVideo=h,this.monitor.rtcSubscribeStat(VL.SUCCESS,f,FL.UNKNOWN,e.userId),null===(d=this._statsReport)||void 0===d||d.setRemoteStreamStatsEvtInterval(e),[2];case 12:return(w=D.sent())instanceof Error&&this.monitor.rtcSubscribeStat(VL.FAIL,f,w.message,e.userId),_&&v?[4,null===(l=this._handler)||void 0===l?void 0:l.rollback(null==m?void 0:m.sdp,[_,v])]:[3,14];case 13:D.sent(),D.label=14;case 14:throw w;case 15:return[2]}}))}))},t.prototype.controlMessage=function(e){var t;return e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:return yB.print("controlMessage()","params: %o",e),r=e,"transcode"===e.type&&(r.roomId=this._roomId),[4,null===(t=this._dataChannelSignal)||void 0===t?void 0:t.sendSignaling("controlMessage",r)];case 1:return i.sent(),[2]}}))}))},t.prototype.updateUserAttributes=function(e){var t;return e_(this,void 0,void 0,(function(){return t_(this,(function(r){switch(r.label){case 0:return yB.print("updateUserAttributes()","attributes: %o",e),[4,null===(t=this._dataChannelSignal)||void 0===t?void 0:t.sendSignaling("updateUserAttributes",{roomId:this._roomId,sessionId:this._sessionId,attributes:e})];case 1:return r.sent(),[2]}}))}))},t.prototype.updateSubTrack=function(e,t,r,i){return e_(this,void 0,void 0,(function(){return t_(this,(function(n){return[2,this._updateSubTrack(e,t,r,i||e.subLayer)]}))}))},t.prototype._updateSubTrack=function(e,t,r,i){var n,o,a,s,c;return void 0===i&&(i={spatialLayer:0,spatialSubLayer:-1}),e_(this,void 0,void 0,(function(){var u,d,l,h,p;return t_(this,(function(f){switch(f.label){case 0:return yB.print("updateSubTrack()","mediaType: %o, subLayer: %o",t,i),gB("updateSubTrack()",e),u=0,u=r===hB.SUB?e.subMediaType|t:e.subMediaType-(e.subMediaType&t),yB.print("updateSubTrack","prev: %o, direction: %o, mediaType: %o, newMediaType: %o",e.subMediaType,r,t,u),e.subMediaType===u&&yB.print("updateSubTrack","mediaType no change"),d=!1,l=!1,tk(u)&&(l=!0),rk(u)&&(d=!0),h={roomId:this._roomId,streamList:[e.streamId],config:{enableMediaType:{video:d,audio:!!this._multiChatMode()||l},qualityLayer:{spatialLayer:null!==(n=i.spatialLayer)&&void 0!==n?n:0,temporalLayer:0,spatialSubLayer:null!==(o=i.spatialSubLayer)&&void 0!==o?o:-1}}},[4,null===(a=this._dataChannelSignal)||void 0===a?void 0:a.sendSignaling("updateSubscribe",h)];case 1:if(200!==(null==(p=f.sent())?void 0:p.code))throw new dP(oP.UPDATE_TRACK_FAILED,(null==p?void 0:p.message)||"update track failed");return e.paused=!d,this._multiChatMode()||(null===(s=e.observer)||void 0===s||s.setUnmuteAudio(l),e.subAudio=l),null===(c=e.observer)||void 0===c||c.setUnmuteVideo(d),e.subVideo=d,e.subMediaType=u,e.subLayer=i,[2,e]}}))}))},t.prototype.subscribe4pushTrack=function(e,t){var r,i,n,o,a,s;return e_(this,void 0,void 0,(function(){var c,u,d,l,h,p,f,_,v,m,S,y,E;return t_(this,(function(g){switch(g.label){case 0:if(yB.print("subscribe4pushTrack()","streamInfo: %o",t),gB("subscribe4pushTrack()",e),c=null==t?void 0:t.message,u=c.audioMid,d=c.videoMid,l=c.sequenceId,h=c.sdp,e.subAudio=!0,l<e.sequenceId)return yB.print("subscribe4pushTrack","sequenceId return",l,e.sequenceId),[2];p=e.audioMid,f=e.videoMid,null===(r=e.observer)||void 0===r||r.setPushTrack(!0),g.label=1;case 1:return g.trys.push([1,8,,11]),p&&f?[4,null===(i=this._handler)||void 0===i?void 0:i.subscribe(e,{audioMid:p,videoMid:f})]:[3,3];case 2:return _=g.sent(),[3,5];case 3:return[4,null===(n=this._handler)||void 0===n?void 0:n.subscribe(e)];case 4:if(!(_=g.sent()))throw new dP(oP.ADD_TRANSCEIVER_FAILED,"add transceiver failed");p=_.audioMid,f=_.videoMid,g.label=5;case 5:return(E={})[p]=u,E[f]=d,v=E,yB.print("onpushtrack midmap",e.userId,v),e.audioMid=u,e.videoMid=d,e.sequenceId=l,m=[],e.audioTrack||m.push(new Promise((function(t,r){var i=setTimeout((function(){return r(new dP(oP.TIME_OUT,"wait audio timeout for userId: ".concat(e.userId)))}),EB);e.on("ontrack",(function r(n){"audio"===n.mediaType&&(yB.print("remoteStream ".concat(e.userId," received audio track")),e.off("ontrack",r),clearTimeout(i),t(0))}))}))),S=function(t){e.ontrack(t)},null===(o=this._handler)||void 0===o||o.on("ontrack",S),this._ontrackCallbackMap.set(e,S),[4,null===(a=this._handler)||void 0===a?void 0:a.setAnswerSdp(null==_?void 0:_.sdp,h,v,e,DL.DOWN)];case 6:return g.sent(),[4,Promise.all(m)];case 7:return g.sent(),[2];case 8:return y=g.sent(),_?[4,null===(s=this._handler)||void 0===s?void 0:s.rollback(null==_?void 0:_.sdp,[p,f])]:[3,10];case 9:g.sent(),g.label=10;case 10:throw y;case 11:return[2]}}))}))},t.prototype.unsubscribe4removeTrack=function(e,t){var r,i;return e_(this,void 0,void 0,(function(){return t_(this,(function(n){switch(n.label){case 0:return gB("unsubscribe4removeTrack()",e),yB.print("unsubscribe4removeTrack()","sequenceId: ",t.sequenceId),t.sequenceId<e.sequenceId?(yB.print("unsubscribe4removeTrack()","sequenceId return"),[2]):(e.subAudio=!1,e.subVideo||e.paused?(e.sequenceId=t.sequenceId,[2]):(null===(r=e.observer)||void 0===r||r.setPushTrack(!1),[4,null===(i=this._handler)||void 0===i?void 0:i.closeMLine([e.videoMid||"",e.audioMid||""])]));case 1:return n.sent(),yB.print("clean unsubscribe4removeTrack"),e.clean(),e.resetHasSubscribed(),[2]}}))}))},t.prototype.unsubscribe=function(e,t,r){var i,n,o,a,s;return void 0===r&&(r=!1),e_(this,void 0,void 0,(function(){var c,u;return t_(this,(function(d){switch(d.label){case 0:if(gB("unsubscribe()",e),c=e.subMediaType-(e.subMediaType&t),!r&&(this._subConfig.muteReplaceUnsub||c!==aB.NONE))return[2,this._updateSubTrack(e,t,hB.UNSUB)];u={roomId:this._roomId,streamId:e.streamId,userId:e.userId},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,null===(i=this._dataChannelSignal)||void 0===i?void 0:i.sendSignaling("unsubscribe",u)];case 2:case 3:return d.sent(),[3,4];case 4:return e.hasSubscribed=!1,e.subVideo=!1,e.paused=!1,e._workaround_1_||(e.subAudio=!1),null===(n=e.observer)||void 0===n||n.setSubscribeVideo(!1),e.subAudio?[3,6]:(null===(o=e.observer)||void 0===o||o.setSubscribeAudio(!1),[4,null===(a=this._handler)||void 0===a?void 0:a.closeMLine([e.videoMid||"",e.audioMid||""])]);case 5:d.sent(),yB.print("unsubscribe","clean unsub ".concat(e.userId)),e.clean(),e.resetHasSubscribed(),this.removeOnTrackListener(e),null===(s=this._statsReport)||void 0===s||s.unsubscribe(e),d.label=6;case 6:return[2]}}))}))},t.prototype.removeOnTrackListener=function(e){var t,r=this._ontrackCallbackMap.get(e);r&&(null===(t=this._handler)||void 0===t||t.off("ontrack",r),this._ontrackCallbackMap.delete(e))},t.prototype.handleRemoveStream=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return gB("handleRemoveStream()",e),e.subVideo=!1,t.message&&t.message!==xx.videoMuted?e._workaround_1_=!1:e._workaround_1_=!0,this.unsubscribe(e,Vf.AUDIO_AND_VIDEO,!0),[2]}))}))},t.prototype.leave=function(){var e;return e_(this,void 0,void 0,(function(){var t,r,i;return t_(this,(function(n){switch(n.label){case 0:return yB.print("leave()"),this.connectionState!==mB.CONNECTED?[3,7]:(this.connectionState=mB.DISCONNECTING,t={Authorization:this._authorization,roomId:this._roomId,sessionId:this._sessionId},[4,this._joinLeaveLock.lock()]);case 1:r=n.sent(),n.label=2;case 2:return n.trys.push([2,4,5,6]),[4,null===(e=this._dataChannelSignal)||void 0===e?void 0:e.sendSignaling("leaveRoom",t)];case 3:return n.sent(),this.connectionState=mB.DISCONNECTED,[3,6];case 4:throw i=n.sent(),this.connectionState=mB.CONNECTED,i;case 5:return r(),[7];case 6:return[3,8];case 7:return[2,Promise.reject(new dP(oP.NOT_CONNECTED_YET,"server not connected"))];case 8:return[2]}}))}))},t.prototype.subscribePublicStream=function(e){var t,r,i,n,o;return e_(this,void 0,void 0,(function(){var a,s,c,u,d,l,h,p,f,_,v,m,S;return t_(this,(function(y){switch(y.label){case 0:return[4,null===(t=this._handler)||void 0===t?void 0:t.subscribe(e)];case 1:if(!(a=y.sent()))throw new dP(oP.ADD_TRANSCEIVER_FAILED,"add transceiver failed");return s=zD(),c=a.audioMid,u=a.videoMid,d={appId:this._appId,streamId:e.streamId,audio:!0,video:!0,data:!0,audioMid:c,videoMid:u,sdpInfo:{sdp:null==a?void 0:a.partialSdp,semantics:null==a?void 0:a.semantics,type:null==a?void 0:a.type},config:{enableMediaType:{audio:!0,video:!0},qualityLayer:{spatialLayer:0,temporalLayer:0}}},[4,null===(r=this._dataChannelSignal)||void 0===r?void 0:r.sendSignaling("startPullStream",d)];case 2:return l=y.sent(),(h=[]).push(new Promise((function(t,r){var i=setTimeout((function(){return r(new dP(oP.TIME_OUT,"wait video timeout for streamId: ".concat(e.streamId)))}),EB);e.on("ontrack",(function r(n){"video"===n.mediaType&&(yB.print("remoteStream ".concat(e.userId," received video track")),e.off("ontrack",r),clearTimeout(i),t(0))}))}))),h.push(new Promise((function(t,r){var i=setTimeout((function(){return r(new dP(oP.TIME_OUT,"wait audio timeout for streamId: ".concat(e.streamId)))}),EB);e.on("ontrack",(function r(n){"audio"===n.mediaType&&(yB.print("remoteStream ".concat(e.userId," received audio track")),e.off("ontrack",r),clearTimeout(i),t(0))}))}))),p=function(t){e.ontrack(t)},null===(i=this._handler)||void 0===i||i.on("ontrack",p),this._ontrackCallbackMap.set(e,p),f=null==l?void 0:l.relayMessage,_=f.audioMid,v=f.videoMid,m=f.sequenceId,S=f.sdp,e.videoMid=v,e.audioMid=_,e.sequenceId=m,e._workaround_1_=!1,e.paused=!1,e.hasSubscribed=!0,e.subAudio=!0,e.subVideo=!0,[4,null===(n=this._handler)||void 0===n?void 0:n.setAnswerSdp(null==a?void 0:a.sdp,S,{},e,DL.DOWN)];case 3:return y.sent(),[4,Promise.all(h)];case 4:return y.sent(),this.monitor.rtcSubscribeStat(VL.SUCCESS,s,FL.UNKNOWN,e.userId),this._statsReport||(this._statsReport=new vB(this,this._handler,this.monitor)),null===(o=this._statsReport)||void 0===o||o.setRemoteStreamStatsEvtInterval(e,{rtt:!1}),[2]}}))}))},t.prototype.unsubscribePublicStream=function(e){var t,r,i;return e_(this,void 0,void 0,(function(){var n;return t_(this,(function(o){switch(o.label){case 0:gB("unsubscribePublicStream()",e),n={appId:this._appId,streamId:e.streamId},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,null===(t=this._dataChannelSignal)||void 0===t?void 0:t.sendSignaling("stopPullStream",n)];case 2:case 3:return o.sent(),[3,4];case 4:return e.hasSubscribed=!1,e.subVideo=!1,e.subAudio=!1,[4,null===(r=this._handler)||void 0===r?void 0:r.closeMLine([e.videoMid||"",e.audioMid||""])];case 5:return o.sent(),e.clean(),e.resetHasSubscribed(),this.removeOnTrackListener(e),null===(i=this._statsReport)||void 0===i||i.unsubscribe(e),[2]}}))}))},t.prototype.destroy=function(){var e,t,r,i;yB.print("destroy()"),this._token=void 0,this._appId=void 0,this._roomId=void 0,this._clientId=void 0,this._authorization=void 0,this._sessionId=void 0,this._context=void 0,null===(e=this._handler)||void 0===e||e.destroy(),null===(t=this._dataChannelSignal)||void 0===t||t.destroy(),null===(r=this._iceConfigRequestManager)||void 0===r||r.abort(),this._handler=void 0,this._dataChannelSignal=void 0,this._iceConfigRequestManager=void 0,this._removeSignalEventHandler(),null===(i=this._statsReport)||void 0===i||i.destroy(),this.connectionState=mB.DISCONNECTED,this.emit("INTERRUPT")},t.prototype.sendUserMessage=function(e,t){var r;return null===(r=this._dataChannelSignal)||void 0===r?void 0:r.sendP2PMessage({to:e,from:this._userInfo.userId,room:this._roomId,app:this._appId,msg:t})},t.prototype.sendRoomMessage=function(e){var t;return null===(t=this._dataChannelSignal)||void 0===t?void 0:t.sendSignaling("customMessage",e)},t.prototype._multiChatMode=function(){var e;return null===(e=this._roomAttributes)||void 0===e?void 0:e.multiChatMode},Object.defineProperty(t.prototype,"handler",{get:function(){return this._handler},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roomAttributes",{get:function(){return this._roomAttributes},set:function(e){this._roomAttributes=e},enumerable:!1,configurable:!0}),$f([RB],t.prototype,"join",null),$f([IB,TB],t.prototype,"publish",null),$f([IB,TB],t.prototype,"updatePubTrack",null),$f([IB,TB],t.prototype,"unpublish",null),$f([IB,TB],t.prototype,"subscribe",null),$f([TB],t.prototype,"controlMessage",null),$f([TB],t.prototype,"updateUserAttributes",null),$f([IB,TB],t.prototype,"updateSubTrack",null),$f([IB,TB],t.prototype,"subscribe4pushTrack",null),$f([IB,TB],t.prototype,"unsubscribe4removeTrack",null),$f([IB,TB],t.prototype,"unsubscribe",null),$f([IB,TB],t.prototype,"handleRemoveStream",null),$f([IB],t.prototype,"subscribePublicStream",null),$f([IB],t.prototype,"unsubscribePublicStream",null),t}(Tk);function TB(e,t,r){var i=r.value;return r.value=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e_(this,void 0,void 0,(function(){return t_(this,(function(r){switch(r.label){case 0:return this._handler&&this._state===mB.CONNECTED?[4,i.apply(this,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:throw new dP(oP.NOT_CONNECTED_YET,"error in ".concat(t,": try again after joined"));case 3:return[2]}}))}))},r}function IB(e,t,r){var i=r.value;return r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e_(this,void 0,void 0,(function(){var t;return t_(this,(function(r){switch(r.label){case 0:return[4,this._pubSubLock.lock()];case 1:t=r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,i.apply(this,e)];case 3:return[2,r.sent()];case 4:return t(),[7];case 5:return[2]}}))}))},r}function RB(e,t,r){var i=r.value;return r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e_(this,void 0,void 0,(function(){var t,r=this;return t_(this,(function(n){return t=!1,[2,new Promise((function(n,o){return e_(r,void 0,void 0,(function(){var r,a;return t_(this,(function(s){switch(s.label){case 0:this.on("INTERRUPT",(function(){t=!0,o(new dP(oP.OPERATION_CANCEL,"operation not finish when leave"))})),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,i.apply(this,e)];case 2:return r=s.sent(),n(r),[3,4];case 3:return a=s.sent(),t||o(a),[3,4];case 4:return[2]}}))}))}))]}))}))},r}var AB,CB,OB=function(){function e(){}return e.getNalunits=function(t){if(t.length-t.position<4)return[];var r=t.position;return 1===t.getInt32(r)||0===t.getInt16(r)&&1===t.getInt8(r+2)?e.getAnnexbNals(t):e.getAvccNals(t)},e.getAnnexbNals=function(t){for(var r=[],i=e.getHeaderPositionAnnexB(t),n=i.pos,o=n;n<t.length-4;){var a=new Uint8Array(t.buffer.slice(n,n+i.headerLength));i.pos===t.position&&t.skip(i.headerLength),o=(i=e.getHeaderPositionAnnexB(t)).pos;var s={header:a,body:new Uint8Array(t.buffer.slice(n+a.byteLength,o)),type:-1};e.analyseNal(s),s.type<=9&&0!==s.type&&r.push(s),t.skip(o-t.position),n=o}return r},e.getAvccNals=function(t){for(var r=[];t.position<t.length-4;){var i=t.getInt32(t.position);if(!(t.length-t.position>=i))break;var n=new Uint8Array(t.buffer.slice(t.position,t.position+4));t.skip(4);var o=new Uint8Array(t.buffer.slice(t.position,t.position+i));t.skip(i);var a={header:n,body:o,type:-1};e.analyseNal(a),a.type<=9&&0!==a.type&&r.push(a)}return r},e.analyseNal=function(e){var t=31&e.body[0];switch(e.type=t,t){case 1:e.ndr=!0;break;case 5:e.idr=!0;break;case 6:e.sei=!0;break;case 7:e.sps=!0;break;case 8:e.pps=!0}},e.getHeaderPositionAnnexB=function(e){for(var t=e.position,r=0,i=e.length;3!==r&&4!==r&&t<i-4;)0===e.getInt16(t)?1===e.getInt16(t+2)?r=4:1===e.getInt8(t+2)?r=3:t++:t++;return t===i-4&&(0===e.getInt16(t)?1===e.getInt16(t+2)?r=4:t=i:(t++,0===e.getInt16(t)&&1===e.getInt8(t)?r=3:t=i)),{pos:t,headerLength:r}},e.getAvcc=function(e,t){var r=new Uint8Array(e.byteLength+t.byteLength+11);r[0]=1,r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=255,r[5]=225;var i=6;return r.set(new Uint8Array([e.byteLength>>>8&255,255&e.byteLength]),i),i+=2,r.set(e,i),r[i+=e.byteLength]=1,i++,r.set(new Uint8Array([t.byteLength>>>8&255,255&t.byteLength]),i),i+=2,r.set(t,i),r},e}(),NB=function(){function e(e){this._position=0,this._dataview=new DataView(e)}return Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.byteLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._dataview.buffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e},enumerable:!1,configurable:!0}),e.prototype.back=function(e){this.position-=e},e.prototype.getUint8=function(e){return this._dataview.getUint8(e)},e.prototype.getInt8=function(e){return this._dataview.getInt8(e)},e.prototype.getInt16=function(e){return this._dataview.getInt16(e)},e.prototype.getUint16=function(e){return this._dataview.getUint16(e)},e.prototype.getUint32=function(e){return this._dataview.getUint32(e)},e.prototype.getInt32=function(e){return this._dataview.getInt32(e)},e.prototype.skip=function(t){for(var r=Math.floor(t/4),i=t%4,n=0;n<r;n++)e.readByte(this,4);i>0&&e.readByte(this,i)},e.readByte=function(e,t,r){var i;switch(t){case 1:i=r?e.getInt8(e.position):e.getUint8(e.position);break;case 2:i=r?e.getInt16(e.position):e.getUint16(e.position);break;case 3:if(r)throw new Error("not supported for readByte 3");i=e.getUint8(e.position)<<16,i|=e.getUint8(e.position+1)<<8,i|=e.getUint8(e.position+2);break;case 4:i=r?e.getInt32(e.position):e.getUint32(e.position);break;case 8:if(r)throw new Error("not supported for readBody 8");i=e.getUint32(e.position)<<32,i|=e.getUint32(e.position+4);break;default:i=""}return e.position+=t,i},e.prototype.readUint8=function(){return e.readByte(this,1)},e.prototype.readUint16=function(){return e.readByte(this,2)},e.prototype.readUint24=function(){return e.readByte(this,3)},e.prototype.readUint32=function(){return e.readByte(this,4)},e.prototype.readUint64=function(){return e.readByte(this,8)},e.prototype.readInt8=function(){return e.readByte(this,1,!0)},e.prototype.readInt16=function(){return e.readByte(this,2,!0)},e.prototype.readInt32=function(){return e.readByte(this,4,!0)},e.prototype.writeUint32=function(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])},e}();!function(e){e[e.internal=0]="internal",e[e.external=1]="external",e[e.bypass=2]="bypass"}(AB||(AB={})),function(e){e[e.invalid=0]="invalid",e[e.cfgResolution=1]="cfgResolution",e[e.bitstreamHash=2]="bitstreamHash",e[e.screenCodec=3]="screenCodec"}(CB||(CB={}));var wB=new Uint8Array([109,167,53,190,103,90,72,1,170,89,63,164,194,199,19,85]),PB=new Uint8Array([109,167,53,190,103,90,72,1,170,89,63,164,194,199,19,84]);function DB(e){for(var t=[];e>=255;)e-=255,t.push(255);return t.push(e),new Uint8Array(t)}function kB(e,t){void 0===t&&(t=0);for(var r=0;255===e[t]&&t<e.byteLength;)t++,r+=255;return t<e.byteLength&&(r+=e[t++]),[r,t]}var MB,UB=function(){function e(){}return e.generateSEI=function(e,t){void 0===t&&(t=!1);var r=new Uint8Array([0,0,0,1]),i=new Uint8Array([6]),n=new Uint8Array([5]),o=t?wB:PB,a=DB(e.byteLength+o.byteLength),s=function(e){for(var t=[],r=0;r<e.length;r++)e[r]<=3&&0===e[r-1]&&0===e[r-2]&&t.push(3),t.push(e[r]);return new Uint8Array(t)}(e);return new Uint8Array(n_(n_(n_(n_(n_(n_(n_([],i_(r),!1),i_(i),!1),i_(n),!1),i_(a),!1),i_(o),!1),i_(s),!1),[128],!1))},e.decodeSeiBody=function(e){var t=function(e){for(var t=[],r=0;r<e.length;r++)e[r]<=3&&0===e[r-1]&&0===e[r-2]||t.push(e[r]);return new Uint8Array(t)}(e=e.slice(0,e.length-1));if(!(t.byteLength<2)){var r=0;if(5===t[1]||100===t[1]){var i=i_(kB(t,r+=2),2),n=i[0];r=i[1];var o=AB.bypass,a=r+n;return t.byteLength>=PB.byteLength&&n>=PB.byteLength&&t.slice(r,r+PB.byteLength).toString()===PB.toString()?(r+=PB.byteLength,o=AB.external):t.byteLength>=PB.byteLength&&n>=PB.byteLength&&t.slice(r,r+wB.byteLength).toString()===wB.toString()&&(r+=wB.byteLength,o=AB.internal),{type:o,payload:t.slice(r,a)}}}},e.parseInternalSEI=function(e){var t=new Map,r=0;if(e.type===AB.internal){for(;e.payload.byteLength-r>=2;){var i=i_(kB(e.payload,r),2),n=i[0];r=i[1];var o=i_(kB(e.payload,r),2),a=o[0];if(r=o[1],t.get(n)||!(a<e.payload.byteLength-r))break;t.set(n,e.payload.slice(r,r+a))}return t}},e.makeInternalSei=function(e){var t,r,i=[];try{for(var n=r_(e),o=n.next();!o.done;o=n.next()){var a=i_(o.value,2),s=a[0],c=a[1],u=DB(s),d=DB(c.byteLength);i.push(u,d,c)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}var l=i.reduce((function(e,t){return e+t.byteLength}),0),h=new Uint8Array(l);return i.reduce((function(e,t){return h.set(t,e),e+t.byteLength}),0),h},e}(),LB=new gk("Stream",0),xB=function(){function e(){this.isScreen=!1,this.seiList=[],this.subVideoDescriptions=[],this.enableSimulcast=!1,this.prevScaleResolutionDownBy=1,this.pubAudio=!1,this.pubVideo=!1,this.stream=new MediaStream,this.videoInputConfig={width:640,height:360,frameRate:30},this.pubAttributes={localaudio:!1,localvideo:!1,videostream:!1,audiostream:!1,extvideo:!1,extaudio:!1}}return Object.defineProperty(e.prototype,"hasPublished",{get:function(){return this.videoTransceiver&&this.audioTransceiver},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEmptyStream",{get:function(){return!this.audioTrack&&!this.videoTrack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initStreamId",{get:function(){return this.stream.id},enumerable:!1,configurable:!0}),e.prototype.initVideoEncodedTransform=function(){var e=this;if(this.videoTransceiver&&this.videoTransceiver.sender){var t=this.videoTransceiver.sender;if(KV()){var r=t.createEncodedStreams(),i=r.readable,n=r.writable,o=new TransformStream({transform:function(t,r){var i=e.seiList[0];if(i){var n=UB.generateSEI(i.content),o=new Uint8Array(n.byteLength+t.data.byteLength);0===i.repeatCount&&e.seiList.splice(0,1),i.repeatCount--,o.set(new Uint8Array(t.data)),o.set(n,t.data.byteLength),t.data=o.buffer,r.enqueue(t)}else r.enqueue(t)}});i.pipeThrough(o).pipeTo(n)}}else LB.print("no sender found when trying to bind encodedTransform")},e.prototype.initAudioEncodedTransform=function(){if(this.audioTransceiver&&this.audioTransceiver.sender){var e=this.audioTransceiver.sender.createEncodedStreams(),t=e.readable,r=e.writable;t.pipeThrough(new TransformStream({transform:function(e,t){t.enqueue(e)}})).pipeTo(r)}else LB.print("no sender found when trying to bind encodedTransform")},e.prototype.clean=function(){var e;this.audioMid=void 0,this.videoMid=void 0,this.videoTransceiver=void 0,this.audioTransceiver=void 0,null===(e=this.observer)||void 0===e||e.reset(),this.prevScaleResolutionDownBy=1,this.subVideoDescriptions=[]},e.prototype.switchTrackEnableState=function(e,t){var r;"audio"===e?r=this.audioTrack:"video"===e&&(r=this.videoTrack);var i=null==r?void 0:r.getTrack();return!(!i||(null==i?void 0:i.enabled)===t)&&(i.enabled=t,!0)},e}(),VB=function(e){function t(t,r,i,n,o){void 0===o&&(o=Xf.LOW);var a=e.call(this)||this;return a.userPriority=o,a.originalStreamIndex=0,a.userId=t,a.isScreen=i,a.streamId=r,a.hasAudio=n.audiostream&&n.localaudio,a.hasVideo=n.videostream&&n.localvideo,a._attributes=n,a.subVideo=!1,a.subAudio=!1,a._sequenceId=0,a.subMediaType=aB.NONE,a.subLayer={spatialLayer:0,spatialSubLayer:-1},a.hasSubscribed=!1,a}return Cf(t,e),Object.defineProperty(t.prototype,"sequenceId",{get:function(){return this._sequenceId||-1},set:function(e){"number"==typeof e&&(this._sequenceId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this._attributes},set:function(e){this.hasVideo=e.localvideo&&e.videostream,this.hasAudio=e.localaudio&&e.audiostream,this._attributes=e},enumerable:!1,configurable:!0}),t.prototype.initVideoEncodedTransform=function(){var e=this;if(this.videoTransceiver&&this.videoTransceiver.receiver){var t=this.videoTransceiver.receiver.createEncodedStreams(),r=t.readable,i=t.writable;r.pipeThrough(new TransformStream({transform:function(t,r){var i=OB.getNalunits(new NB(t.data)).find((function(e){return e.sei}));if(i){var n=UB.decodeSeiBody(i.body);n&&n.type!==AB.internal&&e.safeEmit("onSEIMessage",n.payload)}r.enqueue(t)}})).pipeTo(i)}else LB.print("no receiver found when trying to bind encodedTransform")},t.prototype.initAudioEncodedTransform=function(){if(this.audioTransceiver&&this.audioTransceiver.receiver){var e=this.audioTransceiver.receiver.createEncodedStreams(),t=e.readable,r=e.writable;t.pipeThrough(new TransformStream({transform:function(e,t){t.enqueue(e)}})).pipeTo(r)}else LB.print("no receiver found when trying to bind encodedTransform")},t.prototype.ontrack=function(e){var t,r,i;if((null===(r=null===(t=e.streams)||void 0===t?void 0:t[0])||void 0===r?void 0:r.id)===this.streamId){var n=e.track;"video"===(null==n?void 0:n.kind)?this._setVideoTrack(n):"audio"===(null===(i=e.track)||void 0===i?void 0:i.kind)&&this._setAudioTrack(n),this._setStream(e.streams[0])}this.safeEmit("ontrack",e)},t.prototype.clean=function(){var e;LB.print("clean","exec stream.clean ".concat(this.streamId," ").concat(this.userId)),this.subAudio=!1,this.subVideo=!1,this.audioMid=void 0,this.videoMid=void 0,this.sequenceId=0,this.videoTrack=void 0,this.audioTrack=void 0,this.stream=void 0,this.videoTransceiver=void 0,this.audioTransceiver=void 0,this.recordedVideoFrames=void 0,this.paused=!1,this._workaround_1_=!1,null===(e=this.observer)||void 0===e||e.reset()},t.prototype.resetHasSubscribed=function(){this.hasSubscribed=!1},t.prototype.setRemoteUserPriority=function(e){this.userPriority=e},t.prototype.getStreamPriority=function(){var e=this.isScreen?20:this.hasAudio||this.hasVideo?this.attributes.videoDescriptions.length>1?10-this.subLayer.spatialLayer:9:0;return 1e4*this.userPriority+100*e},t.prototype.getSubscribeFallbackParams=function(e){if(e!==Wf.DISABLE&&this.subVideo){if(this.attributes.videoDescriptions.length-1>this.subLayer.spatialLayer)return[this.originalMediaType,hB.SUB,this._getSubLayerBySpatialLayer(this.subLayer.spatialLayer+1)];if(e===Wf.AUDIO_ONLY)return[Vf.VIDEO,hB.UNSUB]}return null},t.prototype.getSubscribeRecoverParams=function(){if(this.originalMediaType&&rk(this.originalMediaType)){if(!1===this.subVideo)return[this.originalMediaType,hB.SUB,this.subLayer];if("number"==typeof this.originalStreamIndex&&this.subLayer.spatialLayer>this.originalStreamIndex)return[this.originalMediaType,hB.SUB,this._getSubLayerBySpatialLayer(this.subLayer.spatialLayer-1)]}return null},t.prototype._setStream=function(e){var t=this;this.stream=e,e.onaddtrack=function(e){"video"===e.track.kind?t._setVideoTrack(e.track):"audio"===e.track.kind&&t._setAudioTrack(e.track)}},t.prototype._setAudioTrack=function(e){var t,r;(null===(r=null===(t=this.audioTrack)||void 0===t?void 0:t.getTrack())||void 0===r?void 0:r.id)!==(null==e?void 0:e.id)&&(this.audioTrack=new qF(e,HD()),this.emit("ontrack",this.audioTrack))},t.prototype._setVideoTrack=function(e){var t,r;(null===(r=null===(t=this.videoTrack)||void 0===t?void 0:t.getTrack())||void 0===r?void 0:r.id)!==(null==e?void 0:e.id)&&(this.videoTrack=new JF(e,HD()),this.emit("ontrack",this.videoTrack))},t.prototype._getSubLayerBySpatialLayer=function(e){var t=this._attributes,r=t.videoDescriptions,i=t.subVideoDescriptions,n=void 0===i?[]:i,o=r[e],a=o.width,s=o.height,c=n.find((function(e){return e.width===a&&e.height===s}));return{spatialLayer:e,spatialSubLayer:(null==c?void 0:c.sub_index)||-1}},t}(Tk);!function(e){e[e.INITIAL=0]="INITIAL",e[e.BEGIN=1]="BEGIN",e[e.STOPPED=2]="STOPPED",e[e.RECEIVED=3]="RECEIVED"}(MB||(MB={}));var FB,BB=function(){function e(e,t){this._audioEventSessionId=JD(),this._videoEventSessionId=JD(),this._isScreen=!1,this._audioFirstFrameState=MB.INITIAL,this._videoFirstFrameState=MB.INITIAL,this._timeout=1e4,this._currentAudioRecv={startTime:0,eventSessionId:0,type:HL.LOGIN},this._currentVideoRecv={startTime:0,eventSessionId:0,type:HL.LOGIN},this._login=!1,this._unMuteAudio=!1,this._enableAudio=!1,this._unMuteVideo=!1,this._enableVideo=!1,this._remoteUnmuteAudio=!1,this._remoteUnmuteVideo=!1,this._audioExternal=!1,this._pushAudio=!1,this._videoExternal=!1,this._pushVideo=!1,this._autoSubscribeVideo=!1,this._autoSubscribeAudio=!1,this._autoSubscribe=!1,this._publishVideo=!1,this._publishAudio=!1,this._subscribeAudio=!1,this._subscribeVideo=!1,this._subscribe=!1,this._pushTrack=!1,this._multiChatMode=!1,this._stream=e,this._handler=t,this.getTransportDelay()}return e.prototype.beginRecvFrame=function(e,t){var r,i,n,o,a;return e_(this,void 0,void 0,(function(){var s,c,u,d,l,h,p,f=this;return t_(this,(function(_){switch(_.label){case 0:return[4,this.getTransportDelay()];case 1:return _.sent(),s=this._transportDelay,c=!0,u=HL.LOGIN,d=HL.UNMUTE,l=HL.SUBSCRIBE,h=HL.PUSH_TRACK,[u,d,l,h].indexOf(t)>=0&&(s=0,c=!1),e===GL.AUDIO?(c||this._audioEventSessionId++,this._currentAudioRecv={startTime:Date.now(),eventSessionId:this._audioEventSessionId,type:t},p={media_type:e,event_type:jL.BEGIN_RECV,type:t,start:null===(r=this._currentAudioRecv)||void 0===r?void 0:r.startTime,event_session_id:this._audioEventSessionId,stream_user_id:null===(i=this._stream)||void 0===i?void 0:i.userId,transport_delay:s},this._firstAudioFrameTimer&&window.clearTimeout(this._firstAudioFrameTimer),this._firstAudioFrameTimer=window.setTimeout((function(){f.stopRecvFrame(GL.AUDIO,zL.TIMEOUT),f._firstAudioFrameInterval&&window.clearInterval(f._firstAudioFrameInterval)}),this._timeout),dx.rtcFirstFrame(p),this._watchForFirstAudioFrameRecv(),this._audioFirstFrameState=MB.BEGIN,this._login=!0,this._unMuteAudio=!0,this._enableAudio=!0,this._remoteUnmuteAudio=!0):e===GL.VIDEO&&(c||this._videoEventSessionId++,this._currentVideoRecv={startTime:Date.now(),eventSessionId:this._videoEventSessionId,type:t},p={media_type:(null===(n=this._stream)||void 0===n?void 0:n.isScreen)?GL.SCREEN_VIDEO:e,event_type:jL.BEGIN_RECV,type:t,start:null===(o=this._currentVideoRecv)||void 0===o?void 0:o.startTime,event_session_id:this._videoEventSessionId,stream_user_id:null===(a=this._stream)||void 0===a?void 0:a.userId,transport_delay:s},this._firstVideoFrameTimer&&window.clearTimeout(this._firstVideoFrameTimer),this._firstVideoFrameTimer=window.setTimeout((function(){f.stopRecvFrame(GL.VIDEO,zL.TIMEOUT),f._firstVideoFrameInterval&&window.clearInterval(f._firstVideoFrameInterval)}),this._timeout),this._watchForFirstVideoFrameRecv(),dx.rtcFirstFrame(p),this._videoFirstFrameState=MB.BEGIN,this._login=!0,this._unMuteVideo=!0,this._enableVideo=!0,this._remoteUnmuteVideo=!0),[2]}}))}))},e.prototype.stopRecvFrame=function(e,t){var r,i,n,o,a,s,c;if(e===GL.AUDIO){if(this._audioFirstFrameState!==MB.BEGIN)return;var u={event_type:jL.RECV_END,media_type:e,start:null===(r=this._currentAudioRecv)||void 0===r?void 0:r.startTime,reason:t,result:!1,stream_user_id:null===(i=this._stream)||void 0===i?void 0:i.userId,event_session_id:this._audioEventSessionId,type:null===(n=this._currentAudioRecv)||void 0===n?void 0:n.type};this._firstAudioFrameTimer&&window.clearTimeout(this._firstAudioFrameTimer),delete this._currentAudioRecv,dx.rtcFirstFrame(u),this._audioFirstFrameState=MB.STOPPED}else if(e===GL.VIDEO){if(this._videoFirstFrameState!==MB.BEGIN)return;u={event_type:jL.RECV_END,media_type:(null===(o=this._stream)||void 0===o?void 0:o.isScreen)?GL.SCREEN_VIDEO:e,start:null===(a=this._currentVideoRecv)||void 0===a?void 0:a.startTime,reason:t,result:!1,stream_user_id:null===(s=this._stream)||void 0===s?void 0:s.userId,event_session_id:this._videoEventSessionId,type:null===(c=this._currentVideoRecv)||void 0===c?void 0:c.type};this._firstVideoFrameTimer&&window.clearTimeout(this._firstVideoFrameTimer),delete this._currentVideoRecv,dx.rtcFirstFrame(u),this._videoFirstFrameState=MB.STOPPED}},e.prototype.recvFrameFinish=function(e){var t,r,i;return e_(this,void 0,void 0,(function(){var n,o,a,s,c,u,d,l,h,p;return t_(this,(function(f){switch(f.label){case 0:return[4,this.getTransportDelay()];case 1:if(f.sent(),n=this._transportDelay,o=HL.LOGIN,a=HL.UNMUTE,s=HL.SUBSCRIBE,c=HL.PUSH_TRACK,e===GL.AUDIO){if(this._audioFirstFrameState!==MB.BEGIN)return[2];if(!this._currentAudioRecv)return[2];u=this._currentAudioRecv,l=u.type,h=u.startTime,[o,a,s,c].indexOf(l)>=0&&(n=0),p={event_type:jL.RECV_END,media_type:e,start:h,result:!0,stream_user_id:null===(t=this._stream)||void 0===t?void 0:t.userId,event_session_id:this._audioEventSessionId,type:l,transport_delay:n},delete this._currentAudioRecv,this._firstAudioFrameTimer&&window.clearTimeout(this._firstAudioFrameTimer),dx.rtcFirstFrame(p),this._audioFirstFrameState=MB.RECEIVED}else if(e===GL.VIDEO){if(this._videoFirstFrameState!==MB.BEGIN)return[2];if(!this._currentVideoRecv)return[2];d=this._currentVideoRecv,l=d.type,h=d.startTime,[o,a,s,c].indexOf(l)>=0&&(n=0),p={event_type:jL.RECV_END,media_type:(null===(r=this._stream)||void 0===r?void 0:r.isScreen)?GL.SCREEN_VIDEO:e,start:h,result:!0,stream_user_id:null===(i=this._stream)||void 0===i?void 0:i.userId,event_session_id:this._videoEventSessionId,type:l,transport_delay:n},delete this._currentVideoRecv,this._firstVideoFrameTimer&&window.clearTimeout(this._firstVideoFrameTimer),dx.rtcFirstFrame(p),this._videoFirstFrameState=MB.RECEIVED}return[2]}}))}))},e.prototype.setLogin=function(e,t){var r,i,n,o;void 0===t&&(t={audio:!0,video:!0}),this._login!==e&&(this._login=e,e&&(null===(r=this._stream)||void 0===r?void 0:r.hasAudio)&&t.audio&&this.beginRecvFrame(GL.AUDIO,HL.LOGIN),e&&(null===(i=this._stream)||void 0===i?void 0:i.hasVideo)&&t.video&&this.beginRecvFrame(GL.VIDEO,HL.LOGIN),!e&&(null===(n=this._stream)||void 0===n?void 0:n.hasAudio)&&this.stopRecvFrame(GL.AUDIO,zL.LEAVE_ROOM),!e&&(null===(o=this._stream)||void 0===o?void 0:o.hasVideo)&&this.stopRecvFrame(GL.VIDEO,zL.LEAVE_ROOM))},e.prototype.setUnmuteAudio=function(e){var t;this._unMuteAudio!==e&&(this._unMuteAudio=e,this._unMuteAudio?this.beginRecvFrame(GL.AUDIO,HL.UNMUTE):(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.stopRecvFrame(GL.AUDIO,zL.MUTE))},e.prototype.setRemoteUnmuteAudio=function(e){var t;this._remoteUnmuteAudio!==e&&(this._remoteUnmuteAudio=e,this._remoteUnmuteAudio?this.beginRecvFrame(GL.AUDIO,HL.REMOTE_UNMUTE):(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.stopRecvFrame(GL.AUDIO,zL.REMOTE_MUTE))},e.prototype.setEnableAudio=function(e){var t;this._enableAudio!==e&&(this._enableAudio=e,this._enableAudio?this.beginRecvFrame(GL.AUDIO,HL.ENABLE):(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.stopRecvFrame(GL.AUDIO,zL.DISABLE))},e.prototype.setUnmuteVideo=function(e){var t;this._unMuteVideo!==e&&(this._unMuteVideo=e,this._unMuteVideo?this.beginRecvFrame(GL.VIDEO,HL.UNMUTE):(null===(t=this._stream)||void 0===t?void 0:t.hasVideo)&&this.stopRecvFrame(GL.VIDEO,zL.MUTE))},e.prototype.setRemoteUnmuteVideo=function(e){var t;this._remoteUnmuteVideo!==e&&(this._remoteUnmuteVideo=e,this._remoteUnmuteVideo?this.beginRecvFrame(GL.VIDEO,HL.REMOTE_UNMUTE):(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.stopRecvFrame(GL.VIDEO,zL.REMOTE_MUTE))},e.prototype.setEnableVideo=function(e){this._enableVideo!==e&&(this._enableVideo=e,this._enableVideo?this.beginRecvFrame(GL.VIDEO,HL.ENABLE):this.stopRecvFrame(GL.VIDEO,zL.DISABLE))},e.prototype.setExternalAudioSource=function(e){this._audioExternal=e},e.prototype.setPushAudio=function(e){var t;this._audioExternal&&this._pushAudio!==e&&(this._pushAudio=e),this._pushAudio&&this.beginRecvFrame(GL.AUDIO,HL.PUSH),!e&&(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.beginRecvFrame(GL.AUDIO,HL.PUSH)},e.prototype.setExternalVideoSource=function(e){this._videoExternal=e},e.prototype.setPushVideo=function(e){var t;this._videoExternal&&this._pushVideo!==e&&(this._pushVideo=e),this._pushVideo&&this.beginRecvFrame(GL.VIDEO,HL.PUSH),!e&&(null===(t=this._stream)||void 0===t?void 0:t.hasVideo)&&this.beginRecvFrame(GL.VIDEO,HL.PUSH)},e.prototype.setPublishVideo=function(e){var t;this._publishVideo!==e&&(this._publishVideo=e),this._publishVideo&&this.beginRecvFrame(GL.VIDEO,HL.PUBLISH),!e&&(null===(t=this._stream)||void 0===t?void 0:t.hasVideo)&&this.stopRecvFrame(GL.VIDEO,zL.UNPUBLISH)},e.prototype.setPublishAudio=function(e){var t;this._publishAudio!==e&&(this._publishAudio=e),this._publishAudio&&this.beginRecvFrame(GL.AUDIO,HL.PUBLISH),!e&&(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.stopRecvFrame(GL.AUDIO,zL.UNPUBLISH)},e.prototype.setAutoSubscribe=function(e){this._autoSubscribe=e},e.prototype.setAutoSubscribeVideo=function(e){this._autoSubscribeVideo=e},e.prototype.setAutoSubscribeAudio=function(e){this._autoSubscribeAudio=e},e.prototype.setSubscribeAudio=function(e){var t,r;this._autoSubscribeAudio||this._subscribeAudio===e||(this._subscribe=e,e&&(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.beginRecvFrame(GL.AUDIO,HL.SUBSCRIBE)),!e&&(null===(r=this._stream)||void 0===r?void 0:r.hasAudio)&&this.stopRecvFrame(GL.AUDIO,zL.UNSUBSCRIBE)},e.prototype.setSubscribeVideo=function(e){var t,r;this._autoSubscribeVideo||this._subscribeVideo===e||(this._subscribeVideo=e,e&&(null===(t=this._stream)||void 0===t?void 0:t.hasVideo)&&this.beginRecvFrame(GL.VIDEO,HL.SUBSCRIBE)),!e&&(null===(r=this._stream)||void 0===r?void 0:r.hasVideo)&&this.stopRecvFrame(GL.VIDEO,zL.UNSUBSCRIBE)},e.prototype.setPushTrack=function(e){var t;this._pushTrack!==e&&(e&&!this._isScreen&&this.beginRecvFrame(GL.AUDIO,HL.PUSH_TRACK),!e&&(null===(t=this._stream)||void 0===t?void 0:t.hasAudio)&&this.stopRecvFrame(GL.AUDIO,zL.REMOVE_TRACK))},e.prototype.setMultiChatMode=function(e){this._multiChatMode=e},e.prototype.setTimeout=function(e){this._timeout=e},e.prototype._watchForFirstVideoFrameRecv=function(){var e=this,t=-1;this._firstVideoFrameInterval=window.setInterval((function(){return e_(e,void 0,void 0,(function(){var e,r,i,n,o,a,s,c;return t_(this,(function(u){switch(u.label){case 0:return(null===(i=this._handler)||void 0===i?void 0:i.pc)&&(null===(o=null===(n=this._stream)||void 0===n?void 0:n.videoTrack)||void 0===o?void 0:o.getTrack())?[4,HV(null===(a=this._handler)||void 0===a?void 0:a.pc,null===(c=null===(s=this._stream)||void 0===s?void 0:s.videoTrack)||void 0===c?void 0:c.getTrack())]:[3,2];case 1:if(e=u.sent(),(r=e.find((function(e){return"inbound-rtp"===e.type})))&&r.framesReceived>t){if(-1===t)return t=r.framesReceived,[2];this.recvFrameFinish(GL.VIDEO),window.clearInterval(this._firstVideoFrameInterval)}u.label=2;case 2:return[2]}}))}))}),200)},e.prototype._watchForFirstAudioFrameRecv=function(){var e=this,t=-1;this._firstAudioFrameInterval=window.setInterval((function(){return e_(e,void 0,void 0,(function(){var e,r,i,n,o,a,s,c;return t_(this,(function(u){switch(u.label){case 0:return(null===(i=this._handler)||void 0===i?void 0:i.pc)&&(null===(o=null===(n=this._stream)||void 0===n?void 0:n.audioTrack)||void 0===o?void 0:o.getTrack())?[4,HV(null===(a=this._handler)||void 0===a?void 0:a.pc,null===(c=null===(s=this._stream)||void 0===s?void 0:s.audioTrack)||void 0===c?void 0:c.getTrack())]:[3,2];case 1:if(e=u.sent(),(r=e.find((function(e){return"inbound-rtp"===e.type})))&&r.totalSamplesReceived>t){if(-1===t)return t=r.totalSamplesReceived,[2];this.recvFrameFinish(GL.AUDIO),window.clearInterval(this._firstAudioFrameInterval)}u.label=2;case 2:return[2]}}))}))}),200)},e.prototype.getTransportDelay=function(){return e_(this,void 0,void 0,(function(){var e=this;return t_(this,(function(t){switch(t.label){case 0:return[4,this.getTransportDelayIntl()];case 1:return t.sent(),window.clearInterval(this._transportDelayInterval),this._transportDelayInterval=window.setInterval((function(){return e_(e,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return[4,this.getTransportDelayIntl()];case 1:return e.sent(),[2]}}))}))}),2e3),[2]}}))}))},e.prototype.getTransportDelayIntl=function(){var e,t;return e_(this,void 0,void 0,(function(){var r,i,n;return t_(this,(function(o){switch(o.label){case 0:return(null===(e=this._handler)||void 0===e?void 0:e.pc)?[4,HV(null===(t=this._handler)||void 0===t?void 0:t.pc)]:[3,2];case 1:r=o.sent(),i=r.find((function(e){return"transport"===e.type&&"connected"===e.dtlsState})),(n=r.find((function(e){return"candidate-pair"===e.type&&"succeeded"===e.state&&e.id===(null==i?void 0:i.selectedCandidatePairId)})))&&(this._transportDelay=Math.round(1e3*n.currentRoundTripTime/2)),o.label=2;case 2:return[2]}}))}))},e.prototype.reset=function(){this._currentAudioRecv={startTime:0,eventSessionId:0,type:HL.LOGIN},this._currentVideoRecv={startTime:0,eventSessionId:0,type:HL.LOGIN},this._login=!1,this._unMuteAudio=!1,this._enableAudio=!1,this._unMuteVideo=!1,this._remoteUnmuteAudio=!1,this._remoteUnmuteVideo=!1,this._enableVideo=!1,this._audioExternal=!1,this._pushAudio=!1,this._videoExternal=!1,this._pushVideo=!1,this._autoSubscribeVideo=!1,this._autoSubscribeAudio=!1,this._autoSubscribe=!1,this._subscribeAudio=!1,this._subscribeVideo=!1,this._subscribe=!1,this._pushTrack=!1,this._multiChatMode=!1,this._firstAudioFrameTimer&&window.clearTimeout(this._firstAudioFrameTimer),this._firstVideoFrameTimer&&window.clearTimeout(this._firstVideoFrameTimer),this._firstAudioFrameInterval&&window.clearInterval(this._firstAudioFrameInterval),this._firstVideoFrameInterval&&window.clearInterval(this._firstVideoFrameInterval),this._transportDelayInterval&&window.clearInterval(this._transportDelayInterval)},e}();!function(e){e[e.INITIAL=0]="INITIAL",e[e.BEGIN=1]="BEGIN",e[e.STOPPED=2]="STOPPED",e[e.SENT=3]="SENT"}(FB||(FB={}));var jB,GB,HB,zB,KB=function(){function e(e,t){this._audioEventSessionId=JD(),this._videoEventSessionId=JD(),this._currentAudioSend={startTime:0,eventSessionId:0,type:HL.LOGIN},this._currentVideoSend={startTime:0,eventSessionId:0,type:HL.LOGIN},this._login=!1,this._publisher=!1,this._unMuteAudio=!1,this._enableAudio=!1,this._unMuteVideo=!1,this._enableVideo=!1,this._audioExternal=!1,this._pushAudio=!1,this._videoExternal=!1,this._pushVideo=!1,this._autoPublish=!1,this._publish=!1,this._timeout=1e4,this._audioFirstFrameState=FB.INITIAL,this._videoFirstFrameState=FB.INITIAL,this._stream=e,this._handler=t}return e.prototype.beginSendFrame=function(e,t){var r,i,n,o=this;if(e===GL.AUDIO){this._audioEventSessionId++,this._currentAudioSend={startTime:Date.now(),eventSessionId:this._audioEventSessionId,type:t};var a={media_type:e,event_type:jL.BEGIN_SEND,type:t,start:null===(r=this._currentAudioSend)||void 0===r?void 0:r.startTime,event_session_id:this._audioEventSessionId};this._firstAudioFrameTimer&&window.clearTimeout(this._firstAudioFrameTimer),this._firstAudioFrameTimer=window.setTimeout((function(){o.stopSendFrame(GL.AUDIO,zL.TIMEOUT),o._firstAudioFrameInterval&&window.clearInterval(o._firstAudioFrameInterval)}),this._timeout),dx.rtcFirstFrame(a),this._watchForFirstAudioFrameSend(),this._audioFirstFrameState=FB.BEGIN,this._login=!0,this._publisher=!0,this._publish=!0,this._unMuteAudio=!0,this._pushAudio||(this._enableAudio=!0)}else if(e===GL.VIDEO){this._videoEventSessionId++,this._currentVideoSend={startTime:Date.now(),eventSessionId:this._videoEventSessionId,type:t};a={media_type:(null===(i=this._stream)||void 0===i?void 0:i.isScreen)?GL.SCREEN_VIDEO:e,event_type:jL.BEGIN_SEND,type:t,start:null===(n=this._currentVideoSend)||void 0===n?void 0:n.startTime,event_session_id:this._videoEventSessionId};this._firstVideoFrameTimer&&window.clearTimeout(this._firstVideoFrameTimer),this._firstVideoFrameTimer=window.setTimeout((function(){o.stopSendFrame(GL.VIDEO,zL.TIMEOUT),o._firstVideoFrameInterval&&window.clearInterval(o._firstVideoFrameInterval)}),this._timeout),this._watchForFirstVideoFrameSend(),dx.rtcFirstFrame(a),this._videoFirstFrameState=FB.BEGIN,this._login=!0,this._publisher=!0,this._publish=!0,this._unMuteVideo=!0,this._pushVideo||(this._enableVideo=!0)}},e.prototype.stopSendFrame=function(e,t){var r,i,n,o,a;if(e===GL.AUDIO){if(this._audioFirstFrameState!==FB.BEGIN)return;var s={event_type:jL.SENT_END,media_type:e,start:null===(r=this._currentAudioSend)||void 0===r?void 0:r.startTime,reason:t,result:!1,event_session_id:this._audioEventSessionId,type:null===(i=this._currentAudioSend)||void 0===i?void 0:i.type};this._firstAudioFrameTimer&&window.clearTimeout(this._firstAudioFrameTimer),delete this._currentAudioSend,dx.rtcFirstFrame(s),this._audioFirstFrameState=FB.STOPPED}else if(e===GL.VIDEO){if(this._videoFirstFrameState!==FB.BEGIN)return;s={event_type:jL.SENT_END,media_type:(null===(n=this._stream)||void 0===n?void 0:n.isScreen)?GL.SCREEN_VIDEO:e,start:null===(o=this._currentVideoSend)||void 0===o?void 0:o.startTime,reason:t,result:!1,event_session_id:this._videoEventSessionId,type:null===(a=this._currentVideoSend)||void 0===a?void 0:a.type};this._firstVideoFrameTimer&&window.clearTimeout(this._firstVideoFrameTimer),delete this._currentVideoSend,dx.rtcFirstFrame(s),this._videoFirstFrameState=FB.STOPPED}},e.prototype.sendFrameFinish=function(e){var t;if(e===GL.AUDIO){if(this._audioFirstFrameState!==FB.BEGIN)return;if(!this._currentAudioSend)return;var r=this._currentAudioSend,i=r.type,n=r.startTime,o={event_type:jL.SENT_END,media_type:e,start:n,result:!0,event_session_id:this._audioEventSessionId,type:i};delete this._currentAudioSend,this._firstAudioFrameTimer&&window.clearTimeout(this._firstAudioFrameTimer),dx.rtcFirstFrame(o),this._audioFirstFrameState=FB.SENT}else if(e===GL.VIDEO){if(this._videoFirstFrameState!==FB.BEGIN)return;if(!this._currentVideoSend)return;var a=this._currentVideoSend;i=a.type,n=a.startTime,o={event_type:jL.SENT_END,media_type:(null===(t=this._stream)||void 0===t?void 0:t.isScreen)?GL.SCREEN_VIDEO:e,start:n,result:!0,event_session_id:this._videoEventSessionId,type:i};delete this._currentVideoSend,this._firstVideoFrameTimer&&window.clearTimeout(this._firstVideoFrameTimer),dx.rtcFirstFrame(o),this._videoFirstFrameState=FB.SENT}},e.prototype.setLogin=function(e){var t,r;this._login!==e&&(this._login=e,e&&((null===(t=this._stream)||void 0===t?void 0:t.videoTrack)&&this.beginSendFrame(GL.VIDEO,HL.LOGIN),(null===(r=this._stream)||void 0===r?void 0:r.audioTrack)&&this.beginSendFrame(GL.AUDIO,HL.LOGIN)),!e&&this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.LEAVE_ROOM),!e&&this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.LEAVE_ROOM))},e.prototype.setPublish=function(e){var t,r;this._publish!==e&&(this._publish=e,e&&((null===(t=this._stream)||void 0===t?void 0:t.videoTrack)&&this.beginSendFrame(GL.VIDEO,HL.PUBLISH),(null===(r=this._stream)||void 0===r?void 0:r.audioTrack)&&this.beginSendFrame(GL.AUDIO,HL.PUBLISH)),!e&&this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.UNPUBLISH),!e&&this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.UNPUBLISH))},e.prototype.setUnmuteAudio=function(e){this._unMuteAudio!==e&&(this._unMuteAudio=e,e&&this.beginSendFrame(GL.AUDIO,HL.UNMUTE),!e&&this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.MUTE))},e.prototype.setEnableAudio=function(e){this._enableAudio!==e&&(this._enableAudio=e,e&&this.beginSendFrame(GL.AUDIO,HL.ENABLE),!e&&this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.DISABLE))},e.prototype.setUnmuteVideo=function(e){this._unMuteVideo!==e&&(this._unMuteVideo=e,e&&this.beginSendFrame(GL.VIDEO,HL.UNMUTE),!e&&this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.MUTE))},e.prototype.setEnableVideo=function(e){this._enableVideo!==e&&(this._enableVideo=e,e&&this.beginSendFrame(GL.VIDEO,HL.ENABLE),!e&&this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.DISABLE))},e.prototype.setExternalAudioSource=function(e){this._audioExternal!==e&&(this._audioExternal=e,e&&(this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.DISABLE),this._enableAudio=!1),e||(this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.STOP_PUSH),this._pushAudio=!1))},e.prototype.setPushAudio=function(e){this._pushAudio!==e&&(this._pushAudio=e,e&&this.beginSendFrame(GL.AUDIO,HL.PUSH),!e&&this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.STOP_PUSH))},e.prototype.setExternalVideoSource=function(e){this._videoExternal!==e&&(this._videoExternal=e,e&&(this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.DISABLE),this._enableVideo=!1),e||(this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.STOP_PUSH),this._pushVideo=!1))},e.prototype.setPushVideo=function(e){this._pushVideo!==e&&(this._pushVideo=e,e&&this.beginSendFrame(GL.VIDEO,HL.PUSH),!e&&this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.STOP_PUSH))},e.prototype.setAutoPublish=function(e){this._autoPublish=e},e.prototype.setPublisher=function(e){this._publisher!==e&&(this._publisher=e,!e&&this._audioSending&&this.stopSendFrame(GL.AUDIO,zL.AUDIENCE),!e&&this._videoSending&&this.stopSendFrame(GL.VIDEO,zL.AUDIENCE))},e.prototype.setTimeout=function(e){this._timeout=e},e.prototype.setPCSessionId=function(e){this._pcSessionId=e},e.prototype.setHandler=function(e){this._handler=e},e.prototype._getFirstVideoFrameStats=function(){var e,t,r,i,n,o;return e_(this,void 0,void 0,(function(){var a;return t_(this,(function(s){switch(s.label){case 0:return(null===(e=this._handler)||void 0===e?void 0:e.pc)&&(null===(r=null===(t=this._stream)||void 0===t?void 0:t.videoTrack)||void 0===r?void 0:r.getTrack())?[4,HV(null===(i=this._handler)||void 0===i?void 0:i.pc,null===(o=null===(n=this._stream)||void 0===n?void 0:n.videoTrack)||void 0===o?void 0:o.getTrack())]:[3,2];case 1:return a=s.sent(),[2,a.find((function(e){return"outbound-rtp"===e.type}))];case 2:return[2]}}))}))},e.prototype._getFirstAudioFrameStats=function(){var e,t,r,i,n,o;return e_(this,void 0,void 0,(function(){var a;return t_(this,(function(s){switch(s.label){case 0:return(null===(e=this._handler)||void 0===e?void 0:e.pc)&&(null===(r=null===(t=this._stream)||void 0===t?void 0:t.audioTrack)||void 0===r?void 0:r.getTrack())?[4,HV(null===(i=this._handler)||void 0===i?void 0:i.pc,null===(o=null===(n=this._stream)||void 0===n?void 0:n.audioTrack)||void 0===o?void 0:o.getTrack())]:[3,2];case 1:return a=s.sent(),[2,a.find((function(e){return"outbound-rtp"===e.type}))];case 2:return[2]}}))}))},e.prototype._watchForFirstVideoFrameSend=function(){var e=this,t=-1;this._firstVideoFrameInterval=window.setInterval((function(){return e_(e,void 0,void 0,(function(){var e;return t_(this,(function(r){switch(r.label){case 0:return[4,this._getFirstVideoFrameStats()];case 1:if((e=r.sent())&&e.framesSent>t){if(-1===t)return t=e.framesSent,[2];this.sendFrameFinish(GL.VIDEO),window.clearInterval(this._firstVideoFrameInterval)}return[2]}}))}))}),100)},e.prototype._watchForFirstAudioFrameSend=function(){var e=this,t=-1;this._firstAudioFrameInterval=window.setInterval((function(){return e_(e,void 0,void 0,(function(){var e;return t_(this,(function(r){switch(r.label){case 0:return[4,this._getFirstAudioFrameStats()];case 1:if((e=r.sent())&&e.packetsSent>t){if(-1===t)return t=e.packetsSent,[2];this.sendFrameFinish(GL.AUDIO),window.clearInterval(this._firstAudioFrameInterval)}return[2]}}))}))}),100)},e.prototype.reset=function(){this._login=!1,this._publisher=!1,this._unMuteAudio=!1,this._enableAudio=!1,this._unMuteVideo=!1,this._enableVideo=!1,this._audioExternal=!1,this._pushAudio=!1,this._videoExternal=!1,this._pushVideo=!1,this._autoPublish=!1,this._publish=!1,this._audioFirstFrameState=FB.INITIAL,this._videoFirstFrameState=FB.INITIAL,this._currentAudioSend={startTime:0,eventSessionId:0,type:HL.LOGIN},this._currentVideoSend={startTime:0,eventSessionId:0,type:HL.LOGIN},window.clearTimeout(this._firstAudioFrameTimer),window.clearTimeout(this._firstVideoFrameTimer),window.clearInterval(this._firstAudioFrameInterval),window.clearInterval(this._firstVideoFrameInterval)},e.prototype.destroy=function(){this.reset(),delete this._stream,delete this._handler},Object.defineProperty(e.prototype,"_audioSending",{get:function(){return this._audioFirstFrameState===FB.BEGIN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_videoSending",{get:function(){return this._videoFirstFrameState===FB.BEGIN},enumerable:!1,configurable:!0}),e}();!function(e){e[e.UNKOWN=0]="UNKOWN",e[e.EXCELLENT=1]="EXCELLENT",e[e.GOOD=2]="GOOD",e[e.POOR=3]="POOR",e[e.BAD=4]="BAD",e[e.VBAD=5]="VBAD"}(GB||(GB={})),function(e){e[e.INVALID=0]="INVALID",e[e.GOOD=1]="GOOD",e[e.MEDIUM=2]="MEDIUM",e[e.POOR=3]="POOR"}(HB||(HB={})),function(e){e.AUDIO="audio",e.VIDEO="video",e.SCREEN_VIDEO="screen_video",e.SCREEN_AUDIO="screen_audio"}(zB||(zB={}));var WB=((jB={})[zB.AUDIO]={delay:1200,stallRadio:.3},jB[zB.VIDEO]={delay:1200,stallRadio:.6},jB[zB.SCREEN_AUDIO]={delay:1600,stallRadio:.8},jB[zB.SCREEN_VIDEO]={delay:1600,stallRadio:.8},jB),XB=function(){function e(){this._preUplinkStats=new Map,this._preDownlinkStats=new Map,this._connectionState=mB.CONNECTED}return e.prototype.updateUplinkStats=function(e){var t=e.audioStats,r=e.videoStats,i=e.isScreen;if(t.sendKBitrate>0&&t.rtt){var n=i?zB.SCREEN_AUDIO:zB.AUDIO,o=t.rtt,a=t._fractionLost,s=t._retransmittedRate,c=this._getQosLevel(o,a||0,s||0),u=this._preUplinkStats.get(n)||[c];this._preUplinkStats.set(n,n_(n_([],i_(u),!1),[c],!1).slice(-2))}if(r.sentKBitrate>0&&r.rtt){n=i?zB.SCREEN_VIDEO:zB.VIDEO,o=r.rtt,a=r._fractionLost;r.videoLossRate;var d=r._sendBandWidth;s=r._retransmittedRate;0===d&&(a=Math.max(.65,a));c=this._getQosLevel(o,a||0,s||0),u=this._preUplinkStats.get(n)||[c];this._preUplinkStats.set(n,n_(n_([],i_(u),!1),[c],!1).slice(-2))}this._startNetworkQualityReport()},e.prototype.updateDownlinkStats=function(e,t){if(t){var r,i,n=this._getStreamActiveState(t),o=n.audioActive,a=n.videoActive,s=e.audioStats,c=e.videoStats,u=e.isScreen,d=e.userId;if(o&&s.rtt)if(0===s.receivedKBitrate)r=Yf.VBAD;else{var l=s.rtt,h=s.audioLossRate,p=s.stallDuration,f=s.statsInterval,_=s.e2eDelay,v=p/f,m=u?zB.SCREEN_AUDIO:zB.AUDIO,S=this._getQosLevel(l,h||0,c._retransmittedRate||0),y=this._getDownlinkQoE(m,v,_);r=this._getNetworkQuality(S,y)}if(a)if(0===c.receivedKBitrate||0===c.rtt)i=Yf.VBAD;else{l=c.rtt;var E=c.videoLossRate,g=(p=c.stallDuration,f=c.statsInterval,_=c.e2eDelay,c._retransmittedRate);v=p/f,m=u?zB.SCREEN_VIDEO:zB.VIDEO,S=this._getQosLevel(l,E||0,g||0),y=this._getDownlinkQoE(m,v,_);i=this._getNetworkQuality(S,y)}var b=r&&i?Math.ceil((r+i)/2):r||i;if(b){var T="".concat(d).concat(u?"_screen":""),I=this._preDownlinkStats.get(T)||[b];this._preDownlinkStats.set(T,n_(n_([],i_(I),!1),[b],!1).slice(-2)),this._startNetworkQualityReport()}}},e.prototype.setConnectionState=function(e){this._connectionState=e},e.prototype.destroy=function(){this._timer&&(window.clearInterval(this._timer),delete this._timer),this._delayTimer&&(window.clearTimeout(this._delayTimer),delete this._delayTimer),this._preUplinkStats.clear(),this._preDownlinkStats.clear()},e.prototype._startNetworkQualityReport=function(){var e=this;this._delayTimer||this._timer||(this._preUplinkStats.size>0||this._preDownlinkStats.size>0)&&(this._delayTimer=window.setTimeout((function(){delete e._delayTimer,e._reportNetworkQuality(),e._timer=window.setInterval((function(){e._reportNetworkQuality()}),2e3)}),300))},e.prototype._reportNetworkQuality=function(){var e,t,r=this;if(this._connectionState!==mB.CONNECTED)e=t=Yf.VBAD;else{var i=this._getBetterQualityAndRemoveOldest(zB.AUDIO,"up"),n=this._getBetterQualityAndRemoveOldest(zB.VIDEO,"up");e=i&&n?Math.ceil((i+n)/2):i||n||this._getBetterQualityAndRemoveOldest(zB.SCREEN_VIDEO,"up")||this._getBetterQualityAndRemoveOldest(zB.SCREEN_AUDIO,"up")||Yf.UNKNOWN;var o=Array.from(this._preDownlinkStats.keys()).map((function(e){return r._getBetterQualityAndRemoveOldest(e,"down")})).filter((function(e){return e}));t=Math.ceil(o.reduce((function(e,t){return t+e}),0)/o.length)||Yf.UNKNOWN}this.reportor&&this.reportor(e,t)},e.prototype._getNetworkQuality=function(e,t){return t===HB.GOOD?Math.max(e-2,1):t===HB.MEDIUM?e:Math.min(e+1,5)},e.prototype._getQosLevel=function(e,t,r){var i;return i=e<=250&&t<=.15?GB.EXCELLENT:e<=500&&t<=.3?GB.GOOD:e<=750&&t<=.45?GB.POOR:e<=1e3&&t<=.6?GB.BAD:GB.VBAD,r>.5?i=Math.max(i,GB.BAD):r>.35?i=Math.max(i,GB.POOR):r>.15&&(i=Math.max(i,GB.GOOD)),i},e.prototype._getUplinkQoE=function(e,t){var r=HB.INVALID;switch(e){case zB.AUDIO:case zB.VIDEO:r=t<.05?HB.GOOD:t<.1?HB.MEDIUM:HB.POOR;break;case zB.SCREEN_VIDEO:case zB.SCREEN_AUDIO:r=t<.04?HB.GOOD:t<.08?HB.MEDIUM:HB.POOR}return r},e.prototype._getDownlinkQoE=function(e,t,r){var i=WB[e];return t>i.stallRadio||r>i.delay||t>i.stallRadio/2&&r>i.delay/2?HB.POOR:(t>i.stallRadio/2||i.delay,HB.MEDIUM)},e.prototype._getBetterQualityAndRemoveOldest=function(e,t){var r=Yf.UNKNOWN,i="up"===t?this._preUplinkStats:this._preDownlinkStats,n=i.get(e);if(n){var o=n.filter((function(e){return e}));o.length>0&&(r=Math.min.apply(Math,n_([],i_(o),!1))),n.shift(),0===n.length&&i.delete(e)}return r},e.prototype._getStreamActiveState=function(e){var t=e.subMediaType,r=e._attributes,i=e.subVideo;return{audioActive:e.subAudio&&tk(t)&&r.localaudio&&r.audiostream,videoActive:i&&rk(t)&&r.localvideo&&r.videostream}},e}(),YB=function(){function e(e){this._room=e,this._remoteVideoSizeCache={},this._remoteScreenSizeCache={},this._start()}return e.prototype.destroy=function(){this._timer&&(window.clearInterval(this._timer),delete this._timer),this._remoteVideoSizeCache={},this._remoteScreenSizeCache={}},e.prototype._start=function(){var e=this;this._timer||(this._timer=window.setInterval((function(){var t={},r={};e._room.remoteStreams.forEach((function(i,n){i.forEach((function(i){var o,a=null===(o=i.videoTrack)||void 0===o?void 0:o.getTrack();if(a){var s=i.isScreen?e._remoteScreenSizeCache:e._remoteVideoSizeCache,c=s[n]||{},u=c.width,d=void 0===u?0:u,l=c.height,h=void 0===l?0:l,p=a.getSettings(),f=p.width,_=void 0===f?0:f,v=p.height,m=void 0===v?0:v;h===m&&d===_||e.onchange&&e.onchange(n,i.isScreen,_,m),delete s[n],(i.isScreen?r:t)[n]={width:_,height:m}}}))})),Object.keys(e._remoteVideoSizeCache).forEach((function(t){e.onchange&&e.onchange(t,!1,0,0)})),Object.keys(e._remoteScreenSizeCache).forEach((function(t){e.onchange&&e.onchange(t,!0,0,0)})),e._remoteVideoSizeCache=t,e._remoteScreenSizeCache=r}),1e3))},e}(),JB=ba.every;Wi({target:"Array",proto:!0,forced:!jn("every")},{every:function(e){return JB(this,e,arguments.length>1?arguments[1]:void 0)}});var qB=new gk("SubscribeFallbackManager",2),QB=1e4,ZB=function(){function e(e){this._room=e,this._preDownlinkNetworkQuality=[],this._isSubscribeFallbackOrRecover=!1,this._inSubscribeRecoverChecking=!1,this._forbidSubRecover=!1,this._forbidSubRecoverDuration=QB}return e.prototype.updateNetworkQuality=function(e,t){this._preDownlinkNetworkQuality.push(t),this._preDownlinkNetworkQuality=this._preDownlinkNetworkQuality.slice(-10),this._inSubscribeRecoverChecking&&this._preDownlinkNetworkQuality.find((function(e){return e===Yf.BAD||e===Yf.VBAD}))&&this._startForbidSubRecover(),this._preDownlinkNetworkQuality.slice(-3).reduce((function(e,t){return e+t}),0)>3*Yf.POOR&&this._subscribeFallbackOrRecover("fallback"),!this._forbidSubRecover&&10===this._preDownlinkNetworkQuality.length&&this._preDownlinkNetworkQuality.every((function(e){return e===Yf.EXCELLENT}))&&this._subscribeFallbackOrRecover("recover")},e.prototype.destroy=function(){this._stopSubscribeRecoverCheck(),this._stopForbidSubRecover(),delete this.onSubscribeFallback},e.prototype._subscribeFallbackOrRecover=function(e){return e_(this,void 0,void 0,(function(){var t,r,i,n,o,a,s,c,u,d=this;return t_(this,(function(l){switch(l.label){case 0:if(this._isSubscribeFallbackOrRecover||this._room.connectionState!==mB.CONNECTED)return[2];if(this._room.subscribeFallbackOption!==Wf.AUDIO_ONLY&&this._room.subscribeFallbackOption!==Wf.VIDEO_STREAM_LOW)return[3,5];if(t=new Map,this._room.remoteStreams.forEach((function(r){r.forEach((function(r){if(r.hasSubscribed){var i="fallback"===e?r.getSubscribeFallbackParams(d._room.subscribeFallbackOption):r.getSubscribeRecoverParams();if(i){var n=r.getStreamPriority(),o=t.get(n)||[];o.push({stream:r,fallbackOrRecoverOption:i}),t.set(n,o)}}}))})),!(t.size>0))return[3,5];if(qB.print("_subscribeFallbackOrRecover()","start subscribe ".concat(e,".")),r=Array.from(t.keys()).sort((function(e,t){return e-t}))["fallback"===e?0:t.size-1],i=i_(t.get(r)||[],1),!(n=i[0]))return[3,5];o=n.stream,a=n.fallbackOrRecoverOption,this._isSubscribeFallbackOrRecover=!0,s=o.subLayer.spatialLayer,c=o.subVideo,qB.print("_subscribeFallbackOrRecover()","".concat(o.userId,"'s stream will be ").concat(e," to: MediaType=").concat(a[0]," subState=").concat(a[1]," subLayer=").concat(a[2])),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,$D([(u=this._room).updateSubTrack.apply(u,n_([o],i_(a),!1)).then((function(){"recover"===e?d._startSubscribeRecoverCheck():qB.print("_subscribeFallbackOrRecover()","fallback success."),d.onSubscribeFallback&&d.onSubscribeFallback({userId:o.userId,isScreen:o.isScreen,beforeEnable:c,beforeVideoIndex:s,afterEnable:o.subVideo,afterVideoIndex:o.subLayer.spatialLayer,reason:"fallback"===e?Jf.SubscribeFallbackByBandwidth:Jf.SubscribeRecoverByBandwidth})})),(h=2e3,new Promise((function(e){window.setTimeout(e,h)})))])];case 2:case 3:return l.sent(),[3,4];case 4:this._preDownlinkNetworkQuality=[],this._isSubscribeFallbackOrRecover=!1,l.label=5;case 5:return[2]}var h}))}))},e.prototype._startSubscribeRecoverCheck=function(){var e=this;this._stopSubscribeRecoverCheck(),this._inSubscribeRecoverChecking=!0,this._subRecoverCheckTimer=window.setTimeout((function(){e._inSubscribeRecoverChecking=!1,e._forbidSubRecoverDuration=QB,delete e._subRecoverCheckTimer,qB.print("_subscribeFallbackOrRecover()","recover success.")}),2e4)},e.prototype._stopSubscribeRecoverCheck=function(){this._subRecoverCheckTimer&&(window.clearTimeout(this._subRecoverCheckTimer),delete this._subRecoverCheckTimer),this._inSubscribeRecoverChecking=!1},e.prototype._startForbidSubRecover=function(){var e=this;this._stopSubscribeRecoverCheck(),this._stopForbidSubRecover(),this._forbidSubRecoverDuration=Math.min(this._forbidSubRecoverDuration+2e4,12e4),qB.print("_subscribeFallbackOrRecover()","subscribe-recover failed, and subscribe-recover not allowed within ".concat(this._forbidSubRecoverDuration/1e3,"s")),this._forbidSubRecover=!0,this._forbidSubRecoverTimer=window.setTimeout((function(){e._forbidSubRecover=!1,delete e._forbidSubRecoverTimer}),this._forbidSubRecoverDuration)},e.prototype._stopForbidSubRecover=function(){this._forbidSubRecoverTimer&&(window.clearTimeout(this._forbidSubRecoverTimer),delete this._forbidSubRecoverTimer)},e}(),$B=new gk("Room",1),ej=function(e){function t(t,r){var i=e.call(this)||this;return i._remoteUsers=new Map,i._remoteStreams=new Map,i._waitForNewToken=!1,i._userDuplicateLoginTimerMap=new Map,i._hasPublished=!1,i._roomConfig=t,i._mediaServerClient=new bB(r),i._reconnectRecord=new tj,i._addHandlerEventHandler(),i._isReconnecting=!1,i._networkQualityManager=new XB,i._networkQualityManager.reportor=i._reportNetworkQuality.bind(i),i._videoSizeObserver=new YB(i),i._videoSizeObserver.onchange=i._emitVideoSizeChange.bind(i),i._subFallbackManager=new ZB(i),i._subFallbackManager.onSubscribeFallback=i._emitSubscribeFallback.bind(i),i._context=r,i}return Cf(t,e),Object.defineProperty(t.prototype,"hasScreenPublished",{get:function(){var e;return null===(e=this._localScreenStream)||void 0===e?void 0:e.hasPublished},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPublished",{get:function(){var e;return null===(e=this._localStream)||void 0===e?void 0:e.hasPublished},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){return this._mediaServerClient.connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteUsers",{get:function(){return this._remoteUsers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteStreams",{get:function(){return this._remoteStreams},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localScreenStream",{get:function(){return this._localScreenStream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roomInfo",{get:function(){return this._roomInfo},enumerable:!1,configurable:!0}),t.prototype._addHandlerEventHandler=function(){var e,t,r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S,y,E,g,b,T=this;null===(e=this._mediaServerClient)||void 0===e||e.on(Fx.ON_ADD_STREAM,this._onAddStream.bind(this)),null===(t=this._mediaServerClient)||void 0===t||t.on(Fx.ON_REMOVE_STREAM,this._onRemoveStream.bind(this)),null===(r=this._mediaServerClient)||void 0===r||r.on(Fx.USER_CONNECTION,this._onUserConnection.bind(this)),null===(i=this._mediaServerClient)||void 0===i||i.on(Fx.USER_DISCONNECTION,this._onUserDisconnection.bind(this)),null===(n=this._mediaServerClient)||void 0===n||n.on(Fx.ON_UPDATE_ROOM_ATTRIBUTES,this._onUpdateRoomAttributes.bind(this)),null===(o=this._mediaServerClient)||void 0===o||o.on(Fx.ON_UPDATE_STREAM_ATTRIBUTES,this._onUpdateStreamAttributes.bind(this)),null===(a=this._mediaServerClient)||void 0===a||a.on(Fx.ON_PUSH_TRACK,this._onPushTrack.bind(this)),null===(s=this._mediaServerClient)||void 0===s||s.on(Fx.ON_REMOVE_TRACK,this._onRemoveTrack.bind(this)),null===(c=this._mediaServerClient)||void 0===c||c.on(Fx.NODE_CHANGE,this._nodeChange.bind(this)),null===(u=this._mediaServerClient)||void 0===u||u.on(Fx.ON_CUSTOM_MESSAGE,this._onCustomMessage.bind(this)),null===(d=this._mediaServerClient)||void 0===d||d.on(Fx.USER_MESSAGE_RECEIVED,this._onUserMessageReceived.bind(this)),null===(l=this._mediaServerClient)||void 0===l||l.on(Fx.USER_BINARY_MESSAGE_RECEIVED,this._onUserBinaryMessageReceived.bind(this)),null===(h=this._mediaServerClient)||void 0===h||h.on(Fx.POST_PROCESSING_MESSAGE,this._onPostProcessingMessage.bind(this)),null===(p=this._mediaServerClient)||void 0===p||p.on(Fx.ON_USER_TOKEN_WILL_EXPIRE,this._onUserTokenWillExpire.bind(this)),null===(f=this._mediaServerClient)||void 0===f||f.on(Fx.STREAM_CONTROL_MESSAGE,this._onStreamControlMessage.bind(this)),null===(_=this._mediaServerClient)||void 0===_||_.on(Fx.ON_SCENE_CONFIG,this._onSceneConfig.bind(this)),null===(v=this._mediaServerClient)||void 0===v||v.on(Bx.RSCP,this._onPublishOnDemand.bind(this)),null===(m=this._mediaServerClient)||void 0===m||m.on(jx.ON_CONNECTION_STATE_CHANGE,this._onConnectionStateChange.bind(this)),null===(S=this._mediaServerClient)||void 0===S||S.on(jx.ABNORMAL_DISCONNECTION,this._handleAbnormalDisconnection.bind(this)),null===(y=this._mediaServerClient)||void 0===y||y.on("onRemoteStreamStats",(function(e){T._networkQualityManager.updateDownlinkStats(e,T._findRemoteStreamByScreen(e.userId,e.isScreen)),T.emit(cB.ON_REMOTE_STREAM_STATS,ik(e))})),null===(E=this._mediaServerClient)||void 0===E||E.on("onLocalStreamStats",(function(e){T._networkQualityManager.updateUplinkStats(e),T.emit(cB.ON_LOCAL_STREAM_STATS,ik(e))})),null===(g=this._mediaServerClient)||void 0===g||g.on("prevIceNode",(function(e){T._getAccessFeedbackIceNode=e})),null===(b=this._mediaServerClient)||void 0===b||b.on("prevIceNode",(function(e){T._getAccessFeedbackIceNode=e}))},t.prototype._removeHandlerEventHandler=function(){var e;null===(e=this._mediaServerClient)||void 0===e||e.removeAllListeners()},t.prototype.join=function(e,t,r,i,n,o){return e_(this,void 0,void 0,(function(){var a=this;return t_(this,(function(s){return px.setStats({rtc_app_id:e,room_id:t,user_id:i.userId}),$B.print("join()"),[2,new Promise((function(s,c){return e_(a,void 0,void 0,(function(){var a,u,d=this;return t_(this,(function(l){return this._joinResolveCallback=function(e){var t;dx.joinRoom(XL.END,a,!0,e.message,{enable_cloud_proxy:null===(t=d._roomInfo)||void 0===t?void 0:t.useCloudProxy}),s(e)},this._joinRejectCallback=function(e){var t;dx.joinRoom(XL.END,a,!1,e.message,{enable_cloud_proxy:null===(t=d._roomInfo)||void 0===t?void 0:t.useCloudProxy}),c(e)},this._liveControlMessage=n,this._roomInfo={appId:e,roomId:t,token:r,userInfo:i,useCloudProxy:o,roomProfile:this._roomConfig.roomProfileType},a=zD(),this.setSessionId(),dx.joinRoom(XL.BEGIN,a,!1,"",{enable_cloud_proxy:null===(u=this._roomInfo)||void 0===u?void 0:u.useCloudProxy}),this._join(this._joinResolveCallback,this._joinRejectCallback,!1),[2]}))}))}))]}))}))},t.prototype._join=function(e,t,r){var i;return void 0===r&&(r=!1),e_(this,void 0,void 0,(function(){var n,o,a;return t_(this,(function(s){switch(s.label){case 0:n=zD(),$B.print("_join()"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._mediaServerClient.join(this._roomInfo,{node:this._getAccessNode,reason:this._getAccessFeedback,sessionId:this._sessionId,feedbackNode:this._getAccessFeedbackIceNode},r,this._liveControlMessage)];case 2:return o=s.sent(),this._mediaServerClient.roomAttributes=o.roomAttributes,this._reconnectRecord.clear(),this._joinResolveCallback=void 0,this._joinRejectCallback=void 0,this._getAccessFeedback=void 0,this._getAccessNode=void 0,"function"==typeof e&&e(null===(i=this._roomInfo)||void 0===i?void 0:i.userInfo),this._isReconnecting=!1,dx.rtcJoinRoom(0,"web","web",zD()-n),this._onJoinSucc(o,r),[3,4];case 3:return(a=s.sent()).code!==oP.OPERATION_CANCEL&&"function"==typeof t?[2,t(a)]:[3,4];case 4:return[2]}}))}))},t.prototype.publishScreen=function(e,t,r,i,n){var o,a,s,c,u;return e_(this,void 0,void 0,(function(){var d,l,h,p;return t_(this,(function(f){switch(f.label){case 0:return $B.print("publishScreen()"),this._localScreenStream||(this._localScreenStream=new xB,this._localScreenStream.isScreen=!0,this._mediaServerClient.handler&&(this._localScreenStream.observer=new KB(this._localScreenStream,this._mediaServerClient.handler))),d=!1,l=!1,h=!1,p=!1,!this._localScreenStream.videoTrack&&t?(t instanceof tB&&(l=!0),d=!0):this._localScreenStream.videoTrack&&!t&&(d=!1),!this._localScreenStream.audioTrack&&r?(r instanceof rB&&(p=!0),h=!0):this._localScreenStream.audioTrack&&!r&&(h=!1),this._localScreenStream.videoTrack=t,this._localScreenStream.audioTrack=r,this._localScreenStream.videoEncodeConfig=e,i&&(tk(i)&&(this._localScreenStream.pubAudio=n===lB.PUB),rk(i)&&(this._localScreenStream.pubVideo=n===lB.PUB),$B.print("publishScreen mediaType","pubAudio: %o, pubVideo: %o",this._localScreenStream.pubAudio,this._localScreenStream.pubVideo)),this._localScreenStream.pubAudio||this._localScreenStream.pubVideo?this._localScreenStream.hasPublished?[3,2]:(null===(o=this._localScreenStream.observer)||void 0===o||o.setPublish(!0),[4,this._mediaServerClient.publish(this._localScreenStream)]):[2,this.unpublishScreen()];case 1:return f.sent(),[3,4];case 2:return l?null===(a=this._localScreenStream.observer)||void 0===a||a.setPushVideo(d):null===(s=this._localScreenStream.observer)||void 0===s||s.setEnableVideo(d),p?null===(c=this._localScreenStream.observer)||void 0===c||c.setPushAudio(h):null===(u=this._localScreenStream.observer)||void 0===u||u.setEnableAudio(h),[4,this.updatePubScreenTrack()];case 3:f.sent(),f.label=4;case 4:return[2]}}))}))},t.prototype.updatePubScreenTrack=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return $B.print("updatePubScreenTrack","Invoke updatePubScreenTrack"),this._localScreenStream?[4,this._mediaServerClient.updatePubTrack(this._localScreenStream)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.unpublishScreen=function(){var e;return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return $B.print("unpublish","Invoke unpublishScreen"),this._localScreenStream?(null===(e=this._localScreenStream.observer)||void 0===e||e.setPublish(!1),[4,this._mediaServerClient.unpublish(this._localScreenStream)]):[3,2];case 1:t.sent(),this._localScreenStream.clean(),this._localScreenStream=void 0,t.label=2;case 2:return[2]}}))}))},t.prototype.liveControlMessage=function(e){var t;return e_(this,void 0,void 0,(function(){var r=this;return t_(this,(function(i){switch(i.label){case 0:return $B.print("controlMessage","Invoke controlMessage"),null===(t=e.transcodeMeta)||void 0===t||t.layout.regions.forEach((function(e){r.roomInfo&&(e.roomID=r.roomInfo.roomId)})),this._liveControlMessage=e,[4,this._mediaServerClient.controlMessage(e)];case 1:return i.sent(),"stopped"===e.action&&delete this._liveControlMessage,[2]}}))}))},t.prototype.publicStreamControlMessage=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return"stopped"===e.action&&delete e.publicStreamMeta,[4,this._mediaServerClient.controlMessage(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.updateUserAttributes=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return $B.print("updateUserAttributes","Invoke updateUserAttributes"),e.role&&this._roomInfo&&(this._roomInfo.userInfo.role=e.role),[4,this._mediaServerClient.updateUserAttributes(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.publish=function(e,t,r,i,n,o,a){var s,c,u,d,l,h;return void 0===a&&(a=!1),e_(this,void 0,void 0,(function(){var p,f,_,v,m,S;return t_(this,(function(y){switch(y.label){case 0:if($B.print("publish","Invoke publish"),p=!1,this._localStream||(this._localStream=new xB,this._mediaServerClient.handler&&(this._localStream.observer=new KB(this._localStream,this._mediaServerClient.handler)),p=!0),this._localStream.videoTrack=r,this._localStream.audioTrack=i,this._localStream.videoEncodeConfig=e,this._localStream.enableSimulcast=t,n&&(tk(n)&&(this._localStream.pubAudio=o===lB.PUB),rk(n)&&(this._localStream.pubVideo=o===lB.PUB),$B.print("publish mediaType","pubAudio: %o, pubVideo: %o",this._localStream.pubAudio,this._localStream.pubVideo)),this._localStream.hasPublished)return[3,5];y.label=1;case 1:return y.trys.push([1,3,,4]),a?null===(s=this._localStream.observer)||void 0===s||s.setLogin(!0):p&&(f=!!this._localStream.videoTrack,_=!!this._localStream.audioTrack,v=this._localStream.videoTrack instanceof tB,m=this._localStream.audioTrack instanceof rB,this._roomConfig.isAutoPublish&&!this._hasPublished?(f&&(v?null===(c=this._localStream.observer)||void 0===c||c.setPushVideo(!0):null===(u=this._localStream.observer)||void 0===u||u.setEnableVideo(!0)),_&&(m?null===(d=this._localStream.observer)||void 0===d||d.setPushAudio(!0):null===(l=this._localStream.observer)||void 0===l||l.setEnableAudio(!0))):null===(h=this._localStream.observer)||void 0===h||h.setPublish(!0)),[4,this._mediaServerClient.publish(this._localStream)];case 2:return y.sent(),this._hasPublished=!0,this.emit(cB.ON_PUBLISH_RESULT,{isScreen:!1,state:Mf.PUBLISH_SUCC}),[3,4];case 3:throw S=y.sent(),this.emit(cB.ON_PUBLISH_RESULT,{isScreen:!1,state:Mf.PUBLISH_FAIL}),S;case 4:return[3,7];case 5:return[4,this.updatePubTrack()];case 6:y.sent(),y.label=7;case 7:return[2]}}))}))},t.prototype.updatePubTrack=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return $B.print("updatePubTrack","Invoke updatePubTrack"),this._localStream?[4,this._mediaServerClient.updatePubTrack(this._localStream)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.unpublish=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return $B.print("unpublish","Invoke unpublish"),this._localStream?[4,this._mediaServerClient.unpublish(this._localStream)]:[3,2];case 1:e.sent(),this._localStream.clean(),this._localStream=void 0,e.label=2;case 2:return[2]}}))}))},t.prototype.subscribe=function(e,t,r){return e_(this,void 0,void 0,(function(){var i;return t_(this,(function(n){switch(n.label){case 0:return $B.print("subscribe","remoteStream %o",e),i=void 0,r&&(i=this._getSubLayer(r,e)),[4,this._mediaServerClient.subscribe(e,t,i)];case 1:return n.sent(),[2]}}))}))},t.prototype.updateSubTrack=function(e,t,r,i){var n;return e_(this,void 0,void 0,(function(){return t_(this,(function(o){return $B.print("updateSubTrack","Invoke updateSubTrack"),[2,null===(n=this._mediaServerClient)||void 0===n?void 0:n.updateSubTrack(e,t,r,i)]}))}))},t.prototype.updateSubVideoConfig=function(e,t){var r,i,n;return e_(this,void 0,void 0,(function(){var o,a;return t_(this,(function(s){return!(o=this._findRemoteStreamByScreen(e,!1))||!o.hasSubscribed||(null===(i=null===(r=null==o?void 0:o.attributes)||void 0===r?void 0:r.videoDescriptions)||void 0===i?void 0:i.length)<=1?[2]:(a=this._getSubLayer(t,o),o.originalStreamIndex=a.spatialLayer,[2,null===(n=this._mediaServerClient)||void 0===n?void 0:n.updateSubTrack(o,o.subMediaType,hB.SUB,a)])}))}))},t.prototype._getSubLayer=function(e,t){for(var r,i,n,o,a,s=null==t?void 0:t.attributes,c=s.videoDescriptions,u=s.subVideoDescriptions,d=Array.isArray(u)?u:c,l=-1,h=e.width*e.height,p=0;p<(null==d?void 0:d.length);p++)if(h>=(null===(r=d[p])||void 0===r?void 0:r.width)*(null===(i=d[p])||void 0===i?void 0:i.height)){l=p;break}var f=d[0];if(-1===l)f=d[l=d.length-1];else if(0!==l){var _=d[l-1].width*d[l-1].height,v=(_-h)/(_-d[l].width*d[l].height);f=v<.1?d[l-1]:d[l],l=v<.1?l-1:l}return a=null!==(n=null==f?void 0:f.sub_index)&&void 0!==n?n:-1,{spatialLayer:null!==(o=null==f?void 0:f.video_index)&&void 0!==o?o:l,spatialSubLayer:a}},t.prototype.unsubscribe=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){switch(r.label){case 0:return $B.print("unsubscribe","Invoke unsubscribe"),[4,this._mediaServerClient.unsubscribe(e,t)];case 1:return r.sent(),[2]}}))}))},t.prototype.leave=function(e){var t;return void 0===e&&(e=!1),e_(this,void 0,void 0,(function(){var r,i,n,o,a,s,c;return t_(this,(function(u){switch(u.label){case 0:$B.print("leave","Invoke leave"),r=zD(),u.label=1;case 1:u.trys.push([1,3,,4]),clearTimeout(this._reconnectTimer);try{for(i=r_(this._remoteStreams.values()),n=i.next();!n.done;n=i.next())o=n.value,Array.isArray(o)&&o.forEach((function(e){var t;null===(t=e.observer)||void 0===t||t.setLogin(!1)}))}catch(e){s={error:e}}finally{try{n&&!n.done&&(c=i.return)&&c.call(i)}finally{if(s)throw s.error}}return this._localStream&&(null===(t=this._localStream.observer)||void 0===t||t.setLogin(!1)),[4,this._mediaServerClient.leave()];case 2:return u.sent(),this.destroy(),dx.rtcLeaveRoom(0,"",zD()-r),[3,4];case 3:if(a=u.sent(),e)throw a;return this.destroy(),a instanceof Error&&dx.rtcLeaveRoom(-1,a.message,zD()-r),[3,4];case 4:return[2]}}))}))},t.prototype.setRemoteUserPriority=function(e,t){var r,i;null===(r=this.remoteStreams.get(e))||void 0===r||r.forEach((function(e){return e.setRemoteUserPriority(t)})),null===(i=this.userPriorityMap)||void 0===i||i.set(e,t)},t.prototype.destroy=function(){var e,t,r,i;$B.print("destroy","Invoke destroy"),this._destroyAndInitMediaServerClient(),this._roomInfo=void 0,this._remoteUsers=new Map;try{for(var n=r_(this._remoteStreams),o=n.next();!o.done;o=n.next()){var a=i_(o.value,2)[1];Array.isArray(a)&&a.forEach((function(e){e&&e.clean()}))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._remoteStreams=new Map,this._localStream&&(null===(r=this._localStream)||void 0===r||r.clean(),this._localStream=void 0),this._localScreenStream&&(null===(i=this._localScreenStream)||void 0===i||i.clean(),this._localScreenStream=void 0),this._context=void 0,this._reconnectRecord=new tj,this._removeHandlerEventHandler(),this._userDuplicateLoginTimerMap.forEach((function(e){clearTimeout(e)})),this._userDuplicateLoginTimerMap.clear(),this._networkQualityManager.destroy(),this._videoSizeObserver.destroy(),this._subFallbackManager.destroy()},t.prototype.updateToken=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return $B.print("updateToken","Invoke updateToken"),this._roomInfo&&(this._roomInfo.token=e),[4,this._mediaServerClient.updateToken(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.pauseAllSubscribedStream=function(e){return e_(this,void 0,void 0,(function(){var t,r,i,n,o,a,s=this;return t_(this,(function(c){t=[];try{for(r=r_(this._remoteStreams.values()),i=r.next();!i.done;i=r.next())n=i.value,Array.isArray(n)&&n.forEach((function(r){if(r.hasSubscribed){var i=s.updateSubTrack(r,e,hB.UNSUB);i&&t.push(i)}}))}catch(e){o={error:e}}finally{try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(o)throw o.error}}return[2,Promise.all(t)]}))}))},t.prototype.resumeAllSubscribedStream=function(e){return e_(this,void 0,void 0,(function(){var t,r,i,n,o,a,s=this;return t_(this,(function(c){t=[];try{for(r=r_(this._remoteStreams.values()),i=r.next();!i.done;i=r.next())n=i.value,Array.isArray(n)&&n.forEach((function(r){if(r.hasSubscribed&&r.hasSubscribed){var i=s.updateSubTrack(r,e,hB.SUB);i&&t.push(i)}}))}catch(e){o={error:e}}finally{try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(o)throw o.error}}return[2,Promise.all(t)]}))}))},t.prototype.sendUserMessage=function(e,t){var r;return null===(r=this._mediaServerClient)||void 0===r?void 0:r.sendUserMessage(e,t)},t.prototype.setSessionId=function(){this._sessionId=BD(),px.setStats({rtc_session_id:this._sessionId})},t.prototype.sendRoomMessage=function(e,t){var r,i;return void 0===t&&(t=!1),e_(this,void 0,void 0,(function(){var n,o;return t_(this,(function(a){switch(a.label){case 0:return n={clientId:null===(r=this._roomInfo)||void 0===r?void 0:r.userInfo.userId,binary:t,message:""},t?(o=n,[4,XD.ab2b64str(e)]):[3,2];case 1:return o.message=a.sent(),[3,3];case 2:n.message=e,a.label=3;case 3:return[2,null===(i=this._mediaServerClient)||void 0===i?void 0:i.sendRoomMessage(n)]}}))}))},t.prototype._destroyAndInitMediaServerClient=function(){$B.print("_destroyAndInitMediaServerClient()"),this._mediaServerClient&&(this._mediaServerClient.destroy(),this._removeHandlerEventHandler()),this._mediaServerClient=new bB(this._context),this._addHandlerEventHandler()},t.prototype._onJoinSucc=function(e,t){var r,i,n,o,a,s=this;$B.print("JoinSuccess()"),this._serverConfig=e.config;var c=[],u=[],d=[],l=[];null===(a=e.clientsDetail)||void 0===a||a.forEach((function(t){if(t.clientId!==e.clientId){var r=s._remoteUsers.get(t.clientId);r?r._stillExist=!0:c.push(t)}}));try{for(var h=r_(this._remoteUsers.values()),p=h.next();!p.done;p=h.next()){var f=p.value;f._stillExist||u.push({clientId:f.userId}),delete f._stillExist}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}e.streams.forEach((function(e){var t=s._findRemoteStreamByScreen(e.clientId,e.screen);t?(t.stillExist=!0,t.streamId=e.streamId):l.push(e)}));try{for(var _=r_(this._remoteStreams.values()),v=_.next();!v.done;v=_.next()){var m=v.value;Array.isArray(m)&&m.forEach((function(e){e.stillExist?delete e.stillExist:d.push({clientId:e.userId,streamId:e.streamId,message:xx.clientDisconnected})}))}}catch(e){n={error:e}}finally{try{v&&!v.done&&(o=_.return)&&o.call(_)}finally{if(n)throw n.error}}setTimeout((function(){u.forEach((function(e){return s._onUserDisconnection(e)})),c.forEach((function(e){return s._onUserConnection(e)})),d.forEach((function(e){return s._onRemoveStream(e)})),l.forEach((function(e){return s._onAddStream(e,!0,!1)})),t&&s._handleSendOrRecvStreamAfterReconnect()}))},t.prototype._handleSendOrRecvStreamAfterReconnect=function(){var e,t,r=this;this._localStream&&(this._localStream.clean(),this._mediaServerClient.publish(this._localStream).catch((function(e){}))),this._localScreenStream&&(this._localScreenStream.clean(),this._mediaServerClient.publish(this._localScreenStream).catch((function(e){})));try{for(var i=r_(this._remoteStreams.values()),n=i.next();!n.done;n=i.next()){var o=n.value;Array.isArray(o)&&o.forEach((function(e){return e_(r,void 0,void 0,(function(){var t;return t_(this,(function(r){switch(r.label){case 0:if(!e.hasSubscribed)return[3,4];e.resetHasSubscribed(),r.label=1;case 1:return r.trys.push([1,3,,4]),$B.print("start resubscribe ".concat(e.userId," with ").concat(e.subMediaType)),[4,this._mediaServerClient.subscribe(e,e.subMediaType)];case 2:return r.sent(),$B.print("success resubscribe ".concat(e.userId," with ").concat(e.subMediaType)),this.safeEmit(cB.RESUBSCRIBE,{stream:e}),[3,4];case 3:return t=r.sent(),$B.print("failed resubscribe ".concat(e.userId," with ").concat(e.subMediaType,", error:").concat(t)),e.clean(),null==e||e.resetHasSubscribed(),[3,4];case 4:return[2]}}))}))}))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype._findRemoteStream=function(e,t){var r=this._remoteStreams.get(e);return Array.isArray(r)?r.find((function(e){return e.streamId===t})):null},t.prototype._findRemoteStreamByScreen=function(e,t){var r=this._remoteStreams.get(e);return Array.isArray(r)?r.find((function(e){return e.isScreen===t})):null},t.prototype._onAddStream=function(e,t,r){var i,n,o,a,s,c,u,d,l,h,p;if(void 0===t&&(t=!0),void 0===r&&(r=!0),e.clientId!==(null===(i=this._roomInfo)||void 0===i?void 0:i.userInfo.userId)){var f=this._findRemoteStream(e.clientId,e.streamId);if(!f){f=new VB(e.clientId,e.streamId,e.screen,e.attributes,null===(n=this.userPriorityMap)||void 0===n?void 0:n.get(e.clientId)),this._initStreamListeners(f);var _=this._remoteStreams.get(e.clientId);_?_.push(f):this._remoteStreams.set(e.clientId,[f])}if(this._mediaServerClient.handler&&(f.observer=new BB(f,this._mediaServerClient.handler)),!f.isScreen&&(r&&f.hasVideo&&(f.attributes.extvideo?(null===(o=f.observer)||void 0===o||o.setExternalVideoSource(!0),null===(a=f.observer)||void 0===a||a.setPushVideo(!0)):(null===(s=f.observer)||void 0===s||s.setExternalVideoSource(!1),null===(c=f.observer)||void 0===c||c.setPublishVideo(!0))),r&&f.hasAudio&&!this._mediaServerClient.roomAttributes.multiChatMode&&(f.attributes.extaudio?(null===(u=f.observer)||void 0===u||u.setExternalAudioSource(!0),null===(d=f.observer)||void 0===d||d.setPushAudio(!0)):(null===(l=f.observer)||void 0===l||l.setExternalAudioSource(!1),null===(h=f.observer)||void 0===h||h.setPublishAudio(!0))),!0===t&&!1===r)){var v=this._roomConfig,m=v.isAutoSubscribeAudio,S=v.isAutoSubscribeVideo;null===(p=f.observer)||void 0===p||p.setLogin(!0,{audio:!!m,video:!!S})}return t&&this.safeEmit(Fx.ON_ADD_STREAM,{stream:f}),f}},t.prototype._onUserConnection=function(e){var t;if(e.clientId!==(null===(t=this._roomInfo)||void 0===t?void 0:t.userInfo.userId)){var r=this._userDuplicateLoginTimerMap.get(e.clientId);if("number"==typeof r)return this._userDuplicateLoginTimerMap.delete(e.clientId),void self.clearTimeout(r);var i={userId:e.clientId,extraInfo:e.attributes.extra_info};this._remoteUsers.set(e.clientId,Zf({},i)),this.safeEmit(Fx.USER_CONNECTION,{userInfo:i})}},t.prototype._onUserDisconnection=function(e){var t,r=this,i=e.clientId,n=e.tag,o=e.code;if(i)if(i===(null===(t=this.roomInfo)||void 0===t?void 0:t.userInfo.userId)){var a=null;n===Gx.kickedByAdmin?a=oP.KICKED_OUT:n===Gx.onUserTokenDidExpire?a=oP.TOKEN_EXPIRED:n===Gx.userDuplicateLogin&&(a=oP.DUPLICATE_LOGIN),o===Hx.roomDismissByAdmin&&(a=oP.ROOM_DISMISS),a&&this.safeEmit(cB.ON_ROOM_ERROR,{errorCode:a})}else{var s=wf.DROPPED;n===Gx.userLeave?s=wf.QUIT:n===Gx.kickedByAdmin?s=wf.KICKED_BY_ADMIN:n===Gx.roleChanged&&(s=wf.SWITCH_TO_INVISIBLE);var c=function(){r._remoteUsers.delete(i),r.safeEmit(cB.ON_USER_LEAVE,{userInfo:{userId:i},reason:s})};if(n===Gx.userDuplicateLogin){var u=this._userDuplicateLoginTimerMap.get(i);null!=u||self.clearTimeout(u);var d=self.setTimeout(c,5e3);this._userDuplicateLoginTimerMap.set(i,d)}else c()}},t.prototype._onRemoveStream=function(e){var t,r,i,n,o=this;if(e.clientId!==(null===(t=this._roomInfo)||void 0===t?void 0:t.userInfo.userId)){var a=this._remoteStreams.get(e.clientId);if(a){var s=a.find((function(t){return t.streamId==e.streamId}));s&&(null===(r=this._mediaServerClient)||void 0===r||r.handleRemoveStream(s,e).then((function(){if(!(null==s?void 0:s._workaround_1_)){var t=o._remoteStreams.get(e.clientId);if(!t)return;t=t.filter((function(t){return t.streamId!==e.streamId})),o._remoteStreams.set(e.clientId,t)}})).finally((function(){o.safeEmit(Fx.ON_REMOVE_STREAM,{stream:s,reason:e.message})})),s.hasVideo&&(null===(i=s.observer)||void 0===i||i.setPublishVideo(!1)),s.hasAudio&&!this._mediaServerClient.roomAttributes.multiChatMode&&(null===(n=s.observer)||void 0===n||n.setPublishAudio(!1)))}}},t.prototype._onUpdateRoomAttributes=function(e){e.roomAttributes&&(this._mediaServerClient.roomAttributes=e.roomAttributes)},t.prototype._onUpdateStreamAttributes=function(e){var t,r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S,y=e.clientId,E=e.streamId,g=e.attributes,b=this._findRemoteStream(y,E);if(b){var T=b.attributes,I=Zf(Zf({},T),g),R=!1,A=I.localaudio!==T.localaudio,C=!1,O=!1,N=I.localvideo!==T.localvideo,w=!1,P=aB.NONE,D=aB.NONE;I.audiostream!==T.audiostream&&(R=I.localaudio,C=!!I.audiostream,I.audiostream?P|=Vf.AUDIO:D|=Vf.AUDIO),I.videostream!==T.videostream&&(O=I.localvideo,w=!!I.videostream,I.videostream?P|=Vf.VIDEO:D|=Vf.VIDEO),P&&this.safeEmit(cB.ON_USER_PUBLISH_STATE_CHANGE,{userId:y,mediaType:P,isScreen:b.isScreen,pubState:lB.PUB}),D&&this.safeEmit(cB.ON_USER_PUBLISH_STATE_CHANGE,{userId:y,mediaType:D,isScreen:b.isScreen,pubState:lB.UNPUB}),I.localaudio!==T.localaudio&&(I.localaudio?(I.extaudio?(null===(t=b.observer)||void 0===t||t.setExternalAudioSource(!0),null===(r=b.observer)||void 0===r||r.setPushAudio(!0)):(null===(i=b.observer)||void 0===i||i.setExternalAudioSource(!1),null===(n=b.observer)||void 0===n||n.setEnableAudio(!0)),this.safeEmit(cB.ON_USER_START_AUDIO_CAPTURE,{userId:y})):(I.extaudio?(null===(o=b.observer)||void 0===o||o.setExternalAudioSource(!0),null===(a=b.observer)||void 0===a||a.setPushAudio(!1)):(null===(s=b.observer)||void 0===s||s.setExternalAudioSource(!1),null===(c=b.observer)||void 0===c||c.setEnableAudio(!1)),this.safeEmit(cB.ON_USER_STOP_AUDIO_CAPTURE,{userId:y}))),I.localvideo!==T.localvideo&&(I.localvideo?(I.extvideo?(null===(u=b.observer)||void 0===u||u.setExternalVideoSource(!0),null===(d=b.observer)||void 0===d||d.setPushVideo(!0)):(null===(l=b.observer)||void 0===l||l.setExternalVideoSource(!1),null===(h=b.observer)||void 0===h||h.setEnableVideo(!0)),this.safeEmit(cB.ON_USER_START_VIDEO_CAPTURE,{userId:y})):(I.extvideo?(null===(p=b.observer)||void 0===p||p.setExternalVideoSource(!0),null===(f=b.observer)||void 0===f||f.setPushVideo(!1)):(null===(_=b.observer)||void 0===_||_.setExternalVideoSource(!1),null===(v=b.observer)||void 0===v||v.setEnableVideo(!1)),this.safeEmit(cB.ON_USER_STOP_VIDEO_CAPTURE,{userId:y}))),R&&!A&&(null===(m=b.observer)||void 0===m||m.setRemoteUnmuteAudio(C)),O&&!N&&(null===(S=b.observer)||void 0===S||S.setRemoteUnmuteVideo(w)),b.attributes=I}},t.prototype._onPushTrack=function(e){var t=this,r=e.clientId,i=e.streamId,n=this._findRemoteStream(r,i);n||(n=this._onAddStream(e,!1,!1)),this._mediaServerClient.subscribe4pushTrack(n,e).then((function(){return t.safeEmit(cB.SUBSCRIBE_PUSH_TRACK,{stream:n})})).catch((function(e){$B.print("subscribe push track failed: ".concat(e))}))},t.prototype._onRemoveTrack=function(e){var t=this,r=e.clientId,i=e.streamId,n=e.message,o=this._findRemoteStream(r,i);o&&this._mediaServerClient.unsubscribe4removeTrack(o,n).then((function(){var e;if(o._workaround_1_){var n=null===(e=t._remoteStreams.get(r))||void 0===e?void 0:e.filter((function(e){return e.streamId!==i}));t._remoteStreams.set(r,n||[])}t.safeEmit(cB.REMOVE_PUSH_TRACK,{stream:o})})).catch((function(e){$B.print("remove push track failed: ".concat(e))}))},t.prototype._nodeChange=function(e){var t,r=e.nodes,i=e.reason;Cx.clearAccessNode(null===(t=this._roomInfo)||void 0===t?void 0:t.appId),this._destroyAndInitMediaServerClient(),Array.isArray(r)&&r.length?this._getAccessNode=r[0]:this._getAccessFeedback=i,dx.rtcNodeChange(0,JSON.stringify(e),JSON.stringify(i)),this._joinResolveCallback&&this._joinRejectCallback?this._join(this._joinResolveCallback,this._joinRejectCallback):this._reconnect()},t.prototype._reconnect=function(){var e,t,r=this;this._isReconnecting=!0;try{for(var i=r_(this._remoteStreams.values()),n=i.next();!n.done;n=i.next()){var o=n.value;Array.isArray(o)&&o.forEach((function(e){return e.clean()}))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}dx.rtcReconnect(1002,EL.PEERCONNECTION_RECONNECTING,this._roomInfo.userInfo.userId,gL.PEERCONNECTION),this._join((function(){dx.rtcReconnected(bL.PEERCONNECTION_RECONNECTED,TL.PEERCONNECTION)}),(function(e){r._reconnectRecord.record(e),r._reconnectRecord.shouldReconnect?($B.print("Reconnecting error, will reconnect after 3s",e),r._reconnectTimer=setTimeout(r._reconnect.bind(r),3e3)):(r.safeEmit(cB.RECONNECT_FAILED),r.destroy())}),!0)},t.prototype._handleAbnormalDisconnection=function(){$B.print("on ABNORMAL_DISCONNECTION"),this._destroyAndInitMediaServerClient(),navigator.onLine?this._reconnect():this._reconnectTimer=setTimeout(this._reconnect.bind(this),3e3)},t.prototype._onConnectionStateChange=function(e){var t;if(e.next===mB.DISCONNECTED)t=Bf.CONNECTION_STATE_DISCONNECTED;else if(e.next===mB.CONNECTED)t=this._isReconnecting?Bf.CONNECTION_STATE_RECONNECTED:Bf.CONNECTION_STATE_CONNECTED;else{if(e.next!==mB.CONNECTING)return;t=this._isReconnecting?Bf.CONNECTION_STATE_RECONNECTING:Bf.CONNECTION_STATE_CONNECTING}this._networkQualityManager.setConnectionState(e.next),this.safeEmit(jx.ON_CONNECTION_STATE_CHANGE,{state:t})},t.prototype._initStreamListeners=function(e){var t=this;e.on("ontrack",(function(e){e.track})),e.on("onSEIMessage",(function(r){var i;t.emit(cB.ON_SEI_MESSAGED_RECEIVED,{sei:r,remoteStreamKey:{userId:e.userId,roomId:null===(i=t._roomInfo)||void 0===i?void 0:i.roomId,streamIndex:e.isScreen?xf.STREAM_INDEX_SCREEN:xf.STREAM_INDEX_MAIN}})}))},t.prototype._onCustomMessage=function(e){this.safeEmit(Fx.ON_CUSTOM_MESSAGE,e)},t.prototype._onUserMessageReceived=function(e){this.safeEmit(Fx.USER_MESSAGE_RECEIVED,{userId:e.from,message:e.msg})},t.prototype._onUserBinaryMessageReceived=function(e){this.safeEmit(Fx.USER_BINARY_MESSAGE_RECEIVED,{userId:e.from,message:e.msg})},t.prototype._onPostProcessingMessage=function(e){if(e.body){var t=e.body,r=t.error||0,i=dB.START,n=["success","parameter error","subscription timeout","ffmpeg error","cdn error","publish error"];if("2.0"===t.protocol){switch(t.eventType){case"TranscodeStarted":0!==t.error&&(i=dB.START_FAILED);break;case"TranscodeStateChanged":i=0!==t.error?dB.START_FAILED:dB.START_SUCCESS;break;case"TranscodeStopped":i=0!==t.error?dB.STOP_FAILED:dB.STOP_SUCCESS;break;case"TranscodeUpdated":i=0!==t.error?dB.UPDATE_FAILED:dB.UPDATE_SUCCESS}this.safeEmit(Fx.POST_PROCESSING_MESSAGE,{code:r,protocol:t.protocol,error:t.error,eventType:i,message:n[r]})}this.safeEmit(Fx.POST_PROCESSING_MESSAGE,{code:r,message:n[r],type:e.type})}},t.prototype._onUserTokenWillExpire=function(){this.safeEmit(Fx.ON_USER_TOKEN_WILL_EXPIRE,null)},t.prototype._onSceneConfig=function(e){var t,r,i=e.multiSceneConfig,n=SB[this._roomConfig.roomProfileType][1];if(i){var o=i[n];o&&o.engine_BAC&&(null===(t=this._context)||void 0===t||t.audioProfileManager.updateEngineBAC(o.engine_BAC)),o&&o.engine_ANM&&(null===(r=this._context)||void 0===r||r.audioProfileManager.updateEngineANM(o.engine_ANM))}},t.prototype._onStreamControlMessage=function(e){var t,r;e.type===Vx.PushLimitWarn&&((null===(t=this._localStream)||void 0===t?void 0:t.pubAudio)||(null===(r=this._localStream)||void 0===r?void 0:r.pubVideo)||this.unpublish())},t.prototype._onPublishOnDemand=function(e){var t,r,i,n,o,a,s,c,u,d,l;if(!1!==(null===(i=null===(r=null===(t=this._serverConfig)||void 0===t?void 0:t.engine_VPM)||void 0===r?void 0:r.ondemand)||void 0===i?void 0:i.enable)&&(null===(n=this._localStream)||void 0===n?void 0:n.enableSimulcast)&&(null===(o=this._localStream)||void 0===o?void 0:o.videoTransceiver)){var h=null===(a=this._localStream)||void 0===a?void 0:a.stream.id,p=null===(s=this._localStream)||void 0===s?void 0:s.videoTransceiver.sender,f=p.getParameters();if(Array.isArray(f.encodings)&&Array.isArray(e)){var _={};$B.print("_onPublishOnDemand","usedDescriptions: %o",e),e.forEach((function(e){var t;if(null===(t=null==e?void 0:e.StreamIds)||void 0===t?void 0:t.includes(h)){var r=null==e?void 0:e.Metadata.SubvideoIndex;_[r]=r}}));var v={};null===(u=null===(c=this._localStream)||void 0===c?void 0:c.subVideoDescriptions)||void 0===u||u.forEach((function(e){void 0!==_[e.sub_index]&&(v[e.video_index]=e)}));var m=(null===(l=null===(d=p.track)||void 0===d?void 0:d.getSettings())||void 0===l?void 0:l.height)||720,S=[];f.encodings=f.encodings.map((function(e){return e.rid&&(v[e.rid]?(e.active=!0,e.scaleResolutionDownBy=Math.max(m/v[e.rid].height,1),S.push({type:1,rid:e.rid,downBy:e.scaleResolutionDownBy})):(S.push({type:0,rid:e.rid}),e.active=!1)),e})),dx.rtcInvokeStatus(JSON.stringify(S),0,"rscp",h,0)}p.setParameters(f)}},t.prototype._reportNetworkQuality=function(e,t){this._subFallbackManager.updateNetworkQuality(e,t),this.emit(cB.ON_NETWORK_QUALITY,e,t)},t.prototype._emitVideoSizeChange=function(e,t,r,i){var n;this.emit(cB.ON_REMOTE_VIDEO_SIZE_CHANGED,{roomId:null===(n=this.roomInfo)||void 0===n?void 0:n.roomId,userId:e,streamIndex:t?xf.STREAM_INDEX_SCREEN:xf.STREAM_INDEX_MAIN},{width:r,height:i})},t.prototype._emitSubscribeFallback=function(e){this.emit(cB.ON_SIMULCAST_SUBSCRIBE_FALLBACK,e)},t}(Tk),tj=function(){function e(){this._all_201_count=0,this._has_4xx=!1}return Object.defineProperty(e.prototype,"shouldReconnect",{get:function(){return!(this._all_201_count>=3||this._has_4xx)},enumerable:!1,configurable:!0}),e.prototype.record=function(e){var t=!1,r=!1;if(Array.isArray(e)){var i=0;e.map((function(e){var t,n,o;400<=(null===(t=e.error)||void 0===t?void 0:t.code)&&(null===(n=e.error)||void 0===n?void 0:n.code)<500&&(r=!0),201===(null===(o=e.error)||void 0===o?void 0:o.code)&&i++})),i===e.length&&(t=!0),t&&this._all_201_count++,r&&(this._has_4xx=!0)}},e.prototype.clear=function(){this._all_201_count=0,this._has_4xx=!1},e}(),rj=function(e,t){void 0===t&&(t={});var r=document.createElement(e);return t.id&&(r.id=t.id),t.classList&&t.classList.forEach((function(e){r.classList.add(e)})),t.style&&Object.assign(r.style,t.style),t.attributes&&Object.entries(t.attributes).forEach((function(e){var t=i_(e,2),i=t[0],n=t[1];"muted"===i?r.muted=!0:r.setAttribute(i,n)})),r},ij=function(e,t){return void 0===t&&(t={}),t.id&&(e.id=t.id),t.classList&&t.classList.forEach((function(t){e.classList.add(t)})),t.style&&Object.assign(e.style,t.style),t.attributes&&Object.entries(t.attributes).forEach((function(t){var r=i_(t,2),i=r[0],n=r[1];e.setAttribute(i,n)})),e},nj=new gk("Player",0),oj=["play","playing","pause","ended","error","seeking","seeked","waiting","canplay","canplaythrough","durationchange","volumechange","loadedmetadata","loadeddata","loadstart","timeupdate"],aj={playsinline:"","webkit-playsinline":""},sj={playsinline:"","webkit-playsinline":"","x5-playsinline":"","x5-video-player-type":"h5","x-webkit-airplay":"allow",preload:"",muted:""},cj=new(function(){function e(){this.videoCache=[],this.audioCache=[]}return e.prototype.getOrCreate=function(e,t){var r="audio"===e?aj:sj;if("video"===e&&this.videoCache.length>0){if(i=this.videoCache.pop())return ij(i,{style:t,attributes:r}),i}else if("audio"===e&&this.audioCache.length>0){var i;if(i=this.audioCache.pop())return ij(i,{style:t,attributes:r}),i}return rj(e,{style:t,attributes:r})},e.prototype.recycle=function(e){for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e instanceof HTMLVideoElement?this.videoCache.push(e):this.audioCache.push(e)},e}()),uj=function(e){function t(t){var r=e.call(this)||this;r.mirrorType=jf.MIRROR_TYPE_NONE,r.emitVideoEvent=function(e){var t,i,n={type:"video",rawEvent:e,readyState:(null===(t=r._videoDom)||void 0===t?void 0:t.readyState)||0,userId:r.userId,eventName:e.type,currentTime:(null===(i=r._videoDom)||void 0===i?void 0:i.currentTime)||0,isScreen:r.isScreen};r.emit("playback_event",n)},r._internalPlay=function(){var e;if(null===(e=r._videoDom)||void 0===e?void 0:e.paused){var t=r._videoDom.play();(null==t?void 0:t.then)&&t.catch((function(e){var t,i;dx.rtcError("video autoplay failed, userId: ".concat(r.userId),-1e3),r.emit("playback_event",{type:"video",rawEvent:e,readyState:(null===(t=r._videoDom)||void 0===t?void 0:t.readyState)||0,userId:r.userId,eventName:"autoplay-error",currentTime:(null===(i=r._videoDom)||void 0===i?void 0:i.currentTime)||0})}))}};var i=t.renderDom,n=t.userId;r.renderMode=void 0!==t.renderMode?t.renderMode:Lf.RENDER_MODE_FIT;var o="string"==typeof i?document.getElementById(i):i;if(!o)throw new dP(oP.CANT_FIND_DOM,"can't find dom");return r._containerDom=o,r.userId=n,r.isScreen=!!t.isScreen,r._initVideo(),r}return Cf(t,e),t.prototype._initVideo=function(){this._videoDom||(this._videoDom=cj.getOrCreate("video",{width:"100%",height:"100%",background:"black"}),this._videoDom.id="".concat(this.userId,"_").concat(HD()),this.renderMode===Lf.RENDER_MODE_FIT?this._videoDom.style.objectFit="contain":this._videoDom.style.objectFit="cover",this.mirror(this.mirrorType===jf.MIRROR_TYPE_RENDER)),this._initListeners()},t.prototype._initListeners=function(){var e=this;this._videoDom&&oj.forEach((function(t){var r;null===(r=e._videoDom)||void 0===r||r.addEventListener(t,e.emitVideoEvent)}))},t.prototype._removeListeners=function(){var e=this;this._videoDom&&(oj.forEach((function(t){var r;null===(r=e._videoDom)||void 0===r||r.removeEventListener(t,e.emitVideoEvent)})),this._videoDom.addEventListener("canplay",this._internalPlay),this._videoDom.addEventListener("loadeddata",this._internalPlay))},t.prototype._recordFrame=function(e){var t=this;this.on("playback_event",(function(r){var i;if("timeupdate"===r.eventName){var n=e.isScreen?1.5:.5;if(void 0===t.__cumulativeTime&&(t.__cumulativeTime=0),0===(null===(i=t._videoDom)||void 0===i?void 0:i.currentTime))return;if(e.recordedVideoFrames||(e.recordedVideoFrames=[]),t._videoDom.currentTime>t.__cumulativeTime){var o=Math.floor(1e3*(t._videoDom.currentTime-t.__cumulativeTime)),a=t._videoDom.currentTime-t.__cumulativeTime>n;e.recordedVideoFrames.push({playTime:t._videoDom.currentTime,isStall:a,stallCount:a?1:0,stallDuration:o%2e3})}t.__cumulativeTime=t._videoDom.currentTime}}))},t.prototype.playVideo=function(e,t){var r;return e_(this,void 0,void 0,(function(){var i,n,o=this;return t_(this,(function(a){return i=this._videoDom,nj.print("playVideo","play video track: ".concat(this.userId)),i&&i.srcObject instanceof MediaStream&&i.srcObject.getTrackById(null===(r=e.getTrack())||void 0===r?void 0:r.id)||(i||(this._initVideo(),i=this._videoDom),nj.print("playVideo","play video by dom: ".concat(null==i?void 0:i.id)),(n=new MediaStream).addTrack(e.getTrack()),i.srcObject=n,this._containerDom.appendChild(i),i.addEventListener("canplay",this._internalPlay),i.addEventListener("loadeddata",this._internalPlay),setTimeout((function(){return o._internalPlay()})),t&&this._recordFrame(t)),[2]}))}))},t.prototype.updateSrcObject=function(e){var t=e.getTrack();if(t&&this._videoDom){var r=new MediaStream;r.addTrack(t),this._videoDom.srcObject=r}},t.prototype.manuallyPlay=function(){if(nj.print("Invoke AudioPlayer.manuallyPlay"),!this._videoDom)throw new dP(oP.INVALID_PARAMS,"Player not found");var e=this._videoDom.play();return(null==e?void 0:e.then)?e:Promise.resolve(e)},t.prototype.mirror=function(e){nj.print("mirror","".concat(this.userId," set mirror: ").concat(e)),this.mirrorType=e?jf.MIRROR_TYPE_RENDER:jf.MIRROR_TYPE_NONE,this._videoDom&&(this._videoDom.style.transform=e?"rotateY(180deg)":"")},t.prototype.stop=function(){var e=this._containerDom;nj.print("stop","stop video track: ".concat(this.userId)),this._videoDom&&(this._videoDom.srcObject=null,e&&e.contains(this._videoDom)&&e.removeChild(this._videoDom)),this.__cumulativeTime=void 0},t.prototype.destroy=function(){nj.print("destroy","video player: ".concat(this.userId)),this.stop(),e.prototype.removeAllListeners.call(this),this._removeListeners(),this._videoDom&&(cj.recycle(this._videoDom),delete this._videoDom)},Object.defineProperty(t.prototype,"domElement",{get:function(){return this._videoDom},enumerable:!1,configurable:!0}),t}(mk.exports.EventEmitter),dj=function(e){function t(t,r){var i=e.call(this)||this;if(i.emitVideoEvent=function(e){var t,r,n={type:"audio",rawEvent:e,readyState:(null===(t=i._audioDom)||void 0===t?void 0:t.readyState)||0,userId:i.userId,eventName:e.type,currentTime:(null===(r=i._audioDom)||void 0===r?void 0:r.currentTime)||0};i.emit("playback_event",n)},i._internalPlay=function(){var e,t;if(yx("_internalPlay",{paused:null===(e=i._audioDom)||void 0===e?void 0:e.paused}),null===(t=i._audioDom)||void 0===t?void 0:t.paused)try{var r=i._audioDom.play();(null==r?void 0:r.then)&&r.catch((function(e){i._autoPlayError(e)})).then((function(){yx("_internalPlay successfully",{userId:i.userId})}))}catch(e){i._autoPlayError(e)}},r){var n=document.getElementById(r);if(!n)throw new dP(oP.CANT_FIND_DOM,"can't find dom");i._containerDom=n}else i._containerDom=document.body;return i.userId=t,i._initAudio(),i}return Cf(t,e),t.prototype._initAudio=function(){this._audioDom||(this._audioDom=cj.getOrCreate("audio",{display:"none"}),this._audioDom.id="".concat(this.userId,"_").concat(HD()),this._containerDom.appendChild(this._audioDom)),this._initListeners()},t.prototype._initListeners=function(){var e=this;this._audioDom&&oj.forEach((function(t){var r;null===(r=e._audioDom)||void 0===r||r.addEventListener(t,e.emitVideoEvent)}))},t.prototype._removeListeners=function(){var e=this;this._audioDom&&(oj.forEach((function(t){var r;null===(r=e._audioDom)||void 0===r||r.removeEventListener(t,e.emitVideoEvent)})),this._audioDom.removeEventListener("canplay",this._internalPlay),this._audioDom.removeEventListener("loadeddata",this._internalPlay))},t.prototype.playAudio=function(e){var t;return e_(this,void 0,void 0,(function(){var r,i,n=this;return t_(this,(function(o){return nj.print("playAudio","play audio track: ".concat(this.userId)),(r=this._audioDom)&&r.srcObject instanceof MediaStream&&r.srcObject.getTrackById(null===(t=e.getTrack())||void 0===t?void 0:t.id)||(r||(this._initAudio(),r=this._audioDom),(i=new MediaStream).addTrack(e.getTrack()),r.srcObject=i,null==r||r.addEventListener("canplay",this._internalPlay),null==r||r.addEventListener("loadeddata",this._internalPlay),setTimeout((function(){return n._internalPlay()}))),[2]}))}))},t.prototype._autoPlayError=function(e){var t,r;dx.rtcError("audio autoplay failed, userId: ".concat(this.userId,": ").concat(e.message),-1e3),this.emit("playback_event",{type:"audio",rawEvent:e,readyState:(null===(t=this._audioDom)||void 0===t?void 0:t.readyState)||0,userId:this.userId,eventName:"autoplay-error",currentTime:(null===(r=this._audioDom)||void 0===r?void 0:r.currentTime)||0})},t.prototype.manuallyPlay=function(){if(nj.print("Invoke AudioPlayer.manuallyPlay"),!this._audioDom)throw new dP(oP.INVALID_PARAMS,"Player not found");var e=this._audioDom.play();return(null==e?void 0:e.then)?e:Promise.resolve(e)},t.prototype.setPlaybackDevice=function(e){return e_(this,void 0,void 0,(function(){var t;return t_(this,(function(r){switch(r.label){case 0:return nj.print("setPlaybackDevice","setPlaybackDevice: ".concat(e)),[4,xF.enumerateAudioPlaybackDevices()];case 1:return t=r.sent(),t.map((function(e){return e.deviceId})).includes(e)&&this._audioDom&&this._audioDom.setSinkId?[4,this._audioDom.setSinkId(e)]:[2];case 2:return r.sent(),[2]}}))}))},t.prototype.stop=function(){var e=this._containerDom;nj.print("stopAudio","stop audio track: ".concat(this.userId)),this._audioDom&&(this._audioDom.srcObject=null,e&&e.contains(this._audioDom)&&e.removeChild(this._audioDom))},Object.defineProperty(t.prototype,"domElement",{get:function(){return this._audioDom},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){nj.print("destroy","audio player: ".concat(this.userId)),this.stop(),e.prototype.removeAllListeners.call(this),this._removeListeners(),this._audioDom&&(cj.recycle(this._audioDom),delete this._audioDom)},t}(mk.exports.EventEmitter),lj="object"==("undefined"==typeof global?"undefined":t(global))&&global&&global.Object===Object&&global,hj="object"==("undefined"==typeof self?"undefined":t(self))&&self&&self.Object===Object&&self,pj=lj||hj||Function("return this")(),fj=pj.Symbol,_j=Object.prototype,vj=_j.hasOwnProperty,mj=_j.toString,Sj=fj?fj.toStringTag:void 0;var yj=Object.prototype.toString;var Ej=fj?fj.toStringTag:void 0;function gj(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ej&&Ej in Object(e)?function(e){var t=vj.call(e,Sj),r=e[Sj];try{e[Sj]=void 0;var i=!0}catch(e){}var n=mj.call(e);return i&&(t?e[Sj]=r:delete e[Sj]),n}(e):function(e){return yj.call(e)}(e)}function bj(e){return null!=e&&"object"==t(e)}var Tj=Array.isArray;function Ij(e){var r=t(e);return null!=e&&("object"==r||"function"==r)}function Rj(e){return e}function Aj(e){if(!Ij(e))return!1;var t=gj(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var Cj=pj["__core-js_shared__"],Oj=function(){var e=/[^.]+$/.exec(Cj&&Cj.keys&&Cj.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var Nj=Function.prototype.toString;var wj=/^\[object .+?Constructor\]$/,Pj=Function.prototype,Dj=Object.prototype,kj=Pj.toString,Mj=Dj.hasOwnProperty,Uj=RegExp("^"+kj.call(Mj).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Lj(e){return!(!Ij(e)||(t=e,Oj&&Oj in t))&&(Aj(e)?Uj:wj).test(function(e){if(null!=e){try{return Nj.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function xj(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Vj=Date.now;var Fj,Bj,jj,Gj=function(){try{var e=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Lj(r)?r:void 0}(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Hj=Gj,zj=Hj?function(e,t){return Hj(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:Rj,Kj=(Fj=zj,Bj=0,jj=0,function(){var e=Vj(),t=16-(e-jj);if(jj=e,t>0){if(++Bj>=800)return arguments[0]}else Bj=0;return Fj.apply(void 0,arguments)}),Wj=Kj,Xj=/^(?:0|[1-9]\d*)$/;function Yj(e,r){var i=t(e);return!!(r=null==r?9007199254740991:r)&&("number"==i||"symbol"!=i&&Xj.test(e))&&e>-1&&e%1==0&&e<r}function Jj(e,t,r){"__proto__"==t&&Hj?Hj(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function qj(e,t){return e===t||e!=e&&t!=t}var Qj=Object.prototype.hasOwnProperty;function Zj(e,t,r){var i=e[t];Qj.call(e,t)&&qj(i,r)&&(void 0!==r||t in e)||Jj(e,t,r)}var $j=Math.max;function eG(e,t){return Wj(function(e,t,r){return t=$j(void 0===t?e.length-1:t,0),function(){for(var i=arguments,n=-1,o=$j(i.length-t,0),a=Array(o);++n<o;)a[n]=i[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=i[n];return s[t]=r(a),xj(e,this,s)}}(e,t,Rj),e+"")}function tG(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function rG(e){return null!=e&&tG(e.length)&&!Aj(e)}var iG=Object.prototype;function nG(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||iG)}function oG(e){return bj(e)&&"[object Arguments]"==gj(e)}var aG=Object.prototype,sG=aG.hasOwnProperty,cG=aG.propertyIsEnumerable,uG=oG(function(){return arguments}())?oG:function(e){return bj(e)&&sG.call(e,"callee")&&!cG.call(e,"callee")},dG=uG;var lG="object"==("undefined"==typeof exports?"undefined":t(exports))&&exports&&!exports.nodeType&&exports,hG=lG&&"object"==("undefined"==typeof module?"undefined":t(module))&&module&&!module.nodeType&&module,pG=hG&&hG.exports===lG?pj.Buffer:void 0,fG=(pG?pG.isBuffer:void 0)||function(){return!1},_G={};_G["[object Float32Array]"]=_G["[object Float64Array]"]=_G["[object Int8Array]"]=_G["[object Int16Array]"]=_G["[object Int32Array]"]=_G["[object Uint8Array]"]=_G["[object Uint8ClampedArray]"]=_G["[object Uint16Array]"]=_G["[object Uint32Array]"]=!0,_G["[object Arguments]"]=_G["[object Array]"]=_G["[object ArrayBuffer]"]=_G["[object Boolean]"]=_G["[object DataView]"]=_G["[object Date]"]=_G["[object Error]"]=_G["[object Function]"]=_G["[object Map]"]=_G["[object Number]"]=_G["[object Object]"]=_G["[object RegExp]"]=_G["[object Set]"]=_G["[object String]"]=_G["[object WeakMap]"]=!1;var vG="object"==("undefined"==typeof exports?"undefined":t(exports))&&exports&&!exports.nodeType&&exports,mG=vG&&"object"==("undefined"==typeof module?"undefined":t(module))&&module&&!module.nodeType&&module,SG=mG&&mG.exports===vG&&lj.process,yG=function(){try{var e=mG&&mG.require&&mG.require("util").types;return e||SG&&SG.binding&&SG.binding("util")}catch(e){}}(),EG=yG&&yG.isTypedArray,gG=EG?function(e){return function(t){return e(t)}}(EG):function(e){return bj(e)&&tG(e.length)&&!!_G[gj(e)]},bG=gG,TG=Object.prototype.hasOwnProperty;function IG(e,t){var r=Tj(e),i=!r&&dG(e),n=!r&&!i&&fG(e),o=!r&&!i&&!n&&bG(e),a=r||i||n||o,s=a?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],c=s.length;for(var u in e)!t&&!TG.call(e,u)||a&&("length"==u||n&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Yj(u,c))||s.push(u);return s}var RG=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),AG=RG,CG=Object.prototype.hasOwnProperty;function OG(e){return rG(e)?IG(e):function(e){if(!nG(e))return AG(e);var t=[];for(var r in Object(e))CG.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}var NG=Object.prototype.hasOwnProperty;function wG(e){if(!Ij(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=nG(e),r=[];for(var i in e)("constructor"!=i||!t&&NG.call(e,i))&&r.push(i);return r}var PG,DG=(PG=function(e,t){!function(e,t,r,i){var n=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=i?i(r[s],e[s],s,r,e):void 0;void 0===c&&(c=e[s]),n?Jj(r,s,c):Zj(r,s,c)}}(t,function(e){return rG(e)?IG(e,!0):wG(e)}(t),e)},eG((function(e,r){var i=-1,n=r.length,o=n>1?r[n-1]:void 0,a=n>2?r[2]:void 0;for(o=PG.length>3&&"function"==typeof o?(n--,o):void 0,a&&function(e,r,i){if(!Ij(i))return!1;var n=t(r);return!!("number"==n?rG(i)&&Yj(r,i.length):"string"==n&&r in i)&&qj(i[r],e)}(r[0],r[1],a)&&(o=n<3?void 0:o,n=1),e=Object(e);++i<n;){var s=r[i];s&&PG(e,s,i,o)}return e}))),kG=DG;function MG(e,t){return function(e,t){for(var r=-1,i=null==e?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}(t,(function(t){return e[t]}))}function UG(e){return null==e?[]:MG(e,OG(e))}var LG=a,xG=$e("iterator"),VG=!LG((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),r+=i+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[xG]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),FG=I,BG=2147483647,jG=/[^\0-\u007E]/,GG=/[.\u3002\uFF0E\uFF61]/g,HG="Overflow: input needs wider integers to process",zG=n.RangeError,KG=FG(GG.exec),WG=Math.floor,XG=String.fromCharCode,YG=FG("".charCodeAt),JG=FG([].join),qG=FG([].push),QG=FG("".replace),ZG=FG("".split),$G=FG("".toLowerCase),eH=function(e){return e+22+75*(e<26)},tH=function(e,t,r){var i=0;for(e=r?WG(e/700):e>>1,e+=WG(e/t);e>455;)e=WG(e/35),i+=36;return WG(i+36*e/(e+38))},rH=function(e){var t=[];e=function(e){for(var t=[],r=0,i=e.length;r<i;){var n=YG(e,r++);if(n>=55296&&n<=56319&&r<i){var o=YG(e,r++);56320==(64512&o)?qG(t,((1023&n)<<10)+(1023&o)+65536):(qG(t,n),r--)}else qG(t,n)}return t}(e);var r,i,n=e.length,o=128,a=0,s=72;for(r=0;r<e.length;r++)(i=e[r])<128&&qG(t,XG(i));var c=t.length,u=c;for(c&&qG(t,"-");u<n;){var d=BG;for(r=0;r<e.length;r++)(i=e[r])>=o&&i<d&&(d=i);var l=u+1;if(d-o>WG((BG-a)/l))throw zG(HG);for(a+=(d-o)*l,o=d,r=0;r<e.length;r++){if((i=e[r])<o&&++a>BG)throw zG(HG);if(i==o){for(var h=a,p=36;;){var f=p<=s?1:p>=s+26?26:p-s;if(h<f)break;var _=h-f,v=36-f;qG(t,XG(eH(f+_%v))),h=WG(_/v),p+=36}qG(t,XG(eH(h))),s=tH(a,l,u==c),a=0,u++}}a++,o++}return JG(t,"")},iH=Wi,nH=n,oH=W,aH=l,sH=I,cH=VG,uH=Yt.exports,dH=ic,lH=Go,hH=Ph,pH=Or,fH=lc,_H=B,vH=xe,mH=Wo,SH=lo,yH=kt,EH=G,gH=fo,bH=Rn,TH=S,IH=Oc,RH=gc,AH=lu,CH=hI,OH=$e("iterator"),NH="URLSearchParams",wH="URLSearchParamsIterator",PH=pH.set,DH=pH.getterFor(NH),kH=pH.getterFor(wH),MH=oH("fetch"),UH=oH("Request"),LH=oH("Headers"),xH=UH&&UH.prototype,VH=LH&&LH.prototype,FH=nH.RegExp,BH=nH.TypeError,jH=nH.decodeURIComponent,GH=nH.encodeURIComponent,HH=sH("".charAt),zH=sH([].join),KH=sH([].push),WH=sH("".replace),XH=sH([].shift),YH=sH([].splice),JH=sH("".split),qH=sH("".slice),QH=/\+/g,ZH=Array(4),$H=function(e){return ZH[e-1]||(ZH[e-1]=FH("((?:%[\\da-f]{2}){"+e+"})","gi"))},ez=function(e){try{return jH(e)}catch(t){return e}},tz=function(e){var t=WH(e,QH," "),r=4;try{return jH(t)}catch(e){for(;r;)t=WH(t,$H(r--),ez);return t}},rz=/[!'()~]|%20/g,iz={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},nz=function(e){return iz[e]},oz=function(e){return WH(GH(e),rz,nz)},az=hH((function(e,t){PH(this,{type:wH,iterator:IH(DH(e).entries),kind:t})}),"Iterator",(function(){var e=kH(this),t=e.kind,r=e.iterator.next(),i=r.value;return r.done||(r.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),r}),!0),sz=function(e){this.entries=[],this.url=null,void 0!==e&&(EH(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===HH(e,0)?qH(e,1):e:gH(e)))};sz.prototype={type:NH,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,i,n,o,a,s,c=RH(e);if(c)for(r=(t=IH(e,c)).next;!(i=aH(r,t)).done;){if(o=(n=IH(yH(i.value))).next,(a=aH(o,n)).done||(s=aH(o,n)).done||!aH(o,n).done)throw BH("Expected sequence with length 2");KH(this.entries,{key:gH(a.value),value:gH(s.value)})}else for(var u in e)vH(e,u)&&KH(this.entries,{key:u,value:gH(e[u])})},parseQuery:function(e){if(e)for(var t,r,i=JH(e,"&"),n=0;n<i.length;)(t=i[n++]).length&&(r=JH(t,"="),KH(this.entries,{key:tz(XH(r)),value:tz(zH(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],i=0;i<t.length;)e=t[i++],KH(r,oz(e.key)+"="+oz(e.value));return zH(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var cz=function(){fH(this,uz);var e=arguments.length>0?arguments[0]:void 0;PH(this,new sz(e))},uz=cz.prototype;if(dH(uz,{append:function(e,t){AH(arguments.length,2);var r=DH(this);KH(r.entries,{key:gH(e),value:gH(t)}),r.updateURL()},delete:function(e){AH(arguments.length,1);for(var t=DH(this),r=t.entries,i=gH(e),n=0;n<r.length;)r[n].key===i?YH(r,n,1):n++;t.updateURL()},get:function(e){AH(arguments.length,1);for(var t=DH(this).entries,r=gH(e),i=0;i<t.length;i++)if(t[i].key===r)return t[i].value;return null},getAll:function(e){AH(arguments.length,1);for(var t=DH(this).entries,r=gH(e),i=[],n=0;n<t.length;n++)t[n].key===r&&KH(i,t[n].value);return i},has:function(e){AH(arguments.length,1);for(var t=DH(this).entries,r=gH(e),i=0;i<t.length;)if(t[i++].key===r)return!0;return!1},set:function(e,t){AH(arguments.length,1);for(var r,i=DH(this),n=i.entries,o=!1,a=gH(e),s=gH(t),c=0;c<n.length;c++)(r=n[c]).key===a&&(o?YH(n,c--,1):(o=!0,r.value=s));o||KH(n,{key:a,value:s}),i.updateURL()},sort:function(){var e=DH(this);CH(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,r=DH(this).entries,i=mH(e,arguments.length>1?arguments[1]:void 0),n=0;n<r.length;)i((t=r[n++]).value,t.key,this)},keys:function(){return new az(this,"keys")},values:function(){return new az(this,"values")},entries:function(){return new az(this,"entries")}},{enumerable:!0}),uH(uz,OH,uz.entries,{name:"entries"}),uH(uz,"toString",(function(){return DH(this).serialize()}),{enumerable:!0}),lH(cz,NH),iH({global:!0,forced:!cH},{URLSearchParams:cz}),!cH&&_H(LH)){var dz=sH(VH.has),lz=sH(VH.set),hz=function(e){if(EH(e)){var t,r=e.body;if(SH(r)===NH)return t=e.headers?new LH(e.headers):new LH,dz(t,"content-type")||lz(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),bH(e,{body:TH(0,gH(r)),headers:TH(0,t)})}return e};if(_H(MH)&&iH({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return MH(e,arguments.length>1?hz(arguments[1]):{})}}),_H(UH)){var pz=function(e){return fH(this,xH),new UH(e,arguments.length>1?hz(arguments[1]):{})};xH.constructor=pz,pz.prototype=xH,iH({global:!0,forced:!0},{Request:pz})}}var fz,_z={URLSearchParams:cz,getState:DH},vz=Wi,mz=s,Sz=VG,yz=n,Ez=Wo,gz=I,bz=tn.f,Tz=Yt.exports,Iz=lc,Rz=xe,Az=Vn,Cz=JP,Oz=Ro,Nz=yp.codeAt,wz=function(e){var t,r,i=[],n=ZG(QG($G(e),GG,"."),".");for(t=0;t<n.length;t++)r=n[t],qG(i,KG(jG,r)?"xn--"+rH(r):r);return JG(i,".")},Pz=fo,Dz=Go,kz=lu,Mz=_z,Uz=Or,Lz=Uz.set,xz=Uz.getterFor("URL"),Vz=Mz.URLSearchParams,Fz=Mz.getState,Bz=yz.URL,jz=yz.TypeError,Gz=yz.parseInt,Hz=Math.floor,zz=Math.pow,Kz=gz("".charAt),Wz=gz(/./.exec),Xz=gz([].join),Yz=gz(1..toString),Jz=gz([].pop),qz=gz([].push),Qz=gz("".replace),Zz=gz([].shift),$z=gz("".split),eK=gz("".slice),tK=gz("".toLowerCase),rK=gz([].unshift),iK="Invalid scheme",nK="Invalid host",oK="Invalid port",aK=/[a-z]/i,sK=/[\d+-.a-z]/i,cK=/\d/,uK=/^0x/i,dK=/^[0-7]+$/,lK=/^\d+$/,hK=/^[\da-f]+$/i,pK=/[\0\t\n\r #%/:<>?@[\\\]^|]/,fK=/[\0\t\n\r #/:<>?@[\\\]^|]/,_K=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,vK=/[\t\n\r]/g,mK=function(e){var t,r,i,n;if("number"==typeof e){for(t=[],r=0;r<4;r++)rK(t,e%256),e=Hz(e/256);return Xz(t,".")}if("object"==typeof e){for(t="",i=function(e){for(var t=null,r=1,i=null,n=0,o=0;o<8;o++)0!==e[o]?(n>r&&(t=i,r=n),i=null,n=0):(null===i&&(i=o),++n);return n>r&&(t=i,r=n),t}(e),r=0;r<8;r++)n&&0===e[r]||(n&&(n=!1),i===r?(t+=r?":":"::",n=!0):(t+=Yz(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},SK={},yK=Az({},SK,{" ":1,'"':1,"<":1,">":1,"`":1}),EK=Az({},yK,{"#":1,"?":1,"{":1,"}":1}),gK=Az({},EK,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),bK=function(e,t){var r=Nz(e,0);return r>32&&r<127&&!Rz(t,e)?e:encodeURIComponent(e)},TK={ftp:21,file:null,http:80,https:443,ws:80,wss:443},IK=function(e,t){var r;return 2==e.length&&Wz(aK,Kz(e,0))&&(":"==(r=Kz(e,1))||!t&&"|"==r)},RK=function(e){var t;return e.length>1&&IK(eK(e,0,2))&&(2==e.length||"/"===(t=Kz(e,2))||"\\"===t||"?"===t||"#"===t)},AK=function(e){return"."===e||"%2e"===tK(e)},CK={},OK={},NK={},wK={},PK={},DK={},kK={},MK={},UK={},LK={},xK={},VK={},FK={},BK={},jK={},GK={},HK={},zK={},KK={},WK={},XK={},YK=function(e,t,r){var i,n,o,a=Pz(e);if(t){if(n=this.parse(a))throw jz(n);this.searchParams=null}else{if(void 0!==r&&(i=new YK(r,!0)),n=this.parse(a,null,i))throw jz(n);(o=Fz(new Vz)).bindURL(this),this.searchParams=o}};YK.prototype={type:"URL",parse:function(e,t,r){var i,n,o,a,s,c=this,u=t||CK,d=0,l="",h=!1,p=!1,f=!1;for(e=Pz(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=Qz(e,_K,"")),e=Qz(e,vK,""),i=Cz(e);d<=i.length;){switch(n=i[d],u){case CK:if(!n||!Wz(aK,n)){if(t)return iK;u=NK;continue}l+=tK(n),u=OK;break;case OK:if(n&&(Wz(sK,n)||"+"==n||"-"==n||"."==n))l+=tK(n);else{if(":"!=n){if(t)return iK;l="",u=NK,d=0;continue}if(t&&(c.isSpecial()!=Rz(TK,l)||"file"==l&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=l,t)return void(c.isSpecial()&&TK[c.scheme]==c.port&&(c.port=null));l="","file"==c.scheme?u=BK:c.isSpecial()&&r&&r.scheme==c.scheme?u=wK:c.isSpecial()?u=MK:"/"==i[d+1]?(u=PK,d++):(c.cannotBeABaseURL=!0,qz(c.path,""),u=KK)}break;case NK:if(!r||r.cannotBeABaseURL&&"#"!=n)return iK;if(r.cannotBeABaseURL&&"#"==n){c.scheme=r.scheme,c.path=Oz(r.path),c.query=r.query,c.fragment="",c.cannotBeABaseURL=!0,u=XK;break}u="file"==r.scheme?BK:DK;continue;case wK:if("/"!=n||"/"!=i[d+1]){u=DK;continue}u=UK,d++;break;case PK:if("/"==n){u=LK;break}u=zK;continue;case DK:if(c.scheme=r.scheme,n==fz)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=Oz(r.path),c.query=r.query;else if("/"==n||"\\"==n&&c.isSpecial())u=kK;else if("?"==n)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=Oz(r.path),c.query="",u=WK;else{if("#"!=n){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=Oz(r.path),c.path.length--,u=zK;continue}c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=Oz(r.path),c.query=r.query,c.fragment="",u=XK}break;case kK:if(!c.isSpecial()||"/"!=n&&"\\"!=n){if("/"!=n){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,u=zK;continue}u=LK}else u=UK;break;case MK:if(u=UK,"/"!=n||"/"!=Kz(l,d+1))continue;d++;break;case UK:if("/"!=n&&"\\"!=n){u=LK;continue}break;case LK:if("@"==n){h&&(l="%40"+l),h=!0,o=Cz(l);for(var _=0;_<o.length;_++){var v=o[_];if(":"!=v||f){var m=bK(v,gK);f?c.password+=m:c.username+=m}else f=!0}l=""}else if(n==fz||"/"==n||"?"==n||"#"==n||"\\"==n&&c.isSpecial()){if(h&&""==l)return"Invalid authority";d-=Cz(l).length+1,l="",u=xK}else l+=n;break;case xK:case VK:if(t&&"file"==c.scheme){u=GK;continue}if(":"!=n||p){if(n==fz||"/"==n||"?"==n||"#"==n||"\\"==n&&c.isSpecial()){if(c.isSpecial()&&""==l)return nK;if(t&&""==l&&(c.includesCredentials()||null!==c.port))return;if(a=c.parseHost(l))return a;if(l="",u=HK,t)return;continue}"["==n?p=!0:"]"==n&&(p=!1),l+=n}else{if(""==l)return nK;if(a=c.parseHost(l))return a;if(l="",u=FK,t==VK)return}break;case FK:if(!Wz(cK,n)){if(n==fz||"/"==n||"?"==n||"#"==n||"\\"==n&&c.isSpecial()||t){if(""!=l){var S=Gz(l,10);if(S>65535)return oK;c.port=c.isSpecial()&&S===TK[c.scheme]?null:S,l=""}if(t)return;u=HK;continue}return oK}l+=n;break;case BK:if(c.scheme="file","/"==n||"\\"==n)u=jK;else{if(!r||"file"!=r.scheme){u=zK;continue}if(n==fz)c.host=r.host,c.path=Oz(r.path),c.query=r.query;else if("?"==n)c.host=r.host,c.path=Oz(r.path),c.query="",u=WK;else{if("#"!=n){RK(Xz(Oz(i,d),""))||(c.host=r.host,c.path=Oz(r.path),c.shortenPath()),u=zK;continue}c.host=r.host,c.path=Oz(r.path),c.query=r.query,c.fragment="",u=XK}}break;case jK:if("/"==n||"\\"==n){u=GK;break}r&&"file"==r.scheme&&!RK(Xz(Oz(i,d),""))&&(IK(r.path[0],!0)?qz(c.path,r.path[0]):c.host=r.host),u=zK;continue;case GK:if(n==fz||"/"==n||"\\"==n||"?"==n||"#"==n){if(!t&&IK(l))u=zK;else if(""==l){if(c.host="",t)return;u=HK}else{if(a=c.parseHost(l))return a;if("localhost"==c.host&&(c.host=""),t)return;l="",u=HK}continue}l+=n;break;case HK:if(c.isSpecial()){if(u=zK,"/"!=n&&"\\"!=n)continue}else if(t||"?"!=n)if(t||"#"!=n){if(n!=fz&&(u=zK,"/"!=n))continue}else c.fragment="",u=XK;else c.query="",u=WK;break;case zK:if(n==fz||"/"==n||"\\"==n&&c.isSpecial()||!t&&("?"==n||"#"==n)){if(".."===(s=tK(s=l))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(c.shortenPath(),"/"==n||"\\"==n&&c.isSpecial()||qz(c.path,"")):AK(l)?"/"==n||"\\"==n&&c.isSpecial()||qz(c.path,""):("file"==c.scheme&&!c.path.length&&IK(l)&&(c.host&&(c.host=""),l=Kz(l,0)+":"),qz(c.path,l)),l="","file"==c.scheme&&(n==fz||"?"==n||"#"==n))for(;c.path.length>1&&""===c.path[0];)Zz(c.path);"?"==n?(c.query="",u=WK):"#"==n&&(c.fragment="",u=XK)}else l+=bK(n,EK);break;case KK:"?"==n?(c.query="",u=WK):"#"==n?(c.fragment="",u=XK):n!=fz&&(c.path[0]+=bK(n,SK));break;case WK:t||"#"!=n?n!=fz&&("'"==n&&c.isSpecial()?c.query+="%27":c.query+="#"==n?"%23":bK(n,SK)):(c.fragment="",u=XK);break;case XK:n!=fz&&(c.fragment+=bK(n,yK))}d++}},parseHost:function(e){var t,r,i;if("["==Kz(e,0)){if("]"!=Kz(e,e.length-1))return nK;if(t=function(e){var t,r,i,n,o,a,s,c=[0,0,0,0,0,0,0,0],u=0,d=null,l=0,h=function(){return Kz(e,l)};if(":"==h()){if(":"!=Kz(e,1))return;l+=2,d=++u}for(;h();){if(8==u)return;if(":"!=h()){for(t=r=0;r<4&&Wz(hK,h());)t=16*t+Gz(h(),16),l++,r++;if("."==h()){if(0==r)return;if(l-=r,u>6)return;for(i=0;h();){if(n=null,i>0){if(!("."==h()&&i<4))return;l++}if(!Wz(cK,h()))return;for(;Wz(cK,h());){if(o=Gz(h(),10),null===n)n=o;else{if(0==n)return;n=10*n+o}if(n>255)return;l++}c[u]=256*c[u]+n,2!=++i&&4!=i||u++}if(4!=i)return;break}if(":"==h()){if(l++,!h())return}else if(h())return;c[u++]=t}else{if(null!==d)return;l++,d=++u}}if(null!==d)for(a=u-d,u=7;0!=u&&a>0;)s=c[u],c[u--]=c[d+a-1],c[d+--a]=s;else if(8!=u)return;return c}(eK(e,1,-1)),!t)return nK;this.host=t}else if(this.isSpecial()){if(e=wz(e),Wz(pK,e))return nK;if(t=function(e){var t,r,i,n,o,a,s,c=$z(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(r=[],i=0;i<t;i++){if(""==(n=c[i]))return e;if(o=10,n.length>1&&"0"==Kz(n,0)&&(o=Wz(uK,n)?16:8,n=eK(n,8==o?1:2)),""===n)a=0;else{if(!Wz(10==o?lK:8==o?dK:hK,n))return e;a=Gz(n,o)}qz(r,a)}for(i=0;i<t;i++)if(a=r[i],i==t-1){if(a>=zz(256,5-t))return null}else if(a>255)return null;for(s=Jz(r),i=0;i<r.length;i++)s+=r[i]*zz(256,3-i);return s}(e),null===t)return nK;this.host=t}else{if(Wz(fK,e))return nK;for(t="",r=Cz(e),i=0;i<r.length;i++)t+=bK(r[i],SK);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return Rz(TK,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&IK(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,i=e.password,n=e.host,o=e.port,a=e.path,s=e.query,c=e.fragment,u=t+":";return null!==n?(u+="//",e.includesCredentials()&&(u+=r+(i?":"+i:"")+"@"),u+=mK(n),null!==o&&(u+=":"+o)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?a[0]:a.length?"/"+Xz(a,"/"):"",null!==s&&(u+="?"+s),null!==c&&(u+="#"+c),u},setHref:function(e){var t=this.parse(e);if(t)throw jz(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new JK(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+mK(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Pz(e)+":",CK)},getUsername:function(){return this.username},setUsername:function(e){var t=Cz(Pz(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=bK(t[r],gK)}},getPassword:function(){return this.password},setPassword:function(e){var t=Cz(Pz(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=bK(t[r],gK)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?mK(e):mK(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,xK)},getHostname:function(){var e=this.host;return null===e?"":mK(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,VK)},getPort:function(){var e=this.port;return null===e?"":Pz(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=Pz(e))?this.port=null:this.parse(e,FK))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+Xz(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,HK))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=Pz(e))?this.query=null:("?"==Kz(e,0)&&(e=eK(e,1)),this.query="",this.parse(e,WK)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=Pz(e))?("#"==Kz(e,0)&&(e=eK(e,1)),this.fragment="",this.parse(e,XK)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var JK=function(e){var t=Iz(this,qK),r=kz(arguments.length,1)>1?arguments[1]:void 0,i=Lz(t,new YK(e,!1,r));mz||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},qK=JK.prototype,QK=function(e,t){return{get:function(){return xz(this)[e]()},set:t&&function(e){return xz(this)[t](e)},configurable:!0,enumerable:!0}};if(mz&&bz(qK,{href:QK("serialize","setHref"),origin:QK("getOrigin"),protocol:QK("getProtocol","setProtocol"),username:QK("getUsername","setUsername"),password:QK("getPassword","setPassword"),host:QK("getHost","setHost"),hostname:QK("getHostname","setHostname"),port:QK("getPort","setPort"),pathname:QK("getPathname","setPathname"),search:QK("getSearch","setSearch"),searchParams:QK("getSearchParams"),hash:QK("getHash","setHash")}),Tz(qK,"toJSON",(function(){return xz(this).serialize()}),{enumerable:!0}),Tz(qK,"toString",(function(){return xz(this).serialize()}),{enumerable:!0}),Bz){var ZK=Bz.createObjectURL,$K=Bz.revokeObjectURL;ZK&&Tz(JK,"createObjectURL",Ez(ZK,Bz)),$K&&Tz(JK,"revokeObjectURL",Ez($K,Bz))}Dz(JK,"URL"),vz({global:!0,forced:!Sz,sham:!mz},{URL:JK});var eW,tW=function(){function e(e){this._sharedAudioContext=new AudioContext,this._audioDestination=this._sharedAudioContext.createMediaStreamDestination(),this._localGainNode=this._sharedAudioContext.createGain(),this._bufferGainNode=this._sharedAudioContext.createGain(),this.mixingMap=new Map,this.resourcesCache=new Map,this.volumeConfig=new Map,this.cachedBuffer=[],this._context=e,this._localGainNode.gain.value=1}return e.prototype.mixMediaStream=function(e){this._localSource&&this._localSource.disconnect(this._localGainNode),this._localSource=this._sharedAudioContext.createMediaStreamSource(e),this._localSource.connect(this._localGainNode).connect(this._audioDestination)},e.prototype.startAudioMixing=function(e,t,r){return e_(this,void 0,void 0,(function(){var i,n,o,a,s,c,u,d,l,h,p,f,_=this;return t_(this,(function(v){switch(v.label){case 0:if(i=r.playCount,sk(n=r.type,"mixingType",UG(a_)),!(o=this._context.getLocalAudioTrack()))return[2];if((a=HF(o.getTrack()))&&this.mixMediaStream(a),(s=this.mixingMap.get(e))&&s.audioNode){s.audioNode.pause(),this._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_STOPPED,error:aP.AUDIO_MIXING_ERROR_OK});try{s.gainNode.disconnect(this._audioDestination),s.audioSource.disconnect(s.gainNode)}catch(e){}}return(u=this.resourcesCache.get(e))&&u.filePath===t?(c=u.getAudioNode(),[3,3]):[3,1];case 1:return[4,fetch(t,{mode:"cors",credentials:"include"}).then((function(t){if(t.ok)return t.arrayBuffer();throw _._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_FAILED,error:aP.AUDIO_MIXING_ERROR_START_FAILED}),new dP(oP.LOAD_RESOURCES_FAILED,t.statusText)}))];case 2:d=v.sent(),c=new Audio(URL.createObjectURL(new Blob([d]))),v.label=3;case 3:return c.crossOrigin="anonymous",i<=0?c.loop=!0:i>0&&(l=i,c.onended=function(){--l>0?c.play():_._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_FINISHED,error:aP.AUDIO_MIXING_ERROR_OK})}),[4,c.play()];case 4:if(v.sent(),h=this._sharedAudioContext.createMediaElementSource(c),p=this._sharedAudioContext.createGain(),f=this.volumeConfig.get(e),p.gain.value=f?f/100:1,h.connect(p).connect(this._audioDestination),this.mixingMap.set(e,{audioSource:h,audioNode:c,gainNode:p,type:"file"}),n===a_.PUBLISH)try{p.disconnect(this._sharedAudioContext.destination)}catch(e){}else p.connect(this._sharedAudioContext.destination);return this._context.updateLocalAudioTrack(this._audioDestination.stream.getAudioTracks()[0],r.type),this._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_PLAYING,error:aP.AUDIO_MIXING_ERROR_OK}),[2]}}))}))},e.prototype.stopAudioMixing=function(e){var t=this.mixingMap.get(e);t&&"file"===t.type&&(this.mixingMap.delete(e),t.audioNode.pause(),t.audioSource.disconnect(t.gainNode),t.gainNode.disconnect(this._audioDestination),this._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_STOPPED,error:aP.AUDIO_MIXING_ERROR_OK}))},e.prototype.pauseAudioMixing=function(e){var t=this.mixingMap.get(e);t&&(this._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_PAUSED,error:aP.AUDIO_MIXING_ERROR_OK}),t.audioNode.pause())},e.prototype.resumeAudioMixing=function(e){var t=this.mixingMap.get(e);t&&(this._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_PLAYING,error:aP.AUDIO_MIXING_ERROR_OK}),t.audioNode.play())},e.prototype.preloadAudioMixing=function(e,t){return e_(this,void 0,void 0,(function(){var r,i=this;return t_(this,(function(n){switch(n.label){case 0:return this.stopAudioMixing(e),[4,fetch(t,{mode:"cors",credentials:"include"}).then((function(t){if(t.ok)return i._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_PRELOADED,error:aP.AUDIO_MIXING_ERROR_OK}),t.arrayBuffer();throw i._context.emitMessage({mixId:e,state:s_.AUDIO_MIXING_STATE_FAILED,error:aP.AUDIO_MIXING_ERROR_PRELOAD_FAILED}),new dP(oP.LOAD_RESOURCES_FAILED,t.statusText)})).catch((function(e){throw new dP(oP.LOAD_RESOURCES_FAILED,"Load resources failed",e)}))];case 1:return r=n.sent(),this.resourcesCache.set(e,{getAudioNode:function(){return new Audio(URL.createObjectURL(new Blob([r])))},filePath:t}),[2]}}))}))},e.prototype.unloadAudioMixing=function(e){this.resourcesCache.has(e)&&this.resourcesCache.delete(e)},e.prototype.getAudioMixingVolume=function(e){var t=this.mixingMap.get(e);return t?100*t.gainNode.gain.value:0},e.prototype.setAudioMixingVolume=function(e,t){t<0?t=0:t>400&&(t=400),this.volumeConfig.set(e,t);var r=this.mixingMap.get(e);r&&(r.gainNode.gain.value=Number(t)/100)},e.prototype.getAudioMixingDuration=function(e){var t=this.mixingMap.get(e),r=this.mixingMap.get(e);return t||r?t?1e3*t.audioNode.duration:r?1e3*r.audioNode.duration:0:0},e.prototype.getAudioMixingCurrentPosition=function(e){var t=this.mixingMap.get(e);return t?1e3*t.audioNode.currentTime:0},e.prototype.setAudioMixingPosition=function(e,t){var r=this.mixingMap.get(e);r&&(r.audioNode.currentTime=t/1e3,r.audioNode.play())},e.prototype.enableAudioMixingBuffer=function(e){sk(e,"type",UG(a_));var t=this._context.getLocalAudioTrack();if(t){var r=HF(t.getTrack());if(r&&this.mixMediaStream(r),e===a_.PUBLISH)try{this._bufferGainNode.disconnect(this._sharedAudioContext.destination)}catch(e){}else this._bufferGainNode.connect(this._sharedAudioContext.destination);this._context.updateLocalAudioTrack(this._audioDestination.stream.getAudioTracks()[0],e),this._bufferGainNode.connect(this._audioDestination),this._context.emitMessage({mixId:-1,state:s_.AUDIO_MIXING_STATE_PCM_ENABLED,error:aP.AUDIO_MIXING_ERROR_OK})}},e.prototype.disableAudioMixingBuffer=function(){if(this.cachedBuffer=[],this._audioBufferSource){try{this._audioBufferSource.disconnect(this._bufferGainNode),this._bufferGainNode.disconnect(this._audioDestination),this._bufferGainNode.disconnect(this._sharedAudioContext.destination)}catch(e){}finally{this._audioBufferSource=void 0}this._context.updateLocalAudioTrack(),this._context.emitMessage({mixId:-1,state:s_.AUDIO_MIXING_STATE_PCM_DISABLED,error:aP.AUDIO_MIXING_ERROR_OK})}},e.prototype.pushAudioMixingBuffer=function(e){var t=this;this._audioBufferSource&&(this.cachedBuffer.push(e),this.cachedBuffer.length>0)||(this._audioBufferSource=this._sharedAudioContext.createBufferSource(),this._audioBufferSource.buffer=e,this._audioBufferSource.connect(this._bufferGainNode),this._audioBufferSource.start(),this._audioBufferSource.onended=function(){var e;if(null===(e=t._audioBufferSource)||void 0===e||e.disconnect(t._bufferGainNode),t._audioBufferSource=void 0,t.cachedBuffer.length){var r=t.cachedBuffer.shift();r&&t.pushAudioMixingBuffer(r)}})},e.prototype.stopAll=function(){var e=this;if(this._localSource)try{this._localSource.disconnect(this._localGainNode),delete this._localSource}catch(e){}this.mixingMap.forEach((function(t,r){e.stopAudioMixing(r)}))},Object.defineProperty(e.prototype,"mixTrack",{get:function(){return this._audioDestination.stream.getAudioTracks()[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharedAudioContext",{get:function(){return this._sharedAudioContext},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){var e=this._sharedAudioContext;"closed"!==e.state&&"function"==typeof e.close&&e.close(),this.cachedBuffer=[],this.mixingMap.clear(),this.resourcesCache.clear(),this.volumeConfig.clear()},$f([mx("default","id","filePath","options")],e.prototype,"startAudioMixing",null),$f([mx("default","id")],e.prototype,"stopAudioMixing",null),$f([mx("default","id")],e.prototype,"pauseAudioMixing",null),$f([mx("default","id")],e.prototype,"resumeAudioMixing",null),$f([mx("default","id")],e.prototype,"preloadAudioMixing",null),$f([mx("default","id")],e.prototype,"unloadAudioMixing",null),$f([mx("default","id")],e.prototype,"getAudioMixingVolume",null),$f([mx("default","id","volume")],e.prototype,"setAudioMixingVolume",null),$f([mx("default","id")],e.prototype,"getAudioMixingDuration",null),$f([mx("default","id")],e.prototype,"getAudioMixingCurrentPosition",null),$f([mx("default","id","position")],e.prototype,"setAudioMixingPosition",null),$f([mx("default","type")],e.prototype,"enableAudioMixingBuffer",null),$f([mx()],e.prototype,"disableAudioMixingBuffer",null),$f([mx("default","buffer")],e.prototype,"pushAudioMixingBuffer",null),e}();!function(e){e.NORMAL_USER="normalUser",e.SILENT_USER="silentUser"}(eW||(eW={}));var rW=new gk("RTMClient",1),iW=function(e){function t(t){var r=e.call(this)||this;return r._appId=t,r._dataChannelSignal=null,r._handler=null,r._dataChannelSignalState=mB.DISCONNECTED,r._loginSessionId=null,r._userId=null,r._token=null,r._isReconnecting=!1,r._reconnectTimer=null,r._loginResolveCallback=null,r._loginRejectCallback=null,r._iceConfigNode=null,r._wait_login_token=!1,r}return Cf(t,e),t.prototype.login=function(e,t){var r=this;return new Promise((function(i,n){if(rW.print("login","invoke login, token: %o, userId: %o",e,t),r._loginSessionId)throw new dP(oP.ALREADY_LOGIN,"Already logined");if(r._loginResolveCallback)throw new dP(oP.LOGIN_FAILED,"Is logging in, please try again later.");r._userId=t,r._token=e,fx.setStats({rtc_app_id:r._appId,user_id:t}),r._loginResolveCallback=i,r._loginRejectCallback=n,r._dataChannelSignal?r._login():(rW.print("login","init dataChannelSingling"),r._dataChannelSignalState=mB.CONNECTING,r._createDataChannelSignaling(t).then((function(e){r._dataChannelSignal=e,r._login()})).catch((function(){r._onDisconnect()})))}))},t.prototype.logout=function(){var e;return e_(this,void 0,void 0,(function(){return t_(this,(function(t){if(!this._loginSessionId||!this._userId)throw new dP(oP.NOT_LOGIN,"login first");return null===(e=this._dataChannelSignal)||void 0===e||e.sendSignaling("logout",{loginSessionId:this._loginSessionId,userId:this._userId,appId:this._appId},{functionType:$x.C2RTM}).catch((function(){})),this._closeDataChannelSignaling(),this._clearState(),[2]}))}))},t.prototype.updateLoginToken=function(e){return e_(this,void 0,void 0,(function(){var t=this;return t_(this,(function(r){return this._token=e,[2,new Promise((function(e,r){t._wait_login_token?(t._loginResolveCallback=e,t._loginRejectCallback=r,t._login()):e()}))]}))}))},t.prototype.getPeerOnlineStatus=function(e){return e_(this,void 0,void 0,(function(){var t;return t_(this,(function(r){switch(r.label){case 0:if(!this._loginSessionId||!this._userId)throw new dP(oP.NOT_LOGIN,"login first");return this._checkDataChannelSignal(),[4,this._dataChannelSignal.sendSignaling("getPeerOnlineStatus",{loginSessionId:this._loginSessionId,userId:this._userId,appId:this._appId,peerUserId:e},{functionType:$x.C2RTM})];case 1:return[2,null==(t=r.sent())?void 0:t.status]}}))}))},t.prototype.sendUserMessageOutsideRoom=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){switch(r.label){case 0:if(!this._loginSessionId||!this._userId)throw new dP(oP.NOT_LOGIN,"login first");return this._checkDataChannelSignal(),[4,this._dataChannelSignal.sendP2PMessage({from:this._userId,app:this._appId,to:e,room:"",msg:t})];case 1:return r.sent(),[2]}}))}))},t.prototype.setServerParams=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){switch(r.label){case 0:if(!this._loginSessionId||!this._userId)throw new dP(oP.NOT_LOGIN,"login first");return this._checkDataChannelSignal(),[4,this._dataChannelSignal.sendSignaling("setServerParams",{loginSessionId:this._loginSessionId,userId:this._userId,appId:this._appId,signature:e,url:t},{functionType:$x.C2RTM})];case 1:return r.sent(),[2]}}))}))},t.prototype.sendServerMessage=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:if(!this._loginSessionId||!this._userId)throw new dP(oP.NOT_LOGIN,"login first");return this._checkDataChannelSignal(),[4,this._dataChannelSignal.sendP2PMessage({from:this._userId,app:this._appId,to:"",room:"",type:Wx.BUSINESS_SERVER,msg:e})];case 1:return t.sent(),[2]}}))}))},t.prototype.destroy=function(){this._clearState(),this._closeDataChannelSignaling(),e.prototype.removeAllListeners.call(this)},t.prototype._login=function(){var e=this;if(this._userId){var t=HD();this._checkDataChannelSignal(),this._dataChannelSignal.sendSignaling("login",{Token:XD.token2auth(this._appId,null,this._userId,this._token),timestamp:Date.now(),loginSessionId:t,params:{deviceType:"web",userAgent:window.navigator.userAgent,sdkVersion:Qx.VERSION,deviceId:Cx.getDeviceId(),appId:this._appId,userId:this._userId}},{functionType:$x.C2RTM}).then((function(){e._loginResolveCallback&&e._loginResolveCallback(),e._loginSessionId=t,e._wait_login_token=!1})).catch((function(t){var r,i,n=t||{},o=n.code,a=n.message;e._wait_login_token=!1,o>=700&&o<800?708===o?(r=oP.INVALID_PARAMS,i="Invalid userId"):(r=oP.INVALID_TOKEN,i="Invalid token",e._wait_login_token=!0,e._loginRejectCallback||e.emit("onRTMTokenError")):(r=oP.LOGIN_FAILED,i="login failed"),e._loginRejectCallback&&e._loginRejectCallback(new dP(r,a||i))})).finally((function(){e._loginResolveCallback=null,e._loginRejectCallback=null}))}},t.prototype._createDataChannelSignaling=function(e){return e_(this,void 0,void 0,(function(){var t,r,i,n,o,a,s=this;return t_(this,(function(c){switch(c.label){case 0:if(t=new oV,r=this._iceConfigNode)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,null==t?void 0:t.getAccessNode(this._appId,"",e,Cx.getDeviceId(),"")];case 2:if(i=c.sent(),!(r=i[0]))throw new Error;return[3,4];case 3:throw c.sent(),yx("rtm.login.getNodeFailed","",0,!0),new dP(oP.ICE_SERVER_WRONG,"get ICE config failed");case 4:yx("rtm.login.getNodeSuccess",r,0,!0),rW.print("_createDataChannelSignaling()","get node success",r),this._handler=new JV(lx),this._handler.once("disconnect",(function(){rW.print("_createDataChannelSignaling()","recv BasicHandler event: disconnect"),s._onDisconnect()})),c.label=5;case 5:return c.trys.push([5,7,,8]),[4,this._handler.connect(r)];case 6:return n=c.sent(),rW.print("_createDataChannelSignaling()","establish peerConnection success"),this._dataChannelSignalState=mB.CONNECTED,[3,8];case 7:throw o=c.sent(),this._iceConfigNode=null,this._dataChannelSignalState=mB.DISCONNECTED,new dP(oP.ESTABLISH_DATACHANNEL_FAILED,"establish dataChannel failed",o);case 8:return a=new rV(n),rW.print("_createDataChannelSignaling()","send ping"),a.sendPingSignaling(),a.once("close",(function(){rW.print("_createDataChannelSignaling()","recv DataChannelSignaling event: close"),s._onDisconnect()})),a.on(Fx.USER_MESSAGE_RECEIVED_OUTSIDE_ROOM,(function(e){s.emit("onUserMessageReceivedOutsideRoom",{userId:e.from,message:e.msg})})),a.on(Fx.USER_BINARY_MESSAGE_RECEIVED_OUTSIDE_ROOM,(function(e){s.emit("onUserBinaryMessageReceivedOutsideRoom",{userId:e.from,message:e.msg})})),a.on(Fx.USER_DISCONNECTION,(function(){s.emit("onUserDisconnection"),s._clearState()})),a.on(Fx.NODE_CHANGE,(function(e){yx("rtm.nodeChange",JSON.stringify(e),0,!0),Array.isArray(e.nodes)&&e.nodes.length&&(s._iceConfigNode=e.nodes[0]),s._loginResolveCallback&&s._loginRejectCallback?s._login():s._reconnect()})),[2,a]}}))}))},t.prototype._closeDataChannelSignaling=function(){var e,t;null===(e=this._dataChannelSignal)||void 0===e||e.destroy(),this._dataChannelSignal=null,null===(t=this._handler)||void 0===t||t.destroy(),this._handler=null},t.prototype._checkDataChannelSignal=function(){if(!this._dataChannelSignal||this._dataChannelSignalState!==mB.CONNECTED)throw new dP(oP.NOT_CONNECTED_YET,"datachannel not connect")},t.prototype._onDisconnect=function(){this._dataChannelSignalState=mB.DISCONNECTED,this._closeDataChannelSignaling(),navigator.onLine?this._reconnect():this._reconnectTimer=self.setTimeout(this._reconnect.bind(this),3e3)},t.prototype._reconnect=function(){var e=this;!this._isReconnecting&&this._userId&&(rW.print("_reconnect()","start reconnect..."),this._isReconnecting=!0,this._createDataChannelSignaling(this._userId).then((function(t){rW.print("_reconnect()","reconnect success!"),e._dataChannelSignal=t,e._login(),e._reconnectTimer=null})).catch((function(t){rW.print("_reconnect()","Reconnecting error, will reconnect after 3s",t),e._reconnectTimer=self.setTimeout(e._reconnect.bind(e),3e3)})).finally((function(){e._isReconnecting=!1})))},t.prototype._clearState=function(){this._userId=null,this._token=null,this._loginSessionId=null,null!==this._reconnectTimer&&(self.clearTimeout(this._reconnectTimer),this._reconnectTimer=null)},t}(mk.exports.EventEmitter),nW=function(e){function t(t){var r=e.call(this)||this;return r._appId=t,r.remoteStreams=new Map,r}return Cf(t,e),t.prototype.connect=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return this._mediaServerClient=new bB,this._bindEvents(),[4,this._mediaServerClient.connect(this._appId)];case 1:return e.sent(),[2]}}))}))},t.prototype.startPlayPublicStream=function(e){return e_(this,void 0,void 0,(function(){var t,r=this;return t_(this,(function(i){switch(i.label){case 0:if(this.remoteStreams.get(e))throw new dP(oP.REPEAT_PLAY,"repeat play public media stream");return(t=new VB(e,e,!1,{audiostream:!0,localaudio:!0,videostream:!0,localvideo:!0,extaudio:!1,extvideo:!1,videoDescriptions:[]})).on("onSEIMessage",(function(e){if(e instanceof Uint8Array)for(var i=function(e){var t=new DataView(e.buffer);if(t.byteLength<=4||65535!==t.getUint16(0))return{seiCount:1,seis:[e]};for(var r={seiCount:0,seis:[]},i=!1,n=2;n<t.byteLength;){var o=t.getUint16(n);if(n+=2,t.byteLength-n<o){i=!0;break}var a=new Uint8Array(e.buffer,n,o);if(n+=o,t.byteLength-n>0&&t.byteLength-n<=2){i=!0;break}r.seiCount++,r.seis.push(a)}return i&&(r.seiCount=1,r.seis=[e]),r}(e),n=0;n<i.seiCount;n++)r.emit(cB.ON_SEI_MESSAGED_RECEIVED,{sei:i.seis[n],publicStreamId:t.streamId})})),[4,this._mediaServerClient.subscribePublicStream(t)];case 1:return i.sent(),this.remoteStreams.set(e,t),[2,t]}}))}))},t.prototype.stopPlayPublicStream=function(e){var t=this.remoteStreams.get(e);if(t)return this.remoteStreams.delete(e),this._mediaServerClient.unsubscribePublicStream(t)},t.prototype.destroy=function(){this.remoteStreams=new Map,this._mediaServerClient&&this._mediaServerClient.destroy()},t.prototype._handleReconnected=function(){return e_(this,void 0,void 0,(function(){var e,t,r,i,n,o,a,s,c=this;return t_(this,(function(u){clearTimeout(this._reconnectTimer),e=function(e){t.remoteStreams.delete(e),t.startPlayPublicStream(e).then((function(){var t=c.remoteStreams.get(e);c.safeEmit(cB.RESUBSCRIBE,{stream:t})}))},t=this;try{for(r=r_(this.remoteStreams),i=r.next();!i.done;i=r.next())n=i_(i.value,1),o=n[0],e(o)}catch(e){a={error:e}}finally{try{i&&!i.done&&(s=r.return)&&s.call(r)}finally{if(a)throw a.error}}return[2]}))}))},t.prototype._reconnect=function(){var e=this;this._mediaServerClient.removeAllListeners(),this._mediaServerClient.destroy(),navigator.onLine?this.connect().then(this._handleReconnected.bind(this)):this._reconnectTimer=setTimeout((function(){return e.connect().then(e._handleReconnected.bind(e))}),3e3)},t.prototype._bindEvents=function(){var e,t,r=this;null===(e=this._mediaServerClient)||void 0===e||e.on(jx.ABNORMAL_DISCONNECTION,this._reconnect.bind(this)),null===(t=this._mediaServerClient)||void 0===t||t.on("onRemoteStreamStats",(function(e){r.emit("onRemoteStreamStats",e)}))},t}(Tk),oW=new gk("AudioDeviceManager",1),aW=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isAudioPlaybackDeviceTesting=!1,t._isAudioDeviceRecordTesting=!1,t}return Cf(t,e),t.prototype.startAudioPlaybackDeviceTest=function(e,t){return e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:if(this._isAudioPlaybackDeviceTesting||this._isAudioDeviceRecordTesting)throw new dP(oP.REPEAT_DEVICE_TEST,"device test cannot be called repeatedly at the same time.");this._isAudioPlaybackDeviceTesting=!0,oW.print("startAudioPlaybackDeviceTest()","Invoke"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._playAudioFile(e,{loop:!0})];case 2:return i.sent(),[3,4];case 3:throw r=i.sent(),this.stopAudioPlaybackDeviceTest(),r;case 4:return this._startEmitAudioPlaybackDeviceTestVolume(t),[2]}}))}))},t.prototype.stopAudioPlaybackDeviceTest=function(){this._isAudioPlaybackDeviceTesting&&(oW.print("stopAudioPlaybackDeviceTest()","Invoke"),this._isAudioPlaybackDeviceTesting=!1,this._stopEmitAudioPlaybackDeviceTestVolume(),this._destroyAudioElement())},t.prototype.startAudioDeviceRecordTest=function(e){return e_(this,void 0,void 0,(function(){var t=this;return t_(this,(function(r){switch(r.label){case 0:if(this._isAudioDeviceRecordTesting)throw new dP(oP.REPEAT_DEVICE_TEST,"device test cannot be called repeatedly at the same time.");return this._isAudioDeviceRecordTesting=!0,oW.print("startAudioDeviceRecordTest()","Invoke"),this._recoderTimer=window.setTimeout((function(){oW.print("startAudioDeviceRecordTest()","".concat(3e4,'ms automatic call method "stopAudioDeviceRecordAndPlayTest"')),t._stopAudioCaptureAndRecoder()}),3e4),[4,this._startAudioCaptureAndRecoder(e)];case 1:return r.sent(),delete this._audioCaptureAndRecoderResolve,[2]}}))}))},t.prototype.stopAudioDeviceRecordAndPlayTest=function(){oW.print("stopAudioDeviceRecordAndPlayTest()","Invoke"),void 0!==this._recoderTimer&&(clearTimeout(this._recoderTimer),delete this._recoderTimer),this._stopAudioCaptureAndRecoder()},t.prototype.stopAudioDevicePlayTest=function(){this._isAudioDeviceRecordTesting&&(oW.print("stopAudioDevicePlayTest()","Invoke"),this._isAudioDeviceRecordTesting=!1,this.stopAudioDeviceRecordAndPlayTest(),this._stopEmitAudioPlaybackDeviceTestVolume(),this._destroyAudioElement())},t.prototype.getRecordTrack=function(){return this._audioTrack},t.prototype.destroy=function(){oW.print("destroy()","Invoke"),e.prototype.removeAllListeners.call(this),this.stopAudioPlaybackDeviceTest(),this.stopAudioDevicePlayTest()},t.prototype._playAudioFile=function(e,t){var r=this;return new Promise((function(i,n){r._audioElement=rj("audio",{attributes:{src:e,crossOrigin:"",autoplay:"true"}}),r._audioElement.loop=t.loop,oW.print("_playAudioFile()","url=".concat(e,";loop=").concat(t.loop)),r._audioElement.oncanplay=function(){oW.print("_playAudioFile()","oncanplay"),i()},r._audioElement.onerror=function(e){var t,i;n(new dP(oP.LOAD_RESOURCES_FAILED,"audio error: ".concat(e.message||(null===(i=null===(t=r._audioElement)||void 0===t?void 0:t.error)||void 0===i?void 0:i.message))))}}))},t.prototype._destroyAudioElement=function(){this._audioElement&&(oW.print("_destroyAudioElement()","Invoke"),this._audioElement.src="",delete this._audioElement,this._audioCaptureAndRecoderResolve&&this._audioCaptureAndRecoderResolve())},t.prototype._startEmitAudioPlaybackDeviceTestVolume=function(e){var t=this;e=Math.max(e,100),this._audioElement&&(oW.print("_startEmitAudioPlaybackDeviceTestVolume()","start timer(".concat(e,"ms)")),this._audioLevelFetcher=new FF(this._audioElement),this._playbackDeviceTestTimer=self.setInterval((function(){t._audioLevelFetcher&&t.emit("onAudioPlaybackDeviceTestVolume",t._audioLevelFetcher.getAudioLevel())}),e))},t.prototype._stopEmitAudioPlaybackDeviceTestVolume=function(){var e;void 0!==this._playbackDeviceTestTimer&&(oW.print("_stopEmitAudioPlaybackDeviceTestVolume()","stop timer"),self.clearInterval(this._playbackDeviceTestTimer),delete this._playbackDeviceTestTimer),null===(e=this._audioLevelFetcher)||void 0===e||e.destroy(),delete this._audioLevelFetcher},t.prototype._startAudioCaptureAndRecoder=function(e){return e_(this,void 0,void 0,(function(){var t,r,i=this;return t_(this,(function(n){switch(n.label){case 0:return t=this,[4,nB({})];case 1:return t._audioTrack=n.sent(),r=HF(this._audioTrack.getTrack()),oW.print("startAudioDeviceRecordTest()","create microphone track success!"),[2,new Promise((function(t,n){i._mediaRecorder=new MediaRecorder(r),i._mediaRecorder.ondataavailable=function(r){return e_(i,void 0,void 0,(function(){var i,o,a,s=this;return t_(this,(function(c){switch(c.label){case 0:if(!this._isAudioDeviceRecordTesting)return[3,5];oW.print("startAudioDeviceRecordTest()","get recorded file."),i=new Blob([r.data]),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this._playAudioFile(URL.createObjectURL(i),{loop:!1})];case 2:return c.sent(),[3,4];case 3:return o=c.sent(),[2,n(o)];case 4:return this._startEmitAudioPlaybackDeviceTestVolume(e),null===(a=this._audioElement)||void 0===a||a.addEventListener("ended",(function(){s.stopAudioDevicePlayTest(),t()})),this._audioCaptureAndRecoderResolve=t,[3,6];case 5:t(),c.label=6;case 6:return[2]}}))}))},i._mediaRecorder.onerror=function(e){n(new dP(oP.AUDIO_DEVICE_TEST_FAILED,e.message||"mediaRecorder error"))},i._mediaRecorder.start()}))]}}))}))},t.prototype._stopAudioCaptureAndRecoder=function(){var e;this._mediaRecorder&&("recording"===this._mediaRecorder.state&&this._mediaRecorder.stop(),delete this._mediaRecorder),null===(e=this._audioTrack)||void 0===e||e.close(),delete this._audioTrack},t}(mk.exports.EventEmitter),sW=function(){function e(){this.engineBAC={},this.engineANM={},this.channel=1,this.aec=!1,this.agc=!1,this.ans=!1,this._init()}return e.prototype._init=function(){return e_(this,void 0,void 0,(function(){var e,t;return t_(this,(function(r){switch(r.label){case 0:return e=new aV,t=this,[4,e.getAudioProfile()];case 1:return t.engineBAC=r.sent(),[2]}}))}))},e.prototype.updateEngineBAC=function(e){e&&(this.engineBAC={codec:this.engineBAC.codec,play:Zf(Zf({},this.engineBAC.play),e.play),record:Zf(Zf({},this.engineBAC.record),e.record)},this.setAEC(!!e.aec),this.setAGC(!!e.agc))},e.prototype.updateEngineANM=function(e){e&&(this.engineANM={bitrate:e.enc_param.bitrate,channel:e.enc_param.chn})},e.prototype.setAudioProfile=function(e){var t,r,i;switch(e){case Qf.fluent:r=16e3,t=24e3;break;case Qf.standard:r=48e3,t=48e3;break;case Qf.hd:r=48e3,t=128e3,i=2;break;case Qf.standardStereo:r=48e3,t=8e4,i=2;break;case Qf.hdMono:r=48e3,t=128e3}t&&(this.bitrate=t),i&&(this.channel=i),r&&(this.sampleRate=r)},e.prototype.setBitrate=function(e){e>128e3&&(e=128e3),this.bitrate=e},e.prototype.setAEC=function(e){this.aec=e},e.prototype.setAGC=function(e){this.agc=e},e.prototype.setANS=function(e){this.ans=e},e.prototype.getOpusConfigStr=function(){var e,t,r=";";return this.bitrate&&(r+="maxaveragebitrate=".concat(this.bitrate,";")),(this.sampleRate||(null===(e=this.engineBAC.record)||void 0===e?void 0:e.sr))&&(r+="maxplaybackrate=".concat(this.sampleRate||this.engineBAC.record.sr,";sprop-maxcapturerate=").concat(this.sampleRate||this.engineBAC.record.sr,";")),(this.channel>1||(null===(t=this.engineBAC.record)||void 0===t?void 0:t.chn)>1)&&(r+="stereo=1;sprop-stereo=1;"),r},Object.defineProperty(e.prototype,"config",{get:function(){var e,t,r;return{bitrate:this.bitrate||this.engineANM.bitrate,channel:this.channel||(null===(e=this.engineBAC.record)||void 0===e?void 0:e.chn)||(null===(t=this.engineANM)||void 0===t?void 0:t.chn)||1,aec:this.aec,agc:this.agc,ans:this.ans,sampleRate:this.sampleRate||(null===(r=this.engineBAC.record)||void 0===r?void 0:r.sr)}},enumerable:!1,configurable:!0}),e}(),cW=new gk("Engine",0),uW=function(e){function t(t){var r=e.call(this)||this;return r._visibility=!0,r._remoteVideoPlayer=new Map,r._remoteScreenPlayer=new Map,r._remoteAudioPlayer=new Map,r._publicStreamAudioPlayer=new Map,r._publicStreamVideoPlayer=new Map,r._publicStreamIds=new Map,r._videoStreamConstraints={},r._audioStreamConstraints={},r._enableSimulcast=!1,r._videoStreamEncodeConfig=[Jx],r._screenStreamEncodeConfig=[qx],r._pauseAllSubscribeState={audio:!1,video:!1},r._audioPropertiesReportTimer=null,r._mirrorType=jf.MIRROR_TYPE_RENDER,r._audioDeviceManager=new aW,r._audioProfileManager=new sW,r._remoteVideoConfig=new Map,r._userPriorityMap=new Map,r._subscribeFallbackOption=Wf.DISABLE,r._updateMixAudioTrack=function(e,t){return void 0===t&&(t=a_.PLAYOUT_AND_PUBLISH),e_(r,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:return cW.print("_updateMixAudioTrack()"),this._localAudioTrack?(e?(this._localAudioTrack.mixType=t,this._localAudioTrack.mixedAudioTrack=e):(delete this._localAudioTrack.mixType,delete this._localAudioTrack.mixedAudioTrack),(null===(r=this._room)||void 0===r?void 0:r.hasPublished)?[4,this._updatePublish()]:[3,2]):(e&&(this._tempMixingAudioTrack={track:e,type:t}),[2]);case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},r._onAudioMixingMessage=function(e){r.safeEmit(u_.onAudioMixingStateChanged,e)},r._appId=t,r._pubLock=new ZV("pubLock"),r._addDeviceEventHandler(),r._audioMixingManager=new tW({getLocalAudioTrack:function(){return r._localAudioTrack},updateLocalAudioTrack:r._updateMixAudioTrack,emitMessage:r._onAudioMixingMessage}),window.__rtc_engine__=r,window["__rtc_engine__".concat(Math.floor(100*Math.random()+1))]=r,r._trackSourceType={video:Of.VIDEO_SOURCE_TYPE_INTERNAL,screenVideo:Of.VIDEO_SOURCE_TYPE_INTERNAL,audio:Nf.AUDIO_SOURCE_TYPE_INTERNAL,screenAudio:Nf.AUDIO_SOURCE_TYPE_INTERNAL},r._rtmClient=new iW(t),r._handleRTMClient(r._rtmClient),r._useCloudProxy=!1,r._handleAudioDeviceManager(),r}return Cf(t,e),Object.defineProperty(t.prototype,"appId",{get:function(){return this._appId},enumerable:!1,configurable:!0}),t.prototype.updateToken=function(e){var t,r,i;return e_(this,void 0,void 0,(function(){var n,o,a,s;return t_(this,(function(c){switch(c.label){case 0:return cW.print("updateToken()","token: %s",e),ak(e,"token"),this.waitForNewToken&&(null===(t=this._room)||void 0===t?void 0:t._roomInfo)&&this._tempRoomConfig?(n=null===(r=this._room)||void 0===r?void 0:r._roomInfo,o=n.roomId,a=n.userInfo,s=this._tempRoomConfig,delete this._tempRoomConfig,[4,this.joinRoom(e,o,a,s)]):[3,2];case 1:return[2,c.sent()];case 2:if(!this._room)throw new dP(oP.UPDATE_TOKEN_BEFORE_JOIN,"update token before join room");return[4,null===(i=this._room)||void 0===i?void 0:i.updateToken(e)];case 3:return c.sent(),[2]}}))}))},t.prototype.setVideoCaptureDevice=function(e){return e_(this,void 0,void 0,(function(){var t,r;return t_(this,(function(i){switch(i.label){case 0:return cW.print("setVideoCaptureDevice()","deviceId: %s",e),ak(e,"deviceId"),this._localVideoTrack?(t=this._videoStreamConstraints,"user"===e||"environment"===e||"left"===e||"right"===e?(delete t.deviceId,t.facingMode=e):t.deviceId={exact:e},this._videoStreamConstraints=t,[4,iB(t)]):(this._localVideoDeviceId=e,[2,Promise.resolve()]);case 1:return r=i.sent(),this._initLocalTrackEvents(r),this._localVideoTrack.close(),this._localVideoTrack=r,this._videoPlayer&&(this._videoPlayer.stop(),this._videoPlayer.playVideo(r),this._videoPlayer.mirror(!!this._mirrorType)),this._room?this._room.hasPublished?[4,this._updatePublish()]:[3,3]:[2];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},t.prototype.setAudioCaptureDevice=function(e){return e_(this,void 0,void 0,(function(){var t,r;return t_(this,(function(i){switch(i.label){case 0:return cW.print("setAudioCaptureDevice()","deviceId: %s",e),ak(e,"deviceId"),this._localAudioTrack?((t=this._audioStreamConstraints).deviceId={exact:e},this._audioStreamConstraints=t,[4,nB(t,this._audioProfileManager)]):(this._localAudioDeviceId=e,[2,Promise.resolve()]);case 1:return r=i.sent(),this._initLocalTrackEvents(r),this._localAudioTrack.close(),this._localAudioTrack=r,this._room?this._room.hasPublished?[4,this._updatePublish()]:[3,3]:[2];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},t.prototype._addDeviceEventHandler=function(){xF.on(u_.onVideoDeviceStateChanged,this._onVideoDeviceStateChange.bind(this)),xF.on(u_.onAudioDeviceStateChanged,this._onAudioDeviceStateChange.bind(this))},t.prototype._addHandlerEventHandler=function(){var e,t,r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S,y,E,g,b,T,I,R,A,C,O=this;null===(e=this._room)||void 0===e||e.on(Fx.ON_ADD_STREAM,this._onAddStream.bind(this)),null===(t=this._room)||void 0===t||t.on(Fx.ON_REMOVE_STREAM,this._onRemoveStream.bind(this)),null===(r=this._room)||void 0===r||r.on(Fx.USER_CONNECTION,this._onUserConnection.bind(this)),null===(i=this._room)||void 0===i||i.on(cB.ON_USER_LEAVE,this._onUserLeave.bind(this)),null===(n=this._room)||void 0===n||n.on(cB.ON_ROOM_ERROR,this._onRoomError.bind(this)),null===(o=this._room)||void 0===o||o.on(cB.ON_NETWORK_QUALITY,this._onNetworkQuality.bind(this)),null===(a=this._room)||void 0===a||a.on(Fx.ON_CUSTOM_MESSAGE,this._onCustomMessage.bind(this)),null===(s=this._room)||void 0===s||s.on(Fx.USER_MESSAGE_RECEIVED,this._onUserMessageReceived.bind(this)),null===(c=this._room)||void 0===c||c.on(Fx.USER_BINARY_MESSAGE_RECEIVED,this._onUserBinaryMessageReceived.bind(this)),null===(u=this._room)||void 0===u||u.on(Fx.ON_USER_TOKEN_WILL_EXPIRE,this._onUserTokenWillExpire.bind(this)),null===(d=this._room)||void 0===d||d.on(Fx.POST_PROCESSING_MESSAGE,(function(e){!function(e){return"2.0"===e.protocol}(e)?"publicStreamCallback"===e.type?O._onPushPublicStreamResult(e):"transcodeStatusCallback"===e.type&&O._onLiveTranscodingResult(e):O._onStreamMixingEvent({error:e.error,event:e.eventType,message:e.message})})),null===(l=this._room)||void 0===l||l.on(jx.ON_CONNECTION_STATE_CHANGE,this._onConnectionStateChange.bind(this)),null===(h=this._room)||void 0===h||h.on(cB.RESUBSCRIBE,this._onResubscribe.bind(this)),null===(p=this._room)||void 0===p||p.on(cB.SUBSCRIBE_PUSH_TRACK,this._onSubscribePushTrack.bind(this)),null===(f=this._room)||void 0===f||f.on(cB.REMOVE_PUSH_TRACK,this._onRemovePushTrack.bind(this)),null===(_=this._room)||void 0===_||_.on(cB.VIDEO_FIRST_FRAME,this._onVideoFirstFrameDecoded.bind(this)),null===(v=this._room)||void 0===v||v.on(cB.ON_PUBLISH_RESULT,(function(e){var t;(null===(t=O._room)||void 0===t?void 0:t._roomConfig.isAutoPublish)&&O.safeEmit(u_.onAutoPublishResult,e)})),null===(m=this._room)||void 0===m||m.on(cB.ON_REMOTE_STREAM_STATS,(function(e){O.safeEmit(u_.onRemoteStreamStats,e)})),null===(S=this._room)||void 0===S||S.on(cB.ON_LOCAL_STREAM_STATS,(function(e){O.safeEmit(u_.onLocalStreamStats,e)})),null===(y=this._room)||void 0===y||y.on(cB.ON_USER_PUBLISH_STATE_CHANGE,this._onUserPublishStateChange.bind(this)),null===(E=this._room)||void 0===E||E.on(cB.ON_USER_START_AUDIO_CAPTURE,(function(e){var t=e.userId;O.safeEmit(u_.onUserStartAudioCapture,{userId:t})})),null===(g=this._room)||void 0===g||g.on(cB.ON_USER_STOP_AUDIO_CAPTURE,(function(e){var t=e.userId;O.safeEmit(u_.onUserStopAudioCapture,{userId:t})})),null===(b=this._room)||void 0===b||b.on(cB.ON_USER_START_VIDEO_CAPTURE,(function(e){var t=e.userId;O.safeEmit(u_.onUserStartVideoCapture,{userId:t})})),null===(T=this._room)||void 0===T||T.on(cB.ON_USER_STOP_VIDEO_CAPTURE,(function(e){var t=e.userId;O.safeEmit(u_.onUserStopVideoCapture,{userId:t})})),null===(I=this._room)||void 0===I||I.on(cB.ON_SEI_MESSAGED_RECEIVED,(function(e){O.safeEmit(u_.onSEIMessageReceived,e)})),null===(R=this._room)||void 0===R||R.on(cB.ON_REMOTE_VIDEO_SIZE_CHANGED,(function(e,t){O.safeEmit(u_.onRemoteVideoSizeChanged,e,t)})),null===(A=this._room)||void 0===A||A.on(cB.ON_SIMULCAST_SUBSCRIBE_FALLBACK,(function(e){return O.safeEmit(u_.onSimulcastSubscribeFallback,e)})),null===(C=this._room)||void 0===C||C.on(cB.RECONNECT_FAILED,(function(){O.safeEmit(u_.onError,{errorCode:oP.RECONNECT_FAILED})}))},t.prototype.safeEmit=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return vk(t)&&Sx(t,QD(r)),e.prototype.safeEmit.apply(this,n_([t],i_(r),!1))},t.prototype._removeHandlerEventHandler=function(){var e;null===(e=this._room)||void 0===e||e.removeAllListeners()},t.prototype.joinRoom=function(e,t,r,i){return e_(this,void 0,void 0,(function(){var n,o,a;return t_(this,(function(s){switch(s.label){case 0:if(cW.print("joinRoom()","token: %o roomId: %o, userInfo: %o, roomConfig: %o",e,t,r,i),lk(e)||ak(e,"token"),function(e){if("string"!=typeof e||!/^[a-zA-Z0-9@._\-]{1,128}$/.test(e))throw new dP(oP.INVALID_PARAMS,"The RoomId must be within 128 bytes. The supported characters: a-z,A-Z,0-9,@,-,_,.")}(t),function(e){ck(e,"userInfo"),hk(e.userId),lk(e.extraInfo)||ak(e.extraInfo,"userInfo.extraInfo",1,200)}(r),n={isAutoPublish:!0,isAutoSubscribeAudio:!0,isAutoSubscribeVideo:!0,roomProfileType:qf.communication},kG(n,i),function(e){ck(e,"roomConfig"),nk(e.isAutoPublish,"roomConfig.isAutoPublish"),nk(e.isAutoSubscribeAudio,"roomConfig.isAutoSubscribeAudio"),nk(e.isAutoSubscribeVideo,"roomConfig.isAutoSubscribeVideo")}(n),!this._room||this._room.connectionState===mB.DISCONNECTED)return[3,1];throw new dP(oP.REPEAT_JOIN,"Already joined");case 1:this._room=new ej(i,{audioProfileManager:this._audioProfileManager}),this._room.userPriorityMap=this._userPriorityMap,this._room.subscribeFallbackOption=this._subscribeFallbackOption,this._addHandlerEventHandler(),o=this._liveTranscodeConfig&&Ux("started",this._liveTranscodeConfig),s.label=2;case 2:return s.trys.push([2,4,,5]),this._useCloudProxy&&(this._startCloudProxyTimestamp=Date.now()),[4,this._room.join(this._appId,t,e,Zf(Zf({},r),{businessId:this._businessId,role:this._visibility?eW.NORMAL_USER:eW.SILENT_USER}),o,this._useCloudProxy)];case 3:return s.sent(),this._roomConfig=i,this._tempRoomConfig&&delete this._tempRoomConfig,[3,5];case 4:throw(a=s.sent()).code===oP.INVALID_TOKEN&&(this._tempRoomConfig=i),a;case 5:(null==i?void 0:i.isAutoPublish)&&(this._visibility?this._updatePublish({invokeByJoinRoom:!0,mediaType:Vf.AUDIO_AND_VIDEO}):this.safeEmit(u_.onAutoPublishResult,{isScreen:!1,state:Mf.PUBLISH_FAIL})),s.label=6;case 6:return[2]}}))}))},t.prototype.leaveRoom=function(e){var t,r;return void 0===e&&(e=!1),e_(this,void 0,void 0,(function(){return t_(this,(function(i){switch(i.label){case 0:return cW.print("leaveRoom()"),e?[4,null===(t=this._room)||void 0===t?void 0:t.leave(e)]:[3,2];case 1:return i.sent(),[3,3];case 2:null===(r=this._room)||void 0===r||r.leave(e).catch(),i.label=3;case 3:return this._removeHandlerEventHandler(),this._liveTranscodeConfig&&this.stopLiveTranscoding(),this._room=void 0,this._remoteAudioPlayer.forEach((function(e){return e.destroy()})),this._remoteAudioPlayer=new Map,this._remoteScreenPlayer.forEach((function(e){return e.destroy()})),this._remoteScreenPlayer=new Map,this._remoteVideoPlayer.forEach((function(e){return e.destroy()})),this._remoteVideoPlayer=new Map,this._roomConfig=void 0,this._publicStreamIds=new Map,[2]}}))}))},t.prototype.destroy=function(){var e,t,r,i;cW.print("destroy()"),this.removeAllListeners(),this._removeHandlerEventHandler(),null===(e=this._room)||void 0===e||e.destroy(),this._room=void 0,null===(t=this._videoPlayer)||void 0===t||t.destroy(),null===(r=this._audioPlayer)||void 0===r||r.destroy(),this._videoPlayer=void 0,this._audioPlayer=void 0,this._screenPlayer=void 0,this._videoStreamConstraints={},this._audioStreamConstraints={},this._videoStreamEncodeConfig=[Jx],this._screenStreamEncodeConfig=[qx],this._pauseAllSubscribeState={audio:!1,video:!1},clearInterval(this._audioVolumeIndicationTimer),clearInterval(this._dummyTimer),this._audioVolumeIndicationTimer=void 0,this._stopAudioPropertiesReport(),this._localAudioTrack&&(this._localAudioTrack.close(),this._localAudioTrack=void 0),this._localVideoTrack&&(this._localVideoTrack.close(),this._localVideoTrack=void 0),this._localScreenAudioTrack&&(this._localScreenAudioTrack.close(),this._localScreenAudioTrack=void 0),this._localScreenVideoTrack&&(this._localScreenVideoTrack.close(),this._localScreenVideoTrack=void 0),this._localImgVideoTrack&&(this._localImgVideoTrack.stop(),this._localImgVideoTrack=void 0),this._localImgScreenTrack&&(this._localImgScreenTrack.stop(),this._localImgScreenTrack=void 0),this._remoteAudioPlayer.forEach((function(e){return e.destroy()})),this._remoteAudioPlayer=new Map,this._remoteScreenPlayer.forEach((function(e){return e.destroy()})),this._remoteScreenPlayer=new Map,this._remoteVideoPlayer.forEach((function(e){return e.destroy()})),this._remoteVideoPlayer=new Map,this._publicStreamAudioPlayer.forEach((function(e){return e.destroy()})),this._publicStreamAudioPlayer=new Map,this._publicStreamVideoPlayer.forEach((function(e){return e.destroy()})),this._publicStreamVideoPlayer=new Map,this._roomConfig=void 0,this._audioMixingManager.destroy(),this._rtmClient.destroy(),null===(i=this._outsideRoom)||void 0===i||i.destroy(),this._publicStreamIds=new Map,this._audioDeviceManager.destroy(),this._remoteVideoConfig=new Map,this._userPriorityMap.clear()},t.prototype.publishStream=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return cW.print("publishStream()","mediaType: %o",e),this._checkMediaType(e),this._assertNotInRoom(),rk(e)&&!this._localVideoTrack&&this._localImgVideoTrack&&(this._localVideoTrack=(r=this._localImgVideoTrack,new ZF(r,HD())),this._localVideoTrack.dummy=!0),[4,this._updatePublish({mediaType:e})];case 1:return t.sent(),[2]}var r}))}))},t.prototype.unpublishStream=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return cW.print("unpublishStream()","mediaType: %o",e),this._checkMediaType(e),this._assertNotInRoom(),[4,this._updatePublish({mediaType:e,pubState:lB.UNPUB})];case 1:return t.sent(),[2]}}))}))},t.prototype.publishScreen=function(e){return e_(this,void 0,void 0,(function(){var t;return t_(this,(function(r){switch(r.label){case 0:cW.print("publishScreen()","mediaType: %o",e),this._checkMediaType(e),this._assertNotInRoom(),r.label=1;case 1:return r.trys.push([1,3,,4]),rk(e)&&!this._localScreenVideoTrack&&this._localImgScreenTrack&&(this._localScreenVideoTrack=(i=this._localImgScreenTrack,new $F(i,HD())),this._localScreenVideoTrack.dummy=!0),[4,this._updateScreenPublish({mediaType:e,pubState:lB.PUB})];case 2:return r.sent(),[3,4];case 3:throw(t=r.sent())instanceof dP?t:new dP(oP.UNEXPECTED_ERROR,"unexpected error",t);case 4:return[2]}var i}))}))},t.prototype.unpublishScreen=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return cW.print("unpublishScreen()","mediaType: %o",e),this._checkMediaType(e),this._assertNotInRoom(),[4,this._updateScreenPublish({mediaType:e,pubState:lB.UNPUB})];case 1:return t.sent(),[2]}}))}))},t.prototype.subscribeStream=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return cW.print("subscribeStream()","userId: %o, mediaType: %o",e,t),[2,this._subscribe(!1,e,t)]}))}))},t.prototype._subscribe=function(e,t,r){var i,n,o,a,s;return e_(this,void 0,void 0,(function(){var c,u,d,l,h;return t_(this,(function(p){switch(p.label){case 0:if(this._checkMediaType(r),this._assertNotInRoom(),c=this._room.remoteStreams.get(t),!(u=null==c?void 0:c.find((function(t){return t.isScreen===e}))))throw new dP(oP.STREAM_NOT_EXIST,"stream not exist");return this._pauseAllSubscribeState.audio&&(r-=r&Vf.AUDIO),this._pauseAllSubscribeState.video&&(r-=r&Vf.VIDEO),cW.print("subscribeStream()","due to pauseAll mediaType: %o",r),d=u.hasSubscribed,l=this._remoteVideoConfig.get(t)||(null===(i=this._roomConfig)||void 0===i?void 0:i.remoteVideoConfig),u.originalMediaType=r,[4,this._room.subscribe(u,r,l)];case 1:return p.sent(),tk(r)&&this._updateAudioPlayerState(u),rk(r)&&this._updateVideoPlayerState(u),e||!(null===(n=this._roomConfig)||void 0===n?void 0:n.isAutoSubscribeAudio)&&!(null===(o=this._roomConfig)||void 0===o?void 0:o.isAutoSubscribeVideo)||(u.audioTrack||u.videoTrack)&&(h={userId:t,isScreen:!1,state:kf.SUBSCRIBE_SUCC},this.safeEmit(u_.onAutoSubscribeResult,h)),!d&&tk(r)&&(null===(a=u.observer)||void 0===a||a.setSubscribeAudio(!0)),!d&&rk(r)&&(null===(s=u.observer)||void 0===s||s.setSubscribeVideo(!0)),[2]}}))}))},t.prototype.unsubscribeStream=function(e,t){return e_(this,void 0,void 0,(function(){var r,i;return t_(this,(function(n){if(cW.print("unsubscribeStream()","userId: %o, mediaType: %o",e,t),this._checkMediaType(t),this._assertNotInRoom(),r=this._room.remoteStreams.get(e),!(null==(i=null==r?void 0:r.find((function(e){return!e.isScreen})))?void 0:i.hasSubscribed))throw new dP(oP.STREAM_NOT_EXIST,"stream not exist");return this._room.unsubscribe(i,t),[2]}))}))},t.prototype.subscribeScreen=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return cW.print("subscribeScreen() userId: %o, mediaType: %o",e,t),[2,this._subscribe(!0,e,t)]}))}))},t.prototype.unsubscribeScreen=function(e,t){return e_(this,void 0,void 0,(function(){var r,i;return t_(this,(function(n){if(cW.print("unsubscribeScreen() userId: %o, mediaType: %o",e,t),this._checkMediaType(t),this._assertNotInRoom(),r=this._room.remoteStreams.get(e),!(null==(i=null==r?void 0:r.find((function(e){return e.isScreen})))?void 0:i.hasSubscribed))throw new dP(oP.STREAM_NOT_EXIST,"stream not exist");return this._room.unsubscribe(i,t),[2]}))}))},t.prototype.setRemoteVideoConfig=function(e,t){var r;return e_(this,void 0,void 0,(function(){return t_(this,(function(i){return cW.print("setRemoteVideoConfig() userId: %o, remoteVideoConfig: %o",e,t),hk(e),function(e){if("number"!=typeof(null==e?void 0:e.width)||"number"!=typeof(null==e?void 0:e.height))throw new dP(oP.INVALID_PARAMS,"remoteVideoConfig must contain width, height, frameRate")}(t),this._remoteVideoConfig.set(e,t),[2,null===(r=this._room)||void 0===r?void 0:r.updateSubVideoConfig(e,t).then((function(){}))]}))}))},t.prototype.startVideoCapture=function(e){var t,r;return e_(this,void 0,void 0,(function(){var i,n,o,a,s;return t_(this,(function(c){switch(c.label){case 0:if(cW.print("startVideoCapture()","deviceId: %s",e),lk(e)||ak(e,"deviceId"),e=e||this._localVideoDeviceId,this._localVideoTrack&&!this._localVideoTrack.dummy)throw new dP(oP.REPEAT_CAPTURE,"Has already capture");return i=this._videoStreamConstraints,e&&("user"===e||"environment"===e||"left"===e||"right"===e?i.facingMode=e:i.deviceId={exact:e},this._videoStreamConstraints=i),[4,iB(i)];case 1:return n=c.sent(),this._initLocalTrackEvents(n),this._localVideoTrack=n,this._videoPlayer&&this._videoPlayer.playVideo(n),o={},(a=null==n?void 0:n.getTrack())&&(o=a.getSettings()),this._room?(s=this._room._roomConfig.isAutoPublish,(this._room.hasPublished||s)&&(this._visibility?this._updatePublish():this.safeEmit(u_.onAutoPublishResult,{isScreen:!1,state:Mf.PUBLISH_FAIL})),null===(r=null===(t=this._room.localStream)||void 0===t?void 0:t.observer)||void 0===r||r.setEnableVideo(!0),[2,o]):[2,o]}}))}))},t.prototype.stopVideoCapture=function(){var e,t,r,i,n;return e_(this,void 0,void 0,(function(){return t_(this,(function(o){switch(o.label){case 0:if(cW.print("stopVideoCapture()"),this._trackSourceType.video===Of.VIDEO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setVideoSourceType as internal first");return null===(e=this._videoPlayer)||void 0===e||e.stop(),null===(t=this._localVideoTrack)||void 0===t||t.close(),this._localImgVideoTrack&&this._localVideoTrack?(null===(r=this._localVideoTrack)||void 0===r||r.setTrack(this._localImgVideoTrack),this._localVideoTrack.dummy=!0):this._localVideoTrack=void 0,this._room?this._room.hasPublished?[4,this._updatePublish()]:[3,2]:[2];case 1:o.sent(),o.label=2;case 2:return null===(n=null===(i=this._room.localStream)||void 0===i?void 0:i.observer)||void 0===n||n.setEnableVideo(!1),[2]}}))}))},t.prototype.startAudioCapture=function(e){var t,r;return e_(this,void 0,void 0,(function(){var i,n,o;return t_(this,(function(a){switch(a.label){case 0:if(cW.print("startAudioCapture()","deviceId: $o",e),lk(e)||ak(e,"deviceId"),e=e||this._localAudioDeviceId,this._localAudioTrack)throw new dP(oP.REPEAT_CAPTURE,"Has already capture");return i=this._audioStreamConstraints,e&&(i.deviceId={exact:e},this._audioStreamConstraints=i),[4,nB(i,this._audioProfileManager)];case 1:return n=a.sent(),this._initLocalTrackEvents(n),this._localAudioTrack=n,this._tempMixingAudioTrack&&(this._localAudioTrack.mixType=this._tempMixingAudioTrack.type,this._localAudioTrack.mixedAudioTrack=this._tempMixingAudioTrack.track,delete this._tempMixingAudioTrack),this._room?(o=this._room._roomConfig.isAutoPublish,(this._room.hasPublished||o)&&(this._visibility?this._updatePublish():this.safeEmit(u_.onAutoPublishResult,{isScreen:!1,state:Mf.PUBLISH_FAIL})),null===(r=null===(t=this._room.localStream)||void 0===t?void 0:t.observer)||void 0===r||r.setEnableAudio(!0),[2]):[2]}}))}))},t.prototype.stopAudioCapture=function(){var e,t,r;return e_(this,void 0,void 0,(function(){return t_(this,(function(i){switch(i.label){case 0:if(cW.print("stopAudioCapture()"),null===(e=this._localAudioTrack)||void 0===e||e.close(),this._localAudioTrack=void 0,this._audioMixingManager.stopAll(),this._trackSourceType.audio===Nf.AUDIO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setAudioSourceType as internal first");return this._room?this._room.hasPublished?[4,this._updatePublish()]:[3,2]:[2];case 1:i.sent(),i.label=2;case 2:return null===(r=null===(t=this._room.localStream)||void 0===t?void 0:t.observer)||void 0===r||r.setEnableAudio(!1),[2]}}))}))},t.prototype.getAudioMixingManager=function(){return cW.print("getAudioMixingManager()"),this._audioMixingManager},t.prototype.startScreenCapture=function(e){var t,r,i,n;return void 0===e&&(e={}),e_(this,void 0,void 0,(function(){var o,a,s,c;return t_(this,(function(u){switch(u.label){case 0:if(cW.print("startScreenCapture()","config: %o",e),(null===(t=this._localScreenVideoTrack)||void 0===t?void 0:t.dummy)||null===(r=this._localScreenVideoTrack)||void 0===r||r.close(),this._localScreenVideoTrack=void 0,o=e.enableAudio,a=void 0!==o&&o,this._trackSourceType.screenVideo===Of.VIDEO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setVideoSourceType as internal first");if(this._trackSourceType.screenAudio===Nf.AUDIO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setAudioSourceType as internal first");return[4,oB(a)];case 1:return s=u.sent(),this._localScreenVideoTrack=new $F(s.getVideoTracks()[0],HD()),(c=s.getAudioTracks()).length&&(this._localScreenAudioTrack=new eB(c[0],HD()),this._initLocalTrackEvents(this._localScreenAudioTrack)),null===(i=this._screenPlayer)||void 0===i||i.playVideo(this._localScreenVideoTrack),this._initLocalTrackEvents(this._localScreenVideoTrack),(null===(n=this._room)||void 0===n?void 0:n.hasScreenPublished)?[4,this._updateScreenPublish()]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},t.prototype.stopScreenCapture=function(){var e,t,r,i;return e_(this,void 0,void 0,(function(){return t_(this,(function(n){switch(n.label){case 0:return cW.print("stopScreenCapture()"),null===(e=this._screenPlayer)||void 0===e||e.stop(),null===(t=this._localScreenVideoTrack)||void 0===t||t.close(),this._localImgScreenTrack&&this._localScreenVideoTrack?(this._localScreenVideoTrack.setTrack(this._localImgScreenTrack),this._localScreenVideoTrack.dummy=!0):this._localScreenVideoTrack=void 0,null===(r=this._localScreenAudioTrack)||void 0===r||r.close(),this._localScreenAudioTrack=void 0,(null===(i=this._room)||void 0===i?void 0:i.hasScreenPublished)?[4,this._updateScreenPublish()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.setLocalVideoPlayer=function(e,t){var r,i;if(cW.print("setLocalVideoPlayer()","streamIndex: %o, videoPlayerOption: %o",e,t),sk(e,"streamIndex",[xf.STREAM_INDEX_MAIN,xf.STREAM_INDEX_SCREEN]),t&&t.renderDom)return fk(t),e!=xf.STREAM_INDEX_MAIN||this._videoPlayer?e!=xf.STREAM_INDEX_SCREEN||this._screenPlayer?void 0:(this._screenPlayer=new uj(Zf(Zf({},t),{isScreen:!0})),this._initPlayerEvents(this._screenPlayer),this._localScreenVideoTrack&&!this._localScreenVideoTrack.dummy&&this._screenPlayer.playVideo(this._localScreenVideoTrack),this._screenPlayer.domElement):(this._videoPlayer=new uj(t),this._initPlayerEvents(this._videoPlayer),this._videoPlayer.mirror(!!this._mirrorType),this._localVideoTrack&&!this._localVideoTrack.dummy&&this._videoPlayer.playVideo(this._localVideoTrack),this._videoPlayer.domElement);e==xf.STREAM_INDEX_MAIN?(null===(r=this._videoPlayer)||void 0===r||r.destroy(),delete this._videoPlayer):(null===(i=this._screenPlayer)||void 0===i||i.destroy(),delete this._screenPlayer)},t.prototype.startLiveTranscoding=function(e){var t;return e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:cW.print("startLiveTranscoding()","transcode: %o",e),ak(e.url,"liveTranscode.url"),this._liveTranscodeConfig=e,i.label=1;case 1:return i.trys.push([1,3,,4]),this.safeEmit(u_.onStreamMixingEvent,{event:dB.START,error:0,message:""}),[4,null===(t=this._room)||void 0===t?void 0:t.liveControlMessage(Ux("started",this._liveTranscodeConfig))];case 2:return i.sent(),[3,4];case 3:throw(r=i.sent())instanceof dP?r:new dP(oP.UNEXPECTED_ERROR,"unexpected error",r);case 4:return[2]}}))}))},t.prototype.updateLiveTranscoding=function(e){var t;return e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:if(cW.print("updateLiveTranscoding()","transcode: %o",e),!this._liveTranscodeConfig)return[2];this._liveTranscodeConfig=kG(this._liveTranscodeConfig,e),i.label=1;case 1:return i.trys.push([1,3,,4]),this.safeEmit(u_.onStreamMixingEvent,{event:dB.UPDATE,error:0,message:""}),[4,null===(t=this._room)||void 0===t?void 0:t.liveControlMessage(Ux("layoutChanged",this._liveTranscodeConfig))];case 2:return i.sent(),[3,4];case 3:throw(r=i.sent())instanceof dP?r:new dP(oP.UNEXPECTED_ERROR,"unexpected error",r);case 4:return[2]}}))}))},t.prototype.stopLiveTranscoding=function(){var e;return e_(this,void 0,void 0,(function(){var t;return t_(this,(function(r){switch(r.label){case 0:if(cW.print("stopLiveTranscoding()"),!this._liveTranscodeConfig)return[2];delete this._liveTranscodeConfig,r.label=1;case 1:return r.trys.push([1,3,,4]),this.safeEmit(u_.onStreamMixingEvent,{event:dB.STOP,error:0,message:""}),[4,null===(e=this._room)||void 0===e?void 0:e.liveControlMessage({action:"stopped",type:"transcode"})];case 2:return r.sent(),[3,4];case 3:throw(t=r.sent())instanceof dP?t:new dP(oP.UNEXPECTED_ERROR,"unexpected error",t);case 4:return[2]}}))}))},t.prototype.setBusinessId=function(e){return cW.print("setBusinessId()","businessId: %s",e),!function(e){return"string"!=typeof e}(e)&&!this._room&&(px.setStats({rtc_business_id:e}),this._businessId=e,!0)},t.prototype.setUserVisibility=function(e){var t,r;return e_(this,void 0,void 0,(function(){return t_(this,(function(i){switch(i.label){case 0:if(cW.print("setUserVisibility()","enable: %o",e),e=!!e,this._visibility===e)return[2];if(!this._room)return this._visibility=e,[2];if(this._room.connectionState!==mB.CONNECTED)throw new dP(oP.NOT_CONNECTED_YET,"server not connected");return this._room.localStream&&(null===(t=this._room.localStream.observer)||void 0===t||t.setPublisher(e)),!e?[4,this._room.unpublish()]:[3,2];case 1:i.sent(),i.label=2;case 2:return[4,this._room.updateUserAttributes({role:e?eW.NORMAL_USER:eW.SILENT_USER})];case 3:return i.sent(),this._visibility=e,e&&(null===(r=this._roomConfig)||void 0===r?void 0:r.isAutoPublish)&&this._updatePublish({mediaType:Vf.AUDIO_AND_VIDEO}),[2]}}))}))},t.prototype._initPlayerEvents=function(e,t){var r=this;void 0===t&&(t=!1),e.on("playback_event",(function(i){var n,o,a,s;switch(null===(o=null===(n=r._room)||void 0===n?void 0:n.remoteStreams.get(i.userId))||void 0===o||o.find((function(e){return!e.isScreen})),i.eventName){case"timeupdate":return;case"loadeddata":if("audio"===i.type)t?r.safeEmit(u_.onFirstPublicStreamAudioFrameDecoded,{publicStreamId:e.userId}):r.safeEmit(u_.onAudioFirstFrameDecoded,{userId:e.userId}),dx.firstRemoteAudioRender("",i.userId);else{var c={userId:e.userId,height:(null===(a=e.domElement)||void 0===a?void 0:a.videoHeight)||0,width:(null===(s=e.domElement)||void 0===s?void 0:s.videoWidth)||0};t?(c.publicStreamId=c.userId,delete c.userId,r.safeEmit(u_.onFirstPublicStreamVideoFrameDecoded,c),r.safeEmit(u_.onFirstPublicStreamVideoFrameRendered,c)):(r.safeEmit(u_.onVideoFirstFrameDecoded,c),r.safeEmit(u_.onVideoFirstFrameRendered,c)),dx.firstRemoteVideoRender("",i.userId)}break;case"autoplay-error":return t&&(i.publicStreamId=i.userId),void r.safeEmit(u_.onAutoplayFailed,i)}r.safeEmit(u_.onPlayerEvent,i)}))},t.prototype._initLocalTrackEvents=function(e){var t=this;e.on("track-ended",(function(e){var r=!1;e!==t._localScreenAudioTrack&&e!==t._localScreenVideoTrack||(r=!0),t.safeEmit(u_.onTrackEnded,{kind:e.getTrack().kind,isScreen:r})}))},t.prototype.setRemoteVideoPlayer=function(e,t){var r,i,n,o,a,s;cW.print("setRemoteVideoPlayer()","streamIndex: %o, videoPlayerOption: %o",e,t),sk(e,"streamIndex",[xf.STREAM_INDEX_MAIN,xf.STREAM_INDEX_SCREEN]),fk(t);var c=t.userId;if(t.renderDom){if(e==xf.STREAM_INDEX_MAIN){null===(r=this._remoteVideoPlayer.get(c))||void 0===r||r.destroy();var u=new uj(t);return this._initPlayerEvents(u),this._remoteVideoPlayer.set(c,u),(d=null===(n=null===(i=this._room)||void 0===i?void 0:i.remoteStreams.get(c))||void 0===n?void 0:n.find((function(e){return!e.isScreen})))&&this._updateVideoPlayerState(d),u.domElement}null===(o=this._remoteScreenPlayer.get(c))||void 0===o||o.destroy();var d;u=new uj(Zf(Zf({},t),{isScreen:!0}));return this._remoteScreenPlayer.set(c,u),this._initPlayerEvents(u),(d=null===(s=null===(a=this._room)||void 0===a?void 0:a.remoteStreams.get(c))||void 0===s?void 0:s.find((function(e){return e.isScreen})))&&this._updateVideoPlayerState(d),u.domElement}this._getRemotePlayer(c,e===xf.STREAM_INDEX_SCREEN).forEach((function(e){return null==e?void 0:e.destroy()}))},t.prototype.setLocalVideoMirrorType=function(e){cW.print("setLocalVideoMirrorType()","mirrorType: %o",e),sk(e,"mirrorType",[jf.MIRROR_TYPE_NONE,jf.MIRROR_TYPE_RENDER]),this._mirrorType=e,this._videoPlayer&&this._videoPlayer.mirror(!!e)},t.prototype.setAudioPlaybackDevice=function(e){var t;return e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:return cW.print("setAudioPlaybackDevice()","deviceId: %s",e),ak(e,"deviceId"),void 0===HTMLAudioElement.prototype.setSinkId?(cW.print("setAudioPlaybackDevice failed","setSinkId not supported by current browser"),[2]):[4,xF.getDeviceById(e)];case 1:if(!(r=i.sent()))throw new dP(oP.INVALID_DEVICE_ID,"audio playback device id ".concat(e," is invalid"));return this._remoteAudioPlayer.forEach((function(t){t.setPlaybackDevice(e)})),null===(t=this._audioPlayer)||void 0===t||t.setPlaybackDevice(e),this._audioPlaybackDeviceId=e,r&&this.safeEmit(u_.onAudioPlaybackDeviceChanged,r),dx.rtcAudioDevice(BL.PLAYOUT_DEVICE_SWITCH,e,0),[2]}}))}))},t.prototype.play=function(e){return e_(this,void 0,void 0,(function(){var t,r;return t_(this,(function(i){if(cW.print("play()","userId | publicStreamId: %s",e),hk(e),t=this._remoteAudioPlayer.get(e),r=this._remoteVideoPlayer.get(e),t||(t=this._publicStreamAudioPlayer.get(e)),r||(r=this._publicStreamVideoPlayer.get(e)),t||(t=this._audioPlayer),r||(r=this._videoPlayer),!t&&!r)throw new dP(oP.INVALID_PARAMS,"Player not found");return t&&t.manuallyPlay(),r&&r.manuallyPlay(),[2]}))}))},t.prototype.pauseAllSubscribedStream=function(e){return e_(this,void 0,void 0,(function(){var t,r=this;return t_(this,(function(i){return cW.print("pauseAllSubscribedStream()","mediaType: %o",e),this._checkMediaType(e),this._pauseAllSubscribeState.audio&&this._pauseAllSubscribeState.video?[2,Promise.resolve()]:(t=function(){tk(e)&&(r._pauseAllSubscribeState.audio=!0),rk(e)&&(r._pauseAllSubscribeState.video=!0)},this._room?[2,this._room.pauseAllSubscribedStream(e).then((function(){t()}))]:(t(),[2,Promise.resolve()]))}))}))},t.prototype.resumeAllSubscribedStream=function(e){return e_(this,void 0,void 0,(function(){var t,r=this;return t_(this,(function(i){return cW.print("resumeAllSubscribedStream()","mediaType: %o",e),this._checkMediaType(e),this._pauseAllSubscribeState.audio||this._pauseAllSubscribeState.video?(t=function(){tk(e)&&(r._pauseAllSubscribeState.audio=!1),rk(e)&&(r._pauseAllSubscribeState.video=!1)},this._room?[2,this._room.resumeAllSubscribedStream(e).then((function(){var e,i;t(),null===(i=null===(e=r._room)||void 0===e?void 0:e.remoteStreams)||void 0===i||i.forEach((function(e){Array.isArray(e)&&e.forEach((function(e){r._updateAudioPlayerState(e),r._updateVideoPlayerState(e)}))}))}))]:(t(),[2,Promise.resolve()])):[2,Promise.resolve()]}))}))},t.prototype.sendUserMessage=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){if(hk(e),_k(t),!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.IM_BEFORE_JOIN,"join first");return[2,this._room.sendUserMessage(e,t)]}))}))},t.prototype.sendUserBinaryMessage=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){if(hk(e),uk(t,"message"),_k(t),!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.IM_BEFORE_JOIN,"join first");return[2,this._room.sendUserMessage(e,t)]}))}))},t.prototype.sendRoomMessage=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){if(_k(e),!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.IM_BEFORE_JOIN,"join first");return[2,this._room.sendRoomMessage(e)]}))}))},t.prototype.sendRoomBinaryMessage=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){if(_k(e),!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.IM_BEFORE_JOIN,"join first");return[2,this._room.sendRoomMessage(e,!0)]}))}))},t.prototype.setAudioCaptureConfig=function(e){var t;return void 0===e&&(e={}),e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:return cW.print("setAudioCaptureConfig()","config: %o",e),delete e.deviceId,dk(e),r=this._audioStreamConstraints.deviceId,this._audioStreamConstraints=e,r&&(this._audioStreamConstraints.deviceId=r),this._localAudioTrack?(this._localAudioTrack.audioCaptureConfig=this._audioStreamConstraints,[4,null===(t=this._localAudioTrack)||void 0===t?void 0:t.updateAudioCaptureConfig()]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},t.prototype.setVideoCaptureConfig=function(e){var t;return void 0===e&&(e={}),e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){switch(i.label){case 0:return cW.print("setVideoCaptureConfig()","config: %o",e),delete e.deviceId,dk(e),r=this._videoStreamConstraints.deviceId,this._videoStreamConstraints=e,r&&(this._videoStreamConstraints.deviceId=r),this._localVideoTrack?(this._localVideoTrack.videoCaptureConfig=this._videoStreamConstraints,[4,null===(t=this._localVideoTrack)||void 0===t?void 0:t.updateVideoCaptureConfig()]):[3,2];case 1:i.sent(),this._updatePublish(),i.label=2;case 2:return[2]}}))}))},t.prototype.enableSimulcastMode=function(e){return cW.print("enableSimulcastMode()","enabled: %o",e),this._enableSimulcast=e,!0},t.prototype.setVideoEncoderConfig=function(e){var t;return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return cW.print("setVideoEncoderConfig()"," descriptions: %o",e),Array.isArray(e)||(e=[e]),e.length>3&&(e=e.slice(0,3)),e.sort((function(e,t){return t.maxKbps-e.maxKbps})),this._videoStreamEncodeConfig=e,(null===(t=this._room)||void 0===t?void 0:t.hasPublished)&&this._updatePublish(),[2]}))}))},t.prototype.setScreenEncoderConfig=function(e){var t;return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return cW.print("setScreenEncoderConfig()","description: %o",e),this._screenStreamEncodeConfig=[e],(null===(t=this._room)||void 0===t?void 0:t.hasScreenPublished)&&this._updateScreenPublish(),[2]}))}))},t.prototype.sendSEIMessage=function(e,t,r){var i,n,o,a,s,c;cW.print("sendSEIMessage()","streamIdex: %o, message: %o, repeatCount: %o",e,t,r),sk(e,"streamIndex",[xf.STREAM_INDEX_MAIN,xf.STREAM_INDEX_SCREEN]),ok(r,"repeatCount",0,30);var u="string"==typeof t?new Uint8Array(XD.str2ab(t)):t;if(t.length){var d;if(e===xf.STREAM_INDEX_MAIN){if(!(null===(n=null===(i=this._room)||void 0===i?void 0:i.localStream)||void 0===n?void 0:n.hasPublished))return;d=null===(o=this._room)||void 0===o?void 0:o.localStream}else{if(!(null===(s=null===(a=this._room)||void 0===a?void 0:a.localScreenStream)||void 0===s?void 0:s.hasPublished))return;d=null===(c=this._room)||void 0===c?void 0:c.localScreenStream}if(u.byteLength>4096)cW.print("sei size must not bigger than 4KB");else{var l=HD();d.seiList.push({content:u,uuid:l,repeatCount:r}),setTimeout((function(){if(d){var e=d.seiList.findIndex((function(e){return e.uuid===l}));e&&d.seiList.splice(e,1)}}),2e3)}}else cW.print("sei message must not be empty")},t.prototype.setAudioVolumeIndicationInterval=function(e){var t=this;cW.print("setAudioVolumeIndicationInterval()","interval %o: ",e),("number"!=typeof e||e<200)&&(e=200);var r=[];this._audioVolumeIndicationTimer&&clearInterval(this._audioVolumeIndicationTimer),this._audioVolumeIndicationTimer=setInterval((function(){var e,i,n,o;r=[],null===(e=t._room)||void 0===e||e.remoteStreams.forEach((function(e,t){var i;if(0!==e.length){var n=e.find((function(e){return!1===e.isScreen})),o=null===(i=null==n?void 0:n.audioTrack)||void 0===i?void 0:i.getAudioLevel();r.push({userId:t,volume:o||0})}}));var a=null===(i=t._localAudioTrack)||void 0===i?void 0:i.getAudioLevel();r.push({userId:(null===(o=null===(n=t._room)||void 0===n?void 0:n.roomInfo)||void 0===o?void 0:o.userInfo.userId)||"local_user",volume:a||0}),t.safeEmit(u_.onAudioVolumeIndication,{speakers:r})}),e)},t.prototype.enableAudioPropertiesReport=function(e){var t=this;void 0===e&&(e={}),cW.print("enableAudioPropertiesReport()","config %o: ",e);var r=e.interval,i=void 0===r?100:r,n=e.enableInBackground,o=void 0===n||n;this._stopAudioPropertiesReport(),i<=0||(i=Math.max(100,i),this._audioPropertiesReportTimer=self.setInterval((function(){if(o||"hidden"!==document.visibilityState){var e=[],r=t._audioDeviceManager.getRecordTrack()||t._localAudioTrack;if(r){var i=r.getAudioLevel();e.push({streamIndex:xf.STREAM_INDEX_MAIN,audioPropertiesInfo:{linearVolume:i,nonlinearVolume:ek(i)}})}if(t._localScreenAudioTrack){i=t._localScreenAudioTrack.getAudioLevel();e.push({streamIndex:xf.STREAM_INDEX_SCREEN,audioPropertiesInfo:{linearVolume:i,nonlinearVolume:ek(i)}})}if(t.safeEmit(u_.onLocalAudioPropertiesReport,e),t._room){var n=[];t._room.remoteStreams.forEach((function(e,r){e.forEach((function(e){var i,o;if(e.audioTrack){var a=e.audioTrack.getAudioLevel();n.push({streamKey:{userId:r,streamIndex:e.isScreen?xf.STREAM_INDEX_SCREEN:xf.STREAM_INDEX_MAIN,roomId:null===(o=null===(i=t._room)||void 0===i?void 0:i.roomInfo)||void 0===o?void 0:o.roomId},audioPropertiesInfo:{linearVolume:a,nonlinearVolume:ek(a)}})}}))})),t.safeEmit(u_.onRemoteAudioPropertiesReport,n)}}}),i))},t.prototype.setVideoSourceType=function(e,t){var r,i,n,o,a,s,c,u,d,l,h,p,f,_,v,m,S;return e_(this,void 0,void 0,(function(){var y,E,g;return t_(this,(function(b){switch(b.label){case 0:return cW.print("setVideoSourceType()","index: %o, videoSourceType: %o",e,t),sk(e,"streamIndex",[xf.STREAM_INDEX_MAIN,xf.STREAM_INDEX_SCREEN]),sk(t,"VideoSourceType",[Of.VIDEO_SOURCE_TYPE_EXTERNAL,Of.VIDEO_SOURCE_TYPE_INTERNAL]),y=e===xf.STREAM_INDEX_MAIN?"video":"screenVideo",this._trackSourceType[y]===t?[3,4]:(this._trackSourceType[y]=t,cW.print("setVideoSourceType","set ".concat(y," source type to ").concat(t)),this._localVideoTrack&&e===xf.STREAM_INDEX_MAIN?(g=!1,t===Of.VIDEO_SOURCE_TYPE_EXTERNAL&&(g=!0,this._localVideoTrack.close()),null===(r=this._videoPlayer)||void 0===r||r.stop(),this._localVideoTrack=void 0,E=null===(i=this._room)||void 0===i?void 0:i._roomConfig.isAutoPublish,g?null===(a=null===(o=null===(n=this._room)||void 0===n?void 0:n.localStream)||void 0===o?void 0:o.observer)||void 0===a||a.setEnableVideo(!1):null===(u=null===(c=null===(s=this._room)||void 0===s?void 0:s.localStream)||void 0===c?void 0:c.observer)||void 0===u||u.setPushVideo(!1),(null===(d=this._room)||void 0===d?void 0:d.hasPublished)||E?[4,this._updatePublish()]:[3,2]):[3,2]);case 1:b.sent(),b.label=2;case 2:return this._localScreenVideoTrack&&e===xf.STREAM_INDEX_SCREEN?(g=!1,t===Of.VIDEO_SOURCE_TYPE_EXTERNAL&&(g=!0,this._localScreenVideoTrack.close()),null===(l=this._screenPlayer)||void 0===l||l.stop(),this._localScreenVideoTrack=void 0,g?null===(f=null===(p=null===(h=this._room)||void 0===h?void 0:h.localScreenStream)||void 0===p?void 0:p.observer)||void 0===f||f.setEnableVideo(!1):null===(m=null===(v=null===(_=this._room)||void 0===_?void 0:_.localScreenStream)||void 0===v?void 0:v.observer)||void 0===m||m.setPushVideo(!1),(null===(S=this._room)||void 0===S?void 0:S.hasScreenPublished)?[4,this._updateScreenPublish()]:[3,4]):[3,4];case 3:b.sent(),b.label=4;case 4:return[2]}}))}))},t.prototype.setExternalVideoTrack=function(e,t){var r,i,n,o,a,s,c,u;return e_(this,void 0,void 0,(function(){var d;return t_(this,(function(l){switch(l.label){case 0:if(cW.print("setExternalVideoTrack()","index: %o, track: %o",e,t),sk(e,"streamIndex",[xf.STREAM_INDEX_MAIN,xf.STREAM_INDEX_SCREEN]),e!==xf.STREAM_INDEX_MAIN)return[3,2];if(this._trackSourceType.video!==Of.VIDEO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setVideoSourceType as external first");return this._localVideoTrack=new tB(t,HD()),this._initLocalTrackEvents(this._localVideoTrack),null===(r=this._videoPlayer)||void 0===r||r.playVideo(this._localVideoTrack),d=null===(i=this._room)||void 0===i?void 0:i._roomConfig.isAutoPublish,(null===(n=this._room)||void 0===n?void 0:n.hasPublished)||d?[4,this._updatePublish()]:[3,2];case 1:l.sent(),l.label=2;case 2:if(e!==xf.STREAM_INDEX_SCREEN)return[3,4];if(this._trackSourceType.screenVideo!==Of.VIDEO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setVideoSourceType as external first");return this._localScreenVideoTrack=new tB(t,HD()),this._initLocalTrackEvents(this._localScreenVideoTrack),null===(o=this._screenPlayer)||void 0===o||o.playVideo(this._localScreenVideoTrack),null===(c=null===(s=null===(a=this._room)||void 0===a?void 0:a.localScreenStream)||void 0===s?void 0:s.observer)||void 0===c||c.setPushVideo(!0),(null===(u=this._room)||void 0===u?void 0:u.hasScreenPublished)?[4,this._updateScreenPublish()]:[3,4];case 3:l.sent(),l.label=4;case 4:return[2]}}))}))},t.prototype.setAudioSourceType=function(e,t){var r,i,n,o,a,s,c,u,d,l,h,p,f,_,v;return e_(this,void 0,void 0,(function(){var m,S,y;return t_(this,(function(E){switch(E.label){case 0:return cW.print("setAudioSourceType()","index: %o, audioSourceType: %o",e,t),sk(e,"streamIndex",[xf.STREAM_INDEX_MAIN,xf.STREAM_INDEX_SCREEN]),sk(t,"audioSourceType",[Nf.AUDIO_SOURCE_TYPE_EXTERNAL,Nf.AUDIO_SOURCE_TYPE_INTERNAL]),m=e===xf.STREAM_INDEX_MAIN?"audio":"screenAudio",this._trackSourceType[m]===t?[3,4]:(this._trackSourceType[m]=t,cW.print("setVideoSourceType","set ".concat(m," source type to ").concat(t)),this._localAudioTrack&&e===xf.STREAM_INDEX_MAIN?(y=!1,this._trackSourceType.audio===Nf.AUDIO_SOURCE_TYPE_EXTERNAL&&(y=!0,this._localAudioTrack.close()),this._localAudioTrack=void 0,S=null===(r=this._room)||void 0===r?void 0:r._roomConfig.isAutoPublish,y?null===(o=null===(n=null===(i=this._room)||void 0===i?void 0:i.localStream)||void 0===n?void 0:n.observer)||void 0===o||o.setEnableAudio(!1):null===(c=null===(s=null===(a=this._room)||void 0===a?void 0:a.localStream)||void 0===s?void 0:s.observer)||void 0===c||c.setPushAudio(!1),(null===(u=this._room)||void 0===u?void 0:u.hasPublished)||S?[4,this._updatePublish()]:[3,2]):[3,2]);case 1:E.sent(),E.label=2;case 2:return this._localScreenAudioTrack&&e===xf.STREAM_INDEX_SCREEN?(y=!1,this._trackSourceType.audio===Nf.AUDIO_SOURCE_TYPE_EXTERNAL&&(y=!0,this._localScreenAudioTrack.close()),this._localScreenAudioTrack=void 0,y?null===(h=null===(l=null===(d=this._room)||void 0===d?void 0:d.localScreenStream)||void 0===l?void 0:l.observer)||void 0===h||h.setEnableAudio(!1):null===(_=null===(f=null===(p=this._room)||void 0===p?void 0:p.localScreenStream)||void 0===f?void 0:f.observer)||void 0===_||_.setPushAudio(!1),(null===(v=this._room)||void 0===v?void 0:v.hasScreenPublished)?[4,this._updateScreenPublish()]:[3,4]):[3,4];case 3:E.sent(),E.label=4;case 4:return[2]}}))}))},t.prototype.setExternalAudioTrack=function(e,t){var r,i,n,o,a,s,c,u,d;return e_(this,void 0,void 0,(function(){var l;return t_(this,(function(h){switch(h.label){case 0:if(cW.print("setExternalAudioTrack()","index: %o, track: %o",e,t),sk(e,"streamIndex",[xf.STREAM_INDEX_MAIN,xf.STREAM_INDEX_SCREEN]),e!==xf.STREAM_INDEX_MAIN)return[3,2];if(this._trackSourceType.audio!==Nf.AUDIO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setAudioSourceType as external first");return this._localAudioTrack=new rB(t,HD()),this._initLocalTrackEvents(this._localAudioTrack),l=null===(r=this._room)||void 0===r?void 0:r._roomConfig.isAutoPublish,null===(o=null===(n=null===(i=this._room)||void 0===i?void 0:i.localStream)||void 0===n?void 0:n.observer)||void 0===o||o.setPushAudio(!0),(null===(a=this._room)||void 0===a?void 0:a.hasPublished)||l?[4,this._updatePublish()]:[3,2];case 1:h.sent(),h.label=2;case 2:if(e!==xf.STREAM_INDEX_SCREEN)return[3,4];if(this._trackSourceType.screenAudio!==Nf.AUDIO_SOURCE_TYPE_EXTERNAL)throw new dP(oP.STREAM_TYPE_NOT_MATCH,"setAudioSourceType as external first");return this._localScreenAudioTrack=new rB(t,HD()),this._initLocalTrackEvents(this._localScreenAudioTrack),null===(u=null===(c=null===(s=this._room)||void 0===s?void 0:s.localScreenStream)||void 0===c?void 0:c.observer)||void 0===u||u.setPushAudio(!0),(null===(d=this._room)||void 0===d?void 0:d.hasScreenPublished)?[4,this._updateScreenPublish()]:[3,4];case 3:h.sent(),h.label=4;case 4:return[2]}}))}))},t.prototype.login=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return cW.print("login()","token: %o, userInfo: %o",e,t),lk(e)||ak(e,"token"),hk(t),[2,this._rtmClient.login(e,t)]}))}))},t.prototype.logout=function(){return e_(this,void 0,void 0,(function(){return t_(this,(function(e){return cW.print("logout()"),[2,this._rtmClient.logout()]}))}))},t.prototype.updateLoginToken=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){return cW.print("updateLoginToken()","token: %o",e),lk(e)||ak(e,"token"),[2,this._rtmClient.updateLoginToken(e)]}))}))},t.prototype.getPeerOnlineStatus=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){return cW.print("getPeerOnlineStatus()","userId: %o",e),hk(e),[2,this._rtmClient.getPeerOnlineStatus(e)]}))}))},t.prototype.sendUserMessageOutsideRoom=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return hk(e),_k(t),[2,this._rtmClient.sendUserMessageOutsideRoom(e,t)]}))}))},t.prototype.sendUserBinaryMessageOutsideRoom=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return hk(e),uk(t,"message"),_k(t),[2,this._rtmClient.sendUserMessageOutsideRoom(e,t)]}))}))},t.prototype.setServerParams=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){return cW.print("setServerParams()","signature: %o, url: %0",e,t),ak(e,"signature"),ak(t,"url"),[2,this._rtmClient.setServerParams(e,t)]}))}))},t.prototype.sendServerMessage=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){return ak(e,"message"),_k(e),[2,this._rtmClient.sendServerMessage(e)]}))}))},t.prototype.sendServerBinaryMessage=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){return uk(e,"message"),_k(e),[2,this._rtmClient.sendServerMessage(e)]}))}))},t.prototype.startCloudProxy=function(e){if(this._room)throw new dP(oP.START_CLOUD_PROXY_AFTER_JOIN,"[startCloudProxy] should be invoke before join room ");var t;cW.print("startCloudProxy()",e),ak(e.logProxy,"logProxy"),ak(e.accessProxy,"accessProxy"),ak(e.configProxy,"configProxy"),this._originIceConfigRequestUrls=Mx("ICE_CONFIG_REQUEST_URLS"),this._originLogServerUrl=Mx("LOG_SERVER_URL"),this._originConfigServerUrls=Mx("CONFIG_REQUEST_DOMAINS"),kx("ICE_CONFIG_REQUEST_URLS",e.accessProxy),kx("LOG_SERVER_URL",(void 0===(t=e.logProxy)&&(t=""),"https://".concat(t,"/video/v1/webrtc_log/"))),kx("CONFIG_REQUEST_DOMAINS",[e.configProxy]),this._useCloudProxy=!0},t.prototype.stopCloudProxy=function(){if(this._room)throw new dP(oP.STOP_CLOUD_PROXY_BEFORE_LEAVE,"[stopCloudProxy] should be invoke after leave room ");cW.print("stopCloudProxy()"),kx("ICE_CONFIG_REQUEST_URLS",[]),kx("LOG_SERVER_URL",this._originLogServerUrl),kx("CONFIG_REQUEST_DOMAINS",this._originConfigServerUrls),this._useCloudProxy=!1,this._startCloudProxyTimestamp=void 0},t.prototype.startPushPublicStream=function(e,t){return e_(this,void 0,void 0,(function(){var r,i=this;return t_(this,(function(n){if(cW.print("startPushPublicStream()","publicStreamId: %o, publicStreamParam: %o",e,t),pk(e),!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.START_PUBLIC_STREAM_BEFORE_JOIN,"join first");if(this._publicStreamIds.get(e))throw new dP(oP.REPEAT_PUSH,"repeat push public media stream");return r=Lx(e,"started",t),[2,this._room.publicStreamControlMessage(r).then((function(){i._publicStreamIds.set(e,e)}))]}))}))},t.prototype.updatePublicStreamParam=function(e,t){return e_(this,void 0,void 0,(function(){var r;return t_(this,(function(i){if(cW.print("startPushPublicStream()","publicStreamId: %o, publicStreamParam: %o",e,t),pk(e),!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.START_PUBLIC_STREAM_BEFORE_JOIN,"join first");return r=Lx(e,"layoutChanged",t),[2,this._room.publicStreamControlMessage(r)]}))}))},t.prototype.stopPushPublicStream=function(e){return e_(this,void 0,void 0,(function(){var t=this;return t_(this,(function(r){if(cW.print("startPushPublicStream()","publicStreamId: %o",e),pk(e),!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.START_PUBLIC_STREAM_BEFORE_JOIN,"join first");return[2,this._room.publicStreamControlMessage({type:"publicstream",action:"stopped",publicStreamID:e}).then((function(){t._publicStreamIds.delete(e)}))]}))}))},t.prototype.startPlayPublicStream=function(e){var t,r;return e_(this,void 0,void 0,(function(){var i,n,o,a=this;return t_(this,(function(s){switch(s.label){case 0:return pk(e),this._outsideRoom?[3,2]:(this._outsideRoom=new nW(this._appId),this._outsideRoom.on(cB.RESUBSCRIBE,(function(e){var t,r,i=e.stream;if(i){var n=a._publicStreamAudioPlayer.get(i.streamId);n&&i.audioTrack&&(n.stop(),n.playAudio(null===(t=e.stream)||void 0===t?void 0:t.audioTrack));var o=a._publicStreamVideoPlayer.get(i.streamId);o&&i.videoTrack&&o.playVideo(null===(r=e.stream)||void 0===r?void 0:r.videoTrack)}})),null===(t=this._outsideRoom)||void 0===t||t.on("onRemoteStreamStats",(function(e){e.publicStreamId=e.userId,delete e.userId,delete e.isScreen,a.safeEmit(u_.onPublicStreamStats,e)})),null===(r=this._outsideRoom)||void 0===r||r.on(cB.ON_SEI_MESSAGED_RECEIVED,(function(e){a.safeEmit(u_.onPublicStreamSEIMessageReceived,e)})),[4,this._outsideRoom.connect()]);case 1:s.sent(),s.label=2;case 2:return[4,this._outsideRoom.startPlayPublicStream(e)];case 3:return i=s.sent(),(n=this._publicStreamVideoPlayer.get(e))&&(null==i?void 0:i.videoTrack)&&n.playVideo(i.videoTrack,i),!(o=this._publicStreamAudioPlayer.get(e))&&(null==i?void 0:i.audioTrack)&&(o=new dj(e),this._initPlayerEvents(o,!0),o.playAudio(i.audioTrack),this._publicStreamAudioPlayer.set(e,o)),[2]}}))}))},t.prototype.stopPlayPublicStream=function(e){return e_(this,void 0,void 0,(function(){var t;return t_(this,(function(r){return this._outsideRoom?(this._outsideRoom.stopPlayPublicStream(e),(t=this._publicStreamAudioPlayer.get(e))&&(t.destroy(),this._publicStreamAudioPlayer.delete(e)),[2]):[2]}))}))},t.prototype.setAudioProfile=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){return this._audioProfileManager.setAudioProfile(e),[2]}))}))},t.prototype.setPublicStreamVideoPlayer=function(e,t){var r,i;cW.print("setPublicStreamVideoPlayer()","publicStreamId: %o, videoPlayerOption: %o",e,t);var n=this._publicStreamVideoPlayer.get(e);if(!(null==t?void 0:t.renderDom)&&n)return n.destroy(),void this._publicStreamVideoPlayer.delete(e);if(!n){n=new uj(Zf(Zf({},t),{userId:e})),this._initPlayerEvents(n,!0),this._publicStreamVideoPlayer.set(e,n);var o=null===(i=null===(r=this._outsideRoom)||void 0===r?void 0:r.remoteStreams)||void 0===i?void 0:i.get(e);(null==o?void 0:o.videoTrack)&&n.playVideo(o.videoTrack,o)}},t.prototype.setDummyCaptureImagePath=function(e,t){return e_(this,void 0,void 0,(function(){var r=this;return t_(this,(function(i){return[2,new Promise((function(i,n){ak(t,"filePath");var o=new Image;o.crossOrigin="anonymous",o.src=t,o.onload=function(){try{var t=document.createElement("canvas"),a=t.getContext("2d");if(!a)return n(new dP(oP.UNEXPECTED_ERROR,"Not support canvas"));t.width=o.width,t.height=o.height,a.drawImage(o,0,0,o.width,o.height),clearInterval(r._dummyTimer),r._dummyTimer=window.setInterval((function(){a.drawImage(o,0,0,o.width,o.height)}),200);var s=t.captureStream(5).getVideoTracks()[0];e===xf.STREAM_INDEX_MAIN?r._localImgVideoTrack=s:r._localImgScreenTrack=s,i()}catch(e){n(new dP(oP.UNEXPECTED_ERROR,e.message))}},o.onerror=function(){n(new dP(oP.UNEXPECTED_ERROR,"Load image error"))}}))]}))}))},t.prototype.defaultTranscoding=function(){return JSON.parse(JSON.stringify(Yx))},t.prototype._updatePublish=function(e){return void 0===e&&(e={}),e_(this,void 0,void 0,(function(){var t,r,i;return t_(this,(function(n){switch(n.label){case 0:if(cW.print("_updatePublish()","config: %o",e),t={mediaType:void 0,invokeByJoinRoom:!1,pubState:lB.PUB},e=Zf(Zf({},t),e),!this._visibility)throw new dP(oP.NO_PUBLISH_PERMISSION,"no publish permission");return[4,this._pubLock.lock()];case 1:if(r=n.sent(),!this._room||this._room.connectionState!==mB.CONNECTED)return r(),[2];n.label=2;case 2:return n.trys.push([2,4,5,6]),[4,this._room.publish(this._videoStreamEncodeConfig,this._enableSimulcast,this._localVideoTrack,this._localAudioTrack,e.mediaType,e.pubState,e.invokeByJoinRoom)];case 3:return n.sent(),[3,6];case 4:throw(i=n.sent())instanceof dP?i:new dP(oP.UNEXPECTED_ERROR,"unexpected error",i);case 5:return r(),[7];case 6:return[2]}}))}))},t.prototype.startAudioPlaybackDeviceTest=function(e,t){return e_(this,void 0,void 0,(function(){return t_(this,(function(r){switch(r.label){case 0:return cW.print("startAudioPlaybackDeviceTest()","filePath: %o, indicationInterval: %o",e,t),ak(e,"filePath"),ok(t,"indicationInterval"),[4,this._audioDeviceManager.startAudioPlaybackDeviceTest(e,t)];case 1:return[2,r.sent()]}}))}))},t.prototype.stopAudioPlaybackDeviceTest=function(){cW.print("stopAudioPlaybackDeviceTest()"),this._audioDeviceManager.stopAudioPlaybackDeviceTest()},t.prototype.startAudioDeviceRecordTest=function(e){return e_(this,void 0,void 0,(function(){return t_(this,(function(t){switch(t.label){case 0:return cW.print("startAudioDeviceRecordTest()","indicationInterval: %o",e),ok(e,"indicationInterval"),[4,this._audioDeviceManager.startAudioDeviceRecordTest(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.stopAudioDeviceRecordAndPlayTest=function(){cW.print("stopAudioDeviceRecordAndPlayTest()"),this._audioDeviceManager.stopAudioDeviceRecordAndPlayTest()},t.prototype.stopAudioDevicePlayTest=function(){cW.print("stopAudioDevicePlayTest()"),this._audioDeviceManager.stopAudioDevicePlayTest()},t.prototype.setRemoteUserPriority=function(e,t){var r;cW.print("setRemoteUserPriority()","userId: %o, priority: %o",e,t);try{hk(e),sk(t,"priority",[Xf.HIGH,Xf.MEDIUM,Xf.LOW])}catch(e){return console.warn(e),!1}return this._userPriorityMap.set(e,t),null===(r=this._room)||void 0===r||r.setRemoteUserPriority(e,t),!0},t.prototype.setSubscribeFallbackOption=function(e){cW.print("setSubscribeFallbackOption()","option: %o",e);try{sk(e,"option",[Wf.DISABLE,Wf.VIDEO_STREAM_LOW,Wf.AUDIO_ONLY])}catch(e){return console.warn(e),!1}return!this._room&&(this._subscribeFallbackOption=e,!0)},t.prototype._updateScreenPublish=function(e){return void 0===e&&(e={}),e_(this,void 0,void 0,(function(){var t,r,i;return t_(this,(function(n){switch(n.label){case 0:return cW.print("_updateScreenPublish()"),t={mediaType:void 0,pubState:lB.PUB},e=Zf(Zf({},t),e),[4,this._pubLock.lock()];case 1:if(r=n.sent(),!this._room||this._room.connectionState!==mB.CONNECTED)return r(),[2];n.label=2;case 2:return n.trys.push([2,4,5,6]),[4,this._room.publishScreen(this._screenStreamEncodeConfig,this._localScreenVideoTrack,this._localScreenAudioTrack,e.mediaType,e.pubState)];case 3:return n.sent(),[3,6];case 4:throw(i=n.sent())instanceof dP?i:new dP(oP.UNEXPECTED_ERROR,"unexpected error",i);case 5:return r(),[7];case 6:return[2]}}))}))},t.prototype._updateAudioPlayerState=function(e){cW.print("_updateAudioPlayerState()");var t,r=e.userId,i=e.isScreen;if(t=i?this._remoteAudioPlayer.get("".concat(r,"_screen")):this._remoteAudioPlayer.get(r),e.audioTrack){if(!t){var n=i?"".concat(r,"_screen"):r;t=new dj(n),this._initPlayerEvents(t),this._remoteAudioPlayer.set(n,t),this._audioPlaybackDeviceId&&t.setPlaybackDevice(this._audioPlaybackDeviceId)}t.playAudio(e.audioTrack)}else null==t||t.stop()},t.prototype._updateVideoPlayerState=function(e){cW.print("_updateVideoPlayerState()");var t,r=e.userId;t=e.isScreen?this._remoteScreenPlayer.get(r):this._remoteVideoPlayer.get(r),e.videoTrack?t&&t.playVideo(e.videoTrack,e):null==t||t.stop()},t.prototype._onAddStream=function(e){var t,r,i,n,o=e.stream,a=null==o?void 0:o.attributes,s=a.localaudio,c=a.audiostream,u=a.localvideo,d=a.videostream,l=aB.NONE;if(c&&(l|=Vf.AUDIO),d&&(l|=Vf.VIDEO),l){if(null==o?void 0:o.isScreen)this.safeEmit(u_.onUserPublishScreen,{userId:o.userId,mediaType:l});else{this.safeEmit(u_.onUserPublishStream,{userId:o.userId,mediaType:l});var h=aB.NONE;(null===(t=this._roomConfig)||void 0===t?void 0:t.isAutoSubscribeAudio)&&(h|=Vf.AUDIO),(null===(r=this._roomConfig)||void 0===r?void 0:r.isAutoSubscribeVideo)&&(h|=Vf.VIDEO),cW.print("_onAddStream","autoSubType: ".concat(h)),h&&(tk(h)&&(null===(i=o.observer)||void 0===i||i.setAutoSubscribeAudio(!0)),rk(h)&&(null===(n=o.observer)||void 0===n||n.setAutoSubscribeVideo(!0)),this._subscribe(!1,o.userId,h))}(null==o?void 0:o.isScreen)||(s&&this.safeEmit(u_.onUserStartAudioCapture,{userId:o.userId}),u&&this.safeEmit(u_.onUserStartVideoCapture,{userId:o.userId}))}},t.prototype._onRemoveStream=function(e){var t,r=this,i=e.stream,n=null!==(t=dW[e.reason])&&void 0!==t?t:Ff.STREAM_REMOVE_REASON_OTHER,o=i.isScreen?u_.onUserUnpublishScreen:u_.onUserUnpublishStream;this.safeEmit(o,{userId:i.userId,mediaType:Vf.AUDIO_AND_VIDEO,reason:n}),this._getRemotePlayer(i.userId,i.isScreen).forEach((function(e){if(!(null==i?void 0:i._workaround_1_)){var t=i.isScreen?"".concat(i.userId,"_screen"):i.userId;r._remoteAudioPlayer.delete(t),i.isScreen?r._remoteScreenPlayer.delete(i.userId):r._remoteVideoPlayer.delete(i.userId),null==e||e.destroy()}}))},t.prototype._onUserConnection=function(e){this.safeEmit(u_.onUserJoined,e)},t.prototype._onUserLeave=function(e){this.safeEmit(u_.onUserLeave,e)},t.prototype._onRoomError=function(e){var t;this.safeEmit(u_.onError,e),null===(t=this._room)||void 0===t||t.destroy(),this._room=void 0},t.prototype._onNetworkQuality=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.safeEmit.apply(this,n_([u_.onNetworkQuality],i_(e),!1))},t.prototype._onConnectionStateChange=function(e){void 0!==this._startCloudProxyTimestamp&&this._useCloudProxy&&e.state===Bf.CONNECTION_STATE_CONNECTED&&this.safeEmit(u_.onCloudProxyConnected,{interval:Date.now()-this._startCloudProxyTimestamp}),this.safeEmit(u_.onConnectionStateChanged,e)},t.prototype._getRemotePlayer=function(e,t){return[this._remoteAudioPlayer.get(t?"".concat(e,"_screen"):e),(t?this._remoteScreenPlayer:this._remoteVideoPlayer).get(e)]},t.prototype._stopAudioPropertiesReport=function(){null!==this._audioPropertiesReportTimer&&(clearInterval(this._audioPropertiesReportTimer),this._audioPropertiesReportTimer=null)},t.prototype._onResubscribe=function(e){e.stream&&(this._getRemotePlayer(e.stream.userId,e.stream.isScreen).forEach((function(e){return null==e?void 0:e.stop()})),this._updateAudioPlayerState(e.stream),this._updateVideoPlayerState(e.stream))},t.prototype._onSubscribePushTrack=function(e){e.stream&&this._updateAudioPlayerState(e.stream)},t.prototype._onRemovePushTrack=function(e){e.stream&&this._updateAudioPlayerState(e.stream)},t.prototype._onVideoFirstFrameDecoded=function(e){this.safeEmit(u_.onVideoFirstFrameDecoded,e)},t.prototype._onVideoDeviceStateChange=function(e){this.safeEmit(u_.onVideoDeviceStateChanged,e)},t.prototype._onAudioDeviceStateChange=function(e){this.safeEmit(u_.onAudioDeviceStateChanged,e)},t.prototype._onUserPublishStateChange=function(e){var t=e.userId,r=e.isScreen,i=e.mediaType,n=e.pubState,o={userId:t,mediaType:i};r?n===lB.PUB?this.safeEmit(u_.onUserPublishScreen,o):this.safeEmit(u_.onUserUnpublishScreen,Zf(Zf({},o),{reason:Ff.STREAM_REMOVE_REASON_UNPUBLISH})):n===lB.PUB?this.safeEmit(u_.onUserPublishStream,o):this.safeEmit(u_.onUserUnpublishStream,Zf(Zf({},o),{reason:Ff.STREAM_REMOVE_REASON_UNPUBLISH}))},t.prototype._onCustomMessage=function(e){var t=e.message;e.binary?this.safeEmit(u_.onRoomBinaryMessageReceived,{userId:e.clientId,message:t}):this.safeEmit(u_.onRoomMessageReceived,{userId:e.clientId,message:t})},t.prototype._onUserMessageReceived=function(e){this.safeEmit(u_.onUserMessageReceived,e)},t.prototype._onUserBinaryMessageReceived=function(e){this.safeEmit(u_.onUserBinaryMessageReceived,e)},t.prototype._onLiveTranscodingResult=function(e){this.safeEmit(u_.onLiveTranscodingResult,e)},t.prototype._onStreamMixingEvent=function(e){this.safeEmit(u_.onStreamMixingEvent,e)},t.prototype._onUserTokenWillExpire=function(){this.safeEmit(u_.onTokenWillExpire)},t.prototype._onPushPublicStreamResult=function(e){this.safeEmit(u_.onPushPublicStreamResult,e)},t.prototype._handleRTMClient=function(e){var t=this;e.on("onUserMessageReceivedOutsideRoom",(function(e){t.safeEmit(u_.onUserMessageReceivedOutsideRoom,e)})),e.on("onUserBinaryMessageReceivedOutsideRoom",(function(e){t.safeEmit(u_.onUserBinaryMessageReceivedOutsideRoom,e)})),e.on("onUserDisconnection",(function(){t.safeEmit(u_.onError,{errorCode:oP.RTM_DUPLICATE_LOGIN})})),e.on("onRTMTokenError",(function(){t.safeEmit(u_.onError,{errorCode:oP.RTM_TOKEN_ERROR})}))},Object.defineProperty(t.prototype,"waitForNewToken",{get:function(){return!!this._tempRoomConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localAudioTrack",{get:function(){return this._localAudioTrack},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localVideoTrack",{get:function(){return this._localVideoTrack},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localScreenAudioTrack",{get:function(){return this._localScreenAudioTrack},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localScreenVideoTrack",{get:function(){return this._localScreenVideoTrack},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteStreams",{get:function(){var e,t,r=[];return(null===(e=this._room)||void 0===e?void 0:e.remoteStreams)&&(null===(t=this._room)||void 0===t||t.remoteStreams.forEach((function(e){Array.isArray(e)&&e.forEach((function(e){r.push({userId:e.userId,isScreen:e.isScreen,hasVideo:e.hasVideo,hasAudio:e.hasAudio,videoStreamDescriptions:e.attributes.videoDescriptions})}))}))),r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteUsers",{get:function(){var e,t,r=[];return(null===(e=this._room)||void 0===e?void 0:e.remoteUsers)&&(null===(t=this._room)||void 0===t||t.remoteUsers.forEach((function(e){r.push({userId:e.userId})}))),r},enumerable:!1,configurable:!0}),t.prototype._handleAudioDeviceManager=function(){var e=this;this._audioDeviceManager.on("onAudioPlaybackDeviceTestVolume",(function(t){e.safeEmit(u_.onAudioPlaybackDeviceTestVolume,t)}))},t.prototype._assertNotInRoom=function(){if(!this._room||this._room.connectionState!==mB.CONNECTED)throw new dP(oP.INVOKED_BEFORE_JOIN_ROOM,"join first")},t.prototype._checkMediaType=function(e){sk(e,"mediaType",[Vf.AUDIO,Vf.VIDEO,Vf.AUDIO_AND_VIDEO])},$f([mx()],t.prototype,"updateToken",null),$f([mx()],t.prototype,"setVideoCaptureDevice",null),$f([mx()],t.prototype,"setAudioCaptureDevice",null),$f([mx()],t.prototype,"joinRoom",null),$f([mx()],t.prototype,"leaveRoom",null),$f([mx()],t.prototype,"destroy",null),$f([mx()],t.prototype,"publishStream",null),$f([mx()],t.prototype,"unpublishStream",null),$f([mx()],t.prototype,"publishScreen",null),$f([mx()],t.prototype,"unpublishScreen",null),$f([mx()],t.prototype,"subscribeStream",null),$f([mx()],t.prototype,"unsubscribeStream",null),$f([mx()],t.prototype,"subscribeScreen",null),$f([mx()],t.prototype,"unsubscribeScreen",null),$f([mx()],t.prototype,"setRemoteVideoConfig",null),$f([mx()],t.prototype,"startVideoCapture",null),$f([mx()],t.prototype,"stopVideoCapture",null),$f([mx()],t.prototype,"startAudioCapture",null),$f([mx()],t.prototype,"stopAudioCapture",null),$f([mx()],t.prototype,"getAudioMixingManager",null),$f([mx()],t.prototype,"startScreenCapture",null),$f([mx()],t.prototype,"stopScreenCapture",null),$f([mx()],t.prototype,"setLocalVideoPlayer",null),$f([mx()],t.prototype,"startLiveTranscoding",null),$f([mx()],t.prototype,"updateLiveTranscoding",null),$f([mx()],t.prototype,"stopLiveTranscoding",null),$f([mx()],t.prototype,"setBusinessId",null),$f([mx()],t.prototype,"setUserVisibility",null),$f([mx()],t.prototype,"setRemoteVideoPlayer",null),$f([mx()],t.prototype,"setLocalVideoMirrorType",null),$f([mx()],t.prototype,"setAudioPlaybackDevice",null),$f([mx()],t.prototype,"play",null),$f([mx()],t.prototype,"pauseAllSubscribedStream",null),$f([mx()],t.prototype,"resumeAllSubscribedStream",null),$f([mx()],t.prototype,"sendUserMessage",null),$f([mx()],t.prototype,"sendUserBinaryMessage",null),$f([mx()],t.prototype,"sendRoomMessage",null),$f([mx()],t.prototype,"sendRoomBinaryMessage",null),$f([mx()],t.prototype,"setAudioCaptureConfig",null),$f([mx()],t.prototype,"setVideoCaptureConfig",null),$f([mx()],t.prototype,"enableSimulcastMode",null),$f([mx()],t.prototype,"setVideoEncoderConfig",null),$f([mx()],t.prototype,"setScreenEncoderConfig",null),$f([mx()],t.prototype,"sendSEIMessage",null),$f([mx()],t.prototype,"setAudioVolumeIndicationInterval",null),$f([mx()],t.prototype,"enableAudioPropertiesReport",null),$f([mx()],t.prototype,"setVideoSourceType",null),$f([mx()],t.prototype,"setExternalVideoTrack",null),$f([mx()],t.prototype,"setAudioSourceType",null),$f([mx()],t.prototype,"setExternalAudioTrack",null),$f([mx("rtm")],t.prototype,"login",null),$f([mx("rtm")],t.prototype,"logout",null),$f([mx("rtm")],t.prototype,"updateLoginToken",null),$f([mx("rtm")],t.prototype,"getPeerOnlineStatus",null),$f([mx("rtm")],t.prototype,"sendUserMessageOutsideRoom",null),$f([mx("rtm")],t.prototype,"sendUserBinaryMessageOutsideRoom",null),$f([mx("rtm")],t.prototype,"setServerParams",null),$f([mx("rtm")],t.prototype,"sendServerMessage",null),$f([mx("rtm")],t.prototype,"sendServerBinaryMessage",null),$f([mx()],t.prototype,"startCloudProxy",null),$f([mx()],t.prototype,"stopCloudProxy",null),$f([mx()],t.prototype,"startPushPublicStream",null),$f([mx()],t.prototype,"updatePublicStreamParam",null),$f([mx()],t.prototype,"stopPushPublicStream",null),$f([mx("outsideRoom")],t.prototype,"startPlayPublicStream",null),$f([mx("outsideRoom")],t.prototype,"stopPlayPublicStream",null),$f([mx()],t.prototype,"setAudioProfile",null),$f([mx("outsideRoom")],t.prototype,"setPublicStreamVideoPlayer",null),$f([mx()],t.prototype,"setDummyCaptureImagePath",null),$f([mx()],t.prototype,"startAudioPlaybackDeviceTest",null),$f([mx()],t.prototype,"stopAudioPlaybackDeviceTest",null),$f([mx()],t.prototype,"startAudioDeviceRecordTest",null),$f([mx()],t.prototype,"stopAudioDeviceRecordAndPlayTest",null),$f([mx()],t.prototype,"stopAudioDevicePlayTest",null),$f([mx()],t.prototype,"setRemoteUserPriority",null),$f([mx()],t.prototype,"setSubscribeFallbackOption",null),t}(Tk),dW={"client unpublished":Ff.STREAM_REMOVE_REASON_UNPUBLISH,"publish failed":Ff.STREAM_REMOVE_REASON_PUBLISH_FAILED,"stream removed":Ff.STREAM_REMOVE_REASON_KEEP_LIVE_FAILED,"client disconnected":Ff.STREAM_REMOVE_REASON_CLIENT_DISCONNECTED,"client republish":Ff.STREAM_REMOVE_REASON_REPUBLISH},lW=new gk("VERTC",0);[px,fx,_x].forEach((function(e){return e.setStats({rtc_sdk_version:Qx.VERSION,product_line:fL.RTC,report_version:_L.W_5,os:vL.WEB,device_id:Cx.getDeviceId(),user_agent:WD()?"":null===navigator||void 0===navigator?void 0:navigator.userAgent})}));var hW=function(e){return lW.print("createEngine","Invoke VERTC.createEngine"),ak(e,"appId"),[px,fx,_x].forEach((function(t){return t.setStats({rtc_app_id:e})})),dx.sdkInitEngine(Date.now(),WL.BEGIN),new uW(e)},pW=function(e){if(lW.print("destroyEngine","Invoke VERTC.destroyEngine"),!(e instanceof uW))throw new dP(oP.INVALID_ENGINE,"Invalid engine object");e.destroy(),dx.sdkInitEngine(Date.now(),WL.END)},fW=function(){return e_(void 0,void 0,void 0,(function(){return t_(this,(function(e){return[2,xF.enumerateDevices()]}))}))},_W=function(e){return void 0===e&&(e={video:!0,audio:!0}),e_(void 0,void 0,void 0,(function(){var t,r,i,n,o;return t_(this,(function(a){switch(a.label){case 0:if(t=e.video,r=e.audio,i={video:!1,audio:!1},!t)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),n=i,[4,xF.getVideoPermission()];case 2:return n.video=a.sent(),[3,4];case 3:return a.sent(),[3,4];case 4:if(!r)return[3,8];a.label=5;case 5:return a.trys.push([5,7,,8]),o=i,[4,xF.getAudioPermission()];case 6:return o.audio=a.sent(),[3,8];case 7:return a.sent(),[3,8];case 8:return[2,i]}}))}))},vW=function(){return e_(void 0,void 0,void 0,(function(){return t_(this,(function(e){return[2,xF.enumerateAudioCaptureDevices()]}))}))},mW=function(){return e_(void 0,void 0,void 0,(function(){return t_(this,(function(e){return[2,xF.enumerateVideoCaptureDevices()]}))}))},SW=function(){return e_(void 0,void 0,void 0,(function(){return t_(this,(function(e){return[2,xF.enumerateAudioPlaybackDevices()]}))}))},yW=function(){return Qx.VERSION},EW=function(){return dx.rtcSdkApiCall("isSupported",0,""),e_(void 0,void 0,void 0,(function(){var e;return t_(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),!WD()&&window.RTCPeerConnection&&window.RTCPeerConnection.prototype.addTransceiver&&window.RTCPeerConnection.prototype.createDataChannel?[4,zV()]:[2,!1];case 1:return[2,null==(e=t.sent())?void 0:e.includes("H264")];case 2:return t.sent(),[2,!1];case 3:return[2]}}))}))},gW=function(){return dx.rtcSdkApiCall("getSupportedCodecs",0,""),e_(void 0,void 0,void 0,(function(){return t_(this,(function(e){switch(e.label){case 0:return[4,zV()];case 1:return[2,e.sent().map((function(e){return e.toUpperCase()}))]}}))}))};!WD()&&location.search.includes("_rtc_autotest_");var bW=new function(){this.getSdkVersion=yW,this.createEngine=hW,this.destroyEngine=pW,this.enumerateDevices=fW,this.enableDevices=_W,this.enumerateAudioCaptureDevices=vW,this.enumerateVideoCaptureDevices=mW,this.enumerateAudioPlaybackDevices=SW,this.getParameter=Mx,this.setParameter=kx,this.isSupported=EW,this.getSupportedCodecs=gW,this.events=u_,this.ErrorCode=oP,this.platform="VolcEngine",this._monitor=dx};return Zf(Zf(Zf(Zf({},bW),c_),l_),{events:u_})}));
